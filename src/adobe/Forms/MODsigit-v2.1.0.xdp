<?xml version="1.0" encoding="UTF-8"?>
<?xfa generator="AdobeLiveCycleDesigner_V11.0.1.20130830.1.901444" APIVersion="3.6.13235.0"?>
<xdp:xdp xmlns:xdp="http://ns.adobe.com/xdp/" timeStamp="2018-10-05T09:04:01Z" uuid="637d1c42-5089-4862-9178-784641de0e7f">
<template xmlns="http://www.xfa.org/schema/xfa-template/2.8/">
   <?formServer defaultPDFRenderFormat acrobat9.0dynamic?>
   <?formServer allowRenderCaching 0?>
   <?formServer formModel both?>
   <subform name="MOD" layout="tb" locale="it_IT">
      <pageSet>
         <pageArea name="Page1" id="Page1">
            <contentArea x="5.644mm" y="11.121mm" w="201.004mm" h="263.871mm" id="contentArea_ID021144"/>
            <medium stock="a4" short="210mm" long="297mm"/>
            <draw name="txcatasto" x="5.257mm" y="3.235mm" w="39.247mm" minH="6mm">
               <value>
                  <exData contentType="text/html">
                     <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p>COD. CATASTO<span style="xfa-spacerun:yes"> </span><span style="font-size:6pt">(cod. impianto)</span></p></body>
                  </exData>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
               <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
            </draw>
            <field name="codCatasto" y="3.235mm" w="14.356mm" h="6mm" x="45.091mm" access="protected">
               <ui>
                  <textEdit hScrollPolicy="off">
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge/>
                        <edge presence="hidden"/>
                        <?templateDesigner StyleID aped1?></border>
                     <margin/>
                  </textEdit>
               </ui>
               <font typeface="Verdana" size="8pt"/>
               <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
               <para vAlign="middle"/>
               <caption reserve="0.01in">
                  <para vAlign="middle"/>
               </caption>
               <border>
                  <edge presence="hidden"/>
               </border>
               <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.codiceCatasto"/>
            </field>
            <draw name="txAllagatoI" x="173.892mm" y="1.213mm" w="29.522mm" minH="6mm">
               <value>
                  <exData contentType="text/html">
                     <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">ALLEGATO I<span style="xfa-spacerun:yes">  </span><span style="font-size:6pt;color:#808080"> (Art. 1)</span></p></body>
                  </exData>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle"/>
               <font size="8pt" typeface="Verdana"/>
            </draw>
            <draw name="Pages" w="23.514mm" h="4.09mm" x="179.554mm" y="7.482mm">
               <ui>
                  <textEdit>
                     <margin/>
                  </textEdit>
               </ui>
               <value>
                  <exData contentType="text/html" maxLength="0">
                     <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p>Pagina<span style="xfa-spacerun:yes"> </span><span xfa:embedType="uri" xfa:embedMode="raw" xfa:embed="#floatingField005454"/> di<span style="xfa-spacerun:yes"> </span><span xfa:embedType="uri" xfa:embedMode="raw" xfa:embed="#floatingField001575"/></p></body>
                  </exData>
               </value>
               <font typeface="Verdana" size="7pt">
                  <fill>
                     <color value="128,128,128"/>
                  </fill>
               </font>
               <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
               <para vAlign="middle" hAlign="right"/>
            </draw>
            <field h="7.5mm" name="CurrentPage" presence="hidden" w="55mm" access="readOnly" x="348.795mm" y="16.378mm" id="floatingField005454">
               <ui>
                  <numericEdit>
                     <border>
                        <edge stroke="lowered"/>
                     </border>
                     <margin/>
                  </numericEdit>
               </ui>
               <font typeface="Verdana" size="8pt"/>
               <margin bottomInset="1mm" leftInset="1mm" rightInset="1mm" topInset="1mm"/>
               <para vAlign="middle"/>
               <caption reserve="20mm">
                  <para vAlign="middle"/>
                  <value>
                     <text>Text Field</text>
                  </value>
               </caption>
               <calculate override="error"/>
               <event name="event__layout_ready" activity="ready" ref="$layout">
                  <script contentType="application/x-javascript">this.rawValue = xfa.layout.page(this);
</script>
               </event>
               <?templateDesigner floatingFieldPlaceholder #?>
               <bind match="none"/>
            </field>
            <field h="7.5mm" name="PageCount" presence="hidden" w="55mm" access="readOnly" x="348.795mm" y="16.378mm" id="floatingField001575">
               <ui>
                  <numericEdit>
                     <border>
                        <edge stroke="lowered"/>
                     </border>
                     <margin/>
                  </numericEdit>
               </ui>
               <font typeface="Verdana" size="8pt"/>
               <margin bottomInset="1mm" leftInset="1mm" rightInset="1mm" topInset="1mm"/>
               <para vAlign="middle"/>
               <caption reserve="20mm">
                  <para vAlign="middle"/>
                  <value>
                     <text>Text Field</text>
                  </value>
               </caption>
               <calculate override="error"/>
               <event name="event__layout_ready" activity="ready" ref="$layout">
                  <script contentType="application/x-javascript">this.rawValue = xfa.layout.pageCount();
</script>
               </event>
               <?templateDesigner floatingFieldPlaceholder ##?>
               <bind match="none"/>
            </field>
            <subform w="196.943mm" name="systemCommand" layout="lr-tb" x="6.066mm" y="275.397mm" relevant="-print">
               <bind match="none"/>
               <border>
                  <edge presence="hidden"/>
                  <corner thickness="0.175mm" presence="hidden"/>
               </border>
               <margin leftInset="0mm"/>
               <subform layout="tb" name="systemSubform" w="197.752mm">
                  <variables>
                     <script contentType="application/x-javascript" name="SystemJS">
var DEBUG = false;
function debug(message)
{	
	if (DEBUG)
	{
		xfa.host.messageBox(message);	
	}
}

function initButton(checkObj, buttonObj)
{
	/*if(checkObj.rawValue == 'true')
	{
		buttonObj.parent.presence = "visible";
	}
	else
	{*/
		buttonObj.parent.presence = "hidden";
	/*}*/
}

function lockFields(){
	debug("[SystemJS::lockFields] - BEGIN.");
	debug("[SystemJS::lockFields] - Num pages "+ xfa.host.numPages);
	for (var i = 0; i &lt; xfa.host.numPages; i++)
	{
		var oFields = xfa.layout.pageContent(i, "field");
		debug("[SystemJS::lockFields] - Fields: "+oFields );
		var nodesLength = oFields.length;
		//set the access type to be protected for all fields
		debug("[SystemJS::lockFields] - Num nodi nei fields "+nodesLength );
		for (var j = 0; j &lt; nodesLength; j++)
		{
			var oItem = oFields.item(j);
			oItem.access = "protected";	
		}
	}
	debug("[SystemJS::lockFields] - END.");
}
               
               
</script>
                     <?templateDesigner expand 1?></variables>
                  <bind match="none"/>
                  <subform minH="15.196mm" name="flagSubform" w="185.527mm" presence="hidden">
                     <bind match="none"/>
                     <field h="6mm" name="moduloEditabile" w="47.625mm" x="0.525mm">
                        <caption placement="right" reserve="40.625mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>Modulo Editabile</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <ui>
                           <checkButton>
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill/>
                                 <?templateDesigner StyleID apcb2?></border>
                           </checkButton>
                        </ui>
                        <value>
                           <text>true</text>
                        </value>
                        <event ref="$host" activity="docReady" name="event__docReady">
                           <script contentType="application/x-javascript"> 
	//form1.systemSubform.moduloEditabile::docReady - (JavaScript, client)
 
</script>
                        </event>
                        <traversal>
                           <traverse ref="btSalva[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.system.catDig.moduloEditabile"/>
                     </field>
                     <field h="5.662mm" name="barcodeVisibile" w="59.26mm" x="35.991mm">
                        <caption placement="right" reserve="52.26mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>barcode visibile</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <ui>
                           <checkButton>
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill/>
                                 <?templateDesigner StyleID apcb2?></border>
                           </checkButton>
                        </ui>
                        <value>
                           <text>false</text>
                        </value>
                        <traversal>
                           <traverse ref="btPEC[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.system.catDig.barcodeVisibile"/>
                     </field>
                     <field h="6mm" name="btSalva" w="28mm" x="96.45mm" y="0mm">
                        <caption placement="right" reserve="21mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>Bt Salva</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <ui>
                           <checkButton>
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill/>
                                 <?templateDesigner StyleID apcb2?></border>
                           </checkButton>
                        </ui>
                        <value>
                           <text>true</text>
                        </value>
                        <traversal>
                           <traverse ref="barcodeVisibile[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.system.catDig.btSalva"/>
                     </field>
                     <field h="6mm" name="btPEC" w="28mm" x="128.195mm" y="0.607mm">
                        <caption placement="right" reserve="21mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>Bt PE C</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <ui>
                           <checkButton>
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill/>
                                 <?templateDesigner StyleID apcb2?></border>
                           </checkButton>
                        </ui>
                        <value>
                           <text>false</text>
                        </value>
                        <traversal>
                           <traverse ref="salvaBtSubform[0].salvaButton[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.system.catDig.btPEC"/>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <subform name="salvaBtSubform" w="197.145mm" h="10.043mm">
                     <bind match="none"/>
                     <field h="6mm" name="salvaInBozza" w="28.575mm" x="81.285mm" relevant="-print" y="0.089mm">
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial>
                                 <color value="192,192,192"/>
                              </radial>
                           </fill>
                        </border>
                        <caption>
                           <font typeface="Verdana" size="8pt"/>
                           <para hAlign="center" vAlign="middle"/>
                           <value>
                              <text>Salva in bozza</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
flag_controllo_bozza.rawValue = "false";

salvaInBozzaVero.execEvent("click");
</script>
                        </event>
                     </field>
                     <margin topInset="2.54mm" bottomInset="0mm"/>
                     <field name="execBack" x="24.467mm" w="28.575mm" h="6mm" presence="invisible" y="0.115mm">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>Chiudi</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font typeface="Verdana" size="8pt"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <submit format="pdf" textEncoding="UTF-16" xdpContent="pdf datasets xfdf" target="./cpGestImpianto.do"/>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">/*
try {
	var newURLAnnulla = "/modolcatweb/showTemi.do";
	var oEventList = this.resolveNodes("#event");
	//xfa.host.messageBox("#event size="+oEventList.length);
	
	for (var i = 0; i &lt; oEventList.length; i++)
	{
	  var oEventNode = oEventList.item(i);
	  //xfa.host.messageBox("#event activity="+oEventNode.activity);
	  if (oEventNode.activity == "click")
	  {
	    oEventNode.resolveNode("#submit").target = newURLAnnulla ;
	    break;
	  }
	}
}catch(e){
	xfa.host.messageBox("Exception "+e);
}
*/
</script>
                        </event>
                     </field>
                     <field name="buttonControlli" anchorType="middleCenter" w="28.575mm" relevant="-print" x="125.094mm" y="3.09mm" h="6mm">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Verdana"/>
                        <caption>
                           <value>
                              <text>Salva e controlla</text>
                           </value>
                           <para vAlign="middle" hAlign="center" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised">
                              <color value="255,102,0"/>
                           </edge>
                           <fill>
                              <radial>
                                 <color value="192,192,192"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <speak disable="1"/>
                           <toolTip>Salvataggio con controlli formali.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
VAL_FAIL_MSG.value = "";
controlli.run(Richiesta.formValido,Richiesta.formValidoParz);

if(!controlli.isOk(Richiesta.formValidoParz)){
	//var vVAL_FAIL_MSG1 = VAL_FAIL_MSG.value;
		//xfa.host.messageBox(vVAL_FAIL_MSG1.length);
	var vVAL_FAIL_MSG2 = VAL_FAIL_MSG.value.substr(2,5000);

	xfa.host.messageBox("La validazione ha dato esito negativo.\n "+ 
						"Compilare correttamente i campi evidenziati in rosso prima di poter continuare:\n" +vVAL_FAIL_MSG2);       
}else{
	if(!controlli.isOk(Richiesta.formValido)){
		//var vVAL_FAIL_MSG1 = VAL_FAIL_MSG.value;
			//xfa.host.messageBox(vVAL_FAIL_MSG1.length);
		var vVAL_FAIL_MSG2 = VAL_FAIL_MSG.value.substr(2,5000);
		
		xfa.host.messageBox("La validazione ha dato esito negativo.\n "+ 
							"Compilare correttamente i campi evidenziati in rosso prima di poter continuare:\n" +vVAL_FAIL_MSG2);       
	}else{

		flagValidazione.rawValue = "true";
		flag_controllo_bozza.rawValue = "true";
		//xfa.host.messageBox("cis sono");
	
		salvaButton.execEvent("click");
	}	
}
</script>
                        </event>
                     </field>
                     <field h="6mm" name="salvaButton" w="28.575mm" x="7.684mm" y="0.115mm" presence="invisible">
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <caption>
                           <font typeface="Verdana" size="8pt"/>
                           <para hAlign="center" vAlign="middle"/>
                           <value>
                              <text>Salva in bozza</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <submit format="xml" target="./salvaModuloLibrettoXml.do" textEncoding="UTF-8"/>
                        </event>
                     </field>
                     <field name="annullaButton" anchorType="middleCenter" w="28.575mm" relevant="-print" x="66.254mm" y="3.115mm" h="6mm">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Verdana"/>
                        <caption>
                           <value>
                              <text>Chiudi</text>
                           </value>
                           <para vAlign="middle" hAlign="center" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised">
                              <color value="255,102,0"/>
                           </edge>
                           <fill>
                              <radial>
                                 <color value="192,192,192"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <speak disable="1"/>
                           <toolTip>Salvataggio con controlli formali.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vEdit = XMLDatasetUtils.readValue("MOD.system.catDig.moduloEditabile");
//xfa.host.messageBox("moduloEditabile:"+vEdit );
// non iserisce la richiesta e chiude il modulo pdf.

//if (vEdit  == "true" ){

	var result = xfa.host.messageBox("Attenzione!\n"+ 
									 "I dati inseriti dopo l'ultimo salvataggio verranno persi."+'\n'+
									 "Sei sicuro di voler uscire?", "Esci senza salvare", 3, 1);
	if(result == 1){
		execBack.execEvent("click");	
	}
	
//}else{
//	execBack.execEvent("click");	
//} 

//execBack.execEvent("click");	
</script>
                        </event>
                     </field>
                     <field name="flagValidazione" w="25.4mm" h="3.936mm" presence="invisible" x="143.36mm" y="0.904mm">
                        <ui>
                           <checkButton>
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>false</text>
                        </value>
                        <caption placement="right" reserve="18.4mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>validazione</text>
                           </value>
                        </caption>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <bind match="none"/>
                     </field>
                     <field name="flag_controllo_bozza" y="0.088mm" x="162.771mm" w="28mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton>
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>false</text>
                        </value>
                        <caption placement="right" reserve="21mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>Flag_controllo_bozza</text>
                           </value>
                        </caption>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <bind match="dataRef" ref="$.Richiesta.datiModulo.flag_controllo_bozza"/>
                     </field>
                     <field h="6mm" name="salvaInBozzaVero" w="28.575mm" x="140.529mm" y="0.088mm" presence="invisible">
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial>
                                 <color value="192,192,192"/>
                              </radial>
                           </fill>
                        </border>
                        <caption>
                           <font typeface="Verdana" size="8pt"/>
                           <para hAlign="center" vAlign="middle"/>
                           <value>
                              <text>Salva in bozza</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <submit format="xml" target="./salvaModuloLibrettoXml.do" textEncoding="UTF-8"/>
                        </event>
                     </field>
                     <?templateDesigner expand 1?></subform>
                  <event ref="$host" activity="docReady" name="event__docReady">
                     <script contentType="application/x-javascript">
//SystemJS.initButton(flagSubform.btPEC, pecBtSubform.pecButton);
SystemJS.initButton(flagSubform.btSalva , salvaBtSubform.salvaButton);


try{
	var editableField = xfa.resolveNode("systemSubform.flagSubform.moduloEditabile");
//	var barcodeVisible = xfa.resolveNode("systemSubform.flagSubform.barcodeVisibile");
//	xfa.host.messageBox("FormReady fragment - Valore:"+editableField );
//	xfa.host.messageBox("FormReady Barcode Visible- Valore:"+barcodeVisible );
	if (editableField.rawValue=="false") {
	  	SystemJS.lockFields();
	}
	/*
	if (barcodeVisible.rawValue=="true")
	{
		barcodeSubform.PaperFormsBarcode1.presence = "visible";
		barcodeSubform.presence = "visible";
	}
	else
	{
		barcodeSubform.PaperFormsBarcode1.presence = "hidden";
		barcodeSubform.presence = "hidden";
	}
	*/
} catch(e) {
	SystemJS.lockFields();
	xfa.host.messageBox("[SystemFragment::form:ready] Errore on select Node(systemSubform.flagSubform.moduloEditabile) - MODULO DISABILITATO:\n"+ e);	
}
</script>
                  </event>
                  <subform minH="6mm" name="pecBtSubform" w="197.48mm" presence="hidden">
                     <bind match="none"/>
                     <field h="6mm" name="pecButton" w="28.575mm" x="87.312mm" y="0.352mm" relevant="-print">
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <color value="212,208,200"/>
                           </fill>
                           <?templateDesigner StyleID apbx2?></border>
                        <caption>
                           <para hAlign="center" vAlign="middle"/>
                           <value>
                              <text>Invia PEC</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <ui>
                           <button/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <submit format="pdf" target="mailto:" textEncoding="UTF-16" xdpContent="pdf datasets xfdf"/>
                        </event>
                        <event ref="$form" activity="preSubmit" name="event__preSubmit">
                           <script contentType="application/x-javascript">
var DEBUG = false;

var toAddrValue = emailSubform.toAddressField.rawValue;
var subjValue = emailSubform.subjectField.rawValue;
var bodyValue = emailSubform.bodyField.rawValue;

if (DEBUG) xfa.host.messageBox("[preSubmit] - toAddr = "+toAddrValue+" subjValue ="+subjValue+" bodyValue ="+bodyValue);
this.resolveNode("#event").submit.target = "mailto:" + toAddrValue + "?subject="+subjValue +"&amp;body="+bodyValue;
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?>
                     <margin topInset="2.54mm"/>
                  </subform>
                  <subform name="barcodeSubform" w="197.058mm" presence="hidden">
                     <bind match="none"/>
                     <field access="readOnly" h="44.45mm" name="PaperFormsBarcode1" w="82.55mm" x="60.325mm">
                        <calculate>
                           <script contentType="application/x-javascript">//{{Start Generated Content//
/*{{&lt;name&gt;delimCollection&lt;/name&gt;}}*/
/*
var includeFieldNames = true;
var includeLabel = true;
var labelID = "Label";
var is705ViewerRequired = false;
var collection = null;
var delimiter = '\t';
//End Generated Content}}//

// Initialize the barcode content
this.rawValue = " ";

// Encoding data into the barcode

var fieldNames = new Array();
var fieldValues = new Array();

function encode(node)
{
    var barcodeLabel = this.caption.value.text.value;
    if (includeLabel == true &amp;&amp; barcodeLabel.length &gt; 0)
    {
        fieldNames.push(labelID);
        fieldValues.push(barcodeLabel);
    }

    if(collection != null)
    {
        // Create an array of all child nodes in the form
        var entireFormNodes = new Array();
        collectChildNodes(xfa.datasets.data, entireFormNodes);

        // Create an array of all nodes in the collection
        var collectionNodes = new Array();
        var nodes = collection.evaluate();

        for(var i = 0; i &lt; nodes.length; ++i)
        {
            collectChildNodes(nodes.item(i), collectionNodes);
        }

        // If the form has two or more fields sharing the same name, the names of the 
        // parents of these fields, as well as the subscript numbers of the fields and
        // their parents, will be used to differentiate them. However, since we want 
        // to take as little space in the barcode as possible, we only use such extra
        // data in the object names only when necessary.
        resolveDuplicates(collectionNodes, entireFormNodes, fieldNames);

        for(var j = 0; j &lt; nodes.length; ++j)
        {
            // Go through the collection and accumulate the value of each form object
            accumulateFieldValues(nodes.item(j));
        }

        // Forcing dependency (only if the viewer version is 8.00 or older)
        if(xfa.host.version &lt;= 8.00)
        {
            // Create a collection of the selected form objects, but in the form model context
            var formModelNodeList = new Array();

            var dataNodes = collection.evaluate();
            for(var i = 0; i &lt; dataNodes.length; ++i)
            {
                formModelNodeList.push(xfa.form.formNodes(dataNodes.item(i)));
            }

            // Now, force a dependency between the barcode and its form model nodes in its
            // collection
            while(formModelNodeList.length &gt; 0)
            {
                var nodeList = formModelNodeList.pop();
                for(var i = 0; i &lt; nodeList.length; ++i)
                {
                    depends(nodeList.item(i));
                }
            }
        }
    }

    var encodedContent = new String();

    var values = fieldValues.join(delimiter);
    values += delimiter;

    if(includeFieldNames == true)
    {
        var fields = fieldNames.join(delimiter);
        fields += delimiter;

        encodedContent = fields + "\n" + values;
    }
    else
    {
        encodedContent = values;
    }

    return encodedContent;
}

// If there are two or more nodes sharing the same name, differentiate those
// nodes by using subscripts and/or parent name(s).
function resolveDuplicates(encodingNodes, entireFormNodes, fieldNameArray)
{
    for(var i = 0; i &lt; encodingNodes.length; ++i)
    {
        var dataModelNode = encodingNodes[i];
        var nodeName = dataModelNode.name;
        
        nodeName = makeUniqueName(dataModelNode, entireFormNodes, nodeName);

        if(isNodeMultiChoiceList(dataModelNode) &amp;&amp; dataModelNode.parent != null &amp;&amp; 
            nodeName.indexOf(".") == -1)
        {
            var parentName = makeUniqueName(dataModelNode.parent, entireFormNodes, 
                dataModelNode.parent.name);
                
            nodeName = parentName + "." + nodeName;
        }
        
        fieldNameArray.push(nodeName);
    }

    // Remove subscript 0's, if there's no other field sharing the same name at the
    // same level
    compact(fieldNameArray);
}

// Detect if a form object is a multi-choice list box
function isNodeMultiChoiceList(dataNode)
{
    var isMultiChoice = false;
    
    if(dataNode != null &amp;&amp; dataNode.name == "value" &amp;&amp; dataNode.className == "dataValue")
    {
        var parent = dataNode.parent;
        if(parent != null &amp;&amp; parent.className == "dataGroup")
        {
            isMultiChoice = true;
        }
    }
    
    return isMultiChoice;
}

// Given a node, look for duplicates (in the whole form), and come up with a 
// name that differentiates the current node from the rest, using a combination
// of subscript numbers and parent name(s).
function makeUniqueName(node, formNodeArray, nodeName)
{
    for(var i = 0; i &lt; formNodeArray.length; ++i)
    {
        var compNode = formNodeArray[i];

        var nodeSOM = node.somExpression;
        var compNodeSOM = compNode.somExpression;

        if((nodeSOM != compNodeSOM) &amp;&amp; (nodeName == compNode.name))
        {
            if(nodeSOM.substring(0, nodeSOM.lastIndexOf(".")) == 
                compNodeSOM.substring(0, compNodeSOM.lastIndexOf(".")))
            {
                var diffLevelNodeFound = false;
                for(var ii = i; !diffLevelNodeFound  &amp;&amp; ii &lt; formNodeArray.length; ++ii)
                {
                    compNode = formNodeArray[ii];
                    compNodeSOM = compNode.somExpression;

                    if((nodeSOM != compNodeSOM) &amp;&amp; (nodeName == compNode.name) &amp;&amp;
                        (nodeSOM.substring(0, nodeSOM.lastIndexOf(".")) != 
                        compNodeSOM.substring(0, compNodeSOM.lastIndexOf("."))))
                    {
                        diffLevelNodeFound = true;
                    }
                }

                if(!diffLevelNodeFound )
                {
                    // The two nodes are at the same level. There is no need to append the 
                    // current node's parent names to differentiate. Instead, just use
                    // the suffix
                    nodeName += "[" + node.index + "]";
                }
            }
            else
            {
                if(node.parent != null)
                {
                    var parentArray = new Array();
                    for(var j = 0; j &lt; formNodeArray.length; ++j)
                    {
                        var parentNode = formNodeArray[j].parent;
                        if(parentNode != null)
                        {
                            parentArray.push(parentNode);
                        }
                    }

                    nodeName = makeUniqueName(node.parent, parentArray, node.parent.name).concat(
                        ".", nodeName, "[", node.index, "]");
                }
            }
        }
    }

    return nodeName;
}

// Remove subscript 0's, if there's no other field sharing the same name at the
// same level
function compact(nameArray)
{
    for(var i = 0; i &lt; nameArray.length; ++i)
    {
        var fieldName = nameArray[i];
        if(fieldName.substring(fieldName.lastIndexOf("[") + 1, fieldName.lastIndexOf("]")) == "0")
        {
            var fieldNameNoSubscript = fieldName.substring(0, fieldName.lastIndexOf("["));
            var isFound = false;

            for(var j = 0; !isFound &amp;&amp; j &lt; nameArray.length; ++j)
            {
                if(nameArray[j] != nameArray[i])
                {
                    var comparedFieldName = nameArray[j];

                    if(fieldNameNoSubscript ==
                        comparedFieldName.substring(0, comparedFieldName.lastIndexOf("[")))
                    {
                        isFound = true;
                    }
                }
            }

            if(!isFound)
            {
                nameArray.splice(i, 1, fieldNameNoSubscript);
            }
        }
    }
}

// Add object values into a local container
function accumulateFieldValues(node)
{
    if (node.className == "dataGroup")
    {
        var itemCount = node.nodes.length;
        for (var i = 0; i &lt; itemCount; ++i)
        {
            accumulateFieldValues(node.nodes.item(i));
        }
    }
    else
    {
        if(node.value != null)
        {
            fieldValues.push(node.value);
        }
        else
        {
            fieldValues.push("");
        }
    }
}

// Convert an XFA node list into a JavaScript node array
function collectChildNodes(node, childNodeArray)
{
    if(node.className == "dataGroup")
    {
        var itemCount = node.nodes.length;
        for (var i = 0; i &lt; itemCount; ++i)
        {
            collectChildNodes(node.nodes.item(i), childNodeArray);
        }
    }
    else
    {
        childNodeArray.push(node);
    }
}

// Encode the collection data as barcode content
this.rawValue = encode(collection);

// Final sanity check, located here not for efficiency but for consistency and correctness
if (is705ViewerRequired &amp;&amp; xfa.host.version &lt; 7.05)
{
    this.rawValue = " ";
}

// Forcing dependency only if the viewer version is 9.00 or older
function depends(node)
{
    if(xfa.host.version &lt; 9.00)
    {
        if(node.className != "variables")
        {
            var stack = new Array();

            var currentNode = node;
            stack.push(currentNode);

            while (stack.length &gt; 0)
            {
                currentNode = stack.pop();
                if(currentNode == null) continue;

                for(var i = 0; i &lt; currentNode.nodes.length; ++i)
                {
                    stack.push(currentNode.nodes.item(i));
                }
            }
        }
    }
}
*/
</script>
                           <script contentType="application/x-javascript">//{{Start Generated Content//
/*{{&lt;name&gt;delimCollection&lt;/name&gt;}}*/
var includeFieldNames = true;
var includeLabel = true;
var labelID = "Label";
var is705ViewerRequired = false;
var collection = MOD16;
var delimiter = '\t';
//End Generated Content}}//

// Initialize the barcode content
this.rawValue = " ";

// Encoding data into the barcode

var fieldNames = new Array();
var fieldValues = new Array();

function encode(node)
{
    var barcodeLabel = this.caption.value.text.value;
    if (includeLabel == true &amp;&amp; barcodeLabel.length &gt; 0)
    {
        fieldNames.push(labelID);
        fieldValues.push(barcodeLabel);
    }

    if(collection != null)
    {
        // Create an array of all child nodes in the form
        var entireFormNodes = new Array();
        collectChildNodes(xfa.datasets.data, entireFormNodes);

        // Create an array of all nodes in the collection
        var collectionNodes = new Array();
        var nodes = collection.evaluate();

        for(var i = 0; i &lt; nodes.length; ++i)
        {
            collectChildNodes(nodes.item(i), collectionNodes);
        }

        // If the form has two or more fields sharing the same name, the names of the 
        // parents of these fields, as well as the subscript numbers of the fields and
        // their parents, will be used to differentiate them. However, since we want 
        // to take as little space in the barcode as possible, we only use such extra
        // data in the object names only when necessary.
        resolveDuplicates(collectionNodes, entireFormNodes, fieldNames);

        for(var j = 0; j &lt; nodes.length; ++j)
        {
            // Go through the collection and accumulate the value of each form object
            accumulateFieldValues(nodes.item(j));
        }

        // Forcing dependency (only if the viewer version is 8.00 or older)
        if(xfa.host.version &lt;= 8.00)
        {
            // Create a collection of the selected form objects, but in the form model context
            var formModelNodeList = new Array();

            var dataNodes = collection.evaluate();
            for(var i = 0; i &lt; dataNodes.length; ++i)
            {
                formModelNodeList.push(xfa.form.formNodes(dataNodes.item(i)));
            }

            // Now, force a dependency between the barcode and its form model nodes in its
            // collection
            while(formModelNodeList.length &gt; 0)
            {
                var nodeList = formModelNodeList.pop();
                for(var i = 0; i &lt; nodeList.length; ++i)
                {
                    depends(nodeList.item(i));
                }
            }
        }
    }

    var encodedContent = new String();

    var values = fieldValues.join(delimiter);
    values += delimiter;

    if(includeFieldNames == true)
    {
        var fields = fieldNames.join(delimiter);
        fields += delimiter;

        encodedContent = fields + "\n" + values;
    }
    else
    {
        encodedContent = values;
    }

    return encodedContent;
}

// If there are two or more nodes sharing the same name, differentiate those
// nodes by using subscripts and/or parent name(s).
function resolveDuplicates(encodingNodes, entireFormNodes, fieldNameArray)
{
    for(var i = 0; i &lt; encodingNodes.length; ++i)
    {
        var dataModelNode = encodingNodes[i];
        var nodeName = dataModelNode.name;
        
        nodeName = makeUniqueName(dataModelNode, entireFormNodes, nodeName);

        if(isNodeMultiChoiceList(dataModelNode) &amp;&amp; dataModelNode.parent != null &amp;&amp; 
            nodeName.indexOf(".") == -1)
        {
            var parentName = makeUniqueName(dataModelNode.parent, entireFormNodes, 
                dataModelNode.parent.name);
                
            nodeName = parentName + "." + nodeName;
        }
        
        fieldNameArray.push(nodeName);
    }

    // Remove subscript 0's, if there's no other field sharing the same name at the
    // same level
    compact(fieldNameArray);
}

// Detect if a form object is a multi-choice list box
function isNodeMultiChoiceList(dataNode)
{
    var isMultiChoice = false;
    
    if(dataNode != null &amp;&amp; dataNode.name == "value" &amp;&amp; dataNode.className == "dataValue")
    {
        var parent = dataNode.parent;
        if(parent != null &amp;&amp; parent.className == "dataGroup")
        {
            isMultiChoice = true;
        }
    }
    
    return isMultiChoice;
}

// Given a node, look for duplicates (in the whole form), and come up with a 
// name that differentiates the current node from the rest, using a combination
// of subscript numbers and parent name(s).
function makeUniqueName(node, formNodeArray, nodeName)
{
    for(var i = 0; i &lt; formNodeArray.length; ++i)
    {
        var compNode = formNodeArray[i];

        var nodeSOM = node.somExpression;
        var compNodeSOM = compNode.somExpression;

        if((nodeSOM != compNodeSOM) &amp;&amp; (nodeName == compNode.name))
        {
            if(nodeSOM.substring(0, nodeSOM.lastIndexOf(".")) == 
                compNodeSOM.substring(0, compNodeSOM.lastIndexOf(".")))
            {
                var diffLevelNodeFound = false;
                for(var ii = i; !diffLevelNodeFound  &amp;&amp; ii &lt; formNodeArray.length; ++ii)
                {
                    compNode = formNodeArray[ii];
                    compNodeSOM = compNode.somExpression;

                    if((nodeSOM != compNodeSOM) &amp;&amp; (nodeName == compNode.name) &amp;&amp;
                        (nodeSOM.substring(0, nodeSOM.lastIndexOf(".")) != 
                        compNodeSOM.substring(0, compNodeSOM.lastIndexOf("."))))
                    {
                        diffLevelNodeFound = true;
                    }
                }

                if(!diffLevelNodeFound )
                {
                    // The two nodes are at the same level. There is no need to append the 
                    // current node's parent names to differentiate. Instead, just use
                    // the suffix
                    nodeName += "[" + node.index + "]";
                }
            }
            else
            {
                if(node.parent != null)
                {
                    var parentArray = new Array();
                    for(var j = 0; j &lt; formNodeArray.length; ++j)
                    {
                        var parentNode = formNodeArray[j].parent;
                        if(parentNode != null)
                        {
                            parentArray.push(parentNode);
                        }
                    }

                    nodeName = makeUniqueName(node.parent, parentArray, node.parent.name).concat(
                        ".", nodeName, "[", node.index, "]");
                }
            }
        }
    }

    return nodeName;
}

// Remove subscript 0's, if there's no other field sharing the same name at the
// same level
function compact(nameArray)
{
    for(var i = 0; i &lt; nameArray.length; ++i)
    {
        var fieldName = nameArray[i];
        if(fieldName.substring(fieldName.lastIndexOf("[") + 1, fieldName.lastIndexOf("]")) == "0")
        {
            var fieldNameNoSubscript = fieldName.substring(0, fieldName.lastIndexOf("["));
            var isFound = false;

            for(var j = 0; !isFound &amp;&amp; j &lt; nameArray.length; ++j)
            {
                if(nameArray[j] != nameArray[i])
                {
                    var comparedFieldName = nameArray[j];

                    if(fieldNameNoSubscript ==
                        comparedFieldName.substring(0, comparedFieldName.lastIndexOf("[")))
                    {
                        isFound = true;
                    }
                }
            }

            if(!isFound)
            {
                nameArray.splice(i, 1, fieldNameNoSubscript);
            }
        }
    }
}

// Add object values into a local container
function accumulateFieldValues(node)
{
    if (node.className == "dataGroup")
    {
        var itemCount = node.nodes.length;
        for (var i = 0; i &lt; itemCount; ++i)
        {
            accumulateFieldValues(node.nodes.item(i));
        }
    }
    else
    {
        if(node.value != null)
        {
            fieldValues.push(node.value);
        }
        else
        {
            fieldValues.push("");
        }
    }
}

// Convert an XFA node list into a JavaScript node array
function collectChildNodes(node, childNodeArray)
{
    if(node.className == "dataGroup")
    {
        var itemCount = node.nodes.length;
        for (var i = 0; i &lt; itemCount; ++i)
        {
            collectChildNodes(node.nodes.item(i), childNodeArray);
        }
    }
    else
    {
        childNodeArray.push(node);
    }
}

// Encode the collection data as barcode content
this.rawValue = encode(collection);

// Final sanity check, located here not for efficiency but for consistency and correctness
if (is705ViewerRequired &amp;&amp; xfa.host.version &lt; 7.05)
{
    this.rawValue = " ";
}

// Forcing dependency only if the viewer version is 9.00 or older
function depends(node)
{
    if(xfa.host.version &lt; 9.00)
    {
        if(node.className != "variables")
        {
            var stack = new Array();

            var currentNode = node;
            stack.push(currentNode);

            while (stack.length &gt; 0)
            {
                currentNode = stack.pop();
                if(currentNode == null) continue;

                for(var i = 0; i &lt; currentNode.nodes.length; ++i)
                {
                    stack.push(currentNode.nodes.item(i));
                }
            }
        }
    }
}</script>
                        </calculate>
                        <ui>
                           <barcode type="pdf417" errorCorrectionLevel="5" moduleHeight="0.676mm" moduleWidth="0.338mm" dataPrep="flateCompress">
                              <?templateDesigner decodeMethod 2?>
                              <?templateDesigner delimiter '\t'?></barcode>
                        </ui>
                        <bind match="none"/>
                     </field>
                     <draw name="Text94" w="112.889mm" h="6.35mm" x="8.114mm" y="45.78mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <value>
                           <text>Dichiarazione presentata telematicamente  con codice  repertorio :</text>
                        </value>
                        <font size="11pt" typeface="Myriad Pro" posture="italic">
                           <fill>
                              <color value="255,0,0"/>
                           </fill>
                        </font>
                        <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                        <para vAlign="bottom"/>
                     </draw>
                     <field access="readOnly" h="9mm" name="codiceRepertorio" w="186.69mm" x="8.255mm" y="52.13mm">
                        <calculate>
                           <script contentType="application/x-javascript">
var barcodeCaptionValue = PaperFormsBarcode1.caption.value.text.value;
//xfa.host.messageBox("Bar Code Value: "+barcodeCaptionValue );
//this.rawValue = barcodeCaptionValue 

</script>
                        </calculate>
                        <font typeface="Myriad Pro"/>
                        <margin bottomInset="1mm" leftInset="1mm" rightInset="1mm" topInset="1mm"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <?templateDesigner StyleID aped3?>
                                 <edge stroke="lowered"/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <event ref="$host" activity="docReady" name="event__docReady">
                           <script contentType="application/x-javascript">
var codRepertorioValue = this.rawValue;
//xfa.host.messageBox("["+codRepertorioValue+"]");
if (codRepertorioValue  == null || codRepertorioValue == "")
{
	this.presence = "hidden";
}
else
{
	this.presence = "visible";
}
</script>
                        </event>
                        <bind match="none"/>
                     </field>
                     <margin topInset="2.54mm"/>
                     <?templateDesigner expand 1?></subform>
                  <subform minH="20.112mm" name="emailSubform" w="193.668mm" presence="hidden">
                     <bind match="none"/>
                     <field access="readOnly" h="9mm" name="toAddressField" w="62mm" x="0mm" y="0mm">
                        <calculate override="error"/>
                        <caption reserve="25mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>toAddress</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <margin bottomInset="1mm" leftInset="1mm" rightInset="1mm" topInset="1mm"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge stroke="lowered"/>
                                 <?templateDesigner StyleID aped3?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <value>
                           <text maxChars="100"/>
                        </value>
                        <traversal>
                           <traverse ref="subjectField[0]"/>
                        </traversal>
                        <bind match="none"/>
                     </field>
                     <field access="readOnly" h="9mm" name="subjectField" w="79.056mm" x="64.764mm" y="0.324mm">
                        <caption reserve="24.444mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>subject</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <margin bottomInset="1mm" leftInset="1mm" rightInset="1mm" topInset="1mm"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge stroke="lowered"/>
                                 <?templateDesigner StyleID aped3?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <value>
                           <text maxChars="100"/>
                        </value>
                        <traversal>
                           <traverse ref="bodyField[0]"/>
                        </traversal>
                        <bind match="none"/>
                     </field>
                     <field access="readOnly" h="9mm" name="bodyField" w="193.356mm" x="0.312mm" y="11.112mm">
                        <caption reserve="25mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>body</text>
                           </value>
                        </caption>
                        <font typeface="Myriad Pro"/>
                        <margin bottomInset="1mm" leftInset="1mm" rightInset="1mm" topInset="1mm"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit multiLine="1">
                              <border>
                                 <edge stroke="lowered"/>
                                 <?templateDesigner StyleID aped3?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <value>
                           <text maxChars="1000"/>
                        </value>
                        <bind match="none"/>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <?templateDesigner expand 1?></subform>
               <event activity="initialize" name="event__initialize">
                  <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "hidden";
</script>
               </event>
               <?templateDesigner expand 0?></subform>
            <subform name="Footer_Mod" w="197.55mm" layout="lr-tb" x="5.662mm" y="285.304mm">
               <traversal>
                  <traverse operation="first" ref="T1[0]"/>
               </traversal>
               <bind match="none"/>
               <draw h="0.078mm" name="R0" w="197.008mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <fill>
                           <color value="128,128,128"/>
                        </fill>
                        <corner radius="5.08mm"/>
                     </rectangle>
                  </value>
                  <ui>
                     <defaultUi/>
                  </ui>
               </draw>
               <draw name="Rectangle4" w="197.146mm" h="0.731mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <draw h="8.865mm" name="Image1" w="9.039mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <value>
                     <image contentType="image/jpg">/9j/4AAQSkZJRgABAAEAYABgAAD//gAfTEVBRCBUZWNobm9sb2dpZXMgSW5jLiBWMS4wMQD/2wCE
AAgFBgcGBQgHBgcJCAgJDBQNDAsLDBgREg4UHRkeHhwZHBsgJC4nICIrIhscKDYoKy8xMzQzHyY4
PDgyPC4yMzEBCAkJDAoMFw0NFzEhHCExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTEx
MTExMTExMTExMTExMTExMf/EAaIAAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKCwEAAwEBAQEB
AQEBAQAAAAAAAAECAwQFBgcICQoLEAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEU
MoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2Rl
ZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK
0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+foRAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYS
QVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNU
VVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5
usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/AABEIACgAKAMBEQACEQEDEQH/
2gAMAwEAAhEDEQA/AF1vWI9Fg05I9Msp/PtUkZpY+c1x4jEyoySSPpMnyelmFKU5yas7aW7FSHxQ
8iq39jaYFJ/uc12Yahi8RSVWKik+7scmYU8py/ESw1SpNzSvpFPc3/7b8Pb9v2Fs+n2QZr0v7OrW
vp958p/aNHbX7jAm8UNErN/Y2mFQf7nNebiaGLw1J1ZKNl2dz6rL4ZTj8RHDU6k1NrS8Utty3oms
x6zBqKSaZZQeRavIrRR85rjw+IdaTTVjszjJ6WXUozhJu7trbsZvjSGWWPR2iidwLFM7VJxXPjk3
NW7Hr8L1IQoVOZpe9+iMKGG8MkStDNtDD+A+tYOtXnCNKTfKtl0Pc+r4GlUniYKKqSTvLS7PY/sl
t9t+1+Sn2jp5uPmx0xX0HtJ8nJfTsfkfsoc3PbXueOTQ3gkkVYZtrMeNh9a+fVavCDpRb5X06H65
9XwNSrDEzUXUilZ9V/Vzd8Fwywx6wZInQGxfBZSK3wKam79jxOKKkJ4enyu/vfoz0DQt39i2G3P/
AB7x9P8AdFesfAu3Uu/P/tUC90bQUO+f/aoJ0KWu7hol9uzxbydf900DVuh554unlitdEEUroDp8
ZIViK8nHNqat2PveF6cJ4epzJP3v0RhW93c+fGPtEv3h/GfWuFSldan1NShS5H7q27I9sx83419I
fjPQ8Tnu7kTyAXEvDH+M+tfNuUr7n7NToUuRe6tuyN3wjPLJba55sruBp8hG5icV3YFtzd+x8vxR
ThDD0+VJe9+jLWo2VnrOn6S6a1ptu0FlHG6SzgMGxzxXRicNKtJNM8fJs4pZdSlCcW23fS3YpR+G
rZJFY+ItI+Ug/wDHwK51gZ33R7MuKcO4tezl+H+Z6F/b2j5z/atj/wCBCf416x8DboeeyeGrV5Gb
/hItIGST/wAfAryXgZ90ffR4pw8Ypezl+Bd02ys9G0/VnbWtNuGnspI0SKcFi2OOK6MPh5UZNtnj
ZxnFLMKUYQi1Z31t2P/Z</image>
                  </value>
                  <desc>
                     <text name="embeddedHref">..\resources\logo_regione.jpg</text>
                  </desc>
               </draw>
               <draw h="2.445mm" name="T8" w="20.809mm">
                  <font typeface="Arial" posture="italic" size="6pt"/>
                  <para hAlign="right" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>Libretto impianto</text>
                  </value>
                  <?renderCache.bounds 58986 6931 0 0 0 0 0 0?>
                  <?renderCache.textRun 17 Libretto impianto 0 14628 5220 0 0 0 "Arial" 0 1 6000 ISO-8859-1?></draw>
               <field name="dtLibretto" y="3mm" w="12.809mm" h="2.445mm" access="protected">
                  <ui>
                     <dateTimeEdit/>
                  </ui>
                  <font typeface="Arial" posture="italic" size="6pt"/>
                  <para hAlign="right" vAlign="middle"/>
                  <value>
                     <date/>
                  </value>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.data_aggiornamento">
                     <picture>date{YYYY-MM-DD}</picture>
                  </bind>
                  <format>
                     <picture>date{(DD/MM/YYYY)}</picture>
                  </format>
               </field>
               <draw name="Rectangle4" w="163.985mm" h="6.797mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <?templateDesigner expand 0?></subform>
            <field name="sfondoBozza" y="30.734mm" x="5.257mm" w="201.004mm" h="199.243mm">
               <ui>
                  <imageEdit data="embed"/>
               </ui>
               <value>
                  <image contentType="image/jpeg">/9j/4AAQSkZJRgABAQEASABIAAD//gATQ3JlYXRlZCB3aXRoIEdJTVD/2wBDAAUDBAQEAwUEBAQF
BQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBD
AQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4e
Hh4eHh4eHh7/wAARCAMUAzIDASIAAhEBAxEB/8QAHAABAAIDAQEBAAAAAAAAAAAAAAEGAwQFAgcI
/8QAOxABAAEDAgQDBwQCAQQBBAMAAAECAxEEIQUxQVEGEmETInGBocHwFDJCkSNSsWLR4fEzFiQl
kjVDgv/EABQBAQAAAAAAAAAAAAAAAAAAAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIR
AxEAPwD9lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAidtwRVVFNOZmIj1TFUTGeceir+IOJ1ai5Ols1TTbpn
eqOstHS8S1liMUX68bbVbgu0TnkK/pPEO2NRZz/1UurpuJaXURHlu0xM9JBuCInKQBCQAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAARPo4XiLifkpnSaevFU/uqjp6Nnj/Eo0ln2VqZm9Xyx0VOqZqrmqZ80zvM9wJ9N+6Pr
90/U+oHfMz8jER+3bHWEfVP1Bt6fiWu0+PZX8+lW8OrpfEMbfqbc561U8lf+pGOs/wDkF20/ENJq
IjyX6MzyiqcNqPzD5/tziKflzben4lrNPTi1fqmP9at/6BdhXdJ4i2iNRamZ/wBqXW03EtJfxFN6
mKu0g3BETE8piSN+QJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAanFNXTo9JVemmap5REd22w6qxRqLFdquNqox8AUa/euai7
Veu1TVXVO8+jxLLqrM6fUXLdUY8m0fDuxdM8tswAHL0x9Pz7Jnb0x9Pz7AiRPXER/wCETsCUSb5x
ykx2BKPzY/ITAInl1+REREZiMT6JI/Pz+gbOl4hq9PMTRdqnHSreHU0viKuIiNTZiZ70uDz5GduQ
LrpeJ6S/iIuxTVPScw3ImJ5TE/B8/pmYj16Tnk2tLxDV2P8A4705/wCoF2yK7pvEO9MamznvVS62
m4nor84pvRE9pBuiImJjNMxMehmO8AkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHA8UaPNEauijemcVRHZXOW0TsvupopuW5t1/tq
jEqVxDTVaTU12q84idpBrwB9ATTMxE4nHpjm2+G6SjW3arPtKbdyYzGerTZNPersXqbtvEV0zEx/
2Bs6vhes03O3NcdKqYzlpzE01+WYmJjpMYXfh2pp1eli9bzTnnHaeqNXw/S6nM3bUTM9Y5gpEf8A
CY23WDV+H94nS3JjnmmpyNXw/VaWZm5amY70xkGr8SEUzEzERn5xhM7fLAJ+iOv56HWIOU/ACOn5
2I/PoR06fkJjbHT8gCMTG+YeYiIz09eqY6EdOn5ANrT6/V6eI9lfq26VdHV0viGrHl1FqJmf5UuD
G0x0/IRHLp8wXXTcS0l/ERdiKu0tyJiqM0zFUekvn+I6bNixrtXZqj2d+ryxyioF4j5JVrSeIbkV
xTftRMf7U9XY0vE9JfnFN2KZ7TsDdERMTGYnMegCQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARVGYw43ijSe10v6iN6rc5x6O081xExiqIm
nG8SCgdc90R0bnFtLXpdXVTMYpq3p+DU3/sERyI5xPZKOYOv4a1k2NR7GurFFc/0tT5/TNUTmmd4
3XHges/V6SJmY81MREwDfkmnO07x2nqkBo6zhej1Me/ZxOOdOzkanw7XTTP6e5Mx0pnosoCiarSa
nTVTN23MUx1iGDnOYfQK6Ka6ZiumKo7S52s4Po7+f8dNurpNIKhzTP8AbPr7VrT6qq1auTcpp5yw
R0+X2BCSOmSOn52A5z3QRE4j0xk/JBKJACc9JIj1x3AG1ptfqtPP+O9V5Y5U1S6mm8R107am1mOn
lcE9czGO3IFz0nE9HqJiKL9MVT/GqcYb1M5hU+AcNq1d+L92P8NM9sZlbKYxTEdgSAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiYzEx3SA5fH
9HGp0lVUU+9RG0+ioxv8eWH0GqIqjE8lQ47o/wBJr5qppxbrzMT0BzSD0T9wInfLd4LrP0espmqr
/HVtMNHp2ymMZzP/AKBf6aqaoiaZ2mMw9OJ4b13tdNOnrmfPb336w7VM5gEgiQJcbxBxP9PRVp7V
WLkxvPaGxxniFOise7ibtWYpjsqNy5Vcrqrrmaqp3mZ6giZnfM985+qJ656cyepPUD4ieuIZ9Bpb
ur1EWbcYzzntANbM4zTEzHWcbJ9MxMxzXaxw/TW9LTp/Z01UxG+Y5tLV8A0tyJmzHs6vQFWnacTz
kl09bwfV6efPFMXKY6xDnVU1UzHmo8lUzynYHn4nx/O5O3yI3nEfQBu8J0NWv1EW84tc657x2YdF
prmr1EWbdPPnPaFy0Gmt6XT02rVMRjnOOoMtiii3biiiny00xiIxyhkRHJIAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPNdUUxM1bRG8z2BF25Raomu5VF
NMdZTTVTVTFVMxNM75hVeP8AEp1d2bNur/BTneP5PHCOLXNHXFu5mqzyxP8AEFvGLT3rd+3FdqqJ
pmGUAAAAAAES0uNaOnW6SqjHvxvS3kTy5ZB8/qiYmYnaYmaZ9Ec5w6/iXRew1H6miMUV8/SXIznp
/wCQI3+aY3+aPz4gM+h1FWn1Vu7TVjyzEzHeF3sXIu2qblMxNNUZiVB35c4naVh8LayZzpKqsxzo
z2BYWrxHV29Hp5u3Jj0jvL3f1FFjT1XrsxFNP1U/ietr1t/z158kT7tOQYtZfu6m/Veu1TNVXTtD
Ft5Y7o3xj+gE/T7I6xER8IT6QU01TMeXnyiAerNq5eri3aiZrqnERC48I0FvQ6eKY3uTHvVNfgHD
Y0tr212n/LVG3o6sAkAEdc5lg1Wj02ojF2zTVvzxu2AHA1fh61MZ09dVG8ziXL1PCNbYrifLExVO
Imn7rmiYyDS4RoLei08UxibkxE1VN5EJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAABAEq74h4n5pq0unqxEZiuqG14h4lGnt1aezVm5XGJmP4wq8zM887f
X1AnliNo9SNsx0OUfAnYG1w/iF7Q3Zromaqds0d1u0OssauzFy1VGcZmnrCj089ucbNvg12qxr7N
UVTGasVR0nILrG8ZSiEgAAAAAA1eJ6WNZpa7M7TPKfVSrlNVF2q3XtNH2X6qMxtzhW/FGhiiY1lu
Of74joDhUztE9MdUxt8nmJzy+T18OvLAH2TZrrtXablFU0108p/Pgj82Ov8A2BvcT4jd100xV7lq
mn9vr3+jRqzmeso/Nk/mwHKJ+5O2e0I6f9id4mNtwTExic/JYvDvDNo1eppzVP7Yno1PD3DJ1Nca
m9TMWqf2xMfulaYiIiIiMdAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAA5/GuIUaGxER716vMUR29Z/tm4jrLei01V6ueXKO8qbq9Rc1Wom9d
n3pnl2Bju11XK6q6qvNVVvM95R39UR0THQCd8o55x1I6EdAeo6+qYqxiqmcTFUTDzHTkinGd4zGA
X3S1RXp7dUTnNMbsrn+H7sXeF2qusbS6AAAAAAADDq7NOo09VqqI3jZmAULU2K9PeuWqudMz/TF0
26rF4p0n+ONTRTynFXzV2KoqmcdNgT90dw+PzA55Dnz68zn9wO7f4Pw6vW34muZptRvVPdh4bpbu
svxatxOOdVXaFz0mntaaxTatxERAPdq3TatxRRT5YiMYewAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYtTet2LU3btURRTD3XVFFM1VTiIjeVS
47xGdZd8lGYs08o7z3Br8V1tzWama6/2R+ynPJqyjpmefWU/QECfoj6AlBGMZ6Jn1BD1TPl++yPi
YzE9wWPwnezZuWYjlMTH1d5VfCd2addXa/2p/wCFpp5ZBIAAAAAAAMd+3TctzRVETTMb5hStfpa9
JqarNVMRHmmacdYXlxvEuk9tp/b0RPnojcFX+PPr6o+v3/PuebzRG+QD6/f8+6dpicziccz6on+w
WTwrftTYqsU0xTeiPen/AGd2Pioug1FWk1dF+nM+WcTHeO67aa5Rds03KJiYqjIMohIAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJJcXxDxObFE6
azVHtKucx0gGp4h4r7WatLp/2R+6qOrh5nERnb/hNXOd8xzn1R9e/qAfQ+qf6x1BE8s8nT4Jwv8A
WXfa36J9jTG0d5lh4RoK9bqIp/hG9VXT85rjYtU2rVNu1Hlpp2iAUTURFN+5bpj9tUw8T6fRvcct
Ra4ndpjlPvcu7R7gfD6fn5scszHQnbOenM6znl1Bt8Iuza4lYrpnHmnyyu0Tz3UG3M0XIqjby1RO
c8l709UV2aKqd4mmJz3BkAAAAAAAAea6IqiYq5TGJh6AUni+knSa+aMe7VMzTLT/AJSuHiDRU6vR
TMfvojMSqEdMxMYnEgfm35+bH5+fnZHZIEYjnGejveGNdETOkuRy/ZMy4L1Yrm3epuUzETTOQX6O
SWpw/U06jTUXqZ2mPe9G1AJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAABqcU1lGh0tV6vfpFPWZBg43xKjRWZpo96/VtTHb1VG5VNdc1VTNUzOZnvL1
qr1y/eqvXZmZq358oeJ29ARP5+fnRKJ/rB8gTG7No9Lc1eops0RMTPOY6Mdq3Xcri1RTM3KtowuH
CNBb0ViKY965Me9UDPoNLa0mnps24xEc57y2PmiIxGEgq/i2iY1du5EbVR5c+ri5zG3KVo8WW/No
7d3l5a95ViY5RO/QETv8/wA+59/z7kb+ufz7n1z+fcE488zTjMTEyufBLkXOG2ZjpGFMjliJnM/8
dVl8JXfPpK7eZ9yrbPYHcAAAAAAAAABFW8YxnKn+INHOl1s3I/8AjucvSfyVxaPGdFGs0lVG0VRG
afiCl/D5pRNNVNcxVzifLO3Xqn4yB9TbnjIA63hvVxZ1U2a5jyVxjeVqjHTl0Ufhuku6zV027e0R
Oaquy62afJbinMziMZBkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAB5uVRRRNVU4iIzIPGqv29NZqu3JxTTHZTeJay7rNRNyufd/hTnkz8Z4jVrr/AJKJ
mLNO0Ryy5043nE4BER0mc+p8Tvn5/n9k9c9Of5/YHxTTFUzGM5nbHdE43if7WLw9wvHl1mop97Hu
RPQGzwDhv6a3F+7T/mqjr0h1ojAkAAGjxy17Xhl2mIzMR5v6UyvMRGe2V91NuLunuW55VUzCiXqf
LXVT/rVMA89yUJAdjwjXVTrK7XSacuNLf4Dd9lxS1OcROYmQXKOSURnfPdIAAAAAACM74OuGHW6i
3pbFV65VEREf2DMSqtjjupjWzdrx7KqceXtCy6XUWtRZi7aqzTP0BWvE2i/T6qNTRTi3c5+kuRzz
K8cT00avSV2ZjeYzT8VKu0V0XqqK4xVTtMdgeGTS2bmpv02bUT5qnmiJrqimKfNNW0QtvA+G06Kx
FVeKr1W8z2Bn4Xo7ej08W6Ijzfyq7ttIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAACJ2gEoqpiqmaaozEiQVnjXBqrXm1GkjNMzmqj/s4dWJmYjzY7T0fQ
Z5OJxvg1N2Kr+mjy3OdUdwVnOYk55eqqZpqmmYmmY5xOzd4Pw+vW398Rap/dPf0BseHuGzqrsam9
TMWqKs0xP8pWqIxDzaopt26aKI8tNMYiO0PYAAAAIn4ZUnjFn2XEr9ER7ucx812lV/FdM066iqI2
qpBx56k9ToAirfL3Zq8t+3MTiYric/Pd4kmJmJiJxMRkF/tTFVEVxOfNTEvbT4NXFzhtmYqz7rcA
AAAAEE1RG88uoPN65Rat1V1zimIzMqfxfiFWv1E4zFmnamO7Z8Q8S/U3f01qr/DTnzTHWXH+oHSY
59mzoNZe0V7z2q58vWJnaWuieXcF24dr7WusxVany1xzpno4/ijRzFVOss0zzxW4unu3dPfi7YuT
RVTvz2W/hmoq12ipuXrXlmekxz9QaPh/hkWqI1V6jNyremJ6Q7kd+pERt0wAkAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABzON8Tp0VEU0RFd2eUdmfiut
t6LTTdq3q5U09VN1F25fvVXb0zNdXP4At3CeJ2tbRiZim9Ee9S34mJUG1cuW64rt1zRXG+Vm4Nxi
nUUxZ1ExTd5Z/wBgdlEnRIOdxPhVjXe/VHlu/wC0dm1otLa0mnps242p692cAAAAAABDg+LqP8Fm
7j9s4n5u+53iCz7bhlynlMe9HyBTsxvjpJ9vqRmYiZ5zzggCNvzmmNoxE89vihMZxmAWfwpdpr0E
0bxVRVh2c5nCt+E7uNRcsc4qpyskY+gJAABAEzjvvs4HiPicRE6SzVvyrmG14g4lGkteyszE3q8x
n/WFUqzNc1TMzM9Z/wCQJ5c8o+Kfp9j4bdvQECfht9mzwzRV63UU26cxRE+9PaAbHAuGzrb/ALS5
H+Cjn6rdRTFFMURGIpjEPGms27FqLVqIiinkyghIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiZww6zUUaWxVeuTEREf2y3a6bdE11VRTERvKncY4hVrtR
MUzMWadqYBh4jqrms1PtrkT/ANMZ2iGvONt8zPOURmZj6EdPlj6AmP8AkjvmYnphEdPlj6EdPp9A
WDgvGK6q6NLqPfztTWsMfDChaWqbeqs1xt5a42XyiYqpiuOsA9AAAAAAAAMOso9rprlv/amWZ5qx
jHcFAqjFVVH+szCPhv2/P6bPFaItcSvUU52nMZa3w6cvz+gPh8vz+jfGxy5dOX5/RO3L5fn9A6Ph
+77PitvFXu1RiVxUPR1+y1VuuJxiqN+y9W6oqopqic5jOQegAGjxjXU6LSzXG9ydqYZtfqrek01V
65O0co7ypuu1N3U36r1yrFX8Y6QDHfuV3btV25VM1VerHyTMYnGc55yien1BM+iOuE9Mz8yimq5c
poppmqqraIgGTSWK9TqKbNuJzVznHJcuG6S3o7HsqOf8qu7BwPh1Oi08TVMVXqv3VOjEYAiMckgA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACCZxGZ5dTLg
eIuJzTFWksVRE/yqgGt4g4l+ouTprVU+yp/dMfycfpG/I6RjaOyPhsCY7cvt+fYj89Pz7I5en2AK
fjj7Ec49D8+ACcxHmzE94n4Lxw657XR2rkxjNEKPE42xzWzwzfm7w2Iq50zgHVERukAAAAAABFU4
pmUnOMAqfiimI4ntGM0xOXKWHxdbzRZuxTyq8syr1UYmZ9ZgBAfECcTExMRjnK78Irivh9maZjHl
jGFInnvGVq8LXYq4dETzpnE/YHYeL1yizaquXJiKad5lPmpx5s4j1VXxBxL9VdnT2qp9hTO8xt5p
Br8W11etvTXMzFuJmKI7NHGIxznumZmZj6IgEz1+f3MbTPSP+5HodMgjE5iMb8owtHh/hn6eiNRf
jN2Y92J6Q1vDvDPPMazURmP4xMLFHwBIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAACJnCWjxfXU6HTTXjzXJ2ppz9Qa/H+JRpbXsrMx7ar6QqlUzVXNU5m
Z3z3l6v3Ll67VcuVTXVVzn7PAJg+CJASh7s2rl657O1RNVWM4h5mJiZiYxMbAgwmD6AUzic9Xe8I
1+/et5574/twJ9HU8M3Yt8SiJnFNcYBbY5YShIAAAAAACEgOZ4itTd4dXMTjy7qh1ic56r1rrftN
LdpnOJplRpp8ldVPYEciP+Ceyfr9wR/HG3N3fCVzFy9ZxnMbTE8ubhfKJZtLqLunqqqs1RRVMYyD
s+IuJ+aZ0lqcbe/VE9XBnOIjob5mZnMzOckAif6+xP8ASTpnpAI+LqcB4bOsvReux/gp3mP9pa/C
9DXrdRFEYiiMTVPouOmtUWbUWrVPlop2gHuimKaYpiIiI2iIegAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEPN25Rbt1V1zEU0xmZBj12po0mnqvVzGIja
O6ma7U16zUzduzMdu0M3GNfXrru+Yt0zMU0tL1ifkBOZmZmcyjqfL/ybRHPkBl6txNVXlppma52j
ZFG88s9ll8P8L9lEanURE1zHuxPQGxwXhtGisRVXEzduRvPZV9dRNrWXqKs5iud/ReuU+uOaoeIr
XsuJ1zM/uiJ5g5/x+ZP/ALOU4IBH5LNornsdZZuTt78RMsKYq8uKu0xIL/ROYzjGfq9MGgue10dq
5PWmGcAAAAAAAAHmuYxETGYnaVG1tr2WsvW43iK5n5L2qPiWj2fFJmIxTVTP9g5cbxnpKUYiI2no
nkBJ3yfY+wHdE80gDLotNc1epps24nM857Qx26KrlyLduJmuZxGOi4cH4fRotPGN7lURNVQM+g0l
vR6amzaiMRznrLYiMQJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAQlFU4j5giqqmIzM4wqviDiU6q5Vp7dU+xpnfH8pbPiPimZr0liY7XKvTs4E9tsR/x2
AmZmcz8ITG/2RPqnv3BHP7HrG89IJ543dLgXDqtbf9pXH+Cjn6yDZ8O8Mi9XGrvUzFEftpnqs0RE
RtCKKaaKIopjERGIegRKueL7UTVavbZnMf8ACyOP4ntRVw6a5/jVsCrTtMZiImOaI2xnomc8559E
Rty+X5/QEbY9CMbRVk5cunLJExHPkC3+Grk3OF0ead6ZmPk6aveELs+zu2ap3icxHpusEAkAAAAA
AAEK94vtVf47sU7bxn+lhc7xFpbur4fNFrPmic7Ap8ZmcxyI6YTVE01zTVExVG0xKI3jPcEoSjmB
02MTmIjnPKIgjnE4ysHh7hefLq9TGZ/hEg2fD3DI01uNTdp/zVRtnpDsRGBIAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIcfxDxKNNaqsWZibtcYnf9sO
rfi57Kr2UxFePdmVH1tvUUaquNVH+aZmZnpMAxVYnPPPXKJ6kcspBE9Uz1GTSWK9Vfps24ma6uvY
GXhmjua3U026cxTmJqntC56WzbsWYtWoiKI5MXDdHb0enptUYz/Ke8tmIxAJAAavFKIuaC9RNOfc
mYbTzXT5qZp5ZjGQUCc7Z22Piy663NrV3LdXOKpYQDEY3x8AB1vDFeOKYzjzU8lrjko3DbnstfZu
f9UR/a8UxG8xykHoAAAAAAEATPw+bUs6/TX9TXYouYqo257S0fEPE/YUfprM0zdq2mf9YVmiqqmv
zU+7MT7tX3Ba+LcJt62mbluIt3o5TEc1W1Fm5YuzbvUTRVG2JWHg3GYveXT6vFNfSvO0t/iegs66
1ivnj3ao6ApfPPcls6/R3tHe9ndpmO1XSYZeD6CrW395xZp/fPeOwNjgHDZ1d3212JizTOcT/KVr
ppimIiIiIjk8WLdNq1TbojFNMYp+DICEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAA1OJaGzrrM27tO/Srs2wFH4jor+iu+W9EzHSvpLVXzV6e1qbM2r
tEVUyqfFuFXtFX5o81y1P7ZiOQNGimquuLdNNVVVW0YW7gfDqdDp/fxVeqj3qpa/h7hsWbcai/Gb
k70xPR2uoAAAACJ5JQCn+IrUWuKV4/lES5+Jie/b8/ObueLrVMXrd7GZqiY/rDhYxG8RE/ECPTft
69vt/ZHpv2/P6SjoCaa6rf8AkpxPlmJ3XvRXJu6W1cn+VESomd5jGcwuHh27N7hVuZ/jmkHRAAAA
ABDn8b4jTobGKd7tcT5YZ+Jay3otNN6vfHKnvKmaq/c1N6b12Zmqd8egPFyqa65rrqmqqd5l5/Pi
duqQObtcH4zVZmLGqnzW9oiuP4uJnG/q92bVd+5TatxM1Ttjp8wXa/Zsayx7OvFy3VG0x0etFpbW
ksxatU4phi4TpP0elps+aaqsZmejcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAARVEVRiYzCQERtGIjEJAAAAAAAHG8V2or0EV4zNNSrzjnEY+a
68Xo8/Dr8eXPu5hSt9uk4BHJPIhAJ+0rF4Ru5tXbOYnyzExv3yrsfCPm63hW5FHEJonERVT09P8A
2C1iKZzEbYSAAAxaq/b09mq7dnFNMZe7lUUUTVM4iN5lUeN8Rq1t2aYmYsUzMREdQYOJ625rb83K
5nyR+yns1N+U74690z68+s+n5k+PzA7nf6nx+f5/aOW8xP8A5BNMTVtHPpERzla+AcNjS2ov3af8
1UdejV8OcLxEavURmr+MT0d8CNkgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAACMxnAJETVETiZiDMZ5gkR8yZ+P9AkQkAAAAAAAAHm5GaJp7xhQ9TFVG
ouU1beWuYwvldOY+E5U7j1mbXE7nmmPLVvANHG+J5467ojf8+B03T3zuCOnybfB7kWuI2a6s4mfL
t6tSeb1RXNubdVMZmmuJBf4223SxaWv2mnor/wBoyygI2JcTxFxKbVNWls1R55jeY6A1fEPE5u1T
pLNWKI/dVHVxJxGKY5QiOUbzOTnjHUCDomN8Y6ozHPcExvPJ1/D3DZ1FyNTep/xUzGIn+UtfgvDq
9dezPu2aceae8dlvtUU27cUUUxTTTGIiOkA9Rt0iPgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeapxzmIpxvIJz8f6RVVTTGaqopj1lyOJcbs6eKrdj
37kdc7K/q9ZqdVMzevTj/WAWrV8V0difLNyK56xTvhzrviKmKpi3p/NEd55q9ViJ93EQiIxO4Ote
4/rqpmbcUUR0iYzhFPHdftmq3mOfuuUnv6g6/wD9Qa2JiZptzHXZs2PEcTOL1iY9YlX++8wT8Z+Y
LlpeLaK/Pli5FFXSKow3aaqaozTVFXwnL5/TM59/GGzo9Zf0tUVW7lURGfdmdgXjzRnGd0uDoePU
VVRTqaaaZ/2dqzet3aPPbqiqmZ2mAZAAAAAARO2+Mqx4so8usouZ/dT/AEtDieLLPm0UXcZqpmIy
CsfTB+fAxUfDYCU4zE5+SIeqYyC48DuefhtqZnlGP6b2XF8KVzXoq6JnlVlv8T1tGh003K96pj3a
Qa/HeJRorHltzE36o2jt6qnXM1VzVNU1TO8zPd71N65fvVXbszNc7/Jjjb5Ajl8vz7EbfI+wBy+T
Y4fpbmr1FNm3E46z2hisWa792m1apmqudox0XPhWio0Omi3G9cx71QMuj01GlsU2bcYiOveWdEJA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABrcQ1drR2K
rt3fHKI6g96vUW9NZm5crimI+qq8T4vf1lU00TNq3vHljq1uK6y5rtRNyvzU09KM8mtOImcRiAKY
xGIj590wfEA+CITjPqjMdwIOW/ZJOcf+QR6dgmdznMgdSNuQARETiJimY9WzotdqNJMTZrqimJ/b
no1uaY9QXLh/E9NqqKY80UXJ/jPVvPn+Z2nrTynO8LBwXjMzixrJjpEXOvzBYInKURMTETE5ieyQ
AAGlxu37Tht2MZmIzDdY78ea3XTzzTMAoWPqPV2Kou10VbTTOHkEJjMTk+KAdXw5qaNLeuzcuR5J
pz5e8tLiGsr1uom9XOYiZimM7Q1555xmSIxGIx32BM475nujkfkAEpppqqqimmmaqp2iEdYnHwWX
w7wzyRTq9RGa5j3InoDZ4Dw2nRWYuXI81+uN6uzpxkjaEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAicdegMepvW7Fmq7dnFNMZU3ietua3U+1q/ZH7Kc
8vVs+IOIV6nUzYon/FROMR/JzOe8zmesgTz9Y6ojb5ACe3oiNsdEsmn097U1+S1b889ZjlAMXLEb
f29U0zVPuxNXwhY+H8Bt0Yr1XlrzH7ezq2NHprFPltWaKY+AKVRp71W0WLk//wCU1aW/TzsXI+NM
r1FMR0iPhCZiJjExEwD5/MTTzzHxgq2iJmY9F4u6LS3YmK7NExPo4/EPDtE+a5pq8T/rP2BXuyWX
U6a/pq4tXbU0z3xtPzYZ5gkRnqn8kCSMZ3yc0A7HBuMV6eadPeia7czERV2WmmYmImOWMvn9OOsz
HwdrgHFa6LtOmv1ZonlVVPIFnERMTy5dJ7gJRMROMwlE5jpkFL4za9jxG7TjGZy03Y8V24p1tFcf
zpxLjek/MEyg5/Mjf5gkOfzOYH1RmY3iMkzHV0eCcOq116K68xZpnM+oNjw7wyL9f6q/TPs45RPW
VoiIjl2w826aaKIoopimmNoh7AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAABEuR4l1s6bTxbt1R7Svpno6tyumiJqqmIiImZypPFL9Ws1Nd2qKeeKfgDBV
NU5mczOc5R8CY5R5pkjfHr9//YHInvHKETO2WxoNLc1mpixb2md5ntAMnC+H1665iJmm3HOpbdDp
LWjsRZs0+WI5z1lOj01vTaemxRTtTHP1Z4jEAkAAABCQGK7Zt3YqpuUeamYxOVd4nwS5Zt116eqK
6I38krOiYzAPn07TnlHLGN4Oyz8a4PTfmb+mxRdxvHSVZmmumqbdVM0VU84kCOhHRETCQI6dUY91
KPgCy+HuJVXaI016uPNEe7Po7kcvRQbFyu1dpuW8ZpXXhuqo1Wmpu0zvj3oBtCI3SDheLbcTprd3
G8ThXKue09V61di3qbNVq7TFVM9PVU+LcLu6GvzRmu1PKqOgOfHQjp+Y5Jnb4I6Z7gR0I5DLprFz
U36bNqJ89U/1AMvDtHXrtRFmjaOdVXaFy0li3p7NNq3GKaY592Hhmio0Wmi1RHvY96ru2wEgAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhKJmIjcHK8TX5
taCaaavLNc8/RVKpmeeNnY8V3vPrItRPu0Ry/px5nO/KQRzT8UcgDGc/BaPDGj9jpYv3KZ9pX/wr
uht+21dqzziqqMwvVumKaIoiMRTGIBMJAAAAAAAAAETGYw5XHuG/q7FVduj/ADRGdtsusgFAuUV0
1TTXRNExtidnmf76LP4j4bF+j9TbpmbtO846wrM85j1BHP1PqdZhIHTnzdbw3rPYar2FdWKK4xGe
7kpomYriYzmPe/oF/pnMJa/D70X9JbuxyqpjZsAPF23TcomiuIqpnnEvYCq8Z4NVp5m9p8za609n
GjG/1fQpiJ2lX+N8GiYq1Gkjy1daI6g4FqiblymiimaqquUR/wArbwTh1Oj0/mrxVeq3qqa/h7hs
2af1Gop/yY2iejtAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAABExE7SlE/DIKXxqqa+J3qp/wBtt2l0z0bPEqoq1t6YjlXu1qf2xEgmdkdNk8+aPUHS
8N001cVozGcRMwt8TmM91T8Lz/8Ak42zmmVsp5RmMAkAAAAAAAAAAAEVRM/dT+PaL9LrM24n2Vcz
VGZ5T1XCXO4/p/1HD7nu70bxIKhVj/ujp2N9p5dj6fn5/QJn+keWJ2nMZ22OXp+fn9G8co5As3hO
95tDVbmZ/wAdWN3cVbwndmjWV2Z5V05+a0gAAAAhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlKJnaQUjilMUcQv0x/s1YdHxFZi1xSvfauIn/v/
AMud39ef5/YHRPSTlnPzRy+4N3gt32PEbMzOImcSum07woFEzTXFUc4nK78O1EanSUXY7REg2QAA
AAAAAAAAAHm5EVUVUzGYmMPTzXT5sb8pBQ9RE06i5TMYxXMRDxDa4v8A/wAnf2xHmaoCOu2+IJTE
Tv8AAHR8OTjitER1plb45QqPhrfilGIzijdboBIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJ3hICu+L7OIt38c5xKvztVMRzyu3F9N+q0Ny3
FMTVEZp+KkxnGJiM0zMT8QI9D8hKJ/sE09uUS63hzX1WNT+nrq/xV4iJlyE07TnOJ7g+gRMTyS5H
h/iFOotewuTEV24iImZ/dDrgAAAAAAAAAAIqmKYzM4hLW4le9ho7lz0xHxBTuI1efXXZzmfO146e
r1VmapqmczMzMvMbY9AOeMdSJnlHUjpg2zG4Ox4Ut54hVXMftp5rS4vhS15dJVdmnE1TzdqPiCQA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
RVnGIjKn8f0v6fX1VW6cUV7xt1XDo0uMaP8AV6Oun+cRmnHcFLidvgT/AMPVdM0VzRVnMc4xy7ox
O2eu4I5c+n59kztz6fn2RHQjoD3brrtV+eiry1U9Vt4NxK1q7cW6qsXqYiJieqn9nq3VVbri5RM0
3I5VR0B9AHF4Lxim/FNnUTFN3vM83ZzGcbgkRCQAAAAAQCVZ8U6vz1xpLczEUzmqXW4zxCjRWfd9
67VE+WOyn3K67lU13KvPVM5mQRnO/KUCQQmImaoineZ2j4yiezreGtJF7We3r3ot/PMyCx8Msfpt
FatdYpiZ+LZRGcbpAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAEZYdTqrGniZu3Ip2yDNM4HC1XiG1E+WxZ8/rVLUr8Q6uZny2rUZ7AtGY7kTE8pVSOP6
6J//AKpjthmteIrsT/msUzHXygsqXO0XFNLqZiKa5oqnHu1OhmASAAADgeI+G5idZYj3o2qpiOit
04iOffns+hVRmJjac91Y4/wmq3enU2KYqtTzpxykHF/PiHymI7djmAmSPQjpgCNpziNv7dfh3Grt
i5TRqKpuWsYn0cjsjfy7Y36Avmm1FnU0eezXFcfHdliYlQdPdvWKvNZuTRM9nY0HH7tNEUamiK47
xzBZxz7HF9Bcp/8Al8k9qmenXaSqJmL9GPWQbCY3atXENHTz1Fv+2pf43o7XKv2k9IoB1XN4txWz
pLdVNExcvRyp7ONreO6m95qLUezon/8AZyao80zVNUzVPOZ5yDJqr17U3vaXrnmmpj26TmOiMYjn
kkDnjqdM8yUxz3nEA9WKK7t2LVunzVVctly4XpI0ekotU005xmqfVzPDOgrpq/WXYxmMUxLvgRGE
gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACOuEVTimZ
TVOIyr/iDinvTpdNXET/ACqjcGXjPGKbE16fTRFVWP3R0lXNRdu6iuKrtU1Tju81b4xvBz9fv+fc
ERyxERHbCfyPz+jn6/f8+5z9fv8An3A/I/P6RMbf8J5+v3/Puc/X7/n3AiZ93E4mJ5xzh1uF8Yu6
euKL9U3bUz1nk5PP1+/590c9piJyC+2L1u9biu3X5qZ6sqn8C4hXpdRTbq3t1zj4LdRMTGaZzHcH
oABFUZiY7wkBVuN8IrsVVaixmu3zmns4sTMxvGJ7PoUxmMbY65cDjXBYrom/pKZpnnVR3BXcxvjo
mds+iJjyzMTtjaYnodd/mBO2cdCds+nc+PzI35/MCds+iZiN89ER6/M+PzBExEeqY2zmM/HofH5k
evzAxEZ2g5TtEU99iOmfmR6/MEzmJnM8jkiPX5nxBPInb5EZn7oicgmXV4DwurVXPbXqZizTO3rL
xwXhk6urz34rotR6c5Wuxaos2qbdEYpjoD3TEUxERyjZIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAImRyPEHEo09udPZqiblcYmY/jANXxBxWfe0mlnE8
qq4V+MdMznrPVNW/ftOZ+pPruBH/ACfdGO+5PqCY3+Z90ZjOJn4vVNuurlTO/XG0gj7nP5lUTTMx
VGPij65BP3CYn45/Pujn65+v5n6gmnO+JxtzWrw1rJv6T2Nyf8luMfGO6qbzHPm6Ph2/NjiVuJn3
bnuyC4jzTttneHoAABExnlOEgObxLhOm1fmnyU0XJjaYVnWaDU6TPtbdXlif3TyleHi9bou0TRco
iumek8gUCN+XL4p/Pis2u4BauTNWmqi3V0pmPdcLU6DVaeqYuWatuc0xt8ga3zOXojMROOUnyn+g
T8j05oynE9YA5+uT6mJ9P7MTjPMDpk6ZR70zimmap6RDp6Hg2r1ERVVHsqZ5zUDm001VVx5YqzPK
Ih3uFcDq929q+XOKI6uroOGafSRE0x5q46y3QeaKIp5RiMbR2ewAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABq8R1dvR6eq9XMbRtHeQYONcQp0Njb3r1W
fJHb1VG7XVcuVV1VTVVM5me8ves1N3Vaiq7cqmap6doYdugJhB90zvuBzerVuu7dii3TNVU7Qi3R
VcuU0U0zM1bRhb+DcPp0WniK4iq7ViaqpgGtwzgdmzTF3UYu3p335OvTaoiNqKafSIewGvf0envx
i9apr+XJWuM8IuaSqbtrNdqekR+38+y2vF2mmqiaas+WYxIKBE5+yesfZt8W0v6TX12ojafej1af
TuBHT7Mmmq8motVRO8VxjDGzaOPNrLURGZmuNwXqifNRE94emOu7btUea5XFMR1lzdXx3SWpmKIq
uVRyxyB1hWqvEd7+Onoj4y8R4g1UVZqotzHaAWeJieSVf0/iKnzYvWJpj/aHV0PENNq6c268T2nY
G2ISCEeWJiYneJ6S9ANDU8J0V+c1WopnvDQueG7O8279yM9Jd4BWK/Dd/wDjqLcx6xLzHh7VxO12
2tICtU+HL0zE1aiiO+Ibdnw9p6aY9pduV46cnaAa2n0WlsRHs7NOY5TMbtjokAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB5qqppiZqnERvkHjU3rdi1
Vdu1YopjMqbxPXXNbqZrqmfJGfJT2bPHeJVauv2duZixTmMd5cvrmZzIHKOnxJ/M/n5unl8gDGyM
TM7RMzyInFUO/wCG+G+bGsvxy/ZEwDZ8PcM9hbjUX4zcn9sdna6nwAAAETiY3SiZBWfFdMRrLVf+
1Mx/w4lPSJ7uj4g1X6niFUR+2iMOcBT0z6Z+jJpbvsL9F7y5qp3iOmfVjk/JBn1+sv6yZm7XVEVT
+yJ2hgimKcRTM49QAI+XzD8kE5xvEz8JKZmmIqiaonPSdxHxB3OE8cuUV02tZV5qJ2ivrHxWSiui
umKqKvNE7xMPn/XOHS4HxD9LqYt3K6/YVTERHaQW+EvNE5jOYnPWHoAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAK34i4pN2atJp6oimP31Nr
xDxOqxE6azVi5POY6QrMzmN87zOcgj5Y+aUfc+PXmCUTtEz0hPP7tvhOgua6/FMbW4n3qgbHAOG/
rL0XbsT7Cnf4z0WyiPLTFMRERG0YeNPaos2ot2qfLRTtEMoAAAIAzvhzuP6udLo5m3VEXZ2p+7b1
upt6TT1Xrk7Ryjupmu1Nes1NV69nE/tjPKAYJzM5nnO8z6h07AAdcQjeI/4BMRMxtCGbT6W/qZxZ
tVVb4zyhv0cB11W0xbiOuZBy5iY59Tly2dDVcG1mnomfJFcdPLLnYqicVU4nrAHw2+ye35gxvHx3
KemfTP0BHKOyY/dHSER0zvyz9COmd84z9AWXwzrJuWf01deblM5iJ7O5GcbqLw7UV6bVW78TGI/d
nttld7NdNyiLtMziuImPgDIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAACHO43xGnRWMUTFV2rMREdHRqiZpmInE93I41wqdVVN+zmm7FP/7Aq92q
quuarlU1VVb1VPPx27+nf7/09V0V0VTbromiqn+MvPwAn127+nf7/wBHx27+n5v/AEST1AnaJz84
/Pm3uEcQvaC5P8rUz71OOTSnqR+7nMfAF70uptam1Fy3XFUT25x8mWJiY2UfQ6u9o7sXLVfx9Vs4
Zr7WstZifLcj91HUG6IyAljuXaLdE11VYoiMzL1VMRz5d1W8QcRnU3Z01urFinPmmOoNbi/EK9fe
nnFqmZimGltiMf0jeIxM8kgImcRnoSmMRzAjad9tnX4NwerURRfu5poic4n+T1wThFOqiNRqIqim
J2jus1FMU0xTTGIiMRAPGns0WaPJbp8tOWSOSQEObxXhVnVUTVRFNu7viqIdNFWeUAoN+1VavVW6
qfLNO05/5ePzdYvFekp9lTqqacTFWKvgr0xvmes/QCd8omOcSfH5/n9k+vzBO0zOYmcrh4euTc4b
RNX7qfd+SnxvVELJ4Qq/+2u0TM5irl/YO6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiUgOdxbhtnXW5mqIpu9K4VTV6a7pbvsb0YqjrPX5r3MZ
a2v0dnWWpt3aKZzynqCkZ6o5NviOgvaG55a481HSuGrO3MEcufRMbfJHL5HL5AnphksXq7Vym5RX
VRVTymJ3YwFs4PxWjVU+zvTTRejpyiXTmcxsoETiYmNpjeJ7OtRxy/Ggqt1Ux7fGIrjsDb8RcTxF
WksVY/2mFenERtnYqnzTmczPOZ9UTynHyA5fJPL0wd/oTHPHQDriHS4Dw6dbei5XH+CjnnrPRr8M
0NzW6mKKYmKI/dMdIXLTWbens02rUYpgHuimKKIppjERtD0AAAAIBzfEkebhN2I6YlUJmJxjfaFn
8Van2emp08TGbm8/CFY5RjsAc8pARmrOKY5ys3hGiI0ldfWasKzOecdN1x8P2fY8Nt5jE1e8DoJA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABE
xlIDFfsW79qq1doiqmY3VXjHCLujmbtvNdme38Vvea6YqpmmqmKonnEg+f1c8dU755O5xrg024qv
6SPc5zQ4dWYmc7R2AEdSf/YHwOXJPx+aPj8wBPxPj8wMTvjkyaXT3NRqKbNumfPV17Q8UUVV1xTT
TNVUzjELhwbQU6KxE1YqvVR71WAZ+HaO3otNTatxv1nu2UJAAABAJY79ym1aquVz7tMZl7qnEZ7K
v4g4p+oufprM/wCKic1Y/lPYGhxHV3NZqJu1ztnFNPaGrCapid45zuAg/IJn/jJG+Mb55A2eG6ed
VrKLMRMx5szjtC70UxRRFNPKIxDk+GdDOm0k3LlGLlc536Q64JAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9HE41wam95r+niKbnOY7u2
jr6A+f1U1U11U1UzFUc87I6ZXDi/CrOuomqI8t6I2qjqqmqsXNNf9leiYq6evzBiSiOWUgEgDPoN
RXpNRTfoiJmnpK38O11nWWoqoqiKsb09lJpxnM9GTS3rmmuRds1zTXHLsC+Jc3hHFbWto8teKL0c
47uiCQAEJcnj/Eo0tibdqYm9VExHoDW8RcTxE6SxXGf51K7PLbaO084JmaszVmapnMz3R8QJ/o+W
EkRM5+oInPOIzPb0dvw7wz20xq70T7P+NM9XP4Zo7ms1FNqnMU5iaqvRc7FFNu1FFP7adoB7iMbR
ySAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAADU4jobOttTRdpjP8ao5w20ApHENDe0V3FyJmM7VdGryx6L5qbFvUWZt3qIrpn6Kpxfh
d7Q1TcjzV2ZnaY6A5/x6I+JO0Znl6ABKYATbqqoqiqmqaZjlKycF4xF7y2NXOK+lXdWoI264B9Ai
cxnOfU64Vvg3GfZVU6fUT7k7RV2dzVau3p9LOoqriace7HcGLjGuo0Wlqq53J/bT1U+/crvXJu3a
pqqq3mZZddqruq1E37kznlEdMNf557yB8QlHf0BLJpLFepvU2bVMzVVynsx26aq7lNFFE1VVcohb
+CcOp0ViKqozeq/dIM/DdJRpNPTao5/znHOW0RnrOUgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPNdMV0zTVETE84l6AVjjnB6
rOdRpYzRvM0R0cSP7nq+gTEzMYw4nGuC03Iqv6OPLc5zTHKQVqEpriqmqYqpmJp5xMPMTEx3gEoP
jv3T8fmCI32mIxP0ZK7tVdqm3VXXNMcomeTHPr8z8kEzmYjM/IhH5IBn6cjtG/aNjrmd4xv6u54c
4XNzy6vUxM0R+yiQbnh7hnsKI1N+M3Jj3Y7OzBG2yQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAETukBy+McKo1lE3Kaoov
RyqiOaq37Fyxdqs3KZpq6xP/AHX2YzGGnxPh9nW2fLX7tUcquwKVOZifXP59SeuOrZ4hpLujvTbu
ROI5Vd2v6Ajvjqd9uaUSBO8T65/PqmZzM+o2+F6G5rdTFuJ8tMb1VegNjgPDZ1l/2t2P8FG8x/tK
2UUxTTFMRERG0RDxp7Vuxapt2oiKKYxDKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiYiecZSAwavTWtTam3eoiume
XoqvFuGXdFc80RNdnO1XZcXi7RTcomiumKqZ5xIKByj4Gdsuzxng86eZv2Imq3O80x/FyLVFd25F
FET55nEREAy6PT16nUU2LcT5qufpC48P0dvRaemzaiMY97vMsXBuH29Fp42zdqiJqqb4IjkkAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAARVvTMYifi09Nw/T2NVVqLduKap5endugIpjCQAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAB//9k=</image>
               </value>
               <bind match="none"/>
               <event activity="initialize" name="event__initialize">
                  <script contentType="application/x-javascript">
this.access = "protected";

var editableField = Richiesta.statoModulo;
 
if (editableField.rawValue == "BOZZA"){
	this.presence = "visible";
}else
	this.presence = "hidden";
</script>
               </event>
               <desc>
                  <text name="embeddedHref">..\resources\bozza.jpg</text>
               </desc>
            </field>
            <?templateDesigner expand 1?></pageArea>
         <pageArea name="Page2" id="Page2_ID" relevant="-print">
            <medium stock="a4" short="210mm" long="297mm"/>
            <contentArea x="5.644mm" y="4.432mm" w="197.903mm" h="288.135mm" id="contentArea_ID_copy2" name="contentArea2" relevant="-print"/>
            <?templateDesigner expand 1?></pageArea>
         <?templateDesigner expand 0?></pageSet>
      <subform w="197.942mm" name="modelli" layout="tb" presence="hidden">
         <bind match="none"/>
         <draw name="Rectangle6" w="197.163mm" h="3.235mm">
            <value>
               <rectangle>
                  <edge presence="hidden"/>
                  <corner radius="5.08mm" presence="hidden"/>
               </rectangle>
            </value>
         </draw>
         <subform w="195.942mm" name="elencoModuli" layout="lr-tb" relevant="-print">
            <bind match="none"/>
            <border>
               <edge>
                  <color value="225,225,225"/>
               </edge>
               <fill>
                  <radial>
                     <color value="225,225,225"/>
                  </radial>
               </fill>
               <corner thickness="0.176mm">
                  <color value="225,225,225"/>
               </corner>
            </border>
            <margin bottomInset="1.27mm" topInset="1.27mm" leftInset="0.254mm" rightInset="0.254mm"/>
            <draw name="Text4" w="195.485mm" h="13.289mm">
               <ui>
                  <textEdit/>
               </ui>
               <font size="14pt" typeface="Book Antiqua" baselineShift="0pt" weight="bold">
                  <fill>
                     <color value="102,102,153"/>
                  </fill>
               </font>
               <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
               <para vAlign="middle" hAlign="center" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
               <value>
                  <text>INDICE SEZIONI</text>
               </value>
               <border>
                  <edge presence="hidden"/>
               </border>
               <traversal>
                  <traverse ref="Bookmark[0]"/>
               </traversal>
            </draw>
            <subform name="Subform1" w="56.372mm" h="235.967mm">
               <bind match="none"/>
            </subform>
            <field name="Bookmark" access="protected" w="0.1mm" h="5mm">
               <ui>
                  <textEdit>
                     <border presence="hidden">
                        <?templateDesigner StyleID aped0?></border>
                     <margin/>
                  </textEdit>
               </ui>
               <font typeface="Arial" size="8pt"/>
               <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
               <para vAlign="middle"/>
               <bind match="none"/>
               <traversal>
                  <traverse ref="cap_1[0].b1[0]"/>
               </traversal>
            </field>
            <subform w="86.662mm" minH="16.87mm" name="cap_1" layout="lr-tb">
               <field name="b1" w="83mm" h="6.063mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>1. Scheda identificativa impianto</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font typeface="Times New Roman"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
	
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.PageHeaderLogo.intestazInizialeRipSF.Bookmark);	
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b2[0]"/>
                  </traversal>
               </field>
               <field name="b2" w="83mm" h="6.063mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>2. Trattamento acqua</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font typeface="Times New Roman"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">

Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaTrattH2O.PageHeaderLogo.intestazInizialeRipSF.Bookmark);

</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b3[0]"/>
                  </traversal>
               </field>
               <field name="b3" w="83mm" h="6.072mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>3. Nomina terzo responsabile impianto termico</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font typeface="Times New Roman"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaNomina.PageHeaderLogo.intestazInizialeRipSF.Bookmark);	
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="esercizio2[0]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="83mm" h="4.658mm">
                  <value>
                     <text>4. GENERATORI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <font size="8pt" typeface="Times New Roman" weight="bold" posture="italic">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <traversal>
                     <traverse ref="b4[0]"/>
                  </traversal>
               </draw>
               <field name="b4" w="83mm" h="6.676mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>4.1 Gruppi termici o caldaie</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font typeface="Times New Roman"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">

Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori4_1.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
	
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b5[0]"/>
                  </traversal>
               </field>
               <keep intact="contentArea"/>
               <border>
                  <edge thickness="0.3764mm">
                     <color value="102,102,153"/>
                  </edge>
                  <corner thickness="0.376mm">
                     <color value="102,102,153"/>
                  </corner>
               </border>
               <bind match="none"/>
               <margin leftInset="2mm" rightInset="2mm"/>
               <field name="b5" w="83mm" h="6.676mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>4.2 Bruciatori</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font typeface="Times New Roman"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">

Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori4_2.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
	
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b6[0]"/>
                  </traversal>
               </field>
               <field name="b6" w="83mm" h="6.676mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>4.3 Recuperatori / Condensatori lato fumi</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font typeface="Times New Roman"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">

Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori4_3.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
	
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b7[0]"/>
                  </traversal>
               </field>
               <field name="b7" w="83mm" h="6.676mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>4.4 Macchine frigorifere / Pompe di calore</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font typeface="Times New Roman"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori4_4.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
	
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b8[0]"/>
                  </traversal>
               </field>
               <field name="b8" w="83mm" h="6.676mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>4.5 Scambiatori di calore ..........</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori4_5.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
	
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b9[0]"/>
                  </traversal>
               </field>
               <field name="b9" w="83mm" h="6.676mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>4.6 Cogeneratori / Trigeneratori</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori4_6.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
	
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b10[0]"/>
                  </traversal>
               </field>
               <field name="b10" w="83mm" h="6.676mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>4.7 Campi solari termici</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori4_7.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b11[0]"/>
                  </traversal>
               </field>
               <field name="b11" w="83mm" h="6.676mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>4.8 Altri generatori</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori4_8.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="83mm" h="4.658mm">
                  <value>
                     <text>5. SISTEMI DI REGOLAZIONE E CONTABILIZZAZIONE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <font size="8pt" typeface="Times New Roman" weight="bold" posture="italic">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <traversal>
                     <traverse ref="b12[0]"/>
                  </traversal>
               </draw>
               <field name="b12" w="83mm" h="6.475mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>5.1 Regolazione Primaria</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori5_1.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b13[0]"/>
                  </traversal>
               </field>
               <field name="b13" w="83mm" h="6.475mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>5.2 Regolazione singolo ambiente di zona</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaSistemiRegolaz5_2.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b14[0]"/>
                  </traversal>
               </field>
               <field name="b14" w="83mm" h="6.475mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>6. Sistemi di distribuzione</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaGeneratori6.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b15[0]"/>
                  </traversal>
               </field>
               <field name="b15" w="83mm" h="6.475mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>7. Sistema di emissione</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaSistEmissione7.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b16[0]"/>
                  </traversal>
               </field>
               <field name="b16" w="83mm" h="6.475mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>8. Sistema di accumulo</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaSistAccumulo8.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="83mm" h="4.658mm">
                  <value>
                     <text>9. ALTRI COMPONENTI DELL'IMPIANTO</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <font size="8pt" typeface="Times New Roman" weight="bold" posture="italic">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <traversal>
                     <traverse ref="b17[0]"/>
                  </traversal>
               </draw>
               <field name="b17" w="83mm" h="6.881mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>9.1 Torri evaporative</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp9_1.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b18[0]"/>
                  </traversal>
               </field>
               <field name="b18" w="83mm" h="6.881mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>9.2 Raffreddatori di liquido</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp9_2.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b19[0]"/>
                  </traversal>
               </field>
               <field name="b19" w="83mm" h="6.881mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>9.3 Scambiatori di calore intermedi</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp9_3.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b20[0]"/>
                  </traversal>
               </field>
               <field name="b20" w="83mm" h="6.2mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>9.4 Circuiti interrati a condensazione / espansione diretta</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-17.008pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp9_4.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b21[0]"/>
                  </traversal>
               </field>
               <field name="b21" w="83mm" h="5.877mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>9.5 Unità di trattamento aria</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-17.008pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp9_5.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b22[0]"/>
                  </traversal>
               </field>
               <field name="b22" w="83mm" h="5.877mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>9.6 Recuperatori di calore (aria ambiente)</text>
                     </value>
                     <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-17.008pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp9_6.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b23[0]"/>
                  </traversal>
               </field>
               <field name="b23" w="83mm" h="5.877mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>10.1 Impianto di ventilazione meccanica controllata</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp10_1.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="83mm" h="4.658mm">
                  <value>
                     <text>11. RISULTATI  PRIMA VERIFICA ............</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <font size="8pt" typeface="Times New Roman" weight="bold" posture="italic">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <traversal>
                     <traverse ref="b24[0]"/>
                  </traversal>
               </draw>
               <field name="b24" w="83mm" h="4.863mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>11.1 Gruppi termici</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp11_1.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b25[0]"/>
                  </traversal>
               </field>
               <field name="b25" w="83mm" h="7mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>11.2 Macchine frigo / Pompe di calore</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp11_2.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b26[0]"/>
                  </traversal>
               </field>
               <field name="b26" w="83mm" h="9.466mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>11.3 Scambiatori calore sottostazione teleriscaldamento / teleraffrescamento</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-19.843pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp11_3.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b27[0]"/>
                  </traversal>
               </field>
               <field name="b27" w="83mm" h="4.765mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>11.4 Cogeneratori / Trigeneratori</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp11_4.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b28[0]"/>
                  </traversal>
               </field>
               <field name="b28" w="83mm" h="5.257mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>12. Interventi di controllo efficienza energetica</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp12.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b28[1]"/>
                  </traversal>
               </field>
               <field name="b28" w="83mm" h="6.189mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>13. Risultati ispezioni periodiche a cura ente competente</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp13.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[4]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="83mm" h="0.134569in">
                  <value>
                     <text>14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <font size="8pt" typeface="Times New Roman" weight="bold" posture="italic">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <traversal>
                     <traverse ref="b28[2]"/>
                  </traversal>
               </draw>
               <field name="b28" w="83mm" h="5.295mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>14.1 Consumo di combustibile</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp14_1.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b28[3]"/>
                  </traversal>
               </field>
               <field name="b28" w="83mm" h="5.295mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>14.2 Consumo energia elettrica</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp14_2.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b28[4]"/>
                  </traversal>
               </field>
               <field name="b28" w="83mm" h="9.098mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>14.3 Consumo di acqua di reintegro nel circuito impianto termico</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp14_3.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b28[5]"/>
                  </traversal>
               </field>
               <field name="b28" w="83mm" h="9.098mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <text>14.4 Consumo di prodotti chimici trattamento acqua circuito impianto termico</text>
                     </value>
                     <para vAlign="middle" marginLeft="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.schedaAltriComp14_4.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
                  <traversal>
                     <traverse ref="b28[6]"/>
                  </traversal>
               </field>
               <field name="b28" w="83mm" h="6.214mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <caption>
                     <value>
                        <exData contentType="text/html">
                           <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="margin-left:5.669pt;text-decoration:none;letter-spacing:0in">ISTRUZIONI PER LA COMPILAZIONE</p></body>
                        </exData>
                     </value>
                     <para vAlign="middle" marginLeft="5.669pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="-22.677pt" marginRight="0pt"/>
                     <font typeface="Times New Roman" baselineShift="0pt"/>
                  </caption>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
Focus.init();
//xfa.host.setFocus(TOC.IndiceQuadri.TitoloQuadri.Bookmark);	
xfa.host.setFocus(Richiesta.sfIstruzioni.PageHeaderLogo.intestazInizialeRipSF.Bookmark);
</script>
                  </event>
                  <event activity="mouseEnter" name="event__mouseEnter">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("enter",this,"102,102,153","0"); //blu gray
</script>
                  </event>
                  <event activity="mouseExit" name="event__mouseExit">
                     <script contentType="application/x-javascript">
Focus.evidenziaPassaggioMouse("exit",this,"0,0,0","0");
</script>
                  </event>
               </field>
               <traversal>
                  <traverse operation="first" ref="b1[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <subform name="Subform2" w="46.304mm" h="238.191mm">
               <bind match="none"/>
            </subform>
            <keep intact="contentArea"/>
            <traversal>
               <traverse operation="first" ref="Text4[0]"/>
            </traversal>
            <?templateDesigner expand 1?></subform>
         <margin leftInset="1mm" topInset="0mm" bottomInset="0mm" rightInset="1mm"/>
         <event activity="prePrint" ref="$host" name="event__prePrint">
            <script contentType="application/x-javascript">
this.presence = "hidden";
</script>
         </event>
         <event activity="postPrint" ref="$host" name="event__postPrint">
            <script contentType="application/x-javascript">
//this.presence = "visible";
</script>
         </event>
         <event activity="initialize" name="event__initialize">
            <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "hidden";
</script>
         </event>
         <breakAfter target="Page1.#contentArea" targetType="contentArea"/>
         <breakBefore target="Page2.contentArea2" targetType="contentArea"/>
         <traversal>
            <traverse operation="first" ref="elencoModuli[0].Text4[0]"/>
         </traversal>
         <?templateDesigner expand 0?></subform>
      <subform w="201.004mm" name="Richiesta" layout="lr-tb">
         <field name="versioneStampa" w="8.51mm" h="4.044mm" access="protected" presence="hidden">
            <ui>
               <checkButton>
                  <border presence="hidden">
                     <?templateDesigner StyleID aped0?></border>
                  <margin/>
               </checkButton>
            </ui>
            <font typeface="Myriad Pro"/>
            <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
            <para vAlign="middle"/>
            <value>
               <text>false</text>
            </value>
            <items>
               <text>true</text>
               <text>false</text>
            </items>
            <bind match="none"/>
            <traversal>
               <traverse ref="statoModulo[0]"/>
            </traversal>
         </field>
         <field name="statoModulo" w="62mm" access="protected" presence="hidden" minH="4.246mm">
            <ui>
               <textEdit>
                  <border>
                     <?templateDesigner StyleID aped3?>
                     <edge stroke="lowered"/>
                  </border>
                  <margin/>
               </textEdit>
            </ui>
            <font typeface="Myriad Pro"/>
            <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
            <para vAlign="middle"/>
            <caption reserve="25mm">
               <para vAlign="middle"/>
               <value>
                  <text>statoModulo</text>
               </value>
            </caption>
            <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.statoModulo"/>
            <traversal>
               <traverse ref="codice_impianto[0]"/>
            </traversal>
         </field>
         <field name="codice_impianto" w="62mm" h="4.246mm" presence="hidden" access="protected">
            <ui>
               <textEdit>
                  <border>
                     <?templateDesigner StyleID aped3?>
                     <edge stroke="lowered"/>
                  </border>
                  <margin/>
               </textEdit>
            </ui>
            <font typeface="Myriad Pro"/>
            <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
            <para vAlign="middle"/>
            <caption reserve="25mm">
               <para vAlign="middle"/>
               <value>
                  <text>Codice_impianto</text>
               </value>
            </caption>
            <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.codice_impianto"/>
            <traversal>
               <traverse ref="formValido[0]"/>
            </traversal>
         </field>
         <field name="formValido" w="19.208mm" h="5.112mm" presence="hidden">
            <ui>
               <numericEdit>
                  <border>
                     <edge stroke="lowered" presence="hidden"/>
                     <corner presence="hidden"/>
                  </border>
                  <margin/>
               </numericEdit>
            </ui>
            <font typeface="Myriad Pro"/>
            <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
            <para vAlign="middle"/>
            <caption reserve="0.9725mm">
               <para vAlign="middle"/>
            </caption>
            <bind match="none"/>
            <traversal>
               <traverse ref="formValidoParz[0]"/>
            </traversal>
         </field>
         <field name="formValidoParz" w="19.208mm" h="5.112mm" access="protected" presence="hidden">
            <ui>
               <numericEdit>
                  <border>
                     <edge presence="hidden"/>
                     <edge presence="hidden"/>
                     <edge/>
                     <edge presence="hidden"/>
                     <?templateDesigner StyleID aped1?></border>
                  <margin/>
               </numericEdit>
            </ui>
            <font typeface="Myriad Pro"/>
            <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
            <para vAlign="middle"/>
            <caption reserve="0.9725mm">
               <para vAlign="middle"/>
            </caption>
            <bind match="none"/>
            <traversal>
               <traverse ref="lastFocus[0]"/>
            </traversal>
         </field>
         <field name="lastFocus" w="37.547mm" h="3.984mm" access="readOnly" presence="hidden">
            <ui>
               <textEdit>
                  <border>
                     <?templateDesigner StyleID aped3?>
                     <edge stroke="lowered"/>
                  </border>
                  <margin/>
               </textEdit>
            </ui>
            <font typeface="Myriad Pro"/>
            <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
            <para vAlign="middle"/>
            <caption reserve="14.55mm">
               <para vAlign="middle"/>
               <value>
                  <text>lastFocus</text>
               </value>
            </caption>
            <bind match="none"/>
            <calculate override="error"/>
            <event activity="initialize" name="event__initialize">
               <script contentType="application/x-javascript">
this.presence = "hidden";
</script>
            </event>
            <traversal>
               <traverse ref="PageHeaderLogo[0]"/>
            </traversal>
         </field>
         <subform w="199.993mm" name="web" layout="lr-tb" presence="hidden">
            <bind match="none"/>
            <field name="fabbricante" w="34.998mm" h="3.033mm">
               <ui>
                  <choiceList>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <margin/>
                  </choiceList>
               </ui>
               <font typeface="Verdana" size="8pt"/>
               <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
               <para vAlign="middle"/>
               <caption reserve="0.01in">
                  <para vAlign="middle"/>
               </caption>
               <border>
                  <edge presence="hidden"/>
               </border>
               <bind match="dataRef" ref="$.L4_1fabbricanteRif"/>
               <items/>
               <items save="1" presence="hidden"/>
               <bindItems ref="$record.Richiesta.datiPrecompilati.elencoFabbricante.fabbricante[*]" labelRef="descrizione" valueRef="codice"/>
            </field>
            <field name="combustibile" w="28.864mm" h="3.033mm">
               <ui>
                  <choiceList>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <margin/>
                  </choiceList>
               </ui>
               <font typeface="Verdana" size="8pt"/>
               <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
               <para vAlign="middle"/>
               <caption reserve="0.01in">
                  <para vAlign="middle"/>
               </caption>
               <border>
                  <edge presence="hidden"/>
                  <corner/>
               </border>
               <bind match="dataRef" ref="$.L4_1combustibileRif"/>
               <items save="1"/>
               <bindItems ref="$record.Richiesta.datiPrecompilati.elencoCombustibile.combustibile[*]" labelRef="descrizione" valueRef="codice"/>
            </field>
            <field name="fluidoTermoVet" w="24.769mm" h="2.629mm">
               <ui>
                  <choiceList>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <margin/>
                  </choiceList>
               </ui>
               <font typeface="Verdana" size="8pt"/>
               <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
               <para vAlign="middle"/>
               <caption reserve="0.01in">
                  <para vAlign="middle"/>
               </caption>
               <border>
                  <edge presence="hidden"/>
                  <corner/>
               </border>
               <bind match="dataRef" ref="$.L4_1fluidoTermoVettRif"/>
               <items save="1"/>
               <bindItems ref="$record.Richiesta.datiPrecompilati.elencoFluidoTermoVett.fluidoTermoVett[*]" labelRef="descrizione" valueRef="codice"/>
            </field>
            <field name="unitaMisura" w="24.769mm" h="2.629mm">
               <ui>
                  <choiceList>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <margin/>
                  </choiceList>
               </ui>
               <font typeface="Verdana" size="8pt"/>
               <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
               <para vAlign="middle"/>
               <caption reserve="0.01in">
                  <para vAlign="middle"/>
               </caption>
               <border>
                  <edge presence="hidden"/>
                  <corner/>
               </border>
               <bind match="dataRef" ref="$.L4_1fluidoTermoVettRif"/>
               <items save="1"/>
               <bindItems ref="$record.Richiesta.datiPrecompilati.elencoUM.unitaMisura[*]" labelRef="descrizione" valueRef="codice"/>
            </field>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
            <subform h="11.831mm" name="intestazInizialeRipSF" w="197.769mm">
               <border>
                  <corner presence="hidden"/>
                  <edge presence="hidden"/>
               </border>
               <bind match="none"/>
               <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                  <border>
                     <corner presence="hidden" thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <linear type="toTop">
                           <color value="192,192,192"/>
                        </linear>
                     </fill>
                  </border>
                  <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                  <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                  <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>1. SCHEDA IDENTIFICATIVA DELL'IMPIANTO</text>
                  </value>
                  <traversal>
                     <traverse ref="TocButton[0]"/>
                  </traversal>
                  <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                  <?renderCache.textRun 38 1. SCHEDA IDENTIFICATIVA DELL'IMPIANTO 0 153763 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
               <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.018mm" y="2.427mm">
                  <font typeface="Myriad Pro"/>
                  <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                  <para vAlign="middle"/>
                  <ui>
                     <textEdit>
                        <border presence="hidden">
                           <?templateDesigner StyleID aped0?></border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <bind match="none"/>
                  <traversal>
                     <traverse ref="schedaIdentifImp[0]"/>
                  </traversal>
               </field>
               <field name="TocImage" y="0.607mm" x="192.929mm" w="4mm" h="4mm" relevant="-print">
                  <ui>
                     <imageEdit/>
                  </ui>
                  <value>
                     <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                  </value>
                  <?templateDesigner expand 1?>
                  <assist>
                     <toolTip>quadri</toolTip>
                  </assist>
                  <bind match="none"/>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse ref="Bookmark[0]"/>
                  </traversal>
               </field>
               <field h="4.247mm" name="TocButton" w="5mm" x="192.714mm" y="0.607mm" relevant="-print">
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <font typeface="Myriad Pro"/>
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                  </event>
                  <assist>
                     <toolTip>vai all'elenco sezioni</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="TocImage[0]"/>
                  </traversal>
               </field>
               <traversal>
                  <traverse operation="first" ref="Text1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <bind match="none"/>
            <traversal>
               <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
               <traverse ref="schedaIdentifImp[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaIdentifImp" layout="lr-tb">
            <border>
               <edge>
                  <color value="128,128,128"/>
               </edge>
               <corner thickness="0.176mm">
                  <color value="128,128,128"/>
               </corner>
            </border>
            <bind match="none"/>
            <margin leftInset="0mm"/>
            <subform w="197mm" minH="21.576mm" name="sottoSK_1_1">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_1" x="0.001mm" w="166.007mm" minH="6mm">
                  <value>
                     <text>1.1 TIPOLOGIA INTERVENTO</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="txdata[0]"/>
                  </traversal>
               </draw>
               <draw name="txdata" x="7.953mm" y="7.481mm" w="11.727mm" h="6mm">
                  <value>
                     <text>in data:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="dataIntervento[0]"/>
                  </traversal>
                  <?renderCache.bounds 33242 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 8 in data: 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="dataIntervento" y="7.481mm" x="20.085mm" w="20.22mm" h="6mm">
                  <ui>
                     <dateTimeEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </dateTimeEdit>
                     <picture>date{DD/MM/YYYY}</picture>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle" hAlign="center"/>
                  <value>
                     <date/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle" hAlign="center"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_1dataIntervento">
                     <picture>date{YYYY-MM-DD}</picture>
                  </bind>
                  <validate formatTest="error">
                     <script contentType="application/x-javascript">
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio o data intervento maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( (this.rawValue == null || this.rawValue == "") &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);
} else {
	if (this.rawValue &gt; scriptsJS.getDataString()){
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);
	} else {	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	}
}
</script>
                     <message>
                        <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                     </message>
                     <picture>date{DD/MM/YYYY}</picture>
                  </validate>
                  <format>
                     <picture>date{DD/MM/YYYY}</picture>
                  </format>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValido";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,null,null,"CORR",fCheckValidi );
*/

</script>
                  </event>
                  <assist>
                     <toolTip>Data intervento  (sez 1.1)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag4[0]"/>
                  </traversal>
               </field>
               <field name="flagTipoInterv1" w="5.577mm" h="6mm" x="7.953mm" y="15.472mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTipoInterv2.rawValue = "0";
	flagTipoInterv3.rawValue = "0";	
	flagTipoInterv4.rawValue = "0";	
}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_1flagNuovaInst"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Nuova installazione  (sez 1.1)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.98mm" y="15.472mm" w="28.713mm" h="6mm">
                  <value>
                     <text>Nuova installazione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagTipoInterv2[0]"/>
                  </traversal>
                  <?renderCache.bounds 81391 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 19 Nuova installazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTipoInterv2" w="5.785mm" h="6mm" x="45.686mm" y="15.472mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTipoInterv1.rawValue = "0";
	flagTipoInterv3.rawValue = "0";	
	flagTipoInterv4.rawValue = "0";	
}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv1.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_1flagRistrutt"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Ristrutturazione  (sez 1.1)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag2[0]"/>
                  </traversal>
               </field>
               <draw name="txflag2" x="52.59mm" y="15.472mm" w="28.713mm" h="6mm">
                  <value>
                     <text>Ristrutturazione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagTipoInterv3[0]"/>
                  </traversal>
                  <?renderCache.bounds 81391 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 16 Ristrutturazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTipoInterv3" w="5.785mm" h="6mm" x="83.498mm" y="15.472mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTipoInterv1.rawValue = "0";
	flagTipoInterv4.rawValue = "0";	
	flagTipoInterv2.rawValue = "0";	
}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv1.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_1flagSostGenerat"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Sostituzione  (sez 1.1)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag3[0]"/>
                  </traversal>
               </field>
               <draw name="txflag3" x="89.997mm" y="15.472mm" w="39.05mm" h="6mm">
                  <value>
                     <text>Sostituzione del generatore</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagTipoInterv4[0]"/>
                  </traversal>
                  <?renderCache.bounds 110693 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 27 Sostituzione del generatore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTipoInterv4" w="5.785mm" h="6mm" x="131.42mm" y="15.472mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTipoInterv1.rawValue = "0";
	flagTipoInterv3.rawValue = "0";	
	flagTipoInterv2.rawValue = "0";	
}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv1.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_1flagCompilaLibretto"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Compilazione  (sez 1.1)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="sottoSK1_2_1[0]"/>
                  </traversal>
               </field>
               <draw name="txflag4" x="138.093mm" y="15.367mm" w="57.828mm" h="6.209mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Compilazione libretto<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt">impianto esistente</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagTipoInterv1[0]"/>
                  </traversal>
               </draw>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="tx_1_1[0]"/>
                  <traverse ref="sottoSK1_2_1[0]"/>
               </traversal>
            </subform>
            <draw name="Rectangle5" w="195.325mm" h="4.044mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.115mm" minH="21.171mm" name="sottoSK1_2_1">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_2" x="0.422mm" y="0.098mm" w="166.007mm" minH="6mm">
                  <value>
                     <text>1.2 UBICAZIONE E DESTINAZIONE DELL'EDIFICIO</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="cognome[0]"/>
                  </traversal>
               </draw>
               <draw name="xindir" x="6.953mm" y="8.088mm" w="13.772mm" h="6mm">
                  <value>
                     <text>Indirizzo</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="indirizzo[0]"/>
                  </traversal>
                  <?renderCache.bounds 39039 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 9 Indirizzo 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="indirizzo" y="8.088mm" w="80.677mm" h="6mm" x="21.511mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_2indirizzo"/>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="104.413mm" y="8.088mm" w="5.257mm" h="6mm">
                  <value>
                     <text>N.</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="civico[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 2 N. 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="civico" y="8.088mm" w="13.547mm" h="6mm" x="113.31mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_2civico"/>
                  <traversal>
                     <traverse ref="txpalazzo[0]"/>
                  </traversal>
               </field>
               <draw name="txpalazzo" x="127.666mm" y="8.088mm" w="11.727mm" h="6mm">
                  <value>
                     <text>Palazzo</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="palazzo[0]"/>
                  </traversal>
                  <?renderCache.bounds 33242 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 7 Palazzo 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="palazzo" y="8.088mm" w="14.356mm" h="6mm" x="139.191mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_2palazzo"/>
                  <traversal>
                     <traverse ref="txscala[0]"/>
                  </traversal>
               </field>
               <draw name="txscala" x="154.559mm" y="8.088mm" w="8.492mm" h="6mm">
                  <value>
                     <text>Scala</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="scala[0]"/>
                  </traversal>
                  <?renderCache.bounds 24072 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 Scala 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="scala" y="8.088mm" w="8.694mm" h="6mm" x="163.455mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_2scala"/>
                  <traversal>
                     <traverse ref="txinterno[0]"/>
                  </traversal>
               </field>
               <draw name="txinterno" x="173.566mm" y="8.088mm" w="11.121mm" h="6mm">
                  <value>
                     <text>Interno</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="interno[0]"/>
                  </traversal>
                  <?renderCache.bounds 31524 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 7 Interno 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="interno" y="8.088mm" w="8.694mm" h="6mm" x="185.091mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_2interno"/>
                  <traversal>
                     <traverse ref="txcomune[0]"/>
                  </traversal>
               </field>
               <draw name="txcomune" x="6.953mm" y="15.171mm" w="13.772mm" h="6mm">
                  <value>
                     <text>Comune</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="comune[0]"/>
                  </traversal>
                  <?renderCache.bounds 39039 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 6 Comune 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="comune" y="15.171mm" w="80.677mm" h="6mm" x="21.511mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_2comune"/>
                  <traversal>
                     <traverse ref="txprov[0]"/>
                  </traversal>
               </field>
               <draw name="txprov" x="104.413mm" y="15.171mm" w="8.089mm" h="6mm">
                  <value>
                     <text>prov.</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="prov[0]"/>
                  </traversal>
                  <?renderCache.bounds 22929 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 prov. 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="prov" y="15.171mm" w="10.312mm" h="6mm" x="113.31mm" access="protected">
                  <ui>
                     <textEdit>
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_2prov"/>
                  <value>
                     <text maxChars="2"/>
                  </value>
                  <traversal>
                     <traverse ref="sezCatasto[0]"/>
                  </traversal>
               </field>
               <traversal>
                  <traverse operation="first" ref="tx_1_2[0]"/>
                  <traverse ref="sezCatasto[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle5" w="195.325mm" h="2.344mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.758mm" layout="lr-tb" name="sezCatasto">
               <bind match="none"/>
               <subform w="5.473mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
estremiCatastali.instanceManager.addInstance();
var vRowCount = estremiCatastali.instanceManager.count;
//estremiCatastali.foglioN.rawValue = 

</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="addRiga[0]"/>
                     </traversal>
                  </field>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="estremiCatastali[0]"/>
                     </traversal>
                  </draw>
                  <?templateDesigner expand 0?>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "hidden";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="btAdd[0]"/>
                     <traverse ref="estremiCatastali[0]"/>
                  </traversal>
               </subform>
               <draw name="Rectangle5" w="182.763mm" h="5.983mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="190.258mm" minH="5mm" name="estremiCatastali" layout="lr-tb">
                  <keep intact="contentArea"/>
                  <bind match="none"/>
                  <subform w="5.015mm" name="button" h="5.504mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;
var vRowCount = _estremiCatastali.count;
	

if (vRowCount &gt; 1) {
	_estremiCatastali.removeInstance(vIndex);
}else{
	sezione.rawValue = "";
	foglioN.rawValue = "";
	particella.rawValue = "";
	sub.rawValue = "";
	pod.rawValue = "";
	pdr.rawValue = "";
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sezione[0]"/>
                        </traversal>
                     </field>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

if (vIndex == 0 ){ //&amp;&amp; sezione.rawValue != null
	this.presence = "invisible";
}else
	this.presence = "visible";
</script>
                     </event>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "Bozza")*/
	this.presence = "hidden";
</script>
                     </event>
                     <?templateDesigner expand 0?>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sezione[0]"/>
                     </traversal>
                  </subform>
                  <field name="sezione" w="32.582mm" h="5mm">
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Verdana" size="8pt"/>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <ui>
                        <textEdit>
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                        </textEdit>
                     </ui>
                     <caption reserve="12.0436mm">
                        <value>
                           <text>sezione</text>
                        </value>
                        <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     </caption>
                     <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                     <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.sezCatasto.rowCatasto[*].L1_2sezione"/>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.sezione.access = "protected";
}
</script>
                     </event>
                     <traversal>
                        <traverse ref="foglioN[0]"/>
                     </traversal>
                     <value>
                        <text maxChars="5"/>
                     </value>
                  </field>
                  <field name="foglioN" w="26.084mm" h="5mm">
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Verdana" size="8pt"/>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <ui>
                        <textEdit>
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                        </textEdit>
                     </ui>
                     <caption reserve="9.1754mm">
                        <value>
                           <text>foglio</text>
                        </value>
                        <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                     </caption>
                     <value>
                        <text maxChars="5"/>
                     </value>
                     <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                     <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.sezCatasto.rowCatasto[*].L1_2foglio"/>
                     <validate>
                        <script contentType="application/x-javascript">
// NON PIU' OBBLIGATORIO
/*
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio o data intervento maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
*/
</script>
                     </validate>
                     <event activity="prePrint" ref="$host" name="event__prePrint">
                        <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                     </event>
                     <assist>
                        <toolTip>Foglio  (sez 1.2)</toolTip>
                     </assist>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.foglioN.access = "protected";
}
</script>
                     </event>
                     <traversal>
                        <traverse ref="particella[0]"/>
                     </traversal>
                  </field>
                  <field name="particella" w="31.745mm" h="5mm">
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Verdana" size="8pt"/>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <ui>
                        <textEdit>
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                        </textEdit>
                     </ui>
                     <event activity="initialize">
                        <script contentType="application/x-javascript"/>
                     </event>
                     <caption reserve="13.3802mm">
                        <value>
                           <text>particella</text>
                        </value>
                        <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                     </caption>
                     <margin leftInset="0mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                     <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.sezCatasto.rowCatasto[*].L1_2particella"/>
                     <validate>
                        <script contentType="application/x-javascript">
// NON PIU' OBBLIGATORIO
/*
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio o data intervento maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
*/
</script>
                     </validate>
                     <event activity="prePrint" ref="$host" name="event__prePrint">
                        <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                     </event>
                     <assist>
                        <toolTip>Particella  (sez 1.2)</toolTip>
                     </assist>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

if (vIndex == 0 &amp;&amp; sezione.rawValue != null){
	this.acccess = "protected";
}else
	this.acccess = "open";</script>
                     </event>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.particella.access = "protected";
}
</script>
                     </event>
                     <traversal>
                        <traverse ref="sub[0]"/>
                     </traversal>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.particella.access = "protected";
}
</script>
                     </event>
                     <value>
                        <text maxChars="9"/>
                     </value>
                  </field>
                  <field name="sub" h="5mm" w="22.444mm">
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Verdana" size="8pt"/>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <ui>
                        <textEdit>
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                        </textEdit>
                     </ui>
                     <event activity="initialize">
                        <script contentType="application/x-javascript"/>
                     </event>
                     <caption reserve="6.6901mm">
                        <value>
                           <text>sub.</text>
                        </value>
                        <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                     </caption>
                     <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                     <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.sezCatasto.rowCatasto[*].L1_2sub"/>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

if (vIndex == 0 &amp;&amp; sezione.rawValue != null){
	this.acccess = "protected";
}else
	this.acccess = "open";
</script>
                     </event>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.sub.access = "protected";
}
</script>
                     </event>
                     <traversal>
                        <traverse ref="pod[0]"/>
                     </traversal>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.sub.access = "protected";
}
</script>
                     </event>
                     <value>
                        <text maxChars="4"/>
                     </value>
                  </field>
                  <occur max="-1"/>
                  <field name="pod" h="5mm" w="36.599mm">
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Verdana" size="8pt"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                        </textEdit>
                     </ui>
                     <event activity="initialize">
                        <script contentType="application/x-javascript"/>
                     </event>
                     <caption reserve="7.2mm">
                        <value>
                           <text>POD</text>
                        </value>
                        <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                     </caption>
                     <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                     <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.sezCatasto.rowCatasto[*].L1_2pod"/>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

if (vIndex == 0 &amp;&amp; sezione.rawValue != null){
	this.acccess = "protected";
}else
	this.acccess = "open";
</script>
                     </event>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.pod.access = "protected";
}
</script>
                     </event>
                     <traversal>
                        <traverse ref="pdr[0]"/>
                     </traversal>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.pod.access = "protected";
}
</script>
                     </event>
                  </field>
                  <field name="pdr" h="5mm" w="34.576mm">
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Verdana" size="8pt"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                        </textEdit>
                     </ui>
                     <event activity="initialize">
                        <script contentType="application/x-javascript"/>
                     </event>
                     <caption reserve="6.776mm">
                        <value>
                           <text>PDR</text>
                        </value>
                        <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                     </caption>
                     <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                     <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.sezCatasto.rowCatasto[*].L1_2pdr"/>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

if (vIndex == 0 &amp;&amp; sezione.rawValue != null){
	this.acccess = "protected";
}else
	this.acccess = "open";
</script>
                     </event>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.pdr.access = "protected";
}
</script>
                     </event>
                     <event activity="initialize" name="event__initialize">
                        <script contentType="application/x-javascript">
var vIndex =  estremiCatastali.index;

var currentRow = sezCatasto.resolveNode("estremiCatastali["+ vIndex +"]");

if (vIndex == 0 ){
	currentRow.pdr.access = "protected";
}
</script>
                     </event>
                  </field>
                  <?templateDesigner expand 1?>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
               </subform>
               <margin leftInset="6.5mm"/>
               <draw name="Rectangle5" w="187.023mm" h="4.044mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <subform w="196.556mm" name="sottoSK_1_2_2" h="25.496mm">
               <bind match="none"/>
               <keep intact="none"/>
               <field name="flagUnitaImm" w="6.633mm" h="6mm" x="2.095mm" y="2.243mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagUnitaImmSingle"/>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <field name="flagE1" w="6.633mm" h="6mm" x="72.461mm" y="2.243mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagE2.rawValue = "0";
	flagE3.rawValue = "0";	
	flagE4.rawValue = "0";	
	flagE5.rawValue = "0";	
	flagE6.rawValue = "0";	
	flagE7.rawValue = "0";	
	flagE8.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagE1"/>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="9.374mm" w="36.208mm" h="6mm" y="2.243mm">
                  <value>
                     <text>Singola unità immobiliare</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
                  <?renderCache.bounds 102637 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 26 Singola unità immobiliare 0 0 10954 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txcivico" x="78.729mm" w="5.257mm" h="6mm" y="2.243mm">
                  <value>
                     <text>E.1</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagE2[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 E.1 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" x="55.678mm" w="16.378mm" h="6mm" y="2.243mm">
                  <value>
                     <text>Categoria:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagE1[0]"/>
                  </traversal>
                  <?renderCache.bounds 46426 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 10 Categoria: 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="notaCategoria" y="2.445mm" x="51.028mm" w="5.257mm" h="4.65mm" presence="invisible">
                  <ui>
                     <button/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("E.1 Edifici di tutte le tipologie adibiti a residenza e assimilabili;\n"+
					"E.2 Edifici adibiti a residenze collettive, a uffici e assimilabili;\n"+
					"E.3 Edifici adibiti a ospedali, cliniche o case di cura e assimilabili;\n"+
					"E.4 Edifici adibiti ad attività ricreative, associative o di culto e assimilabili;\n"+
					"E.5 Edifici adibiti ad attività commerciali e assimilabili;\n"+
					"E.6 Edifici adibiti ad attività sportive;\n"+
					"E.7 Edifici adibiti ad attività scolastiche a tutti i livelli e assimilabili;\n"+
					"E.8 Edifici adibiti ad attività industriali ed artigianali e assimilabili.");
</script>
                  </event>
                  <traversal>
                     <traverse ref="imgCategoria[0]"/>
                  </traversal>
               </field>
               <draw name="imgCategoria" y="2.849mm" x="51.028mm" w="5.055mm" h="4.044mm" presence="invisible">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="txcivico[8]"/>
                  </traversal>
               </draw>
               <field name="flagE2" w="6.633mm" h="6mm" x="85.401mm" y="2.243mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagE1.rawValue = "0";
	flagE3.rawValue = "0";	
	flagE4.rawValue = "0";	
	flagE5.rawValue = "0";	
	flagE6.rawValue = "0";	
	flagE7.rawValue = "0";	
	flagE8.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagE2"/>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="91.669mm" w="5.257mm" h="6mm" y="2.243mm">
                  <value>
                     <text>E.2</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagE3[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 E.2 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagE3" w="6.633mm" h="6mm" x="97.938mm" y="2.243mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagE2.rawValue = "0";
	flagE1.rawValue = "0";	
	flagE4.rawValue = "0";	
	flagE5.rawValue = "0";	
	flagE6.rawValue = "0";	
	flagE7.rawValue = "0";	
	flagE8.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagE3"/>
                  <traversal>
                     <traverse ref="txcivico[2]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="104.206mm" w="5.257mm" h="6mm" y="2.243mm">
                  <value>
                     <text>E.3</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagE4[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 E.3 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagE4" w="6.633mm" h="6mm" x="110.273mm" y="2.243mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagE2.rawValue = "0";
	flagE3.rawValue = "0";	
	flagE1.rawValue = "0";	
	flagE5.rawValue = "0";	
	flagE6.rawValue = "0";	
	flagE7.rawValue = "0";	
	flagE8.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagE4"/>
                  <traversal>
                     <traverse ref="txcivico[3]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="116.541mm" w="5.257mm" h="6mm" y="2.243mm">
                  <value>
                     <text>E.4</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagE5[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 E.4 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagE5" w="6.633mm" h="6mm" x="123.011mm" y="2.243mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagE2.rawValue = "0";
	flagE3.rawValue = "0";	
	flagE4.rawValue = "0";	
	flagE1.rawValue = "0";	
	flagE6.rawValue = "0";	
	flagE7.rawValue = "0";	
	flagE8.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagE5"/>
                  <traversal>
                     <traverse ref="txcivico[4]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="129.279mm" w="5.257mm" h="6mm" y="2.243mm">
                  <value>
                     <text>E.5</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagE6[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 E.5 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagE6" w="6.633mm" h="6mm" x="136.154mm" y="2.243mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagE2.rawValue = "0";
	flagE3.rawValue = "0";	
	flagE4.rawValue = "0";	
	flagE5.rawValue = "0";	
	flagE1.rawValue = "0";	
	flagE7.rawValue = "0";	
	flagE8.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagE6"/>
                  <traversal>
                     <traverse ref="txcivico[5]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="142.422mm" w="5.257mm" h="6mm" y="2.243mm">
                  <value>
                     <text>E.6</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagE7[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 E.6 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagE7" w="6.633mm" h="6mm" x="148.69mm" y="2.243mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagE2.rawValue = "0";
	flagE3.rawValue = "0";	
	flagE4.rawValue = "0";	
	flagE5.rawValue = "0";	
	flagE6.rawValue = "0";	
	flagE1.rawValue = "0";	
	flagE8.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagE7"/>
                  <traversal>
                     <traverse ref="txcivico[6]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="154.958mm" w="5.257mm" h="6mm" y="2.243mm">
                  <value>
                     <text>E.7</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagE8[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 E.7 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagE8" w="6.633mm" h="6mm" x="161.227mm" y="2.243mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagE2.rawValue = "0";
	flagE3.rawValue = "0";	
	flagE4.rawValue = "0";	
	flagE5.rawValue = "0";	
	flagE6.rawValue = "0";	
	flagE7.rawValue = "0";	
	flagE1.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2flagE8"/>
                  <traversal>
                     <traverse ref="txcivico[7]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="167.495mm" w="5.257mm" h="6mm" y="2.243mm">
                  <value>
                     <text>E.8</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="notaCategoria[0]"/>
                  </traversal>
                  <?renderCache.bounds 14902 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 E.8 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txcivico" x="2.095mm" y="9.927mm" w="35.385mm" h="6mm">
                  <value>
                     <text>Volume lordo riscaldato:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="volLordoRisc[0]"/>
                  </traversal>
                  <?renderCache.bounds 100304 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 24 Volume lordo riscaldato: 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="volLordoRisc" y="9.927mm" x="38.52mm" w="23.699mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="7"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2volLordoRisc"/>
                  <traversal>
                     <traverse ref="txcivico[9]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="62.553mm" y="10.129mm" w="7.103mm" h="6.085mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">(m<span style="vertical-align:3.41pt">3</span>)</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txcivico[10]"/>
                  </traversal>
               </draw>
               <draw name="txcivico" x="2.095mm" y="17.206mm" w="36.288mm" h="6mm">
                  <value>
                     <text>Volume lordo raffrescato:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="volLordoRaffr[0]"/>
                  </traversal>
                  <?renderCache.bounds 102864 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 25 Volume lordo raffrescato: 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="volLordoRaffr" y="17.206mm" x="38.52mm" w="23.699mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="7"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_2volLordoRaffr"/>
                  <traversal>
                     <traverse ref="txcivico[11]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="62.553mm" y="17.408mm" w="7.103mm" h="5.681mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">(m<span style="vertical-align:3.41pt">3</span>)</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="sottoSK1_3[0]"/>
                  </traversal>
               </draw>
               <margin leftInset="5mm"/>
               <traversal>
                  <traverse operation="first" ref="flagUnitaImm[0]"/>
                  <traverse ref="sottoSK1_3[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle5" w="195.325mm" h="4.044mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.556mm" minH="36.735mm" name="sottoSK1_3">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_2" x="0mm" w="166.007mm" minH="6mm">
                  <value>
                     <text>1.3 IMPIANTO TERMICO DESTINATO A SODDISFARE I SEGUENTI SERVIZI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="notaPot[0]"/>
                  </traversal>
               </draw>
               <field name="flagProdH2O" w="6.633mm" h="6mm" x="6.874mm" y="8.29mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.58mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_3flagProdACS"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	potUtileProdH2O.access = "open";
}else{
	potUtileProdH2O.rawValue = "";
	potUtileProdH2O.access = "protected";
}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagClimaInv.rawValue != "1" &amp;&amp; flagClimaEstiva.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Produz. ACS  (sez 1.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	potUtileProdH2O.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="14.154mm" y="8.29mm" w="58.298mm" h="6mm">
                  <value>
                     <text>Produzione di acqua calda sanitaria (acs)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
                  <?renderCache.bounds 165254 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 41 Produzione di acqua calda sanitaria (acs) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagClimaInv" w="6.633mm" h="6mm" x="6.874mm" y="15.772mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_3flagClimaInv"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	potUtileClimaInv.access = "open";
}else{
	potUtileClimaInv.rawValue = "";
	potUtileClimaInv.access = "protected";
}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagProdH2O.rawValue != "1" &amp;&amp; flagClimaEstiva.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Climatizz. invernale  (sez 1.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	potUtileClimaInv.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="14.154mm" y="15.772mm" w="58.298mm" h="6mm">
                  <value>
                     <text>Climatizzazione invernale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txcivico[2]"/>
                  </traversal>
                  <?renderCache.bounds 165254 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 25 Climatizzazione invernale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagClimaEstiva" w="6.633mm" h="6mm" x="6.874mm" y="23.051mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	potUtileClimaEst.access = "open";
}else{
	potUtileClimaEst.rawValue = "";
	potUtileClimaEst.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_3flagClimaEst"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagClimaInv.rawValue != "1" &amp;&amp; flagProdH2O.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Climatizz. estiva  (sez 1.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	potUtileClimaEst.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="14.154mm" y="23.051mm" w="58.298mm" h="6mm">
                  <value>
                     <text>Climatizzazione estiva</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txcivico[4]"/>
                  </traversal>
                  <?renderCache.bounds 165254 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 22 Climatizzazione estiva 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAltro" w="6.633mm" h="6mm" x="6.874mm" y="30.735mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro.access = "open";
}else{
	altro.rawValue = "";
	altro.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_3flagAltro"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagClimaInv.rawValue != "1" &amp;&amp; flagClimaEstiva.rawValue != "1" &amp;&amp; flagProdH2O.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Altro  (sez 1.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="14.154mm" y="30.735mm" w="8.29mm" h="6mm">
                  <value>
                     <text>Altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="altro[0]"/>
                  </traversal>
                  <?renderCache.bounds 23499 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 Altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="altro" y="30.735mm" w="77.847mm" h="6mm" x="22.848mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_3descrAltro"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (flagAltro.rawValue == "1" &amp;&amp; this.rawValue == null ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <assist>
                     <toolTip>Descrizione Altro  (sez 1.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="sottoSK1_4[0]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="146.392mm" y="8.29mm" w="20.624mm" h="6mm">
                  <value>
                     <text>Potenza utile</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="potUtileProdH2O[0]"/>
                  </traversal>
                  <?renderCache.bounds 58462 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 13 Potenza utile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="potUtileProdH2O" y="8.29mm" x="167.219mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="6"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_3potUtileACS"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (flagProdH2O.rawValue == "1" &amp;&amp; this.rawValue == null ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <assist>
                     <toolTip>Potenza utile ACS  (sez 1.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="186.428mm" y="8.29mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(kW)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="imgPot[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txcivico" x="146.392mm" y="15.772mm" w="20.624mm" h="6mm">
                  <value>
                     <text>Potenza utile</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="potUtileClimaInv[0]"/>
                  </traversal>
                  <?renderCache.bounds 58462 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 13 Potenza utile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="potUtileClimaInv" y="15.772mm" x="167.219mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="6"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_3potUtileClimaInv"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (flagClimaInv.rawValue == "1" &amp;&amp; this.rawValue == null ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <assist>
                     <toolTip>Potenza utile climatiz invernale  (sez 1.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[3]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="186.428mm" y="15.772mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(kW)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <traversal>
                     <traverse ref="flagClimaEstiva[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txcivico" x="146.393mm" y="23.051mm" w="20.624mm" h="6mm">
                  <value>
                     <text>Potenza utile</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="potUtileClimaEst[0]"/>
                  </traversal>
                  <?renderCache.bounds 58462 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 13 Potenza utile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="potUtileClimaEst" y="23.051mm" x="167.22mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="6"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_3potUtileClimaEst"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (flagClimaEstiva.rawValue == "1" &amp;&amp; this.rawValue == null ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <assist>
                     <toolTip>Potenza utile climatiz estiva  (sez 1.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[5]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="186.429mm" y="23.051mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(kW)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <traversal>
                     <traverse ref="flagAltro[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="notaPot" y="8.087mm" x="141.135mm" w="5.257mm" h="4.65mm" relevant="-print">
                  <ui>
                     <button highlight="inverted"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("Potenza utile: annotare la potenza massima resa per ciascun servizio; in caso di più generatori annotare il valore più alto "+
					"fra quelli ottenibili sommando le potenze massime rese dei generatori che possono funzionare contemporaneamente; in "+
					"caso di generatori che funzionano l’uno in sostituzione dell’altro considerare solo quello avente la potenza utile più "+
					"elevata. ");
</script>
                  </event>
                  <traversal>
                     <traverse ref="flagProdH2O[0]"/>
                  </traversal>
               </field>
               <draw name="imgPot" y="8.491mm" x="141.135mm" w="5.055mm" h="4.044mm" presence="invisible">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="flagClimaInv[0]"/>
                  </traversal>
               </draw>
               <traversal>
                  <traverse operation="first" ref="tx_1_2[0]"/>
                  <traverse ref="sottoSK1_4[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle5" w="195.325mm" h="6.757mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.556mm" minH="36.735mm" name="sottoSK1_4">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_4" x="0mm" w="166.007mm" minH="6mm">
                  <value>
                     <text>1.4 TIPOLOGIA FLUIDO VETTORE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="flagH2O[0]"/>
                  </traversal>
               </draw>
               <field name="flagH2O" w="6.633mm" h="6mm" x="6.874mm" y="8.982mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_4flagH2O"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagAria.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Acqua  (sez 1.4)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.154mm" y="8.982mm" w="11.745mm" h="6mm">
                  <value>
                     <text>Acqua</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAria[0]"/>
                  </traversal>
                  <?renderCache.bounds 33293 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 Acqua 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAria" w="6.633mm" h="6mm" x="39.649mm" y="8.982mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_4flagAria"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagH2O.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Aria  (sez 1.4)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="46.929mm" y="8.982mm" w="9.906mm" h="6mm">
                  <value>
                     <text>Aria</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAltro[0]"/>
                  </traversal>
                  <?renderCache.bounds 28080 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 Aria 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAltro" w="6.633mm" h="6mm" x="66.137mm" y="8.982mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro.access = "open";
}else{
	altro.rawValue = "";
	altro.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_4flagAltro"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagAria.rawValue != "1" &amp;&amp; flagH2O.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Altro  (sez 1.4)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="73.417mm" y="8.982mm" w="8.29mm" h="6mm">
                  <value>
                     <text>Altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="altro[0]"/>
                  </traversal>
                  <?renderCache.bounds 23499 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 Altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="altro" y="8.982mm" w="77.847mm" h="6mm" x="82.111mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_4descrAltro"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (flagAltro.rawValue == "1" &amp;&amp; this.rawValue == null ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <assist>
                     <toolTip>Descrizione Altro  (sez 1.4)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="sottoSK1_5[0]"/>
                  </traversal>
               </field>
               <traversal>
                  <traverse operation="first" ref="tx_1_4[0]"/>
                  <traverse ref="sottoSK1_5[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle5" w="195.325mm" h="7.547mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.556mm" minH="36.735mm" name="sottoSK1_5">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_4" x="0mm" w="166.007mm" minH="6mm">
                  <value>
                     <text>1.5 INDIVIDUAZIONE DELLA TIPOLOGIA DEI GENERATORI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="flagGenCombu[0]"/>
                  </traversal>
               </draw>
               <subform x="97.882mm" y="0.621mm" w="5.257mm" minH="4.65mm" name="nota" presence="invisible">
                  <bind match="none"/>
                  <draw name="img" y="0.404mm" w="5.055mm" h="4.044mm" relevant="-print">
                     <value>
                        <image href="..\resources\comment.png" contentType="image/png"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                  </draw>
                  <field name="nota" y="0mm" w="5.257mm" h="4.65mm">
                     <ui>
                        <button highlight="inverted"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
xfa.host.messageBox("Nel caso di impianti con più generatori di tipologie diverse è possibile selezionare più campi.");
</script>
                     </event>
                     <traversal>
                        <traverse ref="img[0]"/>
                     </traversal>
                  </field>
                  <?templateDesigner expand 1?></subform>
               <field name="flagGenCombu" w="6.633mm" h="6mm" x="6.874mm" y="8.963mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagGeneratCombu"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagPompaCal.rawValue != "1" &amp;&amp; flagMaccFrig.rawValue != "1" &amp;&amp; flagTelerisc.rawValue != "1" &amp;&amp; flagTeleRaffr.rawValue != "1" &amp;&amp;
	flagCogen.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1"  &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Generatore  (sez 1.5)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.154mm" y="8.963mm" w="37.636mm" h="6mm">
                  <value>
                     <text>Generatore a combustione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagPompaCal[0]"/>
                  </traversal>
                  <?renderCache.bounds 106685 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 24 Generatore a combustione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagPompaCal" w="6.633mm" h="6mm" x="58.453mm" y="8.963mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagPompaCal"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagGenCombu.rawValue != "1" &amp;&amp; flagMaccFrig.rawValue != "1" &amp;&amp; flagTelerisc.rawValue != "1" &amp;&amp; flagTeleRaffr.rawValue != "1" &amp;&amp;
	flagCogen.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Pompa calore  (sez 1.5)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="65.733mm" y="8.963mm" w="30.936mm" h="6mm">
                  <value>
                     <text>Pompa di calore</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagMaccFrig[0]"/>
                  </traversal>
                  <?renderCache.bounds 87693 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 15 Pompa di calore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAltro" w="6.633mm" h="6mm" x="7.095mm" y="24.33mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro.access = "open";
}else{
	altro.rawValue = "";
	altro.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagAltro"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagPompaCal.rawValue != "1" &amp;&amp; flagMaccFrig.rawValue != "1" &amp;&amp; flagTelerisc.rawValue != "1" &amp;&amp; flagTeleRaffr.rawValue != "1" &amp;&amp;
	flagCogen.rawValue != "1" &amp;&amp; flagGenCombu.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Altro  (sez 1.5)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="14.375mm" y="24.33mm" w="8.29mm" h="6mm">
                  <value>
                     <text>Altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="altro[0]"/>
                  </traversal>
                  <?renderCache.bounds 23499 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 Altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="altro" y="24.33mm" w="77.847mm" h="6mm" x="23.069mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5descrAltro"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (flagAltro.rawValue == "1" &amp;&amp; this.rawValue == null ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <assist>
                     <toolTip>Descrizione Altro  (sez 1.5)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[7]"/>
                  </traversal>
               </field>
               <field name="flagMaccFrig" w="6.633mm" h="6mm" x="104.353mm" y="8.963mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagMaccFrigo"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagPompaCal.rawValue != "1" &amp;&amp; flagGenCombu.rawValue != "1" &amp;&amp; flagTelerisc.rawValue != "1" &amp;&amp; flagTeleRaffr.rawValue != "1" &amp;&amp;
	flagCogen.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Macchina frigorifera  (sez 1.5)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="111.633mm" y="8.963mm" w="30.936mm" h="6mm">
                  <value>
                     <text>Macchina frigorifera</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagTelerisc[0]"/>
                  </traversal>
                  <?renderCache.bounds 87693 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 20 Macchina frigorifera 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTelerisc" w="6.633mm" h="6mm" x="7.095mm" y="16.646mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagTelerisc"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagPompaCal.rawValue != "1" &amp;&amp; flagMaccFrig.rawValue != "1" &amp;&amp; flagGenCombu.rawValue != "1" &amp;&amp; flagTeleRaffr.rawValue != "1" &amp;&amp;
	flagCogen.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Teleriscaldamento  (sez 1.5)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[4]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.375mm" y="16.646mm" w="37.636mm" h="6mm">
                  <value>
                     <text>Teleriscaldamento</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagTeleRaffr[0]"/>
                  </traversal>
                  <?renderCache.bounds 106685 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 17 Teleriscaldamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTeleRaffr" w="6.633mm" h="6mm" x="58.674mm" y="16.646mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagTeleraffr"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagPompaCal.rawValue != "1" &amp;&amp; flagMaccFrig.rawValue != "1" &amp;&amp; flagTelerisc.rawValue != "1" &amp;&amp; flagGenCombu.rawValue != "1" &amp;&amp;
	flagCogen.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Teleraffrescamento  (sez 1.5)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[5]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="65.954mm" y="16.646mm" w="30.936mm" h="6mm">
                  <value>
                     <text>Teleraffrescamento</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagCogen[0]"/>
                  </traversal>
                  <?renderCache.bounds 87693 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 18 Teleraffrescamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagCogen" w="6.633mm" h="6mm" x="104.574mm" y="16.646mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagCogener"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagPompaCal.rawValue != "1" &amp;&amp; flagMaccFrig.rawValue != "1" &amp;&amp; flagTelerisc.rawValue != "1" &amp;&amp; flagTeleRaffr.rawValue != "1" &amp;&amp;
	flagGenCombu.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Cogenerazione  (sez 1.5)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="111.854mm" y="16.646mm" w="44.527mm" h="6mm">
                  <value>
                     <text>Cogenerazione / trigenerazione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAltro[0]"/>
                  </traversal>
                  <?renderCache.bounds 126218 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 30 Cogenerazione / trigenerazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" x="7.095mm" y="32.822mm" w="47.719mm" h="6mm">
                  <value>
                     <text>Eventuale integrazione con:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagPannSol[0]"/>
                  </traversal>
                  <?renderCache.bounds 135266 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 27 Eventuale integrazione con: 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagPannSol" w="6.633mm" h="6mm" x="15.183mm" y="39.546mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagPannelliSol"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	superfTotLorda.access = "open";
}else{
	superfTotLorda.rawValue = "";
	superfTotLorda.access = "protected";
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[8]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	superfTotLorda.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="22.463mm" y="39.546mm" w="63.894mm" h="6mm">
                  <value>
                     <text>Pannelli solari termici: superficie totale lorda </text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="superfTotLorda[0]"/>
                  </traversal>
                  <?renderCache.bounds 181117 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 49 Pannelli solari termici: superficie totale lorda  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="superfTotLorda" y="39.546mm" x="86.761mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="4"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5superfLordaTot"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="105.97mm" y="39.546mm" w="7.103mm" h="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">(m<span style="vertical-align:3.41pt">2</span>)</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAltro1[0]"/>
                  </traversal>
               </draw>
               <draw name="txcivico" x="116.889mm" y="46.624mm" w="20.624mm" h="6mm">
                  <value>
                     <text>Potenza utile</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="potUtile[0]"/>
                  </traversal>
                  <?renderCache.bounds 58462 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 13 Potenza utile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="potUtile" y="46.624mm" x="137.716mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="5"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5potUtile"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="txcivico[2]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="156.925mm" y="46.624mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(kW)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <traversal>
                     <traverse ref="txflag1[10]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagClimaInv" w="6.633mm" h="6mm" x="22.664mm" y="53.903mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagClimaInv"/>
                  <traversal>
                     <traverse ref="txflag1[9]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="29.944mm" y="53.903mm" w="36.799mm" h="6mm">
                  <value>
                     <text>Climatizzazione invernale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagClimaEst[0]"/>
                  </traversal>
                  <?renderCache.bounds 104312 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 25 Climatizzazione invernale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" x="14.981mm" y="53.903mm" w="6.874mm" h="6mm">
                  <value>
                     <text>Per:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagClimaInv[0]"/>
                  </traversal>
                  <?renderCache.bounds 19485 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 Per: 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagClimaEst" w="6.633mm" h="6mm" x="67.755mm" y="53.903mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagClimaEst"/>
                  <traversal>
                     <traverse ref="txflag1[11]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="75.035mm" y="53.903mm" w="32.958mm" h="6mm">
                  <value>
                     <text>Climatizzazione estiva</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagProdACS[0]"/>
                  </traversal>
                  <?renderCache.bounds 93424 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 22 Climatizzazione estiva 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagProdACS" w="6.633mm" h="6mm" x="109.61mm" y="53.903mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagProdACS"/>
                  <traversal>
                     <traverse ref="txflag1[12]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="116.89mm" y="53.903mm" w="23.252mm" h="6mm">
                  <value>
                     <text>Produzione acs</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAltro2[0]"/>
                  </traversal>
                  <?renderCache.bounds 65911 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 14 Produzione acs 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAltro2" w="6.633mm" h="6mm" x="140.951mm" y="53.903mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro2.access = "open";
}else{
	altro2.rawValue = "";
	altro2.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagAltroPer"/>
                  <traversal>
                     <traverse ref="txflag1[13]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="148.231mm" y="53.903mm" w="8.29mm" h="6mm">
                  <value>
                     <text>Altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="altro2[0]"/>
                  </traversal>
                  <?renderCache.bounds 23499 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 Altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="altro2" y="53.903mm" w="39.025mm" h="6mm" x="156.925mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5descrAltroPer"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="sottoSK1_6[0]"/>
                  </traversal>
               </field>
               <field name="altro1" y="46.624mm" w="82.094mm" h="6mm" x="31.156mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5descrAltrIntegraz"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="22.462mm" y="46.624mm" w="8.29mm" h="6mm">
                  <value>
                     <text>Altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="altro1[0]"/>
                  </traversal>
                  <?renderCache.bounds 23499 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 Altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAltro1" w="6.633mm" h="6mm" x="15.183mm" y="46.624mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <caption placement="right" reserve="1.056mm">
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                  </caption>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro1.access = "open";
	potUtile.access = "open";
}else{
	altro1.rawValue = "";
	altro1.access = "protected";
	potUtile.rawValue = "";
	potUtile.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaIdentificativaImp.L1_5flagAltraIntegraz"/>
                  <traversal>
                     <traverse ref="txflag1[14]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	altro1.access = "open";
	potUtile.access = "open";
}
</script>
                  </event>
               </field>
               <traversal>
                  <traverse operation="first" ref="tx_1_4[0]"/>
                  <traverse ref="sottoSK1_6[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle5" w="195.325mm" h="6.132mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.115mm" name="sottoSK1_6" h="25.712mm">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_2" x="0.422mm" y="0.098mm" w="166.007mm" minH="6mm">
                  <value>
                     <text>1.6 RESPONSABILE DELL'IMPIANTO</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="notaResp[0]"/>
                  </traversal>
               </draw>
               <draw name="xindir" x="6.953mm" y="6.165mm" w="13.772mm" h="6mm">
                  <value>
                     <text>Cognome</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="xindir[2]"/>
                  </traversal>
                  <?renderCache.bounds 39039 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 7 Cognome 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="cognome" y="6.165mm" w="55.605mm" h="6mm" x="21.653mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle" marginLeft="2.835pt"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_6cognome"/>
                  <traversal>
                     <traverse ref="valDataContrattoAl[0]"/>
                  </traversal>
               </field>
               <draw name="txcomune" x="6.953mm" y="12.837mm" w="21.941mm" h="6mm">
                  <value>
                     <text>Ragione sociale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="esercizio2[0]"/>
                  </traversal>
                  <?renderCache.bounds 62195 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 15 Ragione sociale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="ragSociale" y="12.837mm" w="104.942mm" h="6mm" x="29.741mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_6ragSociale"/>
                  <traversal>
                     <traverse ref="T11[1]"/>
                  </traversal>
               </field>
               <draw name="T11" x="136.3mm" y="6.165mm" w="20.826mm" minH="6mm">
                  <value>
                     <text>Codice Fiscale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="xindir[5]"/>
                  </traversal>
               </draw>
               <field name="cf" y="6.165mm" x="157.541mm" w="38.341mm" h="6mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <assist>
                     <toolTip>Indicare il Codice Fiscale</toolTip>
                  </assist>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_6cf"/>
                  <traversal>
                     <traverse ref="txcomune[0]"/>
                  </traversal>
               </field>
               <field name="nome" y="6.165mm" w="46.102mm" h="6mm" x="88.581mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle" marginLeft="2.835pt"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_6nome"/>
                  <traversal>
                     <traverse ref="T11[0]"/>
                  </traversal>
               </field>
               <draw name="xindir" x="78.674mm" y="6.165mm" w="9.504mm" h="6mm">
                  <value>
                     <text>Nome</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="xindir[3]"/>
                  </traversal>
                  <?renderCache.bounds 26940 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 Nome 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="T11" x="136.502mm" y="12.837mm" w="20.826mm" minH="6mm">
                  <value>
                     <text>P.IVA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="xindir[4]"/>
                  </traversal>
               </draw>
               <field name="piva" y="12.837mm" x="157.541mm" w="38.341mm" h="6mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <assist>
                     <toolTip>Indicare il Codice Fiscale</toolTip>
                  </assist>
                  <bind match="dataRef" ref="$.Richiesta.datiPrecompilati.L1_6piva"/>
                  <traversal>
                     <traverse ref="xindir[2]"/>
                  </traversal>
               </field>
               <field name="notaResp" y="0.658mm" x="59.262mm" w="5.257mm" h="4.65mm" presence="invisible">
                  <ui>
                     <button highlight="inverted"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("Se persona fisica compilare Cognome Nome e Codice Fiscale, se persona giuridica compilare anche Ragione Sociale e P.IVA.");
</script>
                  </event>
                  <traversal>
                     <traverse ref="imgResp[0]"/>
                  </traversal>
               </field>
               <draw name="imgResp" y="1.062mm" x="59.262mm" w="5.055mm" h="4.044mm" presence="invisible">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="cognome[0]"/>
                  </traversal>
               </draw>
               <?templateDesigner expand 0?>
               <draw name="xindir" x="94.445mm" y="18.701mm" w="29.723mm" h="6mm">
                  <value>
                     <text>Firma responsabile</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="datiNomina[1].xindir[1]"/>
                  </traversal>
                  <?renderCache.bounds 84254 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 18 Firma responsabile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="firma2" y="18.701mm" w="71.377mm" h="6mm" x="124.572mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge stroke="dashDotDot">
                              <color value="128,128,128"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner stroke="dashDotDot">
                              <color value="128,128,128"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
               </field>
               <traversal>
                  <traverse operation="first" ref="tx_1_2[0]"/>
               </traversal>
            </subform>
            <traversal>
               <traverse operation="first" ref="sottoSK_1_1[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <border>
            <edge presence="hidden"/>
            <corner thickness="0.175mm" presence="hidden"/>
         </border>
         <bind match="none"/>
         <subform w="197.902mm" name="schedaTrattH2O" layout="lr-tb">
            <bind match="none"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="12.411mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>2. TRATTAMENTO ACQUA</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 20 2. TRATTAMENTO ACQUA 0 209860 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.22mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="sottoSK_2[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.131mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "Bozza")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="sottoSK_2[0]"/>
               </traversal>
            </subform>
            <subform w="197mm" minH="21.576mm" name="sottoSK_2">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_1" w="107.588mm" minH="6mm">
                  <value>
                     <text>2.1 CONTENUTO D'ACQUA DELL'IMPIANTO DI CLIMATIZZAZIONE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="H2OimpClima[0]"/>
                  </traversal>
               </draw>
               <?templateDesigner expand 0?>
               <field name="H2OimpClima" y="0.268mm" x="105.97mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="5" fracDigits="4"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_1contenutoH2OimpClima"/>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
               </field>
               <draw name="txcivico" x="125.179mm" y="0.268mm" w="7.103mm" h="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p>(m<span style="vertical-align:3.41pt">3</span>)</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <traversal>
                     <traverse ref="tx_1_1[1]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 2 (m 0 0 12557 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?>
                  <?renderCache.textRun 1 3 0 11414 9147 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?>
                  <?renderCache.textRun 1 ) 0 16500 12557 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="tx_1_1" w="107.588mm" minH="6mm" x="0.018mm" y="9.569mm">
                  <value>
                     <text>2.2 DUREZZA TOTALE DELL'ACQUA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="durezzaH2O[0]"/>
                  </traversal>
               </draw>
               <field name="durezzaH2O" y="9.635mm" x="105.786mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="2"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_2durezzaTotaleH2O"/>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'+"Range consetito: 0 - 99.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; 99) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
                  <assist>
                     <toolTip>Durezza totale H2O (sez. 2.2)</toolTip>
                  </assist>
               </field>
               <draw name="txcivico" x="124.995mm" y="9.635mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(°fr)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="notaDurezzH2O[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 6 (°fr) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="notaDurezzH2O" y="10.378mm" x="57.24mm" w="5.257mm" h="4.65mm" presence="invisible">
                  <ui>
                     <button highlight="inverted"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("Acqua di alimento.");
</script>
                  </event>
                  <traversal>
                     <traverse ref="imgDurezzH2O[0]"/>
                  </traversal>
               </field>
               <draw name="imgDurezzH2O" y="10.782mm" x="57.24mm" w="5.055mm" h="4.044mm" presence="invisible">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="sottoSK_2_3[0]"/>
                  </traversal>
               </draw>
               <traversal>
                  <traverse operation="first" ref="tx_1_1[0]"/>
                  <traverse ref="sottoSK_2_3[0]"/>
               </traversal>
            </subform>
            <draw name="Rectangle5" w="195.325mm" h="4.044mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="197mm" minH="21.576mm" name="sottoSK_2_3">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_1" w="138.978mm" minH="6mm">
                  <value>
                     <text>2.3 TRATTAMENTO DELL'ACQUA DELL'IMPIANTO DI CLIMATIZZAZIONE (Rif. UNI 8065)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="notaAddolc[0]"/>
                  </traversal>
               </draw>
               <field name="flagAssente" w="5.577mm" h="6mm" x="7.499mm" y="8.154mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3flagAssenteH2Oclima"/>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.526mm" y="8.154mm" w="14.204mm" h="6mm">
                  <value>
                     <text>Assente</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagFiltraz[0]"/>
                  </traversal>
                  <?renderCache.bounds 40263 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 7 Assente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAddolcimento" w="5.785mm" h="6mm" x="62.902mm" y="8.154mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	durezzaTotH2OImp.access = "open";
}else {
	durezzaTotH2OImp.rawValue = "";
	durezzaTotH2OImp.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3flagAddolcimento"/>
                  <traversal>
                     <traverse ref="durezzaTotH2OImp[0]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	durezzaTotH2OImp.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag2" x="69.373mm" y="7.684mm" w="32.189mm" h="7.213mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Addolcimento:</p><p style="font-size:6pt;text-decoration:none;letter-spacing:0in">durezza totale acqua impianto</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAssente[0]"/>
                  </traversal>
               </draw>
               <field name="flagFiltraz" w="5.577mm" h="6mm" x="32.167mm" y="8.154mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagTipoInterv2.rawValue = "0";
	flagTipoInterv3.rawValue = "0";	
	flagTipoInterv4.rawValue = "0";	
}
*/
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3flagFiltrazione"/>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="39.194mm" y="8.154mm" w="17.641mm" h="6mm">
                  <value>
                     <text>Filtrazione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAddolcimento[0]"/>
                  </traversal>
                  <?renderCache.bounds 50006 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 11 Filtrazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="durezzaTotH2OImp" y="8.493mm" x="102.332mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="2"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3durezzaTotaleH2O"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Range consetito: 0 - 99.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; 99) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
                  <assist>
                     <toolTip>Addolcimento (sez 2.3)</toolTip>
                  </assist>
               </field>
               <draw name="txcivico" x="121.541mm" y="8.493mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(°fr)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagCondizChimico[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 6 (°fr) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagCondizChimico" w="5.577mm" h="6mm" x="135.289mm" y="8.695mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3flagCondizChimico"/>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="142.316mm" y="8.695mm" w="38.064mm" h="6mm">
                  <value>
                     <text>Condizionamento chimico</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagProtGeloAssente[0]"/>
                  </traversal>
                  <?renderCache.bounds 107898 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 23 Condizionamento chimico 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag2" x="7.701mm" y="18.805mm" w="30.33mm" h="6mm">
                  <value>
                     <text>Protezione del gelo:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
                  <?renderCache.bounds 85975 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 20 Protezione del gelo: 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagProtGeloAssente" w="5.785mm" h="6mm" x="40.053mm" y="18.603mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3flagAssenteProtGelo"/>
                  <traversal>
                     <traverse ref="txflag2[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="46.928mm" y="19.007mm" w="12.334mm" h="5.459mm">
                  <value>
                     <text>Assente</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag2[2]"/>
                  </traversal>
                  <?renderCache.bounds 34963 15474 0 0 0 0 0 0?>
                  <?renderCache.textRun 7 Assente 0 0 10085 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagProtEtilenic" w="5.785mm" h="6mm" x="40.255mm" y="26.084mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	perConcentrazEtilenic.access = "open";
	PHconcentrazEtilenic.access = "open";
}else {
	perConcentrazEtilenic.rawValue = "";
	perConcentrazEtilenic.access = "protected";
	PHconcentrazEtilenic.rawValue = "";
	PHconcentrazEtilenic.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3flagGlicoleEtilenic"/>
                  <traversal>
                     <traverse ref="perConcentrazEtilenic[0]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	perConcentrazEtilenic.access = "open";
	PHconcentrazEtilenic.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag2" x="46.726mm" y="25.881mm" w="48.705mm" h="7.213mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Glicole etilenico:</p><p style="font-size:6pt;letter-spacing:0in">concentrazione glicole nel fluido termovettore<span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagProtEtilenic[0]"/>
                  </traversal>
               </draw>
               <field name="perConcentrazEtilenic" y="26.084mm" x="96.872mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="3"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3percConcentrazEtilenic"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'+"Range consetito: 0 - 100.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; 100) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
/*  //---------------------------------------------------
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'	+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || flagSI.rawValue != 0 || flagNO.rawValue != 0 || potNominale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
//------------------------------------------------------------------------------------------------------- */
</script>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
                  <assist>
                     <toolTip>Glicole etilenico % (sez. 2.3)</toolTip>
                  </assist>
               </field>
               <draw name="txcivico" x="116.081mm" y="26.084mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(%)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="PHconcentrazEtilenic[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 (%) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="PHconcentrazEtilenic" y="26.286mm" x="125.382mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="2"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3PHconcentrazEtilenic"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Range consetito: 0 - 14.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; 14) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[2]"/>
                  </traversal>
                  <assist>
                     <toolTip>Glicole etilenico ph (sez. 2.3)</toolTip>
                  </assist>
               </field>
               <draw name="txcivico" x="144.591mm" y="26.286mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(pH)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag2[3]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 (pH) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagProtPropLenic" w="5.785mm" h="6mm" x="40.256mm" y="34.375mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	perConcentrazPropLenic.access = "open";
	PHconcentrazPropLenic.access = "open";
}else {
	perConcentrazPropLenic.rawValue = "";
	perConcentrazPropLenic.access = "protected";
	PHconcentrazPropLenic.rawValue = "";
	PHconcentrazPropLenic.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3flagGlicolePropLenic"/>
                  <traversal>
                     <traverse ref="perConcentrazPropLenic[0]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	perConcentrazPropLenic.access = "open";
	PHconcentrazPropLenic.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag2" x="46.727mm" y="34.172mm" w="48.705mm" h="7.213mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Glicole propilenico:</p><p style="font-size:6pt;text-decoration:none;letter-spacing:0in">concentrazione glicole nel fluido termovettore<span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagProtPropLenic[0]"/>
                  </traversal>
               </draw>
               <field name="perConcentrazPropLenic" y="34.375mm" x="96.873mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="3"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3percConcentrazPropLenic"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'+"Range consetito: 0 - 100.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; 100) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[3]"/>
                  </traversal>
                  <assist>
                     <toolTip>Glicole propilenico % (sez. 2.3)</toolTip>
                  </assist>
               </field>
               <draw name="txcivico" x="116.082mm" y="34.375mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(%)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="PHconcentrazPropLenic[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 3 (%) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="PHconcentrazPropLenic" y="34.577mm" x="125.383mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="2"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_3PHconcentrazPropLenic"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Range consetito: 0 - 14.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; 14) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[4]"/>
                  </traversal>
                  <assist>
                     <toolTip>Glicole propilenico ph (sez. 2.3)</toolTip>
                  </assist>
               </field>
               <draw name="txcivico" x="144.592mm" y="34.577mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(pH)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="sottoSK_2_4[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 (pH) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="notaAddolc" y="7.077mm" x="90.401mm" w="5.257mm" h="4.65mm" presence="invisible">
                  <ui>
                     <button highlight="inverted"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("Dopo l'addolcimento.");
</script>
                  </event>
                  <traversal>
                     <traverse ref="imgAddolc[0]"/>
                  </traversal>
               </field>
               <draw name="imgAddolc" y="7.481mm" x="90.401mm" w="5.055mm" h="4.044mm" presence="invisible">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="txflag2[0]"/>
                  </traversal>
               </draw>
               <traversal>
                  <traverse operation="first" ref="tx_1_1[0]"/>
                  <traverse ref="sottoSK_2_4[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle5" w="195.325mm" h="4.044mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="197mm" minH="21.576mm" name="sottoSK_2_4">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_1_1" w="138.978mm" minH="6mm">
                  <value>
                     <text>2.4 TRATTAMENTO DELL'ACQUA CALDA SANITARIA (Rif. UNI 8065)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="notaAddolc[0]"/>
                  </traversal>
               </draw>
               <field name="flagAssenteACS" w="5.577mm" h="6mm" x="7.499mm" y="8.154mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_4flagAssente"/>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.526mm" y="8.154mm" w="14.204mm" h="6mm">
                  <value>
                     <text>Assente</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagFiltrazACS[0]"/>
                  </traversal>
                  <?renderCache.bounds 40263 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 7 Assente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAddolcimentoACS" w="5.785mm" h="6mm" x="62.093mm" y="8.154mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	durezzaTotAddolc.access = "open";
}else {
	durezzaTotAddolc.rawValue = "";
	durezzaTotAddolc.access = "protected";
}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv1.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_4flagAddolcimento"/>
                  <traversal>
                     <traverse ref="durezzaTotAddolc[0]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	durezzaTotAddolc.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag2" x="68.564mm" y="7.684mm" w="34.588mm" h="7.213mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Addolcimento:</p><p style="font-size:6pt;letter-spacing:0in">durezza totale uscita addolcitore</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAssenteACS[0]"/>
                  </traversal>
               </draw>
               <field name="flagFiltrazACS" w="5.577mm" h="6mm" x="32.167mm" y="8.154mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagTipoInterv2.rawValue = "0";
	flagTipoInterv3.rawValue = "0";	
	flagTipoInterv4.rawValue = "0";	
}
*/
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_4flagFiltrazione"/>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="39.194mm" y="8.154mm" w="17.641mm" h="6mm">
                  <value>
                     <text>Filtrazione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAddolcimentoACS[0]"/>
                  </traversal>
                  <?renderCache.bounds 50006 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 11 Filtrazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="durezzaTotAddolc" y="8.493mm" x="104.555mm" w="18.602mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal leadDigits="2"/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_4durezzaTotaleAddolcit"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Range consetito: 0 - 99.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; 99) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
                  <assist>
                     <toolTip>Addolcimento (sez. 2.4)</toolTip>
                  </assist>
               </field>
               <draw name="txcivico" x="123.764mm" y="8.493mm" w="7.103mm" h="6mm">
                  <value>
                     <text>(°fr)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagCondizChimicoACS[0]"/>
                  </traversal>
                  <?renderCache.bounds 20134 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 6 (°fr) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagCondizChimicoACS" w="5.577mm" h="6mm" x="137.512mm" y="8.695mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_4flagCondizChimico"/>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="144.539mm" y="8.695mm" w="38.064mm" h="6mm">
                  <value>
                     <text>Condizionamento chimico</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="sottoSK_2_5[0]"/>
                  </traversal>
                  <?renderCache.bounds 107898 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 23 Condizionamento chimico 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="notaAddolc" y="7.077mm" x="90.401mm" w="5.257mm" h="4.65mm" presence="invisible">
                  <ui>
                     <button highlight="inverted"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("Dopo l'addolcimento.");
</script>
                  </event>
                  <traversal>
                     <traverse ref="imgAddolc[0]"/>
                  </traversal>
               </field>
               <draw name="imgAddolc" y="7.481mm" x="90.401mm" w="5.055mm" h="4.044mm" presence="invisible">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="txflag2[0]"/>
                  </traversal>
               </draw>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="tx_1_1[0]"/>
                  <traverse ref="sottoSK_2_5[0]"/>
               </traversal>
            </subform>
            <draw name="Rectangle5" w="195.325mm" h="2.821mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform name="sottoSK_2_5" w="196.96mm" h="167.346mm">
               <bind match="none"/>
               <draw name="tx_1_1" w="187.895mm" minH="6mm" x="0.018mm" y="0.133mm">
                  <value>
                     <text>2.5 TRATTAMENTO DELL'ACQUA DI RAFFREDDAMENTO DELL'IMPIANTO DI CLIMATIZZAZIONE ESTIVA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="flagAssenteClimaEst[0]"/>
                  </traversal>
               </draw>
               <field name="flagAssenteClimaEst" w="5.577mm" h="6mm" x="7.499mm" y="7.279mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagAssente"/>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.374mm" y="7.279mm" w="14.204mm" h="6mm">
                  <value>
                     <text>Assente</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
                  <?renderCache.bounds 40263 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 7 Assente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" x="7.701mm" y="14.154mm" w="62.076mm" h="6mm">
                  <value>
                     <text>Tipologia circuito di raffreddamento:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold" underline="1"/>
                  <traversal>
                     <traverse ref="flagNoRecupTermico[0]"/>
                  </traversal>
                  <?renderCache.bounds 175963 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 37 Tipologia circuito di raffreddamento: 0 0 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?>
                  <?renderCache.line 0 11579 165129 11579 0 0 0 264?></draw>
               <field name="flagNoRecupTermico" w="5.577mm" h="6mm" x="8.106mm" y="21.088mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagRecupTermicoParz.rawValue = "0";
	flagRecupTermicoTot.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagSenzaRecupTerm"/>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="15.133mm" y="21.088mm" w="34.828mm" h="6mm">
                  <value>
                     <text>senza recupero termico</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagRecupTermicoParz[0]"/>
                  </traversal>
                  <?renderCache.bounds 98725 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 22 senza recupero termico 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagRecupTermicoParz" w="5.577mm" h="6mm" x="51.983mm" y="21.088mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagNoRecupTermico.rawValue = "0";
	flagRecupTermicoTot.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagRecupTermParz"/>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="59.01mm" y="21.088mm" w="38.937mm" h="6mm">
                  <value>
                     <text>a recupero termico parziale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagRecupTermicoTot[0]"/>
                  </traversal>
                  <?renderCache.bounds 110373 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 27 a recupero termico parziale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagRecupTermicoTot" w="5.577mm" h="6mm" x="100.511mm" y="21.088mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagRecupTermicoParz.rawValue = "0";
	flagNoRecupTermico.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagRecupTermTot"/>
                  <traversal>
                     <traverse ref="txflag1[4]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="107.538mm" y="21.088mm" w="38.937mm" h="6mm">
                  <value>
                     <text>a recupero termico totale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag1[5]"/>
                  </traversal>
                  <?renderCache.bounds 110373 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 25 a recupero termico totale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" x="7.701mm" y="28.57mm" w="62.076mm" h="6mm">
                  <value>
                     <text>Origine acqua di alimento:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold" underline="1"/>
                  <traversal>
                     <traverse ref="flagAcquedotto[0]"/>
                  </traversal>
                  <?renderCache.bounds 175963 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 26 Origine acqua di alimento: 0 0 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?>
                  <?renderCache.line 0 11579 118715 11579 0 0 0 264?></draw>
               <field name="flagAcquedotto" w="5.577mm" h="6mm" x="8.106mm" y="35.1mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagPozzo.rawValue = "0";
	flagH2Osuperficiale.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagAcquedotto"/>
                  <traversal>
                     <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="15.133mm" y="35.1mm" w="34.828mm" h="6mm">
                  <value>
                     <text>acquedotto</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagPozzo[0]"/>
                  </traversal>
                  <?renderCache.bounds 98725 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 10 acquedotto 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagPozzo" w="5.577mm" h="6mm" x="51.983mm" y="35.1mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAcquedotto.rawValue = "0";
	flagH2Osuperficiale.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagPozzo"/>
                  <traversal>
                     <traverse ref="txflag1[7]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="59.01mm" y="35.1mm" w="38.937mm" h="6mm">
                  <value>
                     <text>pozzo</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagH2Osuperficiale[0]"/>
                  </traversal>
                  <?renderCache.bounds 110373 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 pozzo 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagH2Osuperficiale" w="5.577mm" h="6mm" x="100.511mm" y="35.1mm">
                  <ui>
                     <checkButton mark="circle" shape="round" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAcquedotto.rawValue = "0";
	flagPozzo.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagAcquaSuperficiale"/>
                  <traversal>
                     <traverse ref="txflag1[8]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="107.538mm" y="35.1mm" w="38.937mm" h="6mm">
                  <value>
                     <text>acqua superficiale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag1[9]"/>
                  </traversal>
                  <?renderCache.bounds 110373 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 18 acqua superficiale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" x="7.701mm" y="42.866mm" w="62.076mm" h="6mm">
                  <value>
                     <text>Trattamenti acqua esistenti:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold" underline="1"/>
                  <traversal>
                     <traverse ref="flagFiltrazSicurezza[0]"/>
                  </traversal>
                  <?renderCache.bounds 175963 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 28 Trattamenti acqua esistenti: 0 0 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?>
                  <?renderCache.line 0 11579 127211 11579 0 0 0 264?></draw>
               <field name="flagFiltraz" w="5.577mm" h="6mm" x="8.106mm" y="51.014mm" access="protected">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagFiltrazSicurezza.access = "open";
	flagFiltrazMasse.access = "open";
	flagFiltrazAltro.access = "open";
	flagFiltrazNoTratt.access = "open";
}else {
	flagFiltrazSicurezza.rawValue = "0";
	flagFiltrazMasse.rawValue = "0";
	flagFiltrazAltro.rawValue = "0";
	flagFiltrazNoTratt.rawValue = "0";
	altro1.rawValue = "";
	
	flagFiltrazSicurezza.access = "protected";
	flagFiltrazMasse.access = "protected";
	flagFiltrazAltro.access = "protected";
	altro1.access = "protected";
	flagFiltrazNoTratt.access = "protected";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagFiltrazione"/>
                  <traversal>
                     <traverse ref="txflag1[10]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.728mm" y="51.014mm" w="17.641mm" h="6mm">
                  <value>
                     <text>Filtrazione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagFiltrazMasse[0]"/>
                  </traversal>
                  <?renderCache.bounds 50006 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 11 Filtrazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagFiltrazSicurezza" w="5.577mm" h="6mm" x="84.537mm" y="47.719mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/* gestione chiesta da actis dato
if (this.rawValue == "1") {
	flagFiltraz.rawValue = "1";
}else if (this.rawValue == "0" &amp;&amp; flagFiltrazMasse.rawValue == "0"  &amp;&amp; flagFiltrazAltro.rawValue == "0" &amp;&amp; flagFiltrazNoTratt.rawValue == "0")
	flagFiltraz.rawValue = "0";
*/

//gestione mia
if (this.rawValue == "1") {
	flagFiltraz.rawValue = "1";
	flagFiltrazMasse.rawValue = "0";
	flagFiltrazAltro.rawValue = "0";
	altro1.rawValue = "";
	altro1.access = "protected";
	flagFiltrazNoTratt.rawValue = "0";
}else if (this.rawValue == "0" &amp;&amp; flagFiltrazMasse.rawValue == "0"  &amp;&amp; flagFiltrazAltro.rawValue == "0" &amp;&amp; flagFiltrazNoTratt.rawValue == "0")
	flagFiltraz.rawValue = "0";
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagFiltrazSicurezza"/>
                  <traversal>
                     <traverse ref="txflag1[11]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="47.719mm" w="44.535mm" h="6mm">
                  <value>
                     <text>filtrazione di sicurezza</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagFiltraz[0]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 24 filtrazione di sicurezza 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagFiltrazMasse" w="5.577mm" h="6mm" x="84.537mm" y="53.845mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagFiltraz.rawValue = "1";
}else if (this.rawValue == "0" &amp;&amp; flagFiltrazSicurezza.rawValue == "0"  &amp;&amp; flagFiltrazAltro.rawValue == "0" &amp;&amp; flagFiltrazNoTratt.rawValue == "0")
	flagFiltraz.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagFiltraz.rawValue = "1";
	flagFiltrazSicurezza.rawValue = "0";
	flagFiltrazAltro.rawValue = "0";
	altro1.rawValue = "";
	altro1.access = "protected";	
	flagFiltrazNoTratt.rawValue = "0";
}else if (this.rawValue == "0" &amp;&amp; flagFiltrazSicurezza.rawValue == "0"  &amp;&amp; flagFiltrazAltro.rawValue == "0" &amp;&amp; flagFiltrazNoTratt.rawValue == "0")
	flagFiltraz.rawValue = "0";
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagFiltrazMasse"/>
                  <traversal>
                     <traverse ref="txflag1[12]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="53.845mm" w="44.535mm" h="6mm">
                  <value>
                     <text>filtrazione a masse</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagFiltrazAltro[0]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 19 filtrazione a masse 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagFiltrazAltro" w="5.577mm" h="6mm" x="84.537mm" y="60.517mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagFiltraz.rawValue = "1";
	altro1.access = "open";
}else{
	altro1.rawValue = "";
	altro1.access = "protected";
	if (flagFiltrazMasse.rawValue == "0"  &amp;&amp; flagFiltrazSicurezza.rawValue == "0" &amp;&amp; flagFiltrazNoTratt.rawValue == "0")
		flagFiltraz.rawValue = "0";
}
*/

if (this.rawValue == "1") {
	flagFiltraz.rawValue = "1";
	flagFiltrazMasse.rawValue = "0";
	flagFiltrazSicurezza.rawValue = "0";	
	flagFiltrazNoTratt.rawValue = "0";	
	altro1.access = "open";
}else{
	altro1.rawValue = "";
	altro1.access = "protected";
	if (flagFiltrazMasse.rawValue == "0"  &amp;&amp; flagFiltrazSicurezza.rawValue == "0" &amp;&amp; flagFiltrazNoTratt.rawValue == "0")
		flagFiltraz.rawValue = "0";
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagFiltrazAltro"/>
                  <traversal>
                     <traverse ref="txflag1[13]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1" ) {
	altro1.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="91.159mm" y="60.517mm" w="8.139mm" h="6mm">
                  <value>
                     <text>altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="altro1[0]"/>
                  </traversal>
                  <?renderCache.bounds 23071 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagFiltrazNoTratt" w="5.577mm" h="6mm" x="84.537mm" y="66.988mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagFiltraz.rawValue = "1";
}else if (this.rawValue == "0" &amp;&amp; flagFiltrazMasse.rawValue == "0"  &amp;&amp; flagFiltrazAltro.rawValue == "0" &amp;&amp; flagFiltrazSicurezza.rawValue == "0")
	flagFiltraz.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagFiltraz.rawValue = "1";
	flagFiltrazMasse.rawValue = "0";
	flagFiltrazAltro.rawValue = "0";
	altro1.rawValue = "";
	altro1.access = "protected";
	flagFiltrazSicurezza.rawValue = "0";	
}else if (this.rawValue == "0" &amp;&amp; flagFiltrazMasse.rawValue == "0"  &amp;&amp; flagFiltrazAltro.rawValue == "0" &amp;&amp; flagFiltrazSicurezza.rawValue == "0")
	flagFiltraz.rawValue = "0";	
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagFiltrazNoTrattam"/>
                  <traversal>
                     <traverse ref="txflag1[14]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="66.988mm" w="44.535mm" h="6mm">
                  <value>
                     <text>nessun trattamento</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagTratt[0]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 18 nessun trattamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="altro1" y="60.517mm" w="96.046mm" h="6mm" x="99.904mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5filtrazioneAltro"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="flagFiltrazNoTratt[0]"/>
                  </traversal>
               </field>
               <field name="flagTratt" w="5.577mm" h="6mm" x="8.106mm" y="74.814mm" access="protected">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagTrattamentoH2O"/>
                  <traversal>
                     <traverse ref="txflag1[15]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.728mm" y="74.814mm" w="30.987mm" h="6mm">
                  <value>
                     <text>Trattamento acqua</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAddolc[0]"/>
                  </traversal>
                  <?renderCache.bounds 87837 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 17 Trattamento acqua 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAddolc" w="5.577mm" h="6mm" x="84.537mm" y="74.814mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagTratt.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagOsmosi.rawValue == "0"  &amp;&amp; flagTrattAltro.rawValue == "0" &amp;&amp; flagTrattNoTratt.rawValue == "0")
	flagTratt.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagTratt.rawValue = "1";	
	flagOsmosi.rawValue = "0";
	flagDemineralizz.rawValue = "0";
	flagTrattAltro.rawValue = "0";
	altro2.rawValue = "";
	altro2.access = "protected";
	flagTrattNoTratt.rawValue = "0";
}else if (this.rawValue == "0" &amp;&amp; flagOsmosi.rawValue == "0"  &amp;&amp; flagTrattAltro.rawValue == "0" &amp;&amp; flagTrattNoTratt.rawValue == "0")
	flagTratt.rawValue = "0";
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagTrattAddolcim"/>
                  <traversal>
                     <traverse ref="txflag1[16]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="74.814mm" w="44.535mm" h="6mm">
                  <value>
                     <text>addolcimento</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagOsmosi[0]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 12 addolcimento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagOsmosi" w="5.577mm" h="6mm" x="84.537mm" y="81.142mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagTratt.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagAddolc.rawValue == "0"  &amp;&amp; flagTrattAltro.rawValue == "0" &amp;&amp; flagTrattNoTratt.rawValue == "0")
	flagTratt.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagTratt.rawValue = "1";	
	flagAddolc.rawValue = "0";
	flagDemineralizz.rawValue = "0";
	flagTrattAltro.rawValue = "0";
	altro2.rawValue = "";
	altro2.access = "protected";
	flagTrattNoTratt.rawValue = "0";	
}else if (this.rawValue == "0" &amp;&amp; flagAddolc.rawValue == "0"  &amp;&amp; flagTrattAltro.rawValue == "0" &amp;&amp; flagTrattNoTratt.rawValue == "0")
	flagTratt.rawValue = "0";	
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagTrattOsmosi"/>
                  <traversal>
                     <traverse ref="txflag1[17]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="81.142mm" w="44.535mm" h="6mm">
                  <value>
                     <text>osmosi inversa</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagDemineralizz[0]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 14 osmosi inversa 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTrattAltro" w="5.577mm" h="6mm" x="84.537mm" y="94.215mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagTratt.rawValue = "1";
	altro2.access = "open";
}else{
	altro2.rawValue = "";
	altro2.access = "protected";
	if (flagOsmosi.rawValue == "0"  &amp;&amp; flagAddolc.rawValue == "0" &amp;&amp; flagTrattNoTratt.rawValue == "0")
		flagTratt.rawValue = "0";
}
*/

if (this.rawValue == "1") {
	flagTratt.rawValue = "1";
	flagOsmosi.rawValue = "0";
	flagDemineralizz.rawValue = "0";
	flagAddolc.rawValue = "0";	
	altro2.access = "open";
	flagTrattNoTratt.rawValue = "0";	
}else{
	altro2.rawValue = "";
	altro2.access = "protected";
	if (flagOsmosi.rawValue == "0"  &amp;&amp; flagAddolc.rawValue == "0" &amp;&amp; flagTrattNoTratt.rawValue == "0")
		flagTratt.rawValue = "0";
}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagTrattAltro"/>
                  <traversal>
                     <traverse ref="txflag1[18]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1" ) {
	altro2.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="91.159mm" y="94.215mm" w="8.139mm" h="6mm">
                  <value>
                     <text>altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="altro2[0]"/>
                  </traversal>
                  <?renderCache.bounds 23071 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="altro2" y="94.215mm" w="96.046mm" h="6mm" x="99.904mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5trattamentoAltro"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="flagTrattNoTratt[0]"/>
                  </traversal>
               </field>
               <field name="flagTrattNoTratt" w="5.577mm" h="6mm" x="84.537mm" y="100.686mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagTratt.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagOsmosi.rawValue == "0"  &amp;&amp; flagTrattAltro.rawValue == "0" &amp;&amp; flagAddolc.rawValue == "0")
	flagTratt.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagTratt.rawValue = "1";	
	flagOsmosi.rawValue = "0";
	flagDemineralizz.rawValue = "0";
	flagTrattAltro.rawValue = "0";
	altro2.rawValue = "";
	altro2.access = "protected";
	flagAddolc.rawValue = "0";	
}else if (this.rawValue == "0" &amp;&amp; flagOsmosi.rawValue == "0"  &amp;&amp; flagTrattAltro.rawValue == "0" &amp;&amp; flagAddolc.rawValue == "0")
	flagTratt.rawValue = "0";
	
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagTrattNoTrattam"/>
                  <traversal>
                     <traverse ref="txflag1[19]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="100.686mm" w="44.535mm" h="6mm">
                  <value>
                     <text>nessun trattamento</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagCondizChimico[0]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 18 nessun trattamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagCondizChimico" w="5.577mm" h="6mm" x="8.106mm" y="107.965mm" access="protected">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagCondizChimico"/>
                  <traversal>
                     <traverse ref="txflag1[20]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.728mm" y="107.965mm" w="36.217mm" h="6mm">
                  <value>
                     <text>Condizionamento chimico</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAntiCrosta[0]"/>
                  </traversal>
                  <?renderCache.bounds 102662 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 23 Condizionamento chimico 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAntiCrosta" w="5.577mm" h="6mm" x="84.537mm" y="107.965mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagAnticorros.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
	flagCondizChimico.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";
	flagAnticorros.rawValue = "0";
	flagAnticrostaEAnticorros.rawValue = "0";
	flagBiocida.rawValue = "0";
	flagChimicoAltro.rawValue = "0";
	altro3.rawValue = "";
	altro3.access = "protected";
	flagChimicoNoTratt.rawValue = "0";		
}else if (this.rawValue == "0" &amp;&amp; flagAnticorros.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
	flagCondizChimico.rawValue = "0";	
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagCondChimAnticrosta"/>
                  <traversal>
                     <traverse ref="txflag1[21]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="107.965mm" w="47.46mm" h="6mm">
                  <value>
                     <text>a prevalente azione anticrostante</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAnticorros[0]"/>
                  </traversal>
                  <?renderCache.bounds 134532 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 33 a prevalente azione anticrostante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagAnticorros" w="5.577mm" h="6mm" x="84.537mm" y="114.495mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagAntiCrosta.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
	flagCondizChimico.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";	
	flagAntiCrosta.rawValue = "0";
	flagAnticrostaEAnticorros.rawValue = "0";
	flagBiocida.rawValue = "0";
	flagChimicoAltro.rawValue = "0";
	altro3.rawValue = "";
	altro3.access = "protected";
	flagChimicoNoTratt.rawValue = "0";	
}else if (this.rawValue == "0" &amp;&amp; flagAntiCrosta.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
	flagCondizChimico.rawValue = "0";
		
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagCondChimAnticorr"/>
                  <traversal>
                     <traverse ref="txflag1[22]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="114.495mm" w="47.13mm" h="6mm">
                  <value>
                     <text>a prevalente azione anticorrosiva</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagAnticrostaEAnticorros[0]"/>
                  </traversal>
                  <?renderCache.bounds 133597 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 33 a prevalente azione anticorrosiva 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagChimicoAltro" w="5.577mm" h="6mm" x="84.537mm" y="134.049mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";
	altro3.access = "open";
}else{
	altro3.rawValue = "";
	altro3.access = "protected";
	if (flagAnticorros.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagAntiCrosta.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
		flagCondizChimico.rawValue = "0";	
}
*/

if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";
	flagAnticorros.rawValue = "0";
	flagAnticrostaEAnticorros.rawValue = "0";
	flagBiocida.rawValue = "0";
	flagAntiCrosta.rawValue = "0";
	flagChimicoNoTratt.rawValue = "0";	
	altro3.access = "open";
}else{
	altro3.rawValue = "";
	altro3.access = "protected";
	if (flagAnticorros.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagAntiCrosta.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
		flagCondizChimico.rawValue = "0";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagCondChimAltro"/>
                  <traversal>
                     <traverse ref="txflag1[23]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1" ) {
	altro3.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="91.159mm" y="134.049mm" w="8.139mm" h="6mm">
                  <value>
                     <text>altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="altro3[0]"/>
                  </traversal>
                  <?renderCache.bounds 23071 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="altro3" y="134.049mm" w="96.046mm" h="6mm" x="99.904mm" access="protected">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5condChimAltro"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="flagChimicoNoTratt[0]"/>
                  </traversal>
               </field>
               <field name="flagChimicoNoTratt" w="5.577mm" h="6mm" x="84.537mm" y="140.317mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagAnticorros.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagAntiCrosta.rawValue == "0")
	flagCondizChimico.rawValue = "0";
*/	

if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";	
	flagAnticorros.rawValue = "0";
	flagAnticrostaEAnticorros.rawValue = "0";
	flagBiocida.rawValue = "0";
	flagChimicoAltro.rawValue = "0";
	altro3.rawValue = "";
	altro3.access = "protected";
	flagAntiCrosta.rawValue = "0";	
}else if (this.rawValue == "0" &amp;&amp; flagAnticorros.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagAntiCrosta.rawValue == "0")
	flagCondizChimico.rawValue = "0";
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagCondChimNoTrattam"/>
                  <traversal>
                     <traverse ref="txflag1[24]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="140.317mm" w="44.535mm" h="6mm">
                  <value>
                     <text>nessun trattamento</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag1[26]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 18 nessun trattamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="Line1" y="107.359mm" x="0.018mm" w="196.942mm" h="0in" presence="invisible">
                  <value>
                     <line>
                        <edge stroke="dashDotDot">
                           <color value="153,153,153"/>
                        </edge>
                     </line>
                  </value>
               </draw>
               <draw name="Line1" y="73.803mm" x="0.018mm" w="196.942mm" h="0in" presence="invisible">
                  <value>
                     <line>
                        <edge stroke="dashDotDot">
                           <color value="153,153,153"/>
                        </edge>
                     </line>
                  </value>
               </draw>
               <field name="flagBiocida" w="5.577mm" h="6mm" x="84.537mm" y="127.578mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagAnticorros.rawValue == "0" &amp;&amp; flagAntiCrosta.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
	flagCondizChimico.rawValue = "0";
*/	

if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";
	flagAnticorros.rawValue = "0";
	flagAntiCrosta.rawValue = "0";
	flagAnticrostaEAnticorros.rawValue = "0";
	flagChimicoAltro.rawValue = "0";
	altro3.rawValue = "";
	altro3.access = "protected";
	flagChimicoNoTratt.rawValue = "0";		
}else if (this.rawValue == "0" &amp;&amp; flagAnticorros.rawValue == "0" &amp;&amp; flagAntiCrosta.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
	flagCondizChimico.rawValue = "0";
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagCondChimBiocida"/>
                  <traversal>
                     <traverse ref="txflag1[25]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="127.578mm" w="44.535mm" h="6mm">
                  <value>
                     <text>biocida</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagChimicoAltro[0]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 7 biocida 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" x="7.701mm" y="143.957mm" w="62.076mm" h="6mm">
                  <value>
                     <text>Gestione torre raffreddamento:</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold" underline="1"/>
                  <traversal>
                     <traverse ref="flagPrefSpurgo[0]"/>
                  </traversal>
                  <?renderCache.bounds 175963 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 30 Gestione torre raffreddamento: 0 0 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?>
                  <?renderCache.line 0 11579 141031 11579 0 0 0 264?></draw>
               <draw name="txcivico" w="11.795mm" h="6mm" x="139.94mm" y="155.684mm">
                  <value>
                     <text>(μS/cm)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="conducibH2Oingresso[0]"/>
                  </traversal>
               </draw>
               <field name="flagPrefSpurgo" w="5.785mm" h="6mm" x="8.106mm" y="150.831mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	conducibH2Oingresso.access = "open";
	taraturaSpurgo.access = "open";
}else {
	conducibH2Oingresso.rawValue = "";
	conducibH2Oingresso.access = "protected";
	taraturaSpurgo.rawValue = "";
	taraturaSpurgo.access = "protected";	
}
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagPrefSpurgoAutom"/>
                  <traversal>
                     <traverse ref="txflag1[27]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	conducibH2Oingresso.access = "open";
	taraturaSpurgo.access = "open";
}
</script>
                  </event>
               </field>
               <draw name="txflag1" x="14.778mm" y="150.832mm" w="101.335mm" h="6mm">
                  <value>
                     <text>Preferenza sistema spurgo automatico (per circuiti a recupero parziale)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
                  <?renderCache.bounds 287249 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 71 Preferenza sistema spurgo automatico (per circuiti a recupero parziale) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="conducibH2Oingresso" y="155.685mm" x="80.695mm" w="58.638mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge stroke="dashDotDot">
                              <color value="128,128,128"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner stroke="dashDotDot">
                              <color value="128,128,128"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5conducibH2Oingresso"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[28]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="14.98mm" y="155.886mm" w="64.733mm" h="6mm">
                  <value>
                     <text>Conducibilita' acqua in ingresso</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="txflag1[29]"/>
                  </traversal>
                  <?renderCache.bounds 183495 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 32 Conducibilita' acqua in ingresso 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" x="14.98mm" y="161.411mm" w="64.733mm" h="6mm">
                  <value>
                     <text>Taratura valore conducibilita' inizio spurgo</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="taraturaSpurgo[0]"/>
                  </traversal>
                  <?renderCache.bounds 183495 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 44 Taratura valore conducibilita' inizio spurgo 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="taraturaSpurgo" y="161.411mm" x="80.696mm" w="58.638mm" h="6mm">
                  <ui>
                     <numericEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge stroke="dashDotDot">
                              <color value="128,128,128"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner stroke="dashDotDot">
                              <color value="128,128,128"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </numericEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <decimal/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5taraturaSpurgo"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="11.795mm" h="6mm" x="140.142mm" y="161.411mm">
                  <value>
                     <text>(μS/cm)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
               </draw>
               <field name="flagAnticrostaEAnticorros" w="5.577mm" h="6mm" x="84.537mm" y="120.906mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagAntiCrosta.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
	flagCondizChimico.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagCondizChimico.rawValue = "1";	
	flagAntiCrosta.rawValue = "0";
	flagBiocida.rawValue = "0";
	flagChimicoAltro.rawValue = "0";
	altro3.rawValue = "";
	altro3.access = "protected";
	flagChimicoNoTratt.rawValue = "0";	
}else if (this.rawValue == "0" &amp;&amp; flagAntiCrosta.rawValue == "0" &amp;&amp; flagBiocida.rawValue == "0"  &amp;&amp; flagChimicoAltro.rawValue == "0" &amp;&amp; flagChimicoNoTratt.rawValue == "0")
	flagCondizChimico.rawValue = "0";
		
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagCondChimAnticrostaAntiCorr"/>
                  <traversal>
                     <traverse ref="txflag1[30]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="120.906mm" w="50.684mm" h="6mm">
                  <value>
                     <text>azione anticrostante e anticorrosiva</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagBiocida[0]"/>
                  </traversal>
                  <?renderCache.bounds 143671 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 36 azione anticrostante e anticorrosiva 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagDemineralizz" w="5.577mm" h="6mm" x="84.537mm" y="87.957mm">
                  <ui>
                     <checkButton size="3.175mm" mark="circle" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == "1") {
	flagTratt.rawValue = "1";	
}else if (this.rawValue == "0" &amp;&amp; flagAddolc.rawValue == "0"  &amp;&amp; flagTrattAltro.rawValue == "0" &amp;&amp; flagTrattNoTratt.rawValue == "0")
	flagTratt.rawValue = "0";
*/

if (this.rawValue == "1") {
	flagTratt.rawValue = "1";	
	flagAddolc.rawValue = "0";
	flagTrattAltro.rawValue = "0";
	flagOsmosi.rawValue = "0";
	altro2.rawValue = "";
	altro2.access = "protected";
	flagTrattNoTratt.rawValue = "0";	
}else if (this.rawValue == "0" &amp;&amp; flagAddolc.rawValue == "0"  &amp;&amp; flagTrattAltro.rawValue == "0" &amp;&amp; flagTrattNoTratt.rawValue == "0")
	flagTratt.rawValue = "0";	
</script>
                  </event>
                  <bind match="dataRef" ref="$.Richiesta.datiSchedaTrattH2O.L2_5flagTrattDemineralizz"/>
                  <traversal>
                     <traverse ref="txflag1[31]"/>
                  </traversal>
               </field>
               <draw name="txflag1" x="91.159mm" y="87.957mm" w="44.535mm" h="6mm">
                  <value>
                     <text>demineralizzazione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="flagTrattAltro[0]"/>
                  </traversal>
                  <?renderCache.bounds 126241 17008 0 0 0 0 0 0?>
                  <?renderCache.textRun 18 demineralizzazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <traversal>
                  <traverse operation="first" ref="tx_1_1[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaNomina" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiPrecompilati"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>3. NOMINA DEL TERZO RESPONSABILE DELL'IMPIANTO TERMICO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 54 3. NOMINA DEL TERZO RESPONSABILE DELL'IMPIANTO TERMICO 0 96490 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="row[0].datiNomina[0].xindir[1]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <bind match="none"/>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="row[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="txflag1" w="197.365mm" h="2.224mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
               <ui>
                  <defaultUi/>
               </ui>
               <font size="8pt" typeface="Verdana"/>
               <para vAlign="middle"/>
            </draw>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform w="197.181mm" name="button" h="5.56mm" presence="hidden">
               <bind match="none"/>
               <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                  <value>
                     <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <assist>
                     <toolTip>Aggiungi riga.</toolTip>
                  </assist>
                  <margin leftInset="1mm"/>
               </draw>
               <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">

	row.instanceManager.addInstance();

</script>
                  </event>
                  <assist>
                     <toolTip>Aggiungi riga.</toolTip>
                  </assist>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="rowGT[0]"/>
                  </traversal>
               </field>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="2.124mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.758mm" layout="lr-tb" name="row">
               <bind match="dataRef" ref="$.sezNomine.rowNomine[*]"/>
               <subform w="4.93mm" name="button" h="6.116mm" presence="hidden">
                  <bind match="none"/>
                  <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                     <value>
                        <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Cancella riga.</toolTip>
                     </assist>
                  </draw>
                  <field name="btCancella" w="4.535mm" h="5.022mm" relevant="-print" x="0.395mm" y="0.907mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	

if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiNomina.cognome.rawValue = "";
	datiNomina.nome.rawValue = "";
	datiNomina.cf.rawValue = "";
	datiNomina.ragSociale.rawValue = "";
	datiNomina.piva.rawValue = "";
	datiNomina.flagProprietario.rawValue = "0";
	datiNomina.flagAmministr.rawValue = "0";
	datiNomina.ragSocialeImpianto.rawValue = "";
	datiNomina.cciaa.rawValue = "";
	datiNomina.valDataContrattoDal.rawValue = "";
	datiNomina.valDataContrattoAl.rawValue = "";
	datiNomina.firma1.rawValue = "";
	datiNomina.firma2.rawValue = "";
}	

</script>
                     </event>
                     <assist>
                        <toolTip>Cancella riga.</toolTip>
                     </assist>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="cancellaRiga[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <subform name="datiNomina" w="197.272mm" h="50mm">
                  <bind match="none"/>
                  <draw name="xindir" x="10.128mm" y="6.085mm" w="16.985mm" h="6mm">
                     <value>
                        <text>Cognome</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="nome[0]"/>
                     </traversal>
                     <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 7 Cognome 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="cognome" y="6.085mm" w="54.996mm" h="6mm" x="28.126mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L3cognome"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="xindir[2]"/>
                     </traversal>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">/*
var vRighe = row.instanceManager.count; 
var vIndex = row.index;

	
if (vRighe &gt; 1  &amp;&amp; (cognome.rawValue == null || cognome.rawValue == "" )) {	
	//xfa.host.messageBox("[attivita::docReady-barbatrucco] record null da eliminare "+attivita.rawValue+"("+vIndex+")");
	row.instanceManager.removeInstance(vIndex);
}
*/
</script>
                     </event>
                  </field>
                  <field name="flagProprietario" w="5.577mm" h="6mm" x="69.519mm" y="22.464mm" access="protected">
                     <ui>
                        <checkButton mark="circle" size="3.175mm" shape="round">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb4?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L3flagProprietario"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAmministr.rawValue = "0";

}
</script>
                     </event>
                     <traversal>
                        <traverse ref="flagAmministr[0]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" x="75.99mm" y="22.464mm" w="37.921mm" h="6mm">
                     <value>
                        <text>propietario/occupante</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="txflag1[1]"/>
                     </traversal>
                     <?renderCache.bounds 107493 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 21 propietario/occupante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden"/>
                     <edge presence="hidden"/>
                     <edge presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                  </border>
                  <draw name="xindir" x="5.275mm" y="0.828mm" w="37.002mm" h="4.044mm">
                     <value>
                        <text>il sottoscritto</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="7pt" typeface="Verdana" weight="bold"/>
                     <traversal>
                        <traverse ref="cognome[0]"/>
                     </traversal>
                     <?renderCache.bounds 104888 11463 0 0 0 0 0 0?>
                     <?renderCache.textRun 15 il sottoscritto 0 0 7785 0 0 0 "Verdana" 1 0 7000 ISO-8859-1?></draw>
                  <draw name="xindir" x="84.942mm" y="6.085mm" w="10.716mm" h="6mm">
                     <value>
                        <text>Nome</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[3]"/>
                     </traversal>
                     <?renderCache.bounds 30376 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 4 Nome 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="nome" y="6.085mm" w="44.684mm" h="6mm" x="95.659mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L3nome"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="cf[0]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="143.58mm" y="6.085mm" w="7.077mm" h="6mm">
                     <value>
                        <text>CF</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[5]"/>
                     </traversal>
                     <?renderCache.bounds 20061 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 2 CF 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="cf" y="6.085mm" w="43.068mm" h="6mm" x="152.881mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L3codiceFiscale"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="piva[0]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="9.723mm" y="14.78mm" w="24.264mm" h="6mm">
                     <value>
                        <text>Ragione sociale</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="esercizio2[0]"/>
                     </traversal>
                     <?renderCache.bounds 68780 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 15 Ragione sociale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="ragSociale" y="14.78mm" w="106.56mm" h="6mm" x="33.987mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L3ragioneSociale"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="flagProprietario[0]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="143.782mm" y="14.577mm" w="7.775mm" h="6mm">
                     <value>
                        <text>P.IVA</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[4]"/>
                     </traversal>
                     <?renderCache.bounds 22039 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 5 P.IVA 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="piva" y="14.577mm" w="42.866mm" h="6mm" x="153.083mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L3piva"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="ragSociale[0]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="5.275mm" y="22.869mm" w="58.233mm" h="4.65mm">
                     <value>
                        <text>responsabile dell'impianto in qualita' di</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[7]"/>
                     </traversal>
                     <?renderCache.bounds 165070 13181 0 0 0 0 0 0?>
                     <?renderCache.textRun 41 responsabile dell'impianto in qualita' di 0 0 8938 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="flagAmministr" w="5.577mm" h="6mm" x="117.019mm" y="22.666mm" access="protected">
                     <ui>
                        <checkButton mark="circle" size="3.175mm" shape="round">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb4?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L3flagAmministratore"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagProprietario.rawValue = "0";

}
</script>
                     </event>
                     <traversal>
                        <traverse ref="ragSocialeImpianto[0]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" x="123.49mm" y="22.666mm" w="21.712mm" h="6mm">
                     <value>
                        <text>amministratore</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                     <?renderCache.bounds 61546 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 14 amministratore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="xindir" x="5.275mm" y="29.136mm" w="73.196mm" h="4.044mm">
                     <value>
                        <text>affida la responsabilita' dell'impianto alla ditta</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="7pt" typeface="Verdana" weight="bold"/>
                     <traversal>
                        <traverse ref="xindir[8]"/>
                     </traversal>
                     <?renderCache.bounds 207485 11463 0 0 0 0 0 0?>
                     <?renderCache.textRun 50 affida la responsabilita' dell'impianto alla ditta 0 0 7785 0 0 0 "Verdana" 1 0 7000 ISO-8859-1?></draw>
                  <draw name="xindir" x="9.723mm" y="34.596mm" w="24.264mm" h="6mm">
                     <value>
                        <text>Ragione sociale</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[9]"/>
                     </traversal>
                     <?renderCache.bounds 68780 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 15 Ragione sociale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="ragSocialeImpianto" y="34.596mm" w="106.56mm" h="6mm" x="34.19mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L3ragSocialeDitta"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="cciaa[0]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="143.58mm" y="34.596mm" w="8.988mm" h="6mm">
                     <value>
                        <text>CCIAA</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[10]"/>
                     </traversal>
                     <?renderCache.bounds 25478 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 5 CCIAA 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="cciaa" y="34.596mm" w="43.068mm" h="6mm" x="152.881mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L3cciaa"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="valDataContrattoDal[0]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="9.521mm" y="41.672mm" w="60.66mm" h="6mm">
                     <value>
                        <text>Riferimento: contratto allegato, valido dal </text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="datiApparecchiature[0].apparecchiature[0]"/>
                     </traversal>
                     <?renderCache.bounds 171950 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 44 Riferimento: contratto allegato, valido dal  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="valDataContrattoDal" y="41.875mm" x="70.99mm" w="20.22mm" h="6mm" access="protected">
                     <ui>
                        <dateTimeEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </dateTimeEdit>
                        <picture>date{DD/MM/YYYY}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <date/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L3dataValiditaContrattoDal">
                        <picture>date{YYYY-MM-DD}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio o data intervento maggiore di quella odierna.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null || this.rawValue &gt; scriptsJS.getDataString()) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                        <message>
                           <text name="formatTest"/>
                        </message>
                        <picture>date{DD/MM/YYYY}</picture>
                     </validate>
                     <format>
                        <picture>date{DD/MM/YYYY}</picture>
                     </format>
                     <traversal>
                        <traverse ref="xindir[11]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="92.018mm" y="42.077mm" w="7.077mm" h="6mm">
                     <value>
                        <text>al</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="valDataContrattoAl[0]"/>
                     </traversal>
                     <?renderCache.bounds 20061 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 2 al 0 6531 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="valDataContrattoAl" y="42.077mm" x="101.319mm" w="20.22mm" h="6mm" access="protected">
                     <ui>
                        <dateTimeEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </dateTimeEdit>
                        <picture>date{DD/MM/YYYY}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <date/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L3dataValiditaContrattoAl">
                        <picture>date{YYYY-MM-DD}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Intervallo data validita' contratto non valido.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &lt; valDataContrattoDal.rawValue) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
</script>
                        <message>
                           <text name="formatTest"/>
                        </message>
                        <picture>date{DD/MM/YYYY}</picture>
                     </validate>
                     <format>
                        <picture>date{DD/MM/YYYY}</picture>
                     </format>
                     <traversal>
                        <traverse ref="datiApparecchiature[0].xindir[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="xindir[1]"/>
                     <traverse ref="datiApparecchiature[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <subform y="50mm" w="197mm" minH="6mm" layout="lr-tb" name="datiApparecchiature">
                  <bind match="none"/>
                  <draw name="xindir" w="24.871mm" h="6mm">
                     <value>
                        <text>Apparecchiature</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="datiFirma[0].xindir[0]"/>
                     </traversal>
                     <?renderCache.bounds 70500 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 15 Apparecchiature 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="apparecchiature" w="160mm" minH="6mm" access="protected">
                     <ui>
                        <textEdit multiLine="1">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge presence="hidden">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner presence="hidden">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L3apparecchiature"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="datiFirma[0].xindir[1]"/>
                     </traversal>
                  </field>
                  <margin leftInset="10mm"/>
                  <?templateDesigner expand 0?>
                  <traversal>
                     <traverse operation="first" ref="xindir[0]"/>
                     <traverse ref="datiFirma[0]"/>
                  </traversal>
               </subform>
               <subform name="datiFirma" w="197.272mm" h="18mm">
                  <bind match="none"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden"/>
                     <edge presence="hidden"/>
                     <edge presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                  </border>
                  <draw name="xindir" x="9.925mm" y="2.476mm" w="60.66mm" h="6mm">
                     <value>
                        <text>Firma del proprietario / amministratore</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="firma1[0]"/>
                     </traversal>
                     <?renderCache.bounds 171950 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 39 Firma del proprietario / amministratore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="xindir" x="9.925mm" y="9.148mm" w="60.66mm" h="6mm">
                     <value>
                        <text>Firma del terzo responsabile</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="firma2[0]"/>
                     </traversal>
                     <?renderCache.bounds 171950 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 28 Firma del terzo responsabile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="firma1" y="2.476mm" w="71.377mm" h="6mm" x="70.787mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dashDotDot">
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dashDotDot">
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                  </field>
                  <field name="firma2" y="9.148mm" w="71.377mm" h="6mm" x="70.787mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dashDotDot">
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dashDotDot">
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="xindir[1]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.042mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <breakAfter/>
               <border>
                  <edge>
                     <color value="192,192,192"/>
                  </edge>
                  <corner thickness="0.176mm">
                     <color value="192,192,192"/>
                  </corner>
               </border>
               <traversal>
                  <traverse operation="first" ref="datiNomina[0]"/>
               </traversal>
               <occur max="-1"/>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori4_1" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaGT"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>4. GENERATORI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 13 4. GENERATORI 0 235995 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].tx_4_1[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="196.758mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezGruppiTermici"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>4.1 GRUPPI TERMICI O CALDAIE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0].addRiga[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="invisible">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (rowGT.datiGT.dataInstallaz.rawValue != null &amp;&amp; rowGT.datiGT.fabbricante.rawValue != null &amp;&amp; rowGT.datiGT.matricola.rawValue != null &amp;&amp; rowGT.datiGT.modello.rawValue !=null
	&amp;&amp; rowGT.datiGT.potTermica.rawValue != null &amp;&amp; rowGT.datiGT.combustibile.rawValue != null &amp;&amp; rowGT.datiGT.fluidoTermoVet.rawValue != null 
	&amp;&amp; (rowGT.datiGT.flagGTsingle.rawValue != 0 || rowGT.datiGT.flagGTmod.rawValue != 0 || rowGT.datiGT.flagTubo.rawValue != 0  || rowGT.datiGT.flagGenAria.rawValue != 0  )){ 

	rowGT.instanceManager.addInstance();


	var vIndex = _rowGT.count-1;
	var currentRow = generatori.resolveNode("rowGT["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.gt.numGruppoT);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo GT.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="rowGT[0].button[0].cancellaRiga[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="rowGT[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="rowGT">
                  <bind match="dataRef" ref="$.rowGT[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="invisible">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  rowGT.index;
var vRowCount = _rowGT.count;

if (datiGT.L4_1dataControllo.rawValue != null) {
	xfa.host.messageBox("Non è possibile cancellare se la data controllo è stata valorizzata.");
}	else{

//DA AGGIUNGERE2
//rimosso la cancellazione della riga intera dalla seconda riga in avanti
/*	
if (vRowCount &gt; 1) {
	_rowGT.removeInstance(vIndex);
}else{
*/
	//gt.numGruppoT.rawValue = null;
	datiGT.dataInstallaz.rawValue = null;
	datiGT.L4_1dataControllo.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.combustibile.rawValue = null;
	datiGT.potTermica.rawValue = null;
	datiGT.flagGTsingle.rawValue = "0";
	datiGT.flagTubo.rawValue = "0";
	datiGT.dataDismiss.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.fluidoTermoVet.rawValue = null;
	datiGT.RendimentoTermico.rawValue = null;
	datiGT.flagGTmod.rawValue = "0";
	datiGT.numAnalisi.rawValue = null;
	datiGT.flagGenAria.rawValue = "0";
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";
//}	

}
</script>
                        </event>
                        <assist>
                           <toolTip>Elimina GT corrente.</toolTip>
                        </assist>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (datiGT.L4_1dataControllo.rawValue != null &amp;&amp; datiGT.dataInstallaz.rawValue &lt;= datiGT.L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="gt[0].txflag1[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";
datiGT.dataDismiss.access = "open";
datiGT.sostComp.access = "open";


if (datiGT.L4_1dataControllo.rawValue == null || datiGT.dataInstallaz.rawValue &gt; datiGT.L4_1dataControllo.rawValue ){

	datiGT.dataInstallaz.access = "open";
	datiGT.fabbricante.access = "open";
	datiGT.modello.access = "open";
	datiGT.matricola.access = "open";
	datiGT.combustibile.access = "open";
	datiGT.fluidoTermoVet.access = "open";
	datiGT.potTermica.access = "open";
	datiGT.RendimentoTermico.access = "open";
	datiGT.flagGTsingle.access = "open";
	datiGT.flagGTmod.access = "open";
	if (datiGT.flagGTmod.rawValue == 1)
		datiGT.numAnalisi.access = "open";
	datiGT.flagTubo.access = "open";
	datiGT.flagGenAria.access = "open";
	datiGT.sostComp.access = "open";
	datiGT.dismissComp.access = "open";
	button.btCancella.access = "open";
}	

this.presence = "hidden";
annullaDismiss.presence  = "hidden";
//01/12/2015
datiGT.dataDismiss.rawValue = null;

try{
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSostGT.index;
	var vRowCount = _rowSostGT.count;			

	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = rowGT.resolveNode("rowSostGT["+ nItemCount +"]");	
		var vIndex = currentRow.index;

//DA AGGIUNGERE		
	/*	if (currentRow.datiGT.flagEditSez4_1.rawValue != "true" ) {
			//xfa.host.messageBox("[currentRow.datiGT.flagEditSez4_1.rawValue ?? "+currentRow.datiGT.flagEditSez4_1.rawValue);		
			currentRow.button.presence = "visible";
		}	*/
		
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}	
	}	
}catch(e){ null;}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="gt[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="26.91mm" minH="11mm" layout="lr-tb" name="gt">
                     <bind match="none"/>
                     <draw name="txflag1" w="26.91mm" h="6mm">
                        <value>
                           <text>Gruppo Termico </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numGruppoT[0]"/>
                        </traversal>
                        <?renderCache.bounds 76280 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 15 Gruppo Termico  0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="numGruppoT" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>GT</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L4_1numGT"/>
                        <traversal>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null || this.rawValue ==""){
	try{
			var vRowCount = _rowGT.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  rowGT.index;

				var currentRow = generatori.resolveNode("rowGT["+ nItemCount +"]");
				
				var vNum = currentRow.gt.numGruppoT.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.gt.numGruppoT.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;				
		//}	
	}catch(e){xfa.host.messageBox("exception rowGT.gt.numGruppoT::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="165.642mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0].xindir[0]"/>
                     </traversal>
                     <?renderCache.bounds 469536 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="77.193mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.504mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante  (sez 4.1)</toolTip>
                        </assist>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
		
		if (codFabbricante.rawValue != null) {
			//var vChoice = this.selectedIndex; 
			//var vText = this.getDisplayItem(vChoice);
			//xfa.host.messageBox("vText: "+vText);
			//codFabbricante.rawValue = this.boundItem(vText);
		  	//xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
		
		if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
			this.access = "protected";		
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <bind match="none"/>
                        <items save="1"/>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_1dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
//xfa.host.messageBox("L4_1_dataInstallaz::validate::INIT");
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'	+"Campo obbligatorio.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);



if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0
	|| flagGenAria.rawValue != 0  )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
	
//DA AGGIUNGERE2
} else  if (this.rawValue == "" || this.rawValue == null ) {

	var vRowCount = _rowSostGT.count;
	if (vRowCount &gt; 0){
		var firstRow = rowGT.resolveNode("rowSostGT["+ 0 +"]");	
		if ( firstRow.datiGT.dataInstallaz.rawValue != null &amp;&amp; firstRow.datiGT.dataInstallaz.rawValue != "" ) {
		    VALIDATION_MSG = "Campo obbligatorio."+'\n'	+"In presenza di componenti sostituiti è necessario compilare la sezione.";
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );			
		}	
	}	
	
} else {	

//DA AGGIUNGERE2
//----------------------------------------------------------------------------
	if (this.rawValue != null || this.rawValue != "" ) {
		
			var vValueSave =  this.rawValue;
			//--------- controllo data installazione e ultima dismissione o sostituzione ---------
			var vIndice = rowSostGT.index;
			var vRowCount = _rowSostGT.count;			
	
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = rowGT.resolveNode("rowSostGT["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { 
					//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
					break;
				}	
			}

			var sObj = this.parent.name+"."+ this.name;
			var oField = xfa.resolveNode(sObj);
				
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
				var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
				//xfa.host.messageBox(VALIDATION_MSG);			
				controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
			} else {
				controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
			} 
	}else 
//----------------------------------------------------------------------------
	
		if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){ 
		
		var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}else if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    /*
	} else if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_1dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true") {
		var VALIDATION_MSG = "Errore!"+'\n'
			+"La data installazione e' inferiore a quella del rapporto di controllo.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    
	*/	
    } else {
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
    }	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa </text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.504mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.581mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.581mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_1matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || dataInstallaz.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <assist>
                           <toolTip>Matricola  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                     </field>
                     <field name="flagGTsingle" w="5.577mm" h="6mm" x="6.084mm" y="42.36mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_1GTsingolo"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTubo.rawValue = "0";
	flagGTmod.rawValue = "0";
	numAnalisi.rawValue = "";
	numAnalisi.access = "protected";
	flagGenAria.rawValue = "0";
}
</script>
                        </event>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField); 

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagGTmod.rawValue != "1" &amp;&amp; flagTubo.rawValue != "1" &amp;&amp; flagGenAria.rawValue != "1"  &amp;&amp; 
	(dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","fCheckValidi");
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <assist>
                           <toolTip>Gruppo termico singolo  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </field>
                     <draw name="txflag1" x="12.555mm" y="42.36mm" w="37.636mm" h="6mm">
                        <value>
                           <text>Gruppo termico singolo</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagGTmod[0]"/>
                        </traversal>
                        <?renderCache.bounds 106685 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Gruppo termico singolo 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagTubo" w="5.577mm" h="6mm" x="6.286mm" y="49.84mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_1tupoRadiante"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagGTsingle.rawValue = "0";
	flagGTmod.rawValue = "0";
	numAnalisi.rawValue = "";
	numAnalisi.access = "protected";
	flagGenAria.rawValue = "0";
}
</script>
                        </event>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField); 

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagGTmod.rawValue != "1" &amp;&amp; flagGTsingle.rawValue != "1" &amp;&amp; flagGenAria.rawValue != "1"  &amp;&amp;
(dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","fCheckValidi");
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <assist>
                           <toolTip>Tubo  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txflag1[1]"/>
                        </traversal>
                     </field>
                     <draw name="txflag1" x="12.757mm" y="49.84mm" w="37.636mm" h="6mm">
                        <value>
                           <text>Tubo / nastro radiante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagGenAria[0]"/>
                        </traversal>
                        <?renderCache.bounds 106685 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Tubo / nastro radiante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="25.073mm" w="19.006mm" h="6mm">
                        <value>
                           <text>Combustibile</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="combustibile[0]"/>
                        </traversal>
                        <?renderCache.bounds 53875 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 12 Combustibile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="combustibile" y="25.073mm" x="24.309mm" w="62.328mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || dataInstallaz.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on combustibile::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
		
		if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
			this.access = "protected";
	
}catch(e){xfa.host.messageBox("Exception on combustibile::init "+e);}
</script>
                        </event>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codCombu.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <assist>
                           <toolTip>Combustibile  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="5.478mm" y="33.363mm" w="56.616mm" h="6mm">
                        <value>
                           <text>Potenza termica utile nominale Pn max</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <?renderCache.bounds 160486 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 37 Potenza termica utile nominale Pn max 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txtAnniManutenzione" x="5.478mm" y="58.333mm" w="40.439mm" h="6mm">
                        <value>
                           <text>Da manutenere ogni (anni)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="anniManutenzione[0]"/>
                        </traversal>
                        <?renderCache.bounds 114630 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 25 Da manutenere ogni (anni) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potTermica" y="33.363mm" x="67.553mm" w="17.187mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_1potTermUtileMax"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <assist>
                           <toolTip>Potenza termica  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <field name="anniManutenzione" y="58.333mm" x="47.939mm" w="17.187mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <assist>
                           <toolTip>Potenza termica  (sez 4.1)</toolTip>
                        </assist>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L4_1manutenzioneAnni">
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </bind>
                        <format>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </format>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                     </field>
                     <draw name="txcivico" x="85.347mm" y="33.363mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_1dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data di dismissione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
}else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString()) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_1dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true")  {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Esiste un legame tra il componente ed il rapporto di controllo.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    
    } else {
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);		
		if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
		else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
			var VALIDATION_MSG = "Errore!"+'\n'
					+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
				
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
		}
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa </text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="L4_1dataControllo[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.604mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.604mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_1modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <assist>
                           <toolTip>Modello  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="xindir" x="107.184mm" y="25.173mm" w="30.127mm" h="6mm">
                        <value>
                           <text>Fluido Termovettore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fluidoTermoVet[0]"/>
                        </traversal>
                        <?renderCache.bounds 85399 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 19 Fluido Termovettore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="fluidoTermoVet" y="25.173mm" x="137.109mm" w="49.337mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || dataInstallaz.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fluidoTermoVet" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fluidoTermoVet.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fluidoTermoVet.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFluido.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFluido.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
		
		if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
			this.access = "protected";
	
}catch(e){xfa.host.messageBox("Exception on fluidoTermoVet::init "+e);}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fluidoTermoVet" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fluidoTermoVet.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fluidoTermoVet.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fluidoTermoVet::enter "+e);}
</script>
                        </event>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFluido.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <assist>
                           <toolTip>Fluido Termovettore  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFluido[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="107.184mm" y="33.463mm" w="53.178mm" h="6mm">
                        <value>
                           <text>Rendimento termico utile a Pn max</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="nota[0].nota[0]"/>
                        </traversal>
                        <?renderCache.bounds 150741 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 33 Rendimento termico utile a Pn max 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="RendimentoTermico" y="33.261mm" x="161.373mm" w="20.018mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="3"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_1percRendimTermUtileMax"/>
                        <validate>
                           <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Range consetito: 0 - 120.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; (this.rawValue &lt; 0 || this.rawValue &gt; 120)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR","formValido");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                        </validate>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                        <assist>
                           <toolTip>Rendimento termico utile (sez. 4.1)</toolTip>
                        </assist>
                     </field>
                     <draw name="txcivico" x="181.998mm" y="33.261mm" w="4.246mm" h="6mm">
                        <value>
                           <text>%</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                        <?renderCache.bounds 12036 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 1 % 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagGTmod" w="5.577mm" h="6mm" x="107.588mm" y="42.36mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_1GTModulare"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTubo.rawValue = "0";
	flagGTsingle.rawValue = "0";
	flagGenAria.rawValue = "0";
	numAnalisi.access = "open";
}else{
	numAnalisi.rawValue = "";
	numAnalisi.access = "protected";
}

</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1" &amp;&amp; dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &gt; L4_1dataControllo.rawValue) {
	numAnalisi.access = "open";
	this.access = "protected";
}

</script>
                        </event>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagGTsingle.rawValue != "1" &amp;&amp; flagTubo.rawValue != "1" &amp;&amp; flagGenAria.rawValue != "1"  &amp;&amp;
(dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","fCheckValidi");
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <assist>
                           <toolTip>Gruppo termico modulare  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txflag1[2]"/>
                        </traversal>
                     </field>
                     <draw name="txflag1" x="113.857mm" y="42.36mm" w="46.72mm" h="6mm">
                        <value>
                           <text>Gruppo termico modulare con n°</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numAnalisi[0]"/>
                        </traversal>
                        <?renderCache.bounds 132435 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 31 Gruppo termico modulare con n° 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagGenAria" w="5.577mm" h="6mm" x="107.588mm" y="49.84mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_1GenAriaCalda"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTubo.rawValue = "0";
	flagGTmod.rawValue = "0";
	numAnalisi.rawValue = "";
	numAnalisi.access = "protected";
	flagGTsingle.rawValue = "0";
}
</script>
                        </event>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagGTmod.rawValue != "1" &amp;&amp; flagTubo.rawValue != "1" &amp;&amp; flagGTsingle.rawValue != "1"  &amp;&amp;
(dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| potTermica.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","fCheckValidi");
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Generatore aria  (sez 4.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txflag1[3]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txflag1" x="114.059mm" y="49.84mm" w="37.636mm" h="6mm">
                        <value>
                           <text>Generatore d'aria calda</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txtAnniManutenzione[0]"/>
                        </traversal>
                        <?renderCache.bounds 106685 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 23 Generatore d'aria calda 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txflag1" x="166.832mm" y="42.36mm" w="29.319mm" h="6mm">
                        <value>
                           <text>analisi fumi previste</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" hAlign="right"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagTubo[0]"/>
                        </traversal>
                        <?renderCache.bounds 83109 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 21 analisi fumi previste 0 2027 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="numAnalisi" y="42.36mm" x="161.171mm" w="5.662mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <integer/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <assist>
                           <toolTip>num analisi fumi  (sez 4.1)</toolTip>
                        </assist>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="txflag1[4]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L4_1numAnalisiFumi">
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </bind>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if ((this.rawValue == null || this.rawValue == 0 || this.rawValue &lt; 0) &amp;&amp; flagGTmod.rawValue == 1) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue == 0 || this.rawValue &lt; 0){	
	var VALIDATION_MSG = "Errore!"+'\n'
					+"Puo' contenere solo valori maggiori di zero.";
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
}
</script>
                        </validate>
                        <format>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </format>
                     </field>
                     <field name="sostComp" y="69.253mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null &amp;&amp; fabbricante.rawValue == null &amp;&amp; matricola.rawValue == null &amp;&amp; potTermica.rawValue == null &amp;&amp; modello.rawValue == null &amp;&amp; 
          combustibile.rawValue == ""  &amp;&amp; fluidoTermoVet.rawValue == ""  &amp;&amp; (flagGTsingle.rawValue == 0 || flagGTmod.rawValue == 0 || flagTubo.rawValue == 0 || flagGenAria.rawValue == 0)){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
//30/11/2015
}else if (L4_1dataControllo.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; L4_1dataControllo.rawValue)){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore alla data di controllo!");	
}else {
		fCheckValidi.rawValue = 0;
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potTermica.execEvent("validate");
		combustibile.execEvent("validate");
		fluidoTermoVet.execEvent("validate");
		flagGTsingle.execEvent("validate");
		flagGTmod.execEvent("validate");
		flagTubo.execEvent("validate");
		flagGenAria.execEvent("validate");
		numAnalisi.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSostGT.addInstance(true);
			newRow.datiGT.L4_1dataControllo.rawValue = L4_1dataControllo.rawValue;		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;
			newRow.datiGT.combustibile.rawValue = combustibile.rawValue;
			newRow.datiGT.codCombu.rawValue = codCombu.rawValue;
			newRow.datiGT.potTermica.rawValue = potTermica.rawValue;
			newRow.datiGT.flagGTsingle.rawValue = flagGTsingle.rawValue;
			newRow.datiGT.flagTubo.rawValue = flagTubo.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.fluidoTermoVet.rawValue = fluidoTermoVet.rawValue;
			newRow.datiGT.codFluido.rawValue = codFluido.rawValue;
			newRow.datiGT.RendimentoTermico.rawValue = RendimentoTermico.rawValue;
			newRow.datiGT.numAnalisi.rawValue = numAnalisi.rawValue;
			newRow.datiGT.flagGTmod.rawValue = flagGTmod.rawValue;
			newRow.datiGT.flagGenAria.rawValue = flagGenAria.rawValue;
			
//DA AGGIUNGERE
			_rowSostGT.moveInstance (newRow.index,0 );
			
			//gt.numGruppoT.rawValue = null;
			flagSost.rawValue = "1";
			
//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			dataDismiss.rawValue = null;

			L4_1dataControllo.rawValue = null;
			fabbricante.rawValue = null;
			matricola.rawValue = null;
			combustibile.rawValue = null;
			potTermica.rawValue = null;
			flagGTsingle.rawValue = "0";
			flagTubo.rawValue = "0";
			modello.rawValue = null;
			fluidoTermoVet.rawValue = null;
			RendimentoTermico.rawValue = null;
			flagGTmod.rawValue = "0";
			numAnalisi.rawValue = null;
			flagGenAria.rawValue = "0";
			
			//if (L4_1dataControllo.rawValue == null || datiGT.dataInstallaz.rawValue &gt; L4_1dataControllo.rawValue){
				dataInstallaz.access = "open";
				fabbricante.access = "open";
				modello.access = "open";
				matricola.access = "open";
				combustibile.access = "open";
				fluidoTermoVet.access = "open";
				potTermica.access = "open";
				RendimentoTermico.access = "open";
				flagGTsingle.access = "open";
				flagGTmod.access = "open";
				flagTubo.access = "open";
				flagGenAria.access = "open";			
			//}
			//--------------------------------------------------------------
			

		//DA AGGIUNGERE	
		var vIndice = rowSostGT.index;
		var vRowCount = _rowSostGT.count;			
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = rowGT.resolveNode("rowSostGT["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			if (vIndex == 0){
				currentRow.button.presence = "visible";
			}else{
				currentRow.button.presence = "invisible";		
			}	
		}	
		
	}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "Bozza")*/
	this.presence = "hidden";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="69.253mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null &amp;&amp; fabbricante.rawValue == null &amp;&amp; matricola.rawValue == null &amp;&amp; potTermica.rawValue == null &amp;&amp; modello.rawValue == null &amp;&amp; 
          combustibile.rawValue == ""  &amp;&amp; fluidoTermoVet.rawValue == ""  &amp;&amp; (flagGTsingle.rawValue == 0 || flagGTmod.rawValue == 0 || flagTubo.rawValue == 0 || flagGenAria.rawValue == 0)){
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna!");
//30/11/2015
}else if (L4_1dataControllo.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; L4_1dataControllo.rawValue)){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore alla data di controllo!");
}else{
		fCheckValidi.rawValue = 0;
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potTermica.execEvent("validate");
		combustibile.execEvent("validate");
		fluidoTermoVet.execEvent("validate");
		flagGTsingle.execEvent("validate");
		flagGTmod.execEvent("validate");
		flagTubo.execEvent("validate");
		flagGenAria.execEvent("validate");
		numAnalisi.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){

			flagDismiss.rawValue = "1";
			
			dataInstallaz.access = "protected";
			fabbricante.access = "protected";
			matricola.access = "protected";
			combustibile.access = "protected";
			potTermica.access = "protected";
			flagGTsingle.access = "protected";
			flagTubo.access = "protected";
			dataDismiss.access = "protected";
			modello.access = "protected";
			fluidoTermoVet.access = "protected";
			RendimentoTermico.access = "protected";
			flagGTmod.access = "protected";
			numAnalisi.access = "protected";
			flagGenAria.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";

			try	{		
				// devo rendere invisibile il pulsante di RollBack della sostituzione
				var vIndice = rowSostGT.index;
				var vRowCount = _rowSostGT.count;			
		
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = rowGT.resolveNode("rowSostGT["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					
					
					if (flagDismiss.rawValue == 1  ) {
						//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
						currentRow.button.presence = "invisible";
					}	
				}			
			}catch(e){ null;}	

		}	
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "hidden";
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="Rectangle6" w="197.163mm" h="1.315mm" x="0.018mm" y="66.624mm">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <field name="flagDismiss" y="69.253mm" x="138.525mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0].button[0].annullaRiga[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	fabbricante.access = "protected";
	matricola.access = "protected";
	combustibile.access = "protected";
	potTermica.access = "protected";
	flagGTsingle.access = "protected";
	flagTubo.access = "protected";
	dataDismiss.access = "protected";
	modello.access = "protected";
	fluidoTermoVet.access = "protected";
	RendimentoTermico.access = "protected";
	flagGTmod.access = "protected";
	numAnalisi.access = "protected";
	flagGenAria.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}
	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSostGT.index;
		var vRowCount = _rowSostGT.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = rowGT.resolveNode("rowSostGT["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}		
}
</script>
                        </event>
                     </field>
                     <field name="flagSost" y="68.848mm" x="35.807mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="flagGiaPresenteDB[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="10.008mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_1fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <field name="codCombu" y="25.577mm" x="87.57mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_1combustibile"/>
                        <traversal>
                           <traverse ref="potTermica[0]"/>
                        </traversal>
                     </field>
                     <field name="codFluido" y="25.375mm" x="185.031mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_1fluidoTermoVett"/>
                        <traversal>
                           <traverse ref="codCombu[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSostGT[0]"/>
                     </traversal>
                     <field name="flagAnnullaDismiss" y="69.05mm" x="154.498mm" w="12.334mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="5.333mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagAnnullaDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 0 ) { 
	button.annullaDismiss.presence = "invisible";
}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">

this
</script>
                        </event>
                     </field>
                     <field name="flagGiaPresenteDB" y="68.849mm" x="6.488mm" w="28mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton>
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>false</text>
                        </value>
                        <caption placement="right" reserve="21mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>Flag Gia Presente D B</text>
                           </value>
                        </caption>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <bind match="dataRef" ref="$.flagGiaPresenteDB"/>
                        <traversal>
                           <traverse ref="flagAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <subform x="61.891mm" y="34.07mm" w="5.257mm" minH="4.65mm" name="nota" presence="invisible">
                        <bind match="none"/>
                        <field name="nota" y="0mm" w="5.257mm" h="4.65mm">
                           <ui>
                              <button highlight="inverted"/>
                           </ui>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
xfa.host.messageBox("Questo dato non rappresenta la 'potenza massima al focolare'  e verrà riportato nell'allegato al punto 'Potenza termica nominale utile.");
</script>
                           </event>
                           <traversal>
                              <traverse ref="img[0]"/>
                           </traversal>
                        </field>
                        <draw name="img" y="0.404mm" w="5.055mm" h="4.044mm" relevant="-print">
                           <value>
                              <image href="..\resources\comment.png" contentType="image/png"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <traversal>
                              <traverse ref="flagGTsingle[0]"/>
                           </traversal>
                        </draw>
                        <?templateDesigner expand 0?>
                        <traversal>
                           <traverse operation="first" ref="nota[0]"/>
                           <traverse ref="flagGTsingle[0]"/>
                        </traversal>
                     </subform>
                     <field name="L4_1dataControllo" w="32.976mm" h="5.055mm" x="65.53mm" y="2.729mm" presence="hidden">
                        <ui>
                           <dateTimeEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </dateTimeEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <date/>
                        </value>
                        <bind match="dataRef" ref="$.L4_1dataControllo">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <traversal>
                           <traverse ref="xindir[1]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 1?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSostGT" id="rowSostGT_ID">
                     <bind match="dataRef" ref="$.sezGTsostituite.rowGTsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm" presence="invisible">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSostGT.index;
var vRowCount = _rowSostGT.count;

//DA AGGIUNGERE
if ( rowGT.datiGT.L4_1dataControllo.rawValue != null ){	
	xfa.host.messageBox("Non è possibile sostituire annullare la sostituzione di un componente che ha la data controllo valorizzata.");
}else{

	rowGT.datiGT.flagSost.rawValue = "0";
	rowGT.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
	rowGT.datiGT.fabbricante.rawValue =			datiGT.fabbricante.rawValue;
	rowGT.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
	rowGT.datiGT.codCombu.rawValue = 		datiGT.codCombu.rawValue;
	rowGT.datiGT.codFluido.rawValue = 		datiGT.codFluido.rawValue;
	rowGT.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
	rowGT.datiGT.combustibile.rawValue =		datiGT.combustibile.rawValue;
	rowGT.datiGT.potTermica.rawValue =			datiGT.potTermica.rawValue;
	rowGT.datiGT.flagGTsingle.rawValue =		datiGT.flagGTsingle.rawValue;
	rowGT.datiGT.flagTubo.rawValue =			datiGT.flagTubo.rawValue;
	//rowGT.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
	rowGT.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
	rowGT.datiGT.fluidoTermoVet.rawValue = 		datiGT.fluidoTermoVet.rawValue;
	rowGT.datiGT.RendimentoTermico.rawValue = 	datiGT.RendimentoTermico.rawValue;
	rowGT.datiGT.flagGTmod.rawValue = 			datiGT.flagGTmod.rawValue;
	rowGT.datiGT.numAnalisi.rawValue = 			datiGT.numAnalisi.rawValue;
	rowGT.datiGT.flagGenAria.rawValue = 		datiGT.flagGenAria.rawValue;
	rowGT.datiGT.L4_1dataControllo.rawValue =		datiGT.L4_1dataControllo.rawValue;
	
	if ( rowGT.datiGT.dataInstallaz.rawValue != null &amp;&amp; rowGT.datiGT.dataInstallaz.rawValue &lt;= rowGT.datiGT.L4_1dataControllo.rawValue){
		rowGT.datiGT.dataInstallaz.access = "protected";
		rowGT.datiGT.fabbricante.access = "protected";
		rowGT.datiGT.matricola.access = "protected";
		rowGT.datiGT.combustibile.access = "protected";
		rowGT.datiGT.potTermica.access = "protected";
		rowGT.datiGT.flagGTsingle.access = "protected";
		rowGT.datiGT.flagTubo.access = "protected";
		rowGT.datiGT.modello.access = "protected";
		rowGT.datiGT.fluidoTermoVet.access = "protected";
		rowGT.datiGT.RendimentoTermico.access = "protected";
		rowGT.datiGT.flagGTmod.access = "protected";
		rowGT.datiGT.numAnalisi.access = "protected";
		rowGT.datiGT.flagGenAria.access = "protected";
	}


//DA AGGIUNGERE2	
	//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
	if (vRowCount &gt; 1){
		var firstRow = this.parent.parent.parent.resolveNode("rowSostGT["+ 1 +"]");
		firstRow.button.presence = "visible";
	}	
	// ...e poi rimuovo
	_rowSostGT.removeInstance(vIndex);
}
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="txflag1[0]"/>
                           </traversal>
                        </field>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
/*
if (datiGT.flagEditSez4_1.rawValue == "true" )
	this.presence = "invisible";
*/

</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( rowGT.datiGT.flagDismiss.rawValue == 1 ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/

</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0].xindir[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="61.314mm">
                        <bind match="none"/>
                        <field name="flagEditSez4_1" y="44.889mm" x="75.034mm" w="28mm" h="6mm" presence="invisible">
                           <ui>
                              <checkButton>
                                 <border>
                                    <?templateDesigner StyleID apcb2?>
                                    <edge stroke="lowered"/>
                                    <fill/>
                                 </border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>false</text>
                           </value>
                           <caption placement="right" reserve="21mm">
                              <para vAlign="middle"/>
                              <value>
                                 <text>Flag Edit Sez4_1</text>
                              </value>
                           </caption>
                           <items>
                              <text>true</text>
                              <text>false</text>
                           </items>
                           <bind match="dataRef" ref="$.flagRollBack4_1"/>
                           <traversal>
                              <traverse ref="flagGenAria[0]"/>
                           </traversal>
                        </field>
                        <field name="fabbricante" y="8.291mm" x="24.281mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_1dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="15.368mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="15.368mm" w="62.323mm" h="6mm" x="24.281mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_1matricola"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <field name="flagGTsingle" w="5.577mm" h="6mm" x="5.679mm" y="38.014mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_1GTsingolo"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTubo.rawValue = "0";
	flagGTmod.rawValue = "0";
	numAnalisi.rawValue = "";
	numAnalisi.access = "protected";
	flagGenAria.rawValue = "0";
}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txflag1[0]"/>
                           </traversal>
                        </field>
                        <draw name="txflag1" x="12.15mm" y="38.014mm" w="37.636mm" h="6mm">
                           <value>
                              <text>Gruppo termico singolo</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagGTmod[0]"/>
                           </traversal>
                           <?renderCache.bounds 106685 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Gruppo termico singolo 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagTubo" w="5.577mm" h="6mm" x="5.881mm" y="44.889mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_1tupoRadiante"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagGTsingle.rawValue = "0";
	flagGTmod.rawValue = "0";
	numAnalisi.rawValue = "";
	numAnalisi.access = "protected";
	flagGenAria.rawValue = "0";
}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txflag1[1]"/>
                           </traversal>
                        </field>
                        <draw name="txflag1" x="12.352mm" y="44.889mm" w="37.636mm" h="6mm">
                           <value>
                              <text>Tubo / nastro radiante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagEditSez4_1[0]"/>
                           </traversal>
                           <?renderCache.bounds 106685 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Tubo / nastro radiante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="22.647mm" w="19.006mm" h="6mm">
                           <value>
                              <text>Combustibile</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="combustibile[0]"/>
                           </traversal>
                           <?renderCache.bounds 53875 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 12 Combustibile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="combustibile" y="22.647mm" x="24.309mm" w="62.328mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				
			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on combustibile::init "+e);}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="5.477mm" y="30.128mm" w="56.616mm" h="6mm">
                           <value>
                              <text>Potenza termica utile nominale Pn max</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                           <?renderCache.bounds 160486 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 37 Potenza termica utile nominale Pn max 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potTermica" y="29.926mm" x="62.498mm" w="17.187mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_1potTermUtileMax"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="80.292mm" y="29.926mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="RendimentoTermico[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_1dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="L4_1dataControllo[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.391mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.391mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_1modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="107.184mm" y="22.647mm" w="30.127mm" h="6mm">
                           <value>
                              <text>Fluido Termovettore</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fluidoTermoVet[0]"/>
                           </traversal>
                           <?renderCache.bounds 85399 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 19 Fluido Termovettore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="fluidoTermoVet" y="22.647mm" x="137.109mm" w="49.337mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fluidoTermoVet" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fluidoTermoVet.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fluidoTermoVet.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFluido.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFluido.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on fluidoTermoVet::init "+e);}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="codCombu[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="107.386mm" y="30.228mm" w="53.178mm" h="6mm">
                           <value>
                              <text>Rendimento termico utile a Pn max</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagGTsingle[0]"/>
                           </traversal>
                           <?renderCache.bounds 150741 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 33 Rendimento termico utile a Pn max 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="RendimentoTermico" y="30.026mm" x="161.373mm" w="20.018mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="3"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_1percRendimTermUtileMax"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="181.998mm" y="30.026mm" w="4.246mm" h="6mm">
                           <value>
                              <text>%</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                           <?renderCache.bounds 12036 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 % 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagGTmod" w="5.577mm" h="6mm" x="107.588mm" y="38.014mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_1GTModulare"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTubo.rawValue = "0";
	flagGTsingle.rawValue = "0";
	flagGenAria.rawValue = "0";
	numAnalisi.access = "open";
}else{
	numAnalisi.rawValue = "";
	numAnalisi.access = "protected";
}

</script>
                           </event>
                           <event activity="initialize" name="event__initialize">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	numAnalisi.access = "open";
}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txflag1[2]"/>
                           </traversal>
                        </field>
                        <draw name="txflag1" x="113.857mm" y="38.014mm" w="46.72mm" h="6mm">
                           <value>
                              <text>Gruppo termico modulare con n°</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="numAnalisi[0]"/>
                           </traversal>
                           <?renderCache.bounds 132435 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 31 Gruppo termico modulare con n° 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagGenAria" w="5.577mm" h="6mm" x="107.588mm" y="44.889mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_1GenAriaCalda"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTubo.rawValue = "0";
	flagGTmod.rawValue = "0";
	numAnalisi.rawValue = "";
	numAnalisi.access = "protected";
	flagGTsingle.rawValue = "0";
}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txflag1[3]"/>
                           </traversal>
                        </field>
                        <draw name="txflag1" x="114.059mm" y="44.889mm" w="37.636mm" h="6mm">
                           <value>
                              <text>Generatore d'aria calda</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txtAnniManutenzione[0]"/>
                           </traversal>
                           <?renderCache.bounds 106685 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 23 Generatore d'aria calda 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txflag1" x="166.832mm" y="38.014mm" w="29.319mm" h="6mm">
                           <value>
                              <text>analisi fumi previste</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" hAlign="right"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagTubo[0]"/>
                           </traversal>
                           <?renderCache.bounds 83109 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 21 analisi fumi previste 0 2027 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="numAnalisi" y="38.014mm" w="5.662mm" h="6mm" x="161.171mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_1numAnalisiFumi"/>
                           <event activity="initialize" name="event__initialize">
                              <script contentType="application/x-javascript">
this.access = "protected";
</script>
                           </event>
                           <traversal>
                              <traverse ref="txflag1[4]"/>
                           </traversal>
                        </field>
                        <field name="codFabbricante" y="8.493mm" x="87.368mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_1fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <field name="codCombu" y="23.051mm" x="87.368mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_1combustibile"/>
                           <traversal>
                              <traverse ref="codFluido[0]"/>
                           </traversal>
                        </field>
                        <field name="codFluido" y="23.253mm" x="185.031mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_1fluidoTermoVett"/>
                           <traversal>
                              <traverse ref="potTermica[0]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <field name="L4_1dataControllo" w="32.976mm" h="5.055mm" x="67.552mm" y="2.427mm" presence="hidden">
                           <ui>
                              <dateTimeEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <date/>
                           </value>
                           <bind match="dataRef" ref="$.L4_1dataControllo">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <traversal>
                              <traverse ref="xindir[1]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <field name="anniManutenzione" y="53.024mm" x="48.545mm" w="17.187mm" h="6mm">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <assist>
                              <toolTip>Potenza termica  (sez 4.1)</toolTip>
                           </assist>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="prePrint" ref="$host" name="event__prePrint">
                              <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                           </event>
                           <event activity="initialize" name="event__initialize">
                              <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                           </event>
                           <bind match="dataRef" ref="$.L4_1manutenzioneAnni">
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </bind>
                           <format>
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </format>
                           <validate>
                              <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                           </validate>
                        </field>
                        <draw name="txtAnniManutenzione" x="5.477mm" y="53.024mm" w="40.439mm" h="6mm">
                           <value>
                              <text>Da manutenere ogni (anni)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="anniManutenzione[0]"/>
                           </traversal>
                           <?renderCache.bounds 114630 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 25 Da manutenere ogni (anni) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == 1 ){
	button.btAnnullaDismiss.presence = "visible";
	button.annullaDismiss.presence = "visible";
}else {
	button.btAnnullaDismiss.presence = "invisible";
	button.annullaDismiss.presence = "invisible";
}
</script>
                  </event>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori4_2" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaBR"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>4. GENERATORI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 13 4. GENERATORI 0 235995 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].tx_4_1[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="196.758mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezBR"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">4.2 BRUCIATORI<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt;font-weight:normal">(se non incorporati nel gruppo termico)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0].addRiga[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="invisible">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (rowBR.gt.numGruppoT.rawValue != null &amp;&amp; rowBR.datiGT.dataInstallaz.rawValue != null &amp;&amp; rowBR.datiGT.fabbricante.rawValue != null &amp;&amp; rowBR.datiGT.matricola.rawValue != null 
	&amp;&amp; rowBR.datiGT.modello.rawValue !=null &amp;&amp; rowBR.datiGT.portataTermicaMax.rawValue !=null ){ 
	rowBR.instanceManager.addInstance();


	var vIndex = _rowBR.count-1;
	var currentRow = schedaGeneratori4_2.generatori.resolveNode("rowBR["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo BR.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="rowBR[0].button[0].cancellaRiga[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="rowBR[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="rowBR">
                  <bind match="dataRef" ref="$.rowBR[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="invisible">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.754mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  rowBR.index;
var vRowCount = _rowBR.count;
	

if (vRowCount &gt; 1) {
	_rowBR.removeInstance(vIndex);
}else{
	gt.numGruppoT.rawValue = null;
	datiGT.dataInstallaz.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.combustibile.rawValue = null;
	datiGT.portataTermicaMax.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.tipologia.rawValue = null;
	datiGT.portataTermicaMin.rawValue = null;
	
	datiGT.flagSost.rawValue = 0;
	datiGT.flagDismiss.rawValue = 0;
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina BR corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="br[0].txflag1[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

gt.numGruppoT.access = "open";
datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.matricola.access = "open";
datiGT.tipologia.access = "open";
datiGT.combustibile.access = "open";

datiGT.portataTermicaMax.access = "open";
datiGT.portataTermicaMin.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";

this.presence = "hidden";
annullaDismiss.presence  = "hidden";
//01/12/2015
datiGT.dataDismiss.rawValue = null;
		

try{
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSostBR.index;
	var vRowCount = _rowSostBR.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = rowBR.resolveNode("rowSostBR["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}	
		
	}	
}catch(e){ null;}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="br[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="24.726mm" minH="11mm" layout="lr-tb" name="br">
                     <bind match="none"/>
                     <draw name="txflag1" w="23.917mm" h="6mm">
                        <value>
                           <text>Bruciatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numBruc[0]"/>
                        </traversal>
                        <?renderCache.bounds 67796 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 10 Bruciatore 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="numBruc" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>BR</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L4_2numBR"/>
                        <traversal>
                           <traverse ref="gt[0].txflag1[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _rowBR.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++)  {
				var vIdx =  rowBR.index;
			//xfa.host.messageBox("vIdx : "+vIdx );
				//var currentRow = generatori.resolveNode("rowBR["+ vIdx +"]");
				var currentRow = generatori.resolveNode("rowBR["+ nItemCount +"]");
				
				//currentRow.br.numBruc.rawValue  = vIdx +1;	
				var vNum = currentRow.br.numBruc.rawValue;		
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception rowBR.br.numBruc::initialize "+e)};	
}	
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="gt[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="39.429mm" name="gt">
                     <bind match="none"/>
                     <draw name="txflag1" w="38.62mm" h="6.209mm">
                        <value>
                           <text>Collegato al Gruppo Termico </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numGruppoT[0]"/>
                        </traversal>
                        <?renderCache.bounds 109474 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Collegato al Gruppo Termico  0 0 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="numGruppoT" w="27.702mm" h="5mm" x="4.246mm" y="6.209mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <caption reserve="5.504mm">
                           <value>
                              <text>GT</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_2numGT"/>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		this.clearItems(); 			
				
		//---------   ---------
		var vIndice = schedaGeneratori4_1.generatori.rowGT.index;
		var vRowCount = schedaGeneratori4_1.generatori._rowGT.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = schedaGeneratori4_1.generatori.rowGT.resolveNode("rowGT["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			var vGruppoT =  currentRow.gt.numGruppoT.rawValue;
			
			if (currentRow.datiGT.dataInstallaz.rawValue != null &amp;&amp; currentRow.datiGT.fabbricante.rawValue != null &amp;&amp; currentRow.datiGT.matricola.rawValue != null
				&amp;&amp; currentRow.datiGT.modello.rawValue != null &amp;&amp; currentRow.datiGT.potTermica.rawValue != null)			
			    this.addItem(vGruppoT);
				
		}

	}catch(e){null;}
</script>
                        </event>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null  &amp;&amp; (datiGT.fabbricante.rawValue != null || datiGT.modello.rawValue != null || datiGT.matricola.rawValue != null || datiGT.combustibile.rawValue != null || datiGT.dataInstallaz.rawValue != null
	|| datiGT.tipologia.rawValue != null || datiGT.portataTermicaMax.rawValue != null || datiGT.portataTermicaMin.rawValue != null) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>GT  (sez 4.2)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="128.195mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0].xindir[0]"/>
                     </traversal>
                     <?renderCache.bounds 363387 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="52.672mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.504mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null 
	|| tipologia.rawValue != null || portataTermicaMax.rawValue != null || portataTermicaMin.rawValue != null)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante  (sez 4.2)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
//qui
</script>
                        </event>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_2dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null 
	|| tipologia.rawValue != null || portataTermicaMax.rawValue != null || portataTermicaMin.rawValue != null  )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}else	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    } else{
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );    
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSostBR.index;
		var vRowCount = _rowSostBR.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = rowBR.resolveNode("rowSostBR["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione  (sez 4.2)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.504mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.581mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.581mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_2matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || dataInstallaz.rawValue != null || combustibile.rawValue != null 
	|| tipologia.rawValue != null || portataTermicaMax.rawValue != null || portataTermicaMin.rawValue != null)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Matricola  (sez 4.2)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                     </field>
                     <draw name="xindir" x="106.981mm" y="16.581mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Tipologia</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tipologia[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Tipologia 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="tipologia" y="16.581mm" w="60.659mm" h="6mm" x="125.179mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_2tipologia"/>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.478mm" y="25.073mm" w="19.006mm" h="6mm">
                        <value>
                           <text>Combustibile</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="combustibile[0]"/>
                        </traversal>
                        <?renderCache.bounds 53875 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 12 Combustibile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="combustibile" y="25.073mm" x="24.309mm" w="62.328mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="none"/>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on combustibile::init "+e);}

</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on combustibile::enter "+e);}
</script>
                        </event>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codCombu.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="codCombu[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="5.882mm" y="33.363mm" w="47.719mm" h="6mm">
                        <value>
                           <text>Portata termica max nominale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                        <?renderCache.bounds 135266 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Portata termica max nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="portataTermicaMax" y="33.161mm" x="53.398mm" w="17.187mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_2portataTermMaxNom"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null 
	|| tipologia.rawValue != null || dataInstallaz.rawValue != null || portataTermicaMin.rawValue != null)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Portata termica max  (sez 4.2)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="71.192mm" y="33.161mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="portataTermicaMin[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_2dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
}else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione  (sez 4.2)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[1]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.604mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.604mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_2modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null 
	|| tipologia.rawValue != null || portataTermicaMax.rawValue != null || portataTermicaMin.rawValue != null)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Modello  (sez 4.2)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="txcivico" x="107.386mm" y="33.463mm" w="44.282mm" h="6mm">
                        <value>
                           <text>Portata termica min nominale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                        <?renderCache.bounds 125524 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Portata termica min nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="portataTermicaMin" y="33.261mm" x="152.072mm" w="20.018mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_2portataTermMinNom"/>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="172.697mm" y="33.261mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="sostComp" y="44.382mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || gt.numGruppoT.rawValue == null ||
		  portataTermicaMax.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		portataTermicaMax.execEvent("validate");
		gt.numGruppoT.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSostBR.addInstance(true);
			
			newRow.datiGT.numGT.rawValue = gt.numGruppoT.rawValue;
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;
			newRow.datiGT.combustibile.rawValue = combustibile.rawValue;
			newRow.datiGT.codCombu.rawValue = combustibile.rawValue;
			newRow.datiGT.portataTermicaMax.rawValue = portataTermicaMax.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.tipologia.rawValue = tipologia.rawValue;
			newRow.datiGT.portataTermicaMin.rawValue = portataTermicaMin.rawValue;

//DA AGGIUNGERE
			_rowSostBR.moveInstance (newRow.index,0 );
			
//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;
			dataDismiss.rawValue = null;	
			//gt.numGruppoT.rawValue = null;
		
			flagSost.rawValue = "1";
			fabbricante.rawValue = null;
			matricola.rawValue = null;
			combustibile.rawValue = null;
			portataTermicaMax.rawValue = null;
			dataDismiss.rawValue = null;
			modello.rawValue = null;
			tipologia.rawValue = null;
			portataTermicaMin.rawValue = null;

			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSostBR.index;
			var vRowCount = _rowSostBR.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = rowBR.resolveNode("rowSostBR["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}	
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="44.382mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || gt.numGruppoT.rawValue == null ||
		  portataTermicaMax.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		portataTermicaMax.execEvent("validate");
		gt.numGruppoT.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){

			flagDismiss.rawValue = "1";
			
            gt.numGruppoT.access = "protected";
			dataInstallaz.access = "protected";
			fabbricante.access = "protected";
			matricola.access = "protected";
			combustibile.access = "protected";
			portataTermicaMax.access = "protected";
			dataDismiss.access = "protected";
			modello.access = "protected";
			tipologia.access = "protected";
			portataTermicaMin.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			try	{		
				// devo rendere invisibile il pulsante di RollBack della sostituzione
				var vIndice = rowSostBR.index;
				var vRowCount = _rowSostBR.count;			
		
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = rowBR.resolveNode("rowSostBR["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					if (flagDismiss.rawValue == 1  ) {
						//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
						currentRow.button.presence = "invisible";
					}	
				}			
			}catch(e){ null;}	
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                     </field>
                     <field name="flagSost" y="44.18mm" x="34.796mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="10.008mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_2fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <field name="codCombu" y="25.577mm" x="87.57mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_2combustibile"/>
                        <traversal>
                           <traverse ref="portataTermicaMax[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSostBR[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="44.585mm" x="138.525mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	gt.numGruppoT.access = "protected";
	flagDismiss.rawValue = "1";
	dataInstallaz.access = "protected";
	fabbricante.access = "protected";
	matricola.access = "protected";
	combustibile.access = "protected";
	portataTermicaMax.access = "protected";
	dataDismiss.access = "protected";
	modello.access = "protected";
	tipologia.access = "protected";
	portataTermicaMin.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}
	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSostBR.index;
		var vRowCount = _rowSostBR.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = rowBR.resolveNode("rowSostBR["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}		
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSostBR[0].button[0].annullaRiga[0]"/>
                        </traversal>
                     </field>
                     <field name="flagAnnullaDismiss" y="44.382mm" x="154.498mm" w="12.334mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="5.333mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagAnnullaDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 0 ) { 
	button.annullaDismiss.presence = "invisible";
}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagDismiss[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSostBR">
                     <bind match="dataRef" ref="$.sezBRsostituite.rowBRsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm" presence="invisible">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSostBR.index;
var vRowCount = _rowSostBR.count;

rowBR.datiGT.flagSost.rawValue = "0";

gt.numGruppoT.rawValue 				= 		datiGT.numGT.rawValue;
rowBR.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
rowBR.datiGT.fabbricante.rawValue =			datiGT.fabbricante.rawValue;
rowBR.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
rowBR.datiGT.codCombu.rawValue = 		datiGT.codCombu.rawValue;
rowBR.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
rowBR.datiGT.combustibile.rawValue =		datiGT.combustibile.rawValue;
rowBR.datiGT.portataTermicaMax.rawValue =	datiGT.portataTermicaMax.rawValue;
rowBR.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
rowBR.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
rowBR.datiGT.tipologia.rawValue = 			datiGT.tipologia.rawValue;
rowBR.datiGT.portataTermicaMin.rawValue = 	datiGT.portataTermicaMin.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSostBR["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo

//if (vRowCount &gt; 1) {
_rowSostBR.removeInstance(vIndex);
//}else{

//}	

</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="txflag1[0]"/>
                           </traversal>
                        </field>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">/*
if (datiGT.flagEditSez4_2.rawValue == "true")
	this.presence = "invisible";
*/
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( rowBR.datiGT.flagDismiss.rawValue == 1 ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0].numGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="40.341mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.291mm" x="24.281mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <items/>
                           <items save="1" presence="hidden"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_2dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="15.368mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="15.368mm" w="62.323mm" h="6mm" x="24.281mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_2matricola"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.478mm" y="22.647mm" w="19.006mm" h="6mm">
                           <value>
                              <text>Combustibile</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="combustibile[0]"/>
                           </traversal>
                           <?renderCache.bounds 53875 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 12 Combustibile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="combustibile" y="22.647mm" x="24.309mm" w="62.328mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on combustibile::init "+e);}
</script>
                           </event>
                           <bind match="none"/>
                           <items/>
                           <items save="1" presence="hidden"/>
                           <traversal>
                              <traverse ref="flagEditSez4_2[0]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_2dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.391mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.391mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_2modello"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.981mm" y="15.368mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Tipologia</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tipologia[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Tipologia 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="tipologia" y="15.368mm" w="60.659mm" h="6mm" x="125.179mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_2tipologia"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="5.679mm" y="31.443mm" w="56.616mm" h="6mm">
                           <value>
                              <text>Portata termica max nominale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                           <?renderCache.bounds 160486 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 28 Portata termica max nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="portataTermicaMax" y="31.241mm" x="62.295mm" w="17.187mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_2portataTermMaxNom"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="80.089mm" y="31.241mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="portataTermicaMin[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="107.183mm" y="31.543mm" w="53.178mm" h="6mm">
                           <value>
                              <text>Portata termica min nominale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <?renderCache.bounds 150741 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 28 Portata termica min nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="portataTermicaMin" y="31.341mm" x="161.17mm" w="20.018mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_2portataTermMinNom"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="181.795mm" y="31.341mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="numGT" y="1.113mm" w="16.378mm" h="6mm" x="61.891mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_2numGT"/>
                           <traversal>
                              <traverse ref="xindir[0]"/>
                           </traversal>
                        </field>
                        <field name="flagEditSez4_2" y="22.951mm" x="106.779mm" w="28mm" h="6mm" presence="invisible">
                           <ui>
                              <checkButton>
                                 <border>
                                    <?templateDesigner StyleID apcb2?>
                                    <edge stroke="lowered"/>
                                    <fill/>
                                 </border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>false</text>
                           </value>
                           <caption placement="right" reserve="21mm">
                              <para vAlign="middle"/>
                              <value>
                                 <text>Flag Edit Sez4_2</text>
                              </value>
                           </caption>
                           <items>
                              <text>true</text>
                              <text>false</text>
                           </items>
                           <bind match="dataRef" ref="$.flagRollBack4_2"/>
                           <traversal>
                              <traverse ref="codCombu[0]"/>
                           </traversal>
                        </field>
                        <field name="codCombu" y="23.759mm" x="88.176mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_2combustibile"/>
                           <traversal>
                              <traverse ref="portataTermicaMax[0]"/>
                           </traversal>
                        </field>
                        <field name="codFabbricante" y="8.19mm" x="87.772mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_2fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[1]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="numGT[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == 1 ){
	button.btAnnullaDismiss.presence = "visible";
	button.annullaDismiss.presence = "visible";
}else {
	button.btAnnullaDismiss.presence = "invisible";
	button.annullaDismiss.presence = "invisible";
}
</script>
                  </event>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori4_3" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaRC"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>4. GENERATORI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 13 4. GENERATORI 0 235995 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].tx_4_1[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="196.758mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezRC"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">4.3 RECUPERATORI / CONDENSATORI LATO FUMI<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt;font-weight:normal">(se non incorporati nel gruppo termico)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0].addRiga[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="invisible">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.gt.numGruppoT.rawValue != null &amp;&amp; row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null 
	&amp;&amp; row.datiGT.modello.rawValue !=null  &amp;&amp; row.datiGT.potenzaTermTotale.rawValue != null ){ 
	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = schedaGeneratori4_3.generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo RC.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowRC[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="invisible">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	

if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	gt.numGruppoT.rawValue = null;
	datiGT.dataInstallaz.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.potenzaTermTotale.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina RC corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0].txflag1[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
gt.numGruppoT.access = "open";
datiGT.flagDismiss.rawValue = "0";
datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.matricola.access = "open";
datiGT.potenzaTermTotale.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

//01/12/2015
datiGT.dataDismiss.rawValue = null;
try{
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
	
		//01/12/2015
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";	
		}	
	}	
}catch(e){ null;}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="24.726mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="0.973458in" h="6.209mm">
                        <value>
                           <text>Recuperatore / Condensatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 70089 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 15 Recuperatore /  0 2835 6654 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?>
                        <?renderCache.textRun 12 Condensatore 0 2835 15054 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>RC</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L4_3numRC"/>
                        <traversal>
                           <traverse ref="gt[0].txflag1[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="gt[0]"/>
                     </traversal>
                  </subform>
                  <subform w="39.429mm" name="gt">
                     <bind match="none"/>
                     <draw name="txflag1" w="38.62mm" h="6.209mm">
                        <value>
                           <text>Collegato al Gruppo Termico </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numGruppoT[0]"/>
                        </traversal>
                        <?renderCache.bounds 109474 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Collegato al Gruppo Termico  0 0 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="numGruppoT" w="27.702mm" h="5mm" x="4.246mm" y="6.209mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <caption reserve="5.504mm">
                           <value>
                              <text>GT</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_3numGT"/>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		this.clearItems(); 			
				
		//---------   ---------
		var vIndice = schedaGeneratori4_1.generatori.rowGT.index;
		var vRowCount = schedaGeneratori4_1.generatori._rowGT.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = schedaGeneratori4_1.generatori.rowGT.resolveNode("rowGT["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			var vGruppoT =  currentRow.gt.numGruppoT.rawValue;
			
			if (currentRow.datiGT.dataInstallaz.rawValue != null &amp;&amp; currentRow.datiGT.fabbricante.rawValue != null &amp;&amp; currentRow.datiGT.matricola.rawValue != null
				&amp;&amp; currentRow.datiGT.modello.rawValue != null &amp;&amp; currentRow.datiGT.potTermica.rawValue != null)			
			    this.addItem(vGruppoT);
				
		}

	}catch(e){null;}
</script>
                        </event>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null  &amp;&amp; (datiGT.fabbricante.rawValue != null || datiGT.modello.rawValue != null || datiGT.matricola.rawValue != null || datiGT.dataInstallaz.rawValue != null
	|| datiGT.potenzaTermTotale.rawValue != null ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>GT  (sez 4.3)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="esercizio2[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="128.195mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0].xindir[0]"/>
                     </traversal>
                     <?renderCache.bounds 363387 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="38.922mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.504mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || potenzaTermTotale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante  (sez 4.3)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}

</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_3dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || potenzaTermTotale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}else if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }else{
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );    
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data Installazione  (sez 4.3)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.504mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.581mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.581mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_3matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || dataInstallaz.rawValue != null || potenzaTermTotale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Matricola  (sez 4.3)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_3dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
}else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}		
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione  (sez 4.3)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[1]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.604mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.604mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_3modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || matricola.rawValue != null || potenzaTermTotale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Modello  (sez 4.3)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="txcivico" x="107.386mm" y="16.581mm" w="45.874mm" h="6mm">
                        <value>
                           <text>Potenza termica nominale totale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaTermTotale[0]"/>
                        </traversal>
                        <?renderCache.bounds 130037 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 31 Potenza termica nominale totale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potenzaTermTotale" y="16.581mm" x="154.296mm" w="20.018mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_3potTermNomTot"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || dataInstallaz.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Potenza termica nominale  (sez 4.3)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="174.921mm" y="16.581mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="sostComp" y="29.419mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || gt.numGruppoT.rawValue == null ||
		  potenzaTermTotale.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potenzaTermTotale.execEvent("validate");
		gt.numGruppoT.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.numGT.rawValue = gt.numGruppoT.rawValue;
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.potenzaTermTotale.rawValue = potenzaTermTotale.rawValue;

//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;
			//gt.numGruppoT.rawValue = null;
			
			fabbricante.rawValue = null;
			matricola.rawValue = null;
			dataDismiss.rawValue = null;
			modello.rawValue = null;
			potenzaTermTotale.rawValue = null;
			
			flagSost.rawValue = "1";

			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}

		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="29.419mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || gt.numGruppoT.rawValue == null ||
		  potenzaTermTotale.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potenzaTermTotale.execEvent("validate");
		gt.numGruppoT.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){	

			gt.numGruppoT.access = "protected";
			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			fabbricante.access = "protected";
			matricola.access = "protected";
			dataDismiss.access = "protected";
			modello.access = "protected";
			potenzaTermTotale.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";
			
			try	{		
				// devo rendere invisibile il pulsante di RollBack della sostituzione
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
		
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					
					
					if (flagDismiss.rawValue == 1  ) {
						//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
						currentRow.button.presence = "invisible";
					}	
				}			
			}catch(e){ null;}
			
		}	
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="29.622mm" x="34.998mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="rowSost[0].button[0].annullaRiga[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.806mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_3fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="29.824mm" x="138.322mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	gt.numGruppoT.access = "protected";
	flagDismiss.rawValue = "1";
	dataInstallaz.access = "protected";
	fabbricante.access = "protected";
	matricola.access = "protected";
	dataDismiss.access = "protected";
	modello.access = "protected";
	potenzaTermTotale.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}
	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}		
}
</script>
                        </event>
                     </field>
                     <field name="flagAnnullaDismiss" y="29.621mm" x="154.295mm" w="12.334mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="5.333mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagAnnullaDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 0 ) { 
	button.annullaDismiss.presence = "invisible";
}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagDismiss[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost">
                     <bind match="dataRef" ref="$.sezRCsostituite.rowRCsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">

var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";

gt.numGruppoT.rawValue =				datiGT.numGT.rawValue;
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
row.datiGT.potenzaTermTotale.rawValue =	datiGT.potenzaTermTotale.rawValue;

//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="esercizio2[0]"/>
                           </traversal>
                        </field>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
/*
if (datiGT.flagEditSez4_3.rawValue == "true")
	this.presence = "invisible";
*/
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == 1 ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0].xindir[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="24.974mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.291mm" x="24.281mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <items/>
                           <items save="1" presence="hidden"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_3dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="15.368mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="15.368mm" w="62.323mm" h="6mm" x="24.281mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_3matricola"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_3dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="numGT[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.391mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.391mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_3modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="106.981mm" y="15.368mm" w="45.874mm" h="6mm">
                           <value>
                              <text>Potenza termica nominale totale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaTermTotale[0]"/>
                           </traversal>
                           <?renderCache.bounds 130037 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 31 Potenza termica nominale totale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potenzaTermTotale" y="15.368mm" x="153.891mm" w="20.018mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_3potTermNomTot"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="174.516mm" y="15.368mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagEditSez4_3[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="numGT" y="1.518mm" w="16.378mm" h="6mm" x="59.262mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_3numGT"/>
                           <traversal>
                              <traverse ref="xindir[1]"/>
                           </traversal>
                        </field>
                        <field name="flagEditSez4_3" y="18.908mm" x="81.302mm" w="28mm" h="6mm" presence="invisible">
                           <ui>
                              <checkButton>
                                 <border>
                                    <?templateDesigner StyleID apcb2?>
                                    <edge stroke="lowered"/>
                                    <fill/>
                                 </border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>false</text>
                           </value>
                           <caption placement="right" reserve="21mm">
                              <para vAlign="middle"/>
                              <value>
                                 <text>Flag Edit Sez4_3</text>
                              </value>
                           </caption>
                           <items>
                              <text>true</text>
                              <text>false</text>
                           </items>
                           <bind match="dataRef" ref="$.flagRollBack4_3"/>
                        </field>
                        <field name="codFabbricante" y="8.595mm" x="87.772mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_3fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == 1 ){
	button.btAnnullaDismiss.presence = "visible";
	button.annullaDismiss.presence = "visible";
}else {
	button.btAnnullaDismiss.presence = "invisible";
	button.annullaDismiss.presence = "invisible";
}
</script>
                  </event>
                  <?templateDesigner expand 0?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori4_4" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaGF"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>4. GENERATORI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 13 4. GENERATORI 0 235995 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].tx_4_1[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="196.758mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezGF"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>4.4 MACCHINE FRIGORIFERE / POMPE DI CALORE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0].addRiga[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="invisible">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null 
	&amp;&amp; row.datiGT.potFrigoNom.rawValue != null ){ 

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo GF.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowGF[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="invisible">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;

if (datiGT.L4_4dataControllo.rawValue != null) {
	xfa.host.messageBox("Non è possibile cancellare se la data controllo è stata valorizzata.");
}	else{
	
//DA AGGIUNGERE2
//rimosso la cancellazione della riga intera dalla seconda riga in avanti
/*	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
*/	//gt.numGruppoT.rawValue = "";
	datiGT.dataInstallaz.rawValue = null;
	datiGT.L4_4dataControllo.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.flagAriaSorg.rawValue = "0";
	datiGT.flagAcquaSorg.rawValue = "0";
	datiGT.fluidoFrogorige.rawValue = "";
	datiGT.flagAriaFluido.rawValue = "0";
	datiGT.flagAcquaFluido.rawValue = "0";
	datiGT.flagAssorbRec.rawValue = "0";
	datiGT.flagAssorbFiamma.rawValue = "0";
	datiGT.combustibile.rawValue = null;
	datiGT.flagCicloCompre.rawValue = "0";
	datiGT.circuiti.rawValue = null;
	datiGT.raffrescam.rawValue = null;
	datiGT.potFrigoNom.rawValue = null;
	datiGT.potFrigoAssorbNom.rawValue = null;
	datiGT.riscaldam.rawValue = null;
	datiGT.potTermNom.rawValue = null;
	datiGT.potTermAssorbNom.rawValue = null;
	

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
	
//}	
}
</script>
                        </event>
                        <assist>
                           <toolTip>Elimina GF corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (datiGT.L4_4dataControllo.rawValue != null &amp;&amp; datiGT.dataInstallaz.rawValue &lt;= datiGT.L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0].txflag1[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";
datiGT.dataDismiss.access = "open";
datiGT.sostComp.access = "open";

if (datiGT.L4_4dataControllo.rawValue == null || datiGT.dataInstallaz.rawValue &gt; datiGT.L4_4dataControllo.rawValue ){
	datiGT.dataInstallaz.access = "open";
	
	datiGT.fabbricante.access = "open";
	datiGT.modello.access = "open";
	datiGT.matricola.access = "open";
	datiGT.flagAriaSorg.access = "open";
	datiGT.flagAcquaSorg.access = "open";
	datiGT.fluidoFrogorige.access = "open";
	datiGT.flagAriaFluido.access = "open";
	datiGT.flagAcquaFluido.access = "open";
	datiGT.flagAssorbRec.access = "open";
	datiGT.flagAssorbFiamma.access = "open";
	
	if (datiGT.flagAssorbFiamma.rawValue == 1)
		datiGT.combustibile.access = "open";
		
	datiGT.flagCicloCompre.access = "open";
	datiGT.circuiti.access = "open";
	datiGT.raffrescam.access = "open";
	datiGT.potFrigoNom.access = "open";
	datiGT.potFrigoAssorbNom.access = "open";
	datiGT.riscaldam.access = "open";
	datiGT.potTermNom.access = "open";
	datiGT.potTermAssorbNom.access = "open";
	
	
	datiGT.sostComp.access = "open";
	datiGT.dismissComp.access = "open";
	button.btCancella.access = "open";
}
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

//01/12/2015
datiGT.dataDismiss.rawValue = null;
try{
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;

//DA AGGIUNGERE		
	/*	if (currentRow.datiGT.flagEditSez4_1.rawValue != "true" ) {
			//xfa.host.messageBox("[currentRow.datiGT.flagEditSez4_1.rawValue ?? "+currentRow.datiGT.flagEditSez4_1.rawValue);		
			currentRow.button.presence = "visible";
		}	*/

		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}	
	}	
}catch(e){ null;}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "Bozza")*/
	this.presence = "invisible";

/*	
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == 1 ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Gruppo Frigo / Pompa di calore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Gruppo Frigo / Pompa di calore 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>GF</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L4_4numGF"/>
                        <traversal>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0].nota[0].nota[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="82.652mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="8.997mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || fluidoFrogorige.rawValue != null || flagAriaSorg.rawValue != 0 ||
	flagAcquaSorg.rawValue != 0 || flagAriaFluido.rawValue != 0 || flagAcquaFluido.rawValue != 0 || flagAssorbRec.rawValue != 0 || flagAssorbFiamma.rawValue != 0 
	|| flagCicloCompre.rawValue != 0 || raffrescam.rawValue != null || potFrigoNom.rawValue != null || potFrigoAssorbNom.rawValue != null || riscaldam.rawValue != null 
	|| potTermNom.rawValue != null  || potTermAssorbNom.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
		
		if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
			this.access = "protected";
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante (sez 4.4)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null  &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || fluidoFrogorige.rawValue != null || flagAriaSorg.rawValue != 0 ||
	flagAcquaSorg.rawValue != 0 || flagAriaFluido.rawValue != 0 || flagAcquaFluido.rawValue != 0 || flagAssorbRec.rawValue != 0 || flagAssorbFiamma.rawValue != 0 
	|| flagCicloCompre.rawValue != 0 || raffrescam.rawValue != null || potFrigoNom.rawValue != null || potFrigoAssorbNom.rawValue != null || riscaldam.rawValue != null 
	|| potTermNom.rawValue != null  || potTermAssorbNom.rawValue != null 	)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
	
//DA AGGIUNGERE2
} else  if (this.rawValue == "" || this.rawValue == null ) {

	var vRowCount = _rowSost.count;
	if (vRowCount &gt; 0){
		var firstRow = row.resolveNode("rowSost["+ 0 +"]");	
		if ( firstRow.datiGT.dataInstallaz.rawValue != null &amp;&amp; firstRow.datiGT.dataInstallaz.rawValue != "" ) {
		    VALIDATION_MSG = "Campo obbligatorio."+'\n'	+"In presenza di componenti sostituiti è necessario compilare la sezione.";
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );			
		}	
	}	
	
} else {	

//DA AGGIUNGERE2
//----------------------------------------------------------------------------
	if (this.rawValue != null || this.rawValue != "" ) {
		
			var vValueSave =  this.rawValue;
			//--------- controllo data installazione e ultima dismissione o sostituzione ---------
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
	
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { 
					//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
					break;
				}	
			}

			var sObj = this.parent.name+"."+ this.name;
			var oField = xfa.resolveNode(sObj);
				
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
				var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
				//xfa.host.messageBox(VALIDATION_MSG);			
				controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
			} else {
				controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
			} 
	}else 
//----------------------------------------------------------------------------	
		if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
			var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data installazione non è corretto.";	
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}
	else if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    /*} else if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_4dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true") {
		var VALIDATION_MSG = "Errore!"+'\n'
			+"La data installazione e' inferiore a quella del rapporto di controllo.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    */
    } else {
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
    }	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 4.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="xindir" x="5.276mm" y="8.997mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="15.872mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="15.872mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || dataInstallaz.rawValue != null || fluidoFrogorige.rawValue != null || flagAriaSorg.rawValue != 0 ||
	flagAcquaSorg.rawValue != 0 || flagAriaFluido.rawValue != 0 || flagAcquaFluido.rawValue != 0 || flagAssorbRec.rawValue != 0 || flagAssorbFiamma.rawValue != 0 
	|| flagCicloCompre.rawValue != 0 || raffrescam.rawValue != null || potFrigoNom.rawValue != null || potFrigoAssorbNom.rawValue != null || riscaldam.rawValue != null 
	|| potTermNom.rawValue != null  || potTermAssorbNom.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Matricola (sez 4.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="xindir" x="5.478mm" y="22.948mm" w="24.78mm" h="6mm">
                        <value>
                           <text>Fluido frigorigeno</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fluidoFrogorige[0]"/>
                        </traversal>
                        <?renderCache.bounds 70243 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 18 Fluido frigorigeno 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="5.478mm" y="53.077mm" w="25.477mm" h="6mm">
                        <value>
                           <text>Raffrescamento</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potFrigoAssorbNom[0]"/>
                        </traversal>
                        <?renderCache.bounds 72218 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 14 Raffrescamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="raffrescam" y="53.076mm" x="48.856mm" w="18.6mm" h="6mm">
                        <ui>
                           <numericEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5" fracDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="potFrigoNom[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L4_4raffrescam"/>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
}else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
    if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_4dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true")  {
		var VALIDATION_MSG = "Errore!"+'\n'+"Esiste un legame tra il componente ed il rapporto di controllo.";
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    
    } else {
        controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);

		if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
		else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
			var VALIDATION_MSG = "Errore!"+'\n' +"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
		}
		
	}	
}
</script>
                           <picture>date{DD/MM/YYYY}</picture>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 4.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[1]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.097mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.097mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || matricola.rawValue != null || fluidoFrogorige.rawValue != null || flagAriaSorg.rawValue != 0 ||
	flagAcquaSorg.rawValue != 0 || flagAriaFluido.rawValue != 0 || flagAcquaFluido.rawValue != 0 || flagAssorbRec.rawValue != 0 || flagAssorbFiamma.rawValue != 0 
	|| flagCicloCompre.rawValue != 0 || raffrescam.rawValue != null || potFrigoNom.rawValue != null || potFrigoAssorbNom.rawValue != null || riscaldam.rawValue != null 
	|| potTermNom.rawValue != null  || potTermAssorbNom.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Modello (sez 4.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="xindir" x="107.184mm" y="15.872mm" w="30.793mm" h="6mm">
                        <value>
                           <text>Sorgente lato esterno</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagAriaSorg[0]"/>
                        </traversal>
                        <?renderCache.bounds 87287 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 21 Sorgente lato esterno 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagAriaSorg" w="5.577mm" h="6mm" x="139.94mm" y="15.872mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_4flagSorgARIA"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAcquaSorg.rawValue = "0";

}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="sostComp" y="75.521mm" x="60.534mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null || modello.rawValue == null || potFrigoNom.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
//30/11/2015
}else if (L4_4dataControllo.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; L4_4dataControllo.rawValue)){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore alla data di controllo!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potFrigoNom.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.L4_4dataControllo.rawValue = L4_4dataControllo.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.codCombu.rawValue = combustibile.rawValue;			
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;			
			newRow.datiGT.flagAriaSorg.rawValue = flagAriaSorg.rawValue;
			newRow.datiGT.flagAcquaSorg.rawValue = flagAcquaSorg.rawValue;
			newRow.datiGT.fluidoFrogorige.rawValue = fluidoFrogorige.rawValue;			
			newRow.datiGT.flagAriaFluido.rawValue = flagAriaFluido.rawValue;
			newRow.datiGT.flagAcquaFluido.rawValue = flagAcquaFluido.rawValue;			
			newRow.datiGT.flagAssorbRec.rawValue = flagAssorbRec.rawValue;
			newRow.datiGT.flagAssorbFiamma.rawValue = flagAssorbFiamma.rawValue;
			newRow.datiGT.combustibile.rawValue = combustibile.rawValue;
			newRow.datiGT.flagCicloCompre.rawValue = flagCicloCompre.rawValue;

			newRow.datiGT.circuiti.rawValue = circuiti.rawValue;
			newRow.datiGT.raffrescam.rawValue = raffrescam.rawValue;
			newRow.datiGT.potFrigoNom.rawValue = potFrigoNom.rawValue;
			newRow.datiGT.potFrigoAssorbNom.rawValue = potFrigoAssorbNom.rawValue;
			newRow.datiGT.riscaldam.rawValue = riscaldam.rawValue;
			newRow.datiGT.potTermNom.rawValue = potTermNom.rawValue;
			newRow.datiGT.potTermAssorbNom.rawValue = potTermAssorbNom.rawValue;
			
//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();

			L4_4dataControllo.rawValue = null;
			dataDismiss.rawValue = null;			
			fabbricante.rawValue = null;
			modello.rawValue = null;
			matricola.rawValue = null;
			flagAriaSorg.rawValue = "0";
			flagAcquaSorg.rawValue = "0";
			fluidoFrogorige.rawValue = null;
			flagAriaFluido.rawValue = "0";
			flagAcquaFluido.rawValue = "0";

			flagAssorbRec.rawValue = "0";
			flagAssorbFiamma.rawValue = "0";
			combustibile.rawValue = null;
			flagCicloCompre.rawValue = "0";
			circuiti.rawValue = null;
			raffrescam.rawValue = null;
			potFrigoNom.rawValue = null;
			potFrigoAssorbNom.rawValue = null;
			riscaldam.rawValue = null;
			potTermNom.rawValue = null;
			potTermAssorbNom.rawValue = null;
			
			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			
			//if (L4_4dataControllo.rawValue == null || datiGT.dataInstallaz.rawValue &gt; L4_4dataControllo.rawValue){

				dataInstallaz.access = "open";
				fabbricante.access = "open";
				modello.access = "open";
				matricola.access = "open";
				flagAriaSorg.access = "open";
				flagAcquaSorg.access = "open";
				fluidoFrogorige.access = "open";
				flagAriaFluido.access = "open";
				flagAcquaFluido.access = "open";
				flagAssorbRec.access = "open";
				flagAssorbFiamma.access = "open";
				if (flagAssorbFiamma.rawValue == 1)
					combustibile.access = "open";
				flagCicloCompre.access = "open";
				circuiti.access = "open";
				raffrescam.access = "open";
				potFrigoNom.access = "open";
				potFrigoAssorbNom.access = "open";
				riscaldam.access = "open";
				potTermNom.access = "open";
				potTermAssorbNom.access = "open";	
			//}
				//DA AGGIUNGERE	
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
			
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					if (vIndex == 0){
						currentRow.button.presence = "visible";
					}else{
						currentRow.button.presence = "invisible";		
					}	
				}	
				
						
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="75.521mm" x="99.76mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null || modello.rawValue == null || potFrigoNom.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
//30/11/2015
}else if (L4_4dataControllo.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; L4_4dataControllo.rawValue)){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore alla data di controllo!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potFrigoNom.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){	

			dataInstallaz.access = "protected";
			flagDismiss.rawValue = "1";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			matricola.access = "protected";
			flagAriaSorg.access = "protected";
			flagAcquaSorg.access = "protected";
			fluidoFrogorige.access = "protected";
			flagAriaFluido.access = "protected";
			flagAcquaFluido.access = "protected";
			flagAssorbRec.access = "protected";
			flagAssorbFiamma.access = "protected";
			combustibile.access = "protected";
			flagCicloCompre.access = "protected";
			circuiti.access = "protected";
			raffrescam.access = "protected";
			potFrigoNom.access = "protected";
			potFrigoAssorbNom.access = "protected";
			riscaldam.access = "protected";
			potTermNom.access = "protected";
			potTermAssorbNom.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";
			
			try	{		
				// devo rendere invisibile il pulsante di RollBack della sostituzione
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
		
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					
					
					if (flagDismiss.rawValue == 1  ) {
						//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
						currentRow.button.presence = "invisible";
					}	
				}			
			}catch(e){ null;}	

	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0].button[0].annullaRiga[0]"/>
                        </traversal>
                     </field>
                     <draw name="Rectangle6" w="197.163mm" h="1.315mm" x="0.018mm" y="66.624mm">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <draw name="txcivico" x="146.41mm" y="15.872mm" w="7.024mm" h="6mm">
                        <value>
                           <text>Aria</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagAcquaSorg[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 Aria 0 2014 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagAcquaSorg" w="5.577mm" h="6mm" x="155.914mm" y="15.872mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_4flagSorgACQUA"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAriaSorg.rawValue = "0";

}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="162.384mm" y="15.872mm" w="8.639mm" h="6mm">
                        <value>
                           <text>Acqua</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <?renderCache.bounds 24489 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 Acqua 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="107.184mm" y="22.948mm" w="30.793mm" h="6mm">
                        <value>
                           <text>Fluido lato utenze</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagAriaFluido[0]"/>
                        </traversal>
                        <?renderCache.bounds 87287 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 18 Fluido lato utenze 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagAriaFluido" w="5.577mm" h="6mm" x="139.94mm" y="22.948mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_4flagFluidoARIA"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAcquaFluido.rawValue = "0";

}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="146.41mm" y="22.948mm" w="7.024mm" h="6mm">
                        <value>
                           <text>Aria</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagAcquaFluido[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 Aria 0 2014 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagAcquaFluido" w="5.577mm" h="6mm" x="155.914mm" y="22.948mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_4flagFluidoACQUA"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAriaFluido.rawValue = "0";

}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[4]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="162.384mm" y="22.948mm" w="8.639mm" h="6mm">
                        <value>
                           <text>Acqua</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagAssorbRec[0]"/>
                        </traversal>
                        <?renderCache.bounds 24489 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 Acqua 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="fluidoFrogorige" y="22.948mm" w="55.807mm" h="6mm" x="30.752mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4fluidoFrigo"/>
                        <traversal>
                           <traverse ref="xindir[7]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="5.478mm" y="32.25mm" w="6.267mm" h="6.672mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                           <corner/>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="codCombu[0]"/>
                        </traversal>
                        <?renderCache.bounds 17765 18913 0 0 0 0 0 0?></draw>
                     <field name="flagAssorbRec" w="5.577mm" h="6mm" x="13.363mm" y="29.419mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_4flagRecupCalore"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAssorbFiamma.rawValue = "0";
	flagCicloCompre.rawValue = "0";
	combustibile.rawValue = "";
	combustibile.access = "protected";
}
</script>
                        </event>
                        <assist>
                           <toolTip>La voce Ad assorbimento per recupero di calore deve essere barrata anche nel caso di recupero dai fumi di&#xD;impianti di cogenerazione</toolTip>
                           <speak priority="toolTip"/>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[8]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="flagAssorbFiamma" w="5.577mm" h="6mm" x="13.364mm" y="35.89mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_4flagFiammaDiretta"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAssorbRec.rawValue = "0";
	flagCicloCompre.rawValue = "0";
	combustibile.access = "open";
}else{
	combustibile.rawValue = "";
	combustibile.access = "protected";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="combustibile[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
	
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1" &amp;&amp; this.access != "protected") {
	combustibile.access = "open";
}
</script>
                        </event>
                     </field>
                     <field name="flagCicloCompre" w="5.577mm" h="6mm" x="13.363mm" y="42.562mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L4_4flagCicloCompress"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAssorbRec.rawValue = "0";
	flagAssorbFiamma.rawValue = "0";
	combustibile.rawValue = "";
	combustibile.access = "protected";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[10]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="5.477mm" y="39.327mm" w="6.267mm" h="6.672mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge presence="hidden">
                              <color value="128,128,128"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner presence="hidden">
                              <color value="128,128,128"/>
                           </corner>
                           <corner/>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="flagCicloCompre[0]"/>
                        </traversal>
                        <?renderCache.bounds 17765 18913 0 0 0 0 0 0?></draw>
                     <draw name="txcivico" x="5.477mm" y="46mm" w="29.724mm" h="3.842mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge presence="hidden">
                              <color value="128,128,128"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <edge>
                              <color value="128,128,128"/>
                           </edge>
                           <corner presence="hidden">
                              <color value="128,128,128"/>
                           </corner>
                           <corner/>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                           <corner>
                              <color value="128,128,128"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="xindir[8]"/>
                        </traversal>
                        <?renderCache.bounds 84257 10891 0 0 0 0 0 0?></draw>
                     <draw name="xindir" x="36.414mm" y="47.011mm" w="15.165mm" h="5.459mm">
                        <value>
                           <text>circuiti n°</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="circuiti[0]"/>
                        </traversal>
                        <?renderCache.bounds 42987 15474 0 0 0 0 0 0?>
                        <?renderCache.textRun 12 circuiti n° 0 0 10085 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="circuiti" y="47.011mm" x="52.388mm" w="5.662mm" h="5.257mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4numCircuiti">
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </bind>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ((this.rawValue == null || this.rawValue == 0 || this.rawValue &lt; 0) &amp;&amp; (flagAssorbRec.rawValue == 1 || flagAssorbFiamma.rawValue == 1 || flagCicloCompre.rawValue ==1)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue == 0 || this.rawValue &lt; 0){	
	var VALIDATION_MSG = "Errore!"+'\n'
					+"Puo' contenere solo valori maggiori di zero.";
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <traversal>
                           <traverse ref="raffrescam[0]"/>
                        </traversal>
                        <format>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </format>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="19.833mm" y="29.824mm" w="56.616mm" h="6mm">
                        <value>
                           <text>Ad assorbimento per recupero calore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[5]"/>
                        </traversal>
                        <?renderCache.bounds 160486 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 35 Ad assorbimento per recupero calore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="19.833mm" y="36.092mm" w="73.231mm" h="6mm">
                        <value>
                           <text>Ad assorbimento a fiamma diretta con combustibile</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[6]"/>
                        </traversal>
                        <?renderCache.bounds 207584 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 49 Ad assorbimento a fiamma diretta con combustibile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="19.631mm" y="43.169mm" w="84.083mm" h="4.044mm">
                        <value>
                           <text>A ciclo di compressione con motore elettrico o endotermico</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[7]"/>
                        </traversal>
                        <?renderCache.bounds 238346 11463 0 0 0 0 0 0?>
                        <?renderCache.textRun 58 A ciclo di compressione con motore elettrico o endotermico 0 0 8079 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="31.856mm" y="53.279mm" w="0.662931in" h="5.661mm">
                        <value>
                           <text>EER(o GUE)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[13]"/>
                        </traversal>
                        <?renderCache.bounds 47731 16047 0 0 0 0 0 0?>
                        <?renderCache.textRun 10 EER(o GUE) 0 0 10371 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="5.477mm" y="59.345mm" w="25.477mm" h="6mm">
                        <value>
                           <text>Riscaldamento</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="riscaldam[0]"/>
                        </traversal>
                        <?renderCache.bounds 72218 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 13 Riscaldamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="31.856mm" y="59.547mm" w="9.504mm" h="5.661mm">
                        <value>
                           <text>COP (</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[11]"/>
                        </traversal>
                        <?renderCache.bounds 26940 16047 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 COP ( 0 0 10371 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="simbolo" y="60.962mm" x="40.356mm" w="5.055mm" h="3.438mm">
                        <value>
                           <image contentType="image/png">iVBORw0KGgoAAAANSUhEUgAAACUAAAAXCAIAAAADThHyAAAAAXNSR0IArs4c6QAAAARnQU1BAACx
jwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAChSURBVEhL7ZVdCoAwDIN3SdH7X2QKk9o1+8kK
GwgTHxTSfUmpNcS1V1iLi5Z3XofcjJWiuHFCxtOw9NxGikCLzSHmhI+HgC4SedpiMWXGwzTtiIaH
YnT88mpRuhGTRb5887pT+od+Jo+j8yn64Xkp9oQcTk8/9ViPrjQ/Tyr5ZM7vj1nNDo3x/bzO/R9V
95nDO1OyeUyXeM3qfqKzufOJvBsIzPMA4+354QAAAABJRU5ErkJggg==</image>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <desc>
                           <text name="embeddedHref">..\resources\simbolo.png</text>
                        </desc>
                        <traversal>
                           <traverse ref="flagGiaPresenteDB[0]"/>
                        </traversal>
                     </draw>
                     <draw name="xindir" x="44.856mm" y="59.547mm" w="3.437mm" h="5.661mm">
                        <value>
                           <text>)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[14]"/>
                        </traversal>
                        <?renderCache.bounds 9743 16047 0 0 0 0 0 0?>
                        <?renderCache.textRun 1 ) 0 0 10371 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="riscaldam" y="59.345mm" x="48.856mm" w="18.6mm" h="6mm">
                        <ui>
                           <numericEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal fracDigits="4" leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="potTermNom[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L4_4riscaldam"/>
                     </field>
                     <draw name="txcivico" x="67.656mm" y="53.28mm" w="40.5mm" h="6mm">
                        <value>
                           <text>Potenza frigorifera nominale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="notaEER[0]"/>
                        </traversal>
                        <?renderCache.bounds 114803 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Potenza frigorifera nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potFrigoNom" y="53.279mm" x="108.056mm" w="16.7mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4potFrigoNom"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || fluidoFrogorige.rawValue != null || flagAriaSorg.rawValue != 0 ||
	flagAcquaSorg.rawValue != 0 || flagAriaFluido.rawValue != 0 || flagAcquaFluido.rawValue != 0 || flagAssorbRec.rawValue != 0 || flagAssorbFiamma.rawValue != 0 
	|| flagCicloCompre.rawValue != 0 || raffrescam.rawValue != null || dataInstallaz.rawValue != null || potFrigoAssorbNom.rawValue != null || riscaldam.rawValue != null 
	|| potTermNom.rawValue != null  || potTermAssorbNom.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Potenza frigorifera nominale (sez 4.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="125.036mm" y="53.279mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="txcivico[12]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="67.656mm" y="59.548mm" w="41.046mm" h="6mm">
                        <value>
                           <text>Potenza termica nominale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[15]"/>
                        </traversal>
                        <?renderCache.bounds 116351 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 24 Potenza termica nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potTermNom" y="59.548mm" x="108.056mm" w="16.7mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4potTermNom"/>
                        <traversal>
                           <traverse ref="txcivico[18]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="125.036mm" y="59.548mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="notaCOP[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="133.056mm" y="53.078mm" w="39.5mm" h="6mm">
                        <value>
                           <text>Potenza assorbita nominale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[9]"/>
                        </traversal>
                        <?renderCache.bounds 111969 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 26 Potenza assorbita nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potFrigoAssorbNom" y="53.077mm" x="172.756mm" w="16.7mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4potFrigoAssorb"/>
                        <traversal>
                           <traverse ref="txcivico[17]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="189.479mm" y="53.077mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="txcivico[16]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="133.056mm" y="59.346mm" w="39.5mm" h="6mm">
                        <value>
                           <text>Potenza assorbita nominale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="potTermAssorbNom[0]"/>
                        </traversal>
                        <?renderCache.bounds 111969 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 26 Potenza assorbita nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potTermAssorbNom" y="59.346mm" x="172.756mm" w="16.7mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4potTermAssorb"/>
                        <traversal>
                           <traverse ref="txcivico[19]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="189.682mm" y="59.346mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[10]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="notaEER" y="53.481mm" x="27.73mm" w="5.257mm" h="4.65mm" presence="invisible">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
xfa.host.messageBox("EER: Indicare i valori nominali come da UNI EN 14511. Qualora i dati non fossero disponibili indicare ND\n"+
					"GUE: Indicare i valori nominali come da UNI EN 12309-2.");
</script>
                        </event>
                        <traversal>
                           <traverse ref="imgERR[0]"/>
                        </traversal>
                     </field>
                     <draw name="imgERR" y="53.885mm" x="27.73mm" w="5.055mm" h="4.044mm" presence="invisible">
                        <value>
                           <image href="..\resources\comment.png" contentType="image/png"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <traversal>
                           <traverse ref="notaPOT[0]"/>
                        </traversal>
                     </draw>
                     <field name="notaCOP" y="60.154mm" x="27.73mm" w="5.257mm" h="4.65mm" presence="invisible">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
xfa.host.messageBox("COP: Indicare i valori nominali come da UNI EN 14511. Qualora i dati non fossero disponibili indicare ND\n"+
					"?: Indicare i valori nominali come da UNI EN 12309-2.");
</script>
                        </event>
                        <traversal>
                           <traverse ref="imgCOP[0]"/>
                        </traversal>
                     </field>
                     <draw name="imgCOP" y="60.558mm" x="27.73mm" w="5.055mm" h="4.044mm" presence="invisible">
                        <value>
                           <image href="..\resources\comment.png" contentType="image/png"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <traversal>
                           <traverse ref="simbolo[0]"/>
                        </traversal>
                     </draw>
                     <field name="notaPOT" y="56.716mm" x="130.356mm" w="5.257mm" h="4.65mm" presence="invisible">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
xfa.host.messageBox("Indicare dati da progetto o schede tecniche macchina come da UNI EN 14511 .");
</script>
                        </event>
                        <traversal>
                           <traverse ref="imgPOT[0]"/>
                        </traversal>
                     </field>
                     <draw name="imgPOT" y="57.12mm" x="131.245mm" w="4.966mm" h="4.044mm" presence="invisible">
                        <value>
                           <image href="..\resources\comment.png" contentType="image/png"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <traversal>
                           <traverse ref="txcivico[11]"/>
                        </traversal>
                     </draw>
                     <field name="flagSost" y="75.116mm" x="34.593mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="flagAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.603mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_4fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <field name="combustibile" y="35.89mm" x="94.445mm" w="79.667mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="none"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on tipoCombu::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">this.access = "protected";
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on tipoCombu::init "+e);}
</script>
                        </event>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codCombu.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; flagAssorbFiamma.rawValue == "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <traversal>
                           <traverse ref="txcivico[9]"/>
                        </traversal>
                     </field>
                     <field name="codCombu" y="35.687mm" x="183.21mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_4tipoCombustibile"/>
                        <traversal>
                           <traverse ref="flagAssorbFiamma[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="75.319mm" x="137.918mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	flagDismiss.rawValue = "1";
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	matricola.access = "protected";
	flagAriaSorg.access = "protected";
	flagAcquaSorg.access = "protected";
	fluidoFrogorige.access = "protected";
	flagAriaFluido.access = "protected";
	flagAcquaFluido.access = "protected";
	flagAssorbRec.access = "protected";
	flagAssorbFiamma.access = "protected";
	combustibile.access = "protected";
	flagCicloCompre.access = "protected";
	circuiti.access = "protected";
	raffrescam.access = "protected";
	potFrigoNom.access = "protected";
	potFrigoAssorbNom.access = "protected";
	riscaldam.access = "protected";
	potTermNom.access = "protected";
	potTermAssorbNom.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}
	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}		
}
</script>
                        </event>
                     </field>
                     <field name="flagAnnullaDismiss" y="75.116mm" x="153.891mm" w="12.334mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="5.333mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagAnnullaDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 0 ) { 
	button.annullaDismiss.presence = "invisible";
}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagDismiss[0]"/>
                        </traversal>
                     </field>
                     <field name="flagGiaPresenteDB" y="75.116mm" x="6.892mm" w="28mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton>
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>false</text>
                        </value>
                        <caption placement="right" reserve="21mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>Flag Gia Presente D B</text>
                           </value>
                        </caption>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <bind match="dataRef" ref="$.flagGiaPresenteDB"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </field>
                     <subform x="74.63mm" y="30.633mm" w="5.257mm" minH="4.65mm" name="nota" presence="invisible">
                        <bind match="none"/>
                        <draw name="img" y="0.404mm" w="5.055mm" h="4.044mm" relevant="-print">
                           <value>
                              <image href="..\resources\comment.png" contentType="image/png"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <traversal>
                              <traverse ref="txtAnniManutenzione[0]"/>
                           </traversal>
                        </draw>
                        <field name="nota" y="0mm" w="5.257mm" h="4.65mm">
                           <ui>
                              <button highlight="inverted"/>
                           </ui>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
xfa.host.messageBox("La voce 'Ad assorbimento per recupero di calore' deve essere barrata anche nel caso di recupero dai fumi di "+
					"impianti di cogenerazione.");
</script>
                           </event>
                           <traversal>
                              <traverse ref="img[0]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <traversal>
                           <traverse operation="first" ref="nota[0]"/>
                           <traverse ref="txtAnniManutenzione[0]"/>
                        </traversal>
                     </subform>
                     <field name="L4_4dataControllo" y="1.21mm" x="69.574mm" w="20.22mm" h="6mm" presence="hidden">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_4dataControllo">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null  &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || fluidoFrogorige.rawValue != null || flagAriaSorg.rawValue != 0 ||
	flagAcquaSorg.rawValue != 0 || flagAriaFluido.rawValue != 0 || flagAcquaFluido.rawValue != 0 || flagAssorbRec.rawValue != 0 || flagAssorbFiamma.rawValue != 0 
	|| flagCicloCompre.rawValue != 0 || raffrescam.rawValue != null || potFrigoNom.rawValue != null || potFrigoAssorbNom.rawValue != null || riscaldam.rawValue != null 
	|| potTermNom.rawValue != null  || potTermAssorbNom.rawValue != null 	)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"il formato della data installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}
	else if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    /*} else if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_4dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true") {
		var VALIDATION_MSG = "Errore!"+'\n'
			+"La data installazione e' inferiore a quella del rapporto di controllo.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    */
    } else {
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
    }	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 4.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_4dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 1?>
                     <field name="anniManutenzione" y="67.635mm" x="47.938mm" w="17.187mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <assist>
                           <toolTip>Potenza termica  (sez 4.1)</toolTip>
                        </assist>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <bind match="dataRef" ref="$.L4_4manutenzioneAnni">
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </bind>
                        <format>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </format>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                     </field>
                     <draw name="txtAnniManutenzione" x="5.477mm" y="67.635mm" w="40.439mm" h="6mm">
                        <value>
                           <text>Da manutenere ogni (anni)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="anniManutenzione[0]"/>
                        </traversal>
                        <?renderCache.bounds 114630 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 25 Da manutenere ogni (anni) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  </subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1">
                     <bind match="dataRef" ref="$.sezGFsostituite.rowGFsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm" presence="invisible">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

//DA AGGIUNGERE
if ( row.datiGT.L4_4dataControllo.rawValue != null ){	
	xfa.host.messageBox("Non è possibile sostituire annullare la sostituzione di un componente che ha la data controllo valorizzata.");
}else{
	
	row.datiGT.flagSost.rawValue = "0";
	row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
	row.datiGT.L4_4dataControllo.rawValue =		datiGT.L4_4dataControllo.rawValue;
	//row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
	row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
	row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
	row.datiGT.codCombu.rawValue = 		datiGT.codCombu.rawValue;
	row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
	row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
	
	row.datiGT.flagAriaSorg.rawValue =		datiGT.flagAriaSorg.rawValue;
	row.datiGT.flagAcquaSorg.rawValue =		datiGT.flagAcquaSorg.rawValue;
	row.datiGT.fluidoFrogorige.rawValue =	datiGT.fluidoFrogorige.rawValue;
	row.datiGT.flagAriaFluido.rawValue =	datiGT.flagAriaFluido.rawValue;
	row.datiGT.flagAcquaFluido.rawValue =	datiGT.flagAcquaFluido.rawValue;
	
	row.datiGT.flagAssorbRec.rawValue = 	datiGT.flagAssorbRec.rawValue;
	row.datiGT.flagAssorbFiamma.rawValue =  datiGT.flagAssorbFiamma.rawValue;
	row.datiGT.combustibile.rawValue = 		datiGT.combustibile.rawValue;
	row.datiGT.flagCicloCompre.rawValue = 	datiGT.flagCicloCompre.rawValue;
	row.datiGT.circuiti.rawValue = 			datiGT.circuiti.rawValue;
	
	row.datiGT.raffrescam				= 	datiGT.raffrescam.rawValue;
	row.datiGT.potFrigoNom				= 	datiGT.potFrigoNom.rawValue;
	row.datiGT.potFrigoAssorbNom		=	datiGT.potFrigoAssorbNom.rawValue;
	row.datiGT.riscaldam				=	datiGT.riscaldam.rawValue;
	row.datiGT.potTermNom				=	datiGT.potTermNom.rawValue;
	row.datiGT.potTermAssorbNom			=	datiGT.potTermAssorbNom.rawValue;
	
	

	if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp;  row.datiGT.dataInstallaz.rawValue &lt;= row.datiGT.L4_4dataControllo.rawValue){
		row.datiGT.dataInstallaz.access = "protected";
		row.datiGT.fabbricante.access = "protected";
		row.datiGT.modello.access = "protected";
		row.datiGT.matricola.access = "protected";
		row.datiGT.flagAriaSorg.access = "protected";
		row.datiGT.flagAcquaSorg.access = "protected";
		row.datiGT.fluidoFrogorige.access = "protected";
		row.datiGT.flagAriaFluido.access = "protected";
		row.datiGT.flagAcquaFluido.access = "protected";
		row.datiGT.flagAssorbRec.access = "protected";
		row.datiGT.flagAssorbFiamma.access = "protected";
		row.datiGT.combustibile.access = "protected";
		row.datiGT.flagCicloCompre.access = "protected";
		row.datiGT.circuiti.access = "protected";
		row.datiGT.raffrescam.access = "protected";
		row.datiGT.potFrigoNom.access = "protected";
		row.datiGT.potFrigoAssorbNom.access = "protected";
		row.datiGT.riscaldam.access = "protected";
		row.datiGT.potTermNom.access = "protected";
		row.datiGT.potTermAssorbNom.access = "protected";
	}

	//DA AGGIUNGERE2	
	//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
	if (vRowCount &gt; 1){
		var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
		firstRow.button.presence = "visible";
	}	
	// ...e poi rimuovo
	_rowSost.removeInstance(vIndex);
	
}
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="txflag1[0]"/>
                           </traversal>
                        </field>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">/*
if (datiGT.flagEditSez4_4.rawValue == "true")
	this.presence = "invisible";
	*/
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == 1 ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0].xindir[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="73.447mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.256mm" x="24.281mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.256mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="14.929mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="14.929mm" w="62.323mm" h="6mm" x="24.281mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4matricola"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="L4_4dataControllo[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.356mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.356mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.981mm" y="15.096mm" w="30.793mm" h="6mm">
                           <value>
                              <text>Sorgente lato esterno</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagAriaSorg[0]"/>
                           </traversal>
                           <?renderCache.bounds 87287 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 21 Sorgente lato esterno 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagAriaSorg" w="5.577mm" h="6mm" x="139.737mm" y="15.096mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_4flagSorgARIA"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAcquaSorg.rawValue = "0";

}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="146.207mm" y="15.096mm" w="7.024mm" h="6mm">
                           <value>
                              <text>Aria</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagAcquaSorg[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 Aria 0 2014 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagAcquaSorg" w="5.577mm" h="6mm" x="155.711mm" y="15.096mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_4flagSorgACQUA"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAriaSorg.rawValue = "0";

}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="162.181mm" y="15.096mm" w="8.639mm" h="6mm">
                           <value>
                              <text>Acqua</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                           <?renderCache.bounds 24489 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 Acqua 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="21.803mm" w="24.78mm" h="6mm">
                           <value>
                              <text>Fluido frigorigeno</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fluidoFrogorige[0]"/>
                           </traversal>
                           <?renderCache.bounds 70243 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 18 Fluido frigorigeno 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="5.882mm" y="51.932mm" w="22.5mm" h="6mm">
                           <value>
                              <text>Raffrescamento</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[17]"/>
                           </traversal>
                           <?renderCache.bounds 63780 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 14 Raffrescamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="raffrescam" y="51.931mm" x="45.356mm" w="18.6mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5" fracDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                           <bind match="dataRef" ref="$.L4_4raffrescam"/>
                        </field>
                        <draw name="xindir" x="107.184mm" y="21.803mm" w="30.793mm" h="6mm">
                           <value>
                              <text>Fluido lato utenze</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagAriaFluido[0]"/>
                           </traversal>
                           <?renderCache.bounds 87287 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 18 Fluido lato utenze 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagAriaFluido" w="5.577mm" h="6mm" x="139.94mm" y="21.803mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_4flagFluidoARIA"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAcquaFluido.rawValue = "0";

}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="146.41mm" y="21.803mm" w="7.024mm" h="6mm">
                           <value>
                              <text>Aria</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagAcquaFluido[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 Aria 0 2014 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagAcquaFluido" w="5.577mm" h="6mm" x="155.914mm" y="21.803mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_4flagFluidoACQUA"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAriaFluido.rawValue = "0";

}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txcivico[4]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="162.384mm" y="21.803mm" w="8.639mm" h="6mm">
                           <value>
                              <text>Acqua</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagAssorbRec[0]"/>
                           </traversal>
                           <?renderCache.bounds 24489 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 Acqua 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="fluidoFrogorige" y="21.803mm" w="55.807mm" h="6mm" x="30.752mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4fluidoFrigo"/>
                           <traversal>
                              <traverse ref="xindir[7]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="5.478mm" y="31.105mm" w="6.267mm" h="6.672mm">
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <border>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                           </border>
                           <traversal>
                              <traverse ref="flagAssorbFiamma[0]"/>
                           </traversal>
                           <?renderCache.bounds 17765 18913 0 0 0 0 0 0?></draw>
                        <field name="flagAssorbRec" w="5.577mm" h="6mm" x="13.363mm" y="28.274mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_4flagRecupCalore"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAssorbFiamma.rawValue = "0";
	flagCicloCompre.rawValue = "0";
	combustibile.rawValue = "";
	combustibile.access = "protected";
}
</script>
                           </event>
                           <assist>
                              <toolTip>La voce Ad assorbimento per recupero di calore deve essere barrata anche nel caso di recupero dai fumi di&#xD;impianti di cogenerazione</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[8]"/>
                           </traversal>
                        </field>
                        <field name="flagAssorbFiamma" w="5.577mm" h="6mm" x="13.364mm" y="34.745mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_4flagFiammaDiretta"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAssorbRec.rawValue = "0";
	flagCicloCompre.rawValue = "0";
	combustibile.access = "open";
}else{
	combustibile.rawValue = "";
	combustibile.access = "protected";
}
</script>
                           </event>
                           <traversal>
                              <traverse ref="combustibile[0]"/>
                           </traversal>
                        </field>
                        <field name="flagCicloCompre" w="5.577mm" h="6mm" x="13.363mm" y="41.417mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L4_4flagCicloCompress"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAssorbRec.rawValue = "0";
	flagAssorbFiamma.rawValue = "0";
	combustibile.rawValue = "";
	combustibile.access = "protected";
}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txcivico[10]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="5.477mm" y="38.182mm" w="6.267mm" h="6.672mm">
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <border>
                              <edge presence="hidden">
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <corner presence="hidden">
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                           </border>
                           <traversal>
                              <traverse ref="flagCicloCompre[0]"/>
                           </traversal>
                           <?renderCache.bounds 17765 18913 0 0 0 0 0 0?></draw>
                        <draw name="txcivico" x="5.477mm" y="44.855mm" w="29.724mm" h="3.842mm">
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <border>
                              <edge presence="hidden">
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <corner presence="hidden">
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                           </border>
                           <traversal>
                              <traverse ref="xindir[8]"/>
                           </traversal>
                           <?renderCache.bounds 84257 10891 0 0 0 0 0 0?></draw>
                        <draw name="xindir" x="36.414mm" y="45.866mm" w="15.165mm" h="5.459mm">
                           <value>
                              <text>circuiti n°</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="circuiti[0]"/>
                           </traversal>
                           <?renderCache.bounds 42987 15474 0 0 0 0 0 0?>
                           <?renderCache.textRun 12 circuiti n° 0 0 10085 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="circuiti" y="45.866mm" x="52.388mm" w="5.662mm" h="5.257mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <integer/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4numCircuiti"/>
                           <traversal>
                              <traverse ref="raffrescam[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="19.833mm" y="28.679mm" w="56.616mm" h="6mm">
                           <value>
                              <text>Ad assorbimento per recupero calore</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[5]"/>
                           </traversal>
                           <?renderCache.bounds 160486 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 35 Ad assorbimento per recupero calore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="19.833mm" y="34.947mm" w="73.231mm" h="6mm">
                           <value>
                              <text>Ad assorbimento a fiamma diretta con combustibile</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="codCombu[0]"/>
                           </traversal>
                           <?renderCache.bounds 207584 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 49 Ad assorbimento a fiamma diretta con combustibile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="19.631mm" y="42.024mm" w="84.083mm" h="4.044mm">
                           <value>
                              <text>A ciclo di compressione con motore elettrico o endotermico</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagEditSez4_4[0]"/>
                           </traversal>
                           <?renderCache.bounds 238346 11463 0 0 0 0 0 0?>
                           <?renderCache.textRun 58 A ciclo di compressione con motore elettrico o endotermico 0 0 8079 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="28.856mm" y="52.134mm" w="16.8mm" h="5.661mm">
                           <value>
                              <text>EER(o GUE)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potFrigoNom[0]"/>
                           </traversal>
                           <?renderCache.bounds 47622 16047 0 0 0 0 0 0?>
                           <?renderCache.textRun 10 EER(o GUE) 0 0 10371 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="5.881mm" y="58.2mm" w="22.5mm" h="6mm">
                           <value>
                              <text>Riscaldamento</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="riscaldam[0]"/>
                           </traversal>
                           <?renderCache.bounds 63780 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 13 Riscaldamento 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="28.856mm" y="58.402mm" w="16.8mm" h="5.661mm">
                           <value>
                              <text>COP (     )</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[14]"/>
                           </traversal>
                           <?renderCache.bounds 47622 16047 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 COP (     ) 0 0 10371 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="riscaldam" y="57.997mm" x="45.356mm" w="18.6mm" h="6.203mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5" fracDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <traversal>
                              <traverse ref="txcivico[18]"/>
                           </traversal>
                           <bind match="dataRef" ref="$.L4_4riscaldam"/>
                        </field>
                        <draw name="txcivico" x="65.356mm" y="52.135mm" w="40.843mm" h="6mm">
                           <value>
                              <text>Potenza frigorifera nominale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[11]"/>
                           </traversal>
                           <?renderCache.bounds 115775 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 28 Potenza frigorifera nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potFrigoNom" y="52.134mm" x="106.356mm" w="16.7mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4potFrigoNom"/>
                           <traversal>
                              <traverse ref="potFrigoAssorbNom[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="124.356mm" y="52.134mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="txcivico[12]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="65.356mm" y="58.403mm" w="41.046mm" h="6mm">
                           <value>
                              <text>Potenza termica nominale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potTermNom[0]"/>
                           </traversal>
                           <?renderCache.bounds 116351 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 24 Potenza termica nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potTermNom" y="58.403mm" x="106.356mm" w="16.7mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4potTermNom"/>
                           <traversal>
                              <traverse ref="potTermAssorbNom[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="124.356mm" y="58.403mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="simbolo[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="132.256mm" y="51.933mm" w="39.5mm" h="6mm">
                           <value>
                              <text>Potenza assorbita nominale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[9]"/>
                           </traversal>
                           <?renderCache.bounds 111969 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 26 Potenza assorbita nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potFrigoAssorbNom" y="51.932mm" x="171.887mm" w="16.7mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4potFrigoAssorb"/>
                           <traversal>
                              <traverse ref="txcivico[13]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="189.479mm" y="51.932mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="txcivico[16]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="132.156mm" y="58.201mm" w="39.5mm" h="6mm">
                           <value>
                              <text>Potenza assorbita nominale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="txcivico[19]"/>
                           </traversal>
                           <?renderCache.bounds 111969 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 26 Potenza assorbita nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potTermAssorbNom" y="58.201mm" x="171.887mm" w="16.7mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4potTermAssorb"/>
                           <traversal>
                              <traverse ref="txcivico[15]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="189.479mm" y="58.201mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[10]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="simbolo" y="59.614mm" x="37.156mm" w="5.055mm" h="3.438mm">
                           <value>
                              <image contentType="image/png">iVBORw0KGgoAAAANSUhEUgAAACUAAAAXCAIAAAADThHyAAAAAXNSR0IArs4c6QAAAARnQU1BAACx
jwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAChSURBVEhL7ZVdCoAwDIN3SdH7X2QKk9o1+8kK
GwgTHxTSfUmpNcS1V1iLi5Z3XofcjJWiuHFCxtOw9NxGikCLzSHmhI+HgC4SedpiMWXGwzTtiIaH
YnT88mpRuhGTRb5887pT+od+Jo+j8yn64Xkp9oQcTk8/9ViPrjQ/Tyr5ZM7vj1nNDo3x/bzO/R9V
95nDO1OyeUyXeM3qfqKzufOJvBsIzPMA4+354QAAAABJRU5ErkJggg==</image>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <desc>
                              <text name="embeddedHref">..\resources\simbolo.png</text>
                           </desc>
                           <traversal>
                              <traverse ref="txtAnniManutenzione[0]"/>
                           </traversal>
                        </draw>
                        <field name="flagEditSez4_4" y="44.247mm" x="119.922mm" w="28mm" h="6mm" presence="invisible">
                           <ui>
                              <checkButton>
                                 <border>
                                    <?templateDesigner StyleID apcb2?>
                                    <edge stroke="lowered"/>
                                    <fill/>
                                 </border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>false</text>
                           </value>
                           <caption placement="right" reserve="21mm">
                              <para vAlign="middle"/>
                              <value>
                                 <text>Flag Edit Sez4_4</text>
                              </value>
                           </caption>
                           <items>
                              <text>true</text>
                              <text>false</text>
                           </items>
                           <bind match="dataRef" ref="$.flagRollBack4_4"/>
                           <traversal>
                              <traverse ref="txcivico[7]"/>
                           </traversal>
                        </field>
                        <field name="codFabbricante" y="8.66mm" x="87.772mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_4fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <field name="codCombu" y="35.755mm" x="174.112mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_4tipoCombustibile"/>
                           <traversal>
                              <traverse ref="txcivico[6]"/>
                           </traversal>
                        </field>
                        <field name="combustibile" y="34.946mm" x="93.838mm" w="79.667mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="none"/>
                           <event activity="prePrint" ref="$host" name="event__prePrint">
                              <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                           </event>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">this.access = "protected";
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on tipoCombu::init "+e);}
</script>
                           </event>
                           <items/>
                           <items save="1" presence="hidden"/>
                           <traversal>
                              <traverse ref="txcivico[9]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <field name="L4_4dataControllo" y="1.884mm" x="70.99mm" w="20.22mm" h="6mm" access="protected" presence="hidden">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_4dataControllo">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[1]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <field name="anniManutenzione" y="66.167mm" x="47.938mm" w="17.187mm" h="6mm">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <assist>
                              <toolTip>Potenza termica  (sez 4.1)</toolTip>
                           </assist>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="prePrint" ref="$host" name="event__prePrint">
                              <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                           </event>
                           <event activity="initialize" name="event__initialize">
                              <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                           </event>
                           <bind match="dataRef" ref="$.L4_4manutenzioneAnni">
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </bind>
                           <format>
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </format>
                           <validate>
                              <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                           </validate>
                        </field>
                        <draw name="txtAnniManutenzione" x="5.477mm" y="66.167mm" w="40.439mm" h="6mm">
                           <value>
                              <text>Da manutenere ogni (anni)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="anniManutenzione[0]"/>
                           </traversal>
                           <?renderCache.bounds 114630 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 25 Da manutenere ogni (anni) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori4_5" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaSC"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>4. GENERATORI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 13 4. GENERATORI 0 235995 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].tx_4_1[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="196.758mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezSC"/>
               <draw name="tx_4_1" w="196.96mm" h="6.209mm">
                  <value>
                     <text>4.5 SCAMBIATORI DI CALORE DELLA SOTTOSTAZIONE DI TELERISCALDAMENTO / TELERAFFRESCAMENTO</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0].addRiga[0]"/>
                  </traversal>
                  <?renderCache.bounds 556895 17600 0 0 1417 0 0 0?>
                  <?renderCache.textRun 87 4.5 SCAMBIATORI DI CALORE DELLA SOTTOSTAZIONE DI TELERISCALDAMENTO / TELERAFFRESCAMENTO 0 1417 11148 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){ 
	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = schedaGeneratori4_5.generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo SC.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowSC[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.748mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (datiGT.L4_5dataControllo.rawValue != null) {
	xfa.host.messageBox("Non è possibile cancellare se la data controllo è stata valorizzata.");
}	else{
//DA AGGIUNGERE2
//rimosso la cancellazione della riga intera dalla seconda riga in avanti
/*	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
*/	datiGT.dataInstallaz.rawValue = null;
	datiGT.L4_5dataControllo.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.potenzaTermTotale.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";
//}	
}
</script>
                        </event>
                        <assist>
                           <toolTip>Elimina SC corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (datiGT.L4_5dataControllo.rawValue != null &amp;&amp; datiGT.dataInstallaz.rawValue &lt;= datiGT.L4_5dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.869mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0].txflag1[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.666mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "1";
datiGT.dataDismiss.access = "open";
datiGT.sostComp.access = "open";

if (datiGT.L4_5dataControllo.rawValue == null || datiGT.dataInstallaz.rawValue &gt; datiGT.L4_5dataControllo.rawValue ){
	datiGT.dataInstallaz.access = "open";
	
	datiGT.fabbricante.access = "open";
	datiGT.modello.access = "open";
	datiGT.matricola.access = "open";
	datiGT.potenzaTermTotale.access = "open";
	
	
	datiGT.sostComp.access = "open";
	datiGT.dismissComp.access = "open";
	button.btCancella.access = "open";
}

this.presence = "hidden";
annullaDismiss.presence  = "hidden";
//01/12/2015
datiGT.dataDismiss.rawValue = null;
try{
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;

//DA AGGIUNGERE		
	/*	if (currentRow.datiGT.flagEditSez4_1.rawValue != "true" ) {
			//xfa.host.messageBox("[currentRow.datiGT.flagEditSez4_1.rawValue ?? "+currentRow.datiGT.flagEditSez4_1.rawValue);		
			currentRow.button.presence = "visible";
		}	*/
		
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}	
	}	
}catch(e){ null;}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == 1 ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="24.726mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="0.973458in" h="6.209mm">
                        <value>
                           <text>Scambiatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 70089 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Scambiatore 0 2835 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>SC</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L4_5numSC"/>
                        <traversal>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}		
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="167.22mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0].xindir[0]"/>
                     </traversal>
                     <?renderCache.bounds 474009 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.064mm" h="41.949mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.504mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || potenzaTermTotale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
		
		if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_5dataControllo.rawValue)
			this.access = "protected";
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante (sez 4.5)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}

</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_5dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || potenzaTermTotale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
//DA AGGIUNGERE2
} else  if (this.rawValue == "" || this.rawValue == null ) {

	var vRowCount = _rowSost.count;
	if (vRowCount &gt; 0){
		var firstRow = row.resolveNode("rowSost["+ 0 +"]");	
		if ( firstRow.datiGT.dataInstallaz.rawValue != null &amp;&amp; firstRow.datiGT.dataInstallaz.rawValue != "" ) {
		    VALIDATION_MSG = "Campo obbligatorio."+'\n'	+"In presenza di componenti sostituiti è necessario compilare la sezione.";
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );			
		}	
	}	
	
} else {	

//DA AGGIUNGERE2
//----------------------------------------------------------------------------
	if (this.rawValue != null || this.rawValue != "" ) {
		
			var vValueSave =  this.rawValue;
			//--------- controllo data installazione e ultima dismissione o sostituzione ---------
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
	
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { 
					//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
					break;
				}	
			}

			var sObj = this.parent.name+"."+ this.name;
			var oField = xfa.resolveNode(sObj);
				
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
				var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
				//xfa.host.messageBox(VALIDATION_MSG);			
				controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
			} else {
				controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
			} 
	}else 
//----------------------------------------------------------------------------	
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
		if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
			var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}else	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
   /* } else if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_5dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true") {
		var VALIDATION_MSG = "Errore!"+'\n'
			+"La data installazione e' inferiore a quella del rapporto di controllo.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    */
    } else {
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
    }	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");

</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 4.5)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_5dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.504mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.581mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.581mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_5matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || dataInstallaz.rawValue != null || potenzaTermTotale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Matricola (sez 4.5)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_5dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_5dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);	

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
}else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
    if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_5dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true")  {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Esiste un legame tra il componente ed il rapporto di controllo.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    
    } else {
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
		
		if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
		else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
			var VALIDATION_MSG = "Errore!"+'\n'
					+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
				
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
		}
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 4.5)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[1]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.604mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.604mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_5modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || matricola.rawValue != null || potenzaTermTotale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Modello (sez 4.5)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_5dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="106.981mm" y="16.581mm" w="45.874mm" h="6mm">
                        <value>
                           <text>Potenza termica nominale totale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaTermTotale[0]"/>
                        </traversal>
                        <?renderCache.bounds 130037 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 31 Potenza termica nominale totale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potenzaTermTotale" y="16.581mm" x="158.542mm" w="20.018mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_5potTermNomTot"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || dataInstallaz.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Potenza termica nominale (sez 4.5)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_5dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="179.167mm" y="16.581mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="notaPOT[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="sostComp" y="33.463mm" x="60.13mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || potenzaTermTotale.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
//30/11/2015
}else if (L4_5dataControllo.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; L4_5dataControllo.rawValue)){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore alla data di controllo!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potenzaTermTotale.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.L4_5dataControllo.rawValue = L4_5dataControllo.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.potenzaTermTotale.rawValue = potenzaTermTotale.rawValue;
			
		//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
		//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			L4_5dataControllo.rawValue = null;
			fabbricante.rawValue = null;
			matricola.rawValue = null;
			dataDismiss.rawValue = null;
			modello.rawValue = null;
			potenzaTermTotale.rawValue = null;
			
			flagSost.rawValue = "1";

			//--------------------------------------------------------------
			
			//if (L4_5dataControllo.rawValue == null || datiGT.dataInstallaz.rawValue &gt; L4_5dataControllo.rawValue){

				dataInstallaz.access = "open";
				fabbricante.access = "open";
				matricola.access = "open";
				dataDismiss.access = "open";
				modello.access = "open";
				potenzaTermTotale.access = "open";		
			//}
			
				//DA AGGIUNGERE	
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
			
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					if (vIndex == 0){
						currentRow.button.presence = "visible";
					}else{
						currentRow.button.presence = "invisible";		
					}	
				}	

		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="33.463mm" x="99.356mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || potenzaTermTotale.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
//30/11/2015
}else if (L4_5dataControllo.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; L4_5dataControllo.rawValue)){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore alla data di controllo!");
}else{
		fCheckValidi.rawValue = 0;
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potenzaTermTotale.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){	

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			fabbricante.access = "protected";
			matricola.access = "protected";
			dataDismiss.access = "protected";
			modello.access = "protected";
			potenzaTermTotale.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			try	{		
				// devo rendere invisibile il pulsante di RollBack della sostituzione
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
		
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					
					
					if (flagDismiss.rawValue == 1  ) {
						//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
						currentRow.button.presence = "invisible";
					}	
				}			
			}catch(e){ null;}	
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagDismiss[0]"/>
                        </traversal>
                     </field>
                     <field name="notaPOT" y="17.287mm" x="153.689mm" w="5.257mm" h="4.65mm" presence="invisible">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
xfa.host.messageBox("Si intende quella verificata con lettura sul contatore.");
</script>
                        </event>
                        <traversal>
                           <traverse ref="imgPOT[0]"/>
                        </traversal>
                     </field>
                     <draw name="imgPOT" y="17.691mm" x="153.689mm" w="5.055mm" h="4.044mm" presence="invisible">
                        <value>
                           <image href="..\resources\comment.png" contentType="image/png"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                     </draw>
                     <field name="flagSost" y="33.456mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="10.203mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_5fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagGiaPresenteDB" y="33.052mm" x="5.275mm" w="28mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton>
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>false</text>
                        </value>
                        <caption placement="right" reserve="21mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>Flag Gia Presente D B</text>
                           </value>
                        </caption>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <bind match="dataRef" ref="$.flagGiaPresenteDB"/>
                        <traversal>
                           <traverse ref="flagAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <field name="flagDismiss" y="33.659mm" x="141.961mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSost[0].button[0].annullaRiga[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	flagDismiss.rawValue = "1";
	
	dataInstallaz.access = "protected";
	fabbricante.access = "protected";
	matricola.access = "protected";
	dataDismiss.access = "protected";
	modello.access = "protected";
	potenzaTermTotale.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}
	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}		
}
</script>
                        </event>
                     </field>
                     <field name="flagAnnullaDismiss" y="33.456mm" x="157.934mm" w="12.334mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="5.333mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagAnnullaDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 0 ) { 
	button.annullaDismiss.presence = "invisible";
}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="txtAnniManutenzione[0]"/>
                        </traversal>
                     </field>
                     <field name="L4_5dataControllo" w="32.976mm" h="9mm" x="66.137mm" y="0.192mm" presence="hidden">
                        <ui>
                           <dateTimeEdit>
                              <border>
                                 <?templateDesigner StyleID aped3?>
                                 <edge stroke="lowered"/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="2.715mm">
                           <para vAlign="middle"/>
                        </caption>
                        <bind match="dataRef" ref="$.L4_5dataControllo">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <traversal>
                           <traverse ref="flagGiaPresenteDB[0]"/>
                        </traversal>
                     </field>
                     <field name="anniManutenzione" y="24.56mm" x="47.736mm" w="17.187mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <assist>
                           <toolTip>Potenza termica  (sez 4.1)</toolTip>
                        </assist>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <bind match="dataRef" ref="$.L4_5manutenzioneAnni">
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </bind>
                        <format>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </format>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </field>
                     <draw name="txtAnniManutenzione" x="5.275mm" y="24.56mm" w="40.439mm" h="6mm">
                        <value>
                           <text>Da manutenere ogni (anni)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="anniManutenzione[0]"/>
                        </traversal>
                        <?renderCache.bounds 114630 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 25 Da manutenere ogni (anni) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <?templateDesigner expand 1?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost">
                     <bind match="dataRef" ref="$.sezSCsostituite.rowSCsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

//DA AGGIUNGERE
if ( row.datiGT.L4_5dataControllo.rawValue != null ){	
	xfa.host.messageBox("Non è possibile sostituire annullare la sostituzione di un componente che ha la data controllo valorizzata.");
}else{
	row.datiGT.flagSost.rawValue = "0";
	row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
	//row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
	row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
	row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
	row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
	row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
	row.datiGT.potenzaTermTotale.rawValue =	datiGT.potenzaTermTotale.rawValue;
	row.datiGT.L4_5dataControllo.rawValue =	datiGT.L4_5dataControllo.rawValue;
	
	if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.dataInstallaz.rawValue &lt;=  row.datiGT.L4_5dataControllo.rawValue){
		row.datiGT.dataInstallaz.access = "protected";
		row.datiGT.fabbricante.access = "protected";
		row.datiGT.matricola.access = "protected";
		row.datiGT.modello.access = "protected";
		row.datiGT.potenzaTermTotale.access = "protected";
	}	
	
	//DA AGGIUNGERE2	
	//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
	if (vRowCount &gt; 1){
		var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
		firstRow.button.presence = "visible";
	}	
	// ...e poi rimuovo
	_rowSost.removeInstance(vIndex);

	
}	

</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="txflag1[0]"/>
                           </traversal>
                        </field>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
/*
if (datiGT.flagEditSez4_5.rawValue == "true")
	this.presence = "invisible";	*/
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == 1 ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0].flagEditSez4_5[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="30.634mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.291mm" x="24.281mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_5dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="15.368mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="15.368mm" w="62.323mm" h="6mm" x="24.281mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_5matricola"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_5dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[1]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.391mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.391mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_5modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="106.981mm" y="15.368mm" w="45.874mm" h="6mm">
                           <value>
                              <text>Potenza termica nominale totale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaTermTotale[0]"/>
                           </traversal>
                           <?renderCache.bounds 130037 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 31 Potenza termica nominale totale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potenzaTermTotale" y="15.368mm" x="153.891mm" w="20.018mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_5potTermNomTot"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="174.516mm" y="15.368mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="txtAnniManutenzione[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagEditSez4_5" y="0.451mm" x="71.799mm" w="28mm" h="6mm" presence="invisible">
                           <ui>
                              <checkButton>
                                 <border>
                                    <?templateDesigner StyleID apcb2?>
                                    <edge stroke="lowered"/>
                                    <fill/>
                                 </border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>false</text>
                           </value>
                           <caption placement="right" reserve="21mm">
                              <para vAlign="middle"/>
                              <value>
                                 <text>Flag Edit Sez4_5</text>
                              </value>
                           </caption>
                           <items>
                              <text>true</text>
                              <text>false</text>
                           </items>
                           <bind match="dataRef" ref="$.flagRollBack4_5"/>
                           <traversal>
                              <traverse ref="L4_5dataControllo[0]"/>
                           </traversal>
                        </field>
                        <field name="codFabbricante" y="8.742mm" x="87.57mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_5fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="flagEditSez4_5[0]"/>
                        </traversal>
                        <field name="L4_5dataControllo" w="32.976mm" h="9mm" x="163.193mm" y="0.752mm" presence="hidden">
                           <ui>
                              <dateTimeEdit>
                                 <border>
                                    <?templateDesigner StyleID aped3?>
                                    <edge stroke="lowered"/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="2.715mm">
                              <para vAlign="middle"/>
                           </caption>
                           <bind match="dataRef" ref="$.L4_5dataControllo">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <traversal>
                              <traverse ref="xindir[0]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <field name="anniManutenzione" y="22.951mm" x="47.736mm" w="17.187mm" h="6mm">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <assist>
                              <toolTip>Potenza termica  (sez 4.1)</toolTip>
                           </assist>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="prePrint" ref="$host" name="event__prePrint">
                              <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                           </event>
                           <event activity="initialize" name="event__initialize">
                              <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                           </event>
                           <bind match="dataRef" ref="$.L4_5manutenzioneAnni">
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </bind>
                           <format>
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </format>
                           <validate>
                              <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                           </validate>
                        </field>
                        <draw name="txtAnniManutenzione" x="5.275mm" y="22.951mm" w="40.439mm" h="6mm">
                           <value>
                              <text>Da manutenere ogni (anni)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="anniManutenzione[0]"/>
                           </traversal>
                           <?renderCache.bounds 114630 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 25 Da manutenere ogni (anni) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori4_6" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaCG"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>4. GENERATORI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 13 4. GENERATORI 0 235995 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].tx_4_1[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="197.769mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezCG"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>4.6 COGENERATORI / TRIGENERATORI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0].addRiga[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="invisible">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){ 
	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = schedaGeneratori4_6.generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo CG.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowCG[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="invisible">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;

if (datiGT.L4_6dataControllo.rawValue != null) {
	xfa.host.messageBox("Non è possibile cancellare se la data controllo è stata valorizzata.");
}	else{

//DA AGGIUNGERE2
//rimosso la cancellazione della riga intera dalla seconda riga in avanti
/*	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
*/	datiGT.dataInstallaz.rawValue = null;
	datiGT.L4_6dataControllo.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.tipologia.rawValue = null;
	datiGT.combustibile.rawValue = null;
	datiGT.potenzaTermNomi.rawValue = null;
	datiGT.potenzaElettrNomi.rawValue = null;
	datiGT.tempUscitaMin.rawValue = null;
	datiGT.tempUscitaMax.rawValue = null;
	datiGT.tempFumiValleMin.rawValue = null;
	datiGT.tempFumiValleMax.rawValue = null;
	datiGT.tempIngressoMin.rawValue = null;
	datiGT.tempIngressoMax.rawValue = null;
	datiGT.tempFumiMonteMin.rawValue = null;
	datiGT.tempFumiMonteMax.rawValue = null;
	datiGT.tempMotoreMin.rawValue = null;
	datiGT.tempMotoreMax.rawValue = null;
	datiGT.emissioniMin.rawValue = null;
	datiGT.emissioniMax.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";
//}	
}

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina CG corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (datiGT.L4_6dataControllo.rawValue != null &amp;&amp; datiGT.dataInstallaz.rawValue &lt;= datiGT.L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0].txflag1[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";
datiGT.dataDismiss.access = "open";
datiGT.sostComp.access = "open";

if (datiGT.L4_6dataControllo.rawValue == null || datiGT.dataInstallaz.rawValue &gt; datiGT.L4_6dataControllo.rawValue ){
	datiGT.dataInstallaz.access = "open";
	
	datiGT.fabbricante.access = "open";
	datiGT.modello.access = "open";
	datiGT.matricola.access = "open";
	datiGT.tipologia.access = "open";
	datiGT.combustibile.access = "open";
	datiGT.potenzaTermNomi.access = "open";
	datiGT.potenzaElettrNomi.access = "open";
	datiGT.tempUscitaMin.access = "open";
	datiGT.tempUscitaMax.access = "open";
	datiGT.tempFumiValleMin.access = "open";
	datiGT.tempFumiValleMax.access = "open";
	datiGT.tempIngressoMin.access = "open";
	datiGT.tempIngressoMax.access = "open";
	datiGT.tempFumiMonteMin.access = "open";
	datiGT.tempFumiMonteMax.access = "open";
	datiGT.tempMotoreMin.access = "open";
	datiGT.tempMotoreMax.access = "open";
	datiGT.emissioniMin.access = "open";
	datiGT.emissioniMax.access = "open";
	
	
	datiGT.sostComp.access = "open";
	datiGT.dismissComp.access = "open";
	button.btCancella.access = "open";
}
this.presence = "hidden";
annullaDismiss.presence  = "hidden";
//01/12/2015
datiGT.dataDismiss.rawValue = null;

try{
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;

//DA AGGIUNGERE		
	/*	if (currentRow.datiGT.flagEditSez4_1.rawValue != "true" ) {
			//xfa.host.messageBox("[currentRow.datiGT.flagEditSez4_1.rawValue ?? "+currentRow.datiGT.flagEditSez4_1.rawValue);		
			currentRow.button.presence = "visible";
		}	*/
		
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}	
	}	
}catch(e){ null;}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == 1 ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="38.475mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="38.071mm" h="6.209mm">
                        <value>
                           <text>Cogeneratore / Trigeneratore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 107918 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Cogeneratore / Trigeneratore 0 2835 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>CG</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L4_6numCG"/>
                        <traversal>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;		
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="153.875mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0].xindir[0]"/>
                     </traversal>
                     <?renderCache.bounds 436181 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="82.598mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.504mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || potenzaTermNomi.rawValue != null
	|| potenzaElettrNomi.rawValue != null || tempUscitaMin.rawValue != null || tempUscitaMax.rawValue != null || tempFumiValleMin.rawValue != null || tempFumiValleMax.rawValue != null
	|| tempIngressoMin.rawValue != null || tempIngressoMax.rawValue != null || tempFumiMonteMin.rawValue != null || tempFumiMonteMax.rawValue != null || tempMotoreMin.rawValue != null
	|| tempMotoreMax.rawValue != null || tipologia.rawValue != null || emissioniMin.rawValue != null || emissioniMax.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
		if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
			this.access = "protected";		
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante (sez 4.6)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || potenzaTermNomi.rawValue != null
	|| potenzaElettrNomi.rawValue != null || tempUscitaMin.rawValue != null || tempUscitaMax.rawValue != null || tempFumiValleMin.rawValue != null || tempFumiValleMax.rawValue != null
	|| tempIngressoMin.rawValue != null || tempIngressoMax.rawValue != null || tempFumiMonteMin.rawValue != null || tempFumiMonteMax.rawValue != null || tempMotoreMin.rawValue != null
	|| tempMotoreMax.rawValue != null || emissioniMin.rawValue != null || emissioniMax.rawValue != null  || tipologia.rawValue != null  )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
//DA AGGIUNGERE2
} else  if (this.rawValue == "" || this.rawValue == null ) {

	var vRowCount = _rowSost.count;
	if (vRowCount &gt; 0){
		var firstRow = row.resolveNode("rowSost["+ 0 +"]");	
		if ( firstRow.datiGT.dataInstallaz.rawValue != null &amp;&amp; firstRow.datiGT.dataInstallaz.rawValue != "" ) {
		    VALIDATION_MSG = "Campo obbligatorio."+'\n'	+"In presenza di componenti sostituiti è necessario compilare la sezione.";
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );			
		}	
	}	
	
} else {	

//DA AGGIUNGERE2
//----------------------------------------------------------------------------
	if (this.rawValue != null || this.rawValue != "" ) {
		
			var vValueSave =  this.rawValue;
			//--------- controllo data installazione e ultima dismissione o sostituzione ---------
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
	
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { 
					//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
					break;
				}	
			}

			var sObj = this.parent.name+"."+ this.name;
			var oField = xfa.resolveNode(sObj);
				
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
				var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
				//xfa.host.messageBox(VALIDATION_MSG);			
				controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
			} else {
				controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
			} 
	}else 
//----------------------------------------------------------------------------
		if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
			var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}else	
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
   /* } else if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_6dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true") {
		var VALIDATION_MSG = "Errore!"+'\n'
			+"La data installazione e' inferiore a quella del rapporto di controllo.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    */
    } else {
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
    }	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 4.6)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.504mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.581mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.581mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || dataInstallaz.rawValue != null || combustibile.rawValue != null || potenzaTermNomi.rawValue != null
	|| potenzaElettrNomi.rawValue != null || tempUscitaMin.rawValue != null || tempUscitaMax.rawValue != null || tempFumiValleMin.rawValue != null || tempFumiValleMax.rawValue != null
	|| tempIngressoMin.rawValue != null || tempIngressoMax.rawValue != null || tempFumiMonteMin.rawValue != null || tempFumiMonteMax.rawValue != null || tempMotoreMin.rawValue != null
	|| tempMotoreMax.rawValue != null || tipologia.rawValue != null || emissioniMin.rawValue != null || emissioniMax.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Matricola (sez 4.6)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="104.353mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="134.886mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);	

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);


if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
}else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
    if (this.rawValue != null &amp;&amp; this.rawValue &lt;= L4_6dataControllo.rawValue &amp;&amp; flagGiaPresenteDB.rawValue != "true")  {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Esiste un legame tra il componente ed il rapporto di controllo.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	    
    } else {
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
		
		if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
		else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
			var VALIDATION_MSG = "Errore!"+'\n'
					+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
				
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
		}
	}
}
</script>
                           <picture>date{DD/MM/YYYY}</picture>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 4.6)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[1]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="104.556mm" y="9.604mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.604mm" w="61.468mm" h="6mm" x="122.754mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || potenzaTermNomi.rawValue != null
	|| potenzaElettrNomi.rawValue != null || tempUscitaMin.rawValue != null || tempUscitaMax.rawValue != null || tempFumiValleMin.rawValue != null || tempFumiValleMax.rawValue != null
	|| tempIngressoMin.rawValue != null || tempIngressoMax.rawValue != null || tempFumiMonteMin.rawValue != null || tempFumiMonteMax.rawValue != null || tempMotoreMin.rawValue != null
	|| tempMotoreMax.rawValue != null || tipologia.rawValue != null || emissioniMin.rawValue != null || emissioniMax.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Modello (sez 4.6)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="5.679mm" y="30.43mm" w="61.267mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Potenza termica nominale (<span style="font-size:6pt">massimo recupero</span>)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaTermNomi[0]"/>
                        </traversal>
                     </draw>
                     <field name="potenzaTermNomi" y="30.43mm" x="66.541mm" w="17.374mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6potTermNom"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || potenzaTermNomi.rawValue != null
	|| potenzaElettrNomi.rawValue != null || tempUscitaMin.rawValue != null || tempUscitaMax.rawValue != null || tempFumiValleMin.rawValue != null || tempFumiValleMax.rawValue != null
	|| tempIngressoMin.rawValue != null || tempIngressoMax.rawValue != null || tempFumiMonteMin.rawValue != null || tempFumiMonteMax.rawValue != null || tempMotoreMin.rawValue != null
	|| tempMotoreMax.rawValue != null || tipologia.rawValue != null || emissioniMin.rawValue != null || emissioniMax.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Potenza termica nominale (sez 4.6)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="84.537mm" y="30.43mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="sostComp" y="74.913mm" x="60.737mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || potenzaTermNomi.rawValue == null ||
		  potenzaElettrNomi.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
//30/11/2015
}else if (L4_6dataControllo.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; L4_6dataControllo.rawValue)){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore alla data di controllo!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potenzaTermNomi.execEvent("validate");
		potenzaElettrNomi.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = 		dataInstallaz.rawValue;
			newRow.datiGT.L4_6dataControllo.rawValue = 		L4_6dataControllo.rawValue;
			newRow.datiGT.dataDismiss.rawValue = 		dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = 		fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.codCombu.rawValue = codCombu.rawValue;			
			newRow.datiGT.modello.rawValue = 			modello.rawValue;
			newRow.datiGT.matricola.rawValue = 			matricola.rawValue;
			newRow.datiGT.tipologia.rawValue =			tipologia.rawValue;
			newRow.datiGT.combustibile.rawValue = 		combustibile.rawValue;
			newRow.datiGT.potenzaTermNomi.rawValue =	potenzaTermNomi.rawValue;
			newRow.datiGT.potenzaElettrNomi.rawValue =	potenzaElettrNomi.rawValue;
			newRow.datiGT.tempUscitaMin.rawValue =		tempUscitaMin.rawValue;
			newRow.datiGT.tempUscitaMax.rawValue =		tempUscitaMax.rawValue;
			newRow.datiGT.tempFumiValleMin.rawValue =	tempFumiValleMin.rawValue;
			newRow.datiGT.tempFumiValleMax.rawValue =	tempFumiValleMax.rawValue;
			newRow.datiGT.tempIngressoMin.rawValue =	tempIngressoMin.rawValue;
			newRow.datiGT.tempIngressoMax.rawValue =	tempIngressoMax.rawValue;
			newRow.datiGT.tempFumiMonteMin.rawValue =	tempFumiMonteMin.rawValue;
			newRow.datiGT.tempFumiMonteMax.rawValue =	tempFumiMonteMax.rawValue;
			newRow.datiGT.tempMotoreMin.rawValue =		tempMotoreMin.rawValue;
			newRow.datiGT.tempMotoreMax.rawValue =		tempMotoreMax.rawValue;
			newRow.datiGT.emissioniMin.rawValue =		emissioniMin.rawValue;
			newRow.datiGT.emissioniMax.rawValue =		emissioniMax.rawValue;
			
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			
			L4_6dataControllo.rawValue = null;
			fabbricante.rawValue = null;
			matricola.rawValue = null;
			dataDismiss.rawValue = null;
			modello.rawValue = null;
			tipologia.rawValue = null;
			combustibile.rawValue = null;
			potenzaTermNomi.rawValue = null;
			potenzaElettrNomi.rawValue = null;
			tempUscitaMin.rawValue = null;
			tempUscitaMax.rawValue = null;
			tempFumiValleMin.rawValue = null;
			tempFumiValleMax.rawValue = null;
			tempIngressoMin.rawValue = null;
			tempIngressoMax.rawValue = null;
			tempFumiMonteMin.rawValue = null;
			tempFumiMonteMax.rawValue = null;
			tempMotoreMin.rawValue = null;
			tempMotoreMax.rawValue = null;
			emissioniMin.rawValue = null;
			emissioniMax.rawValue = null;
			
			flagSost.rawValue = "1";

			//--------------------------------------------------------------
			
			//if (L4_6dataControllo.rawValue == null || datiGT.dataInstallaz.rawValue &gt; L4_6dataControllo.rawValue){
			
				dataInstallaz.access = "open";
				dataDismiss.access = "open";
				fabbricante.access = "open";
				modello.access = "open";
				matricola.access = "open";
				tipologia.access = "open";
				combustibile.access = "open";
				potenzaTermNomi.access = "open";
				potenzaElettrNomi.access = "open";
				tempUscitaMin.access = "open";
				tempUscitaMax.access = "open";
				tempFumiValleMin.access = "open";
				tempFumiValleMax.access = "open";
				tempIngressoMin.access = "open";
				tempIngressoMax.access = "open";
				tempFumiMonteMin.access = "open";
				tempFumiMonteMax.access = "open";
				tempMotoreMin.access = "open";
				tempMotoreMax.access = "open";
				emissioniMin.access = "open";
				emissioniMax.access = "open";			
			//}
			
				//DA AGGIUNGERE	
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
			
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					if (vIndex == 0){
						currentRow.button.presence = "visible";
					}else{
						currentRow.button.presence = "invisible";		
					}	
				}	
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="74.913mm" x="99.963mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || potenzaTermNomi.rawValue == null ||
		  potenzaElettrNomi.rawValue == null){		
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
//30/11/2015
}else if (L4_6dataControllo.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; L4_6dataControllo.rawValue)){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore alla data di controllo!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potenzaTermNomi.execEvent("validate");
		potenzaElettrNomi.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			matricola.access = "protected";
			tipologia.access = "protected";
			combustibile.access = "protected";
			potenzaTermNomi.access = "protected";
			potenzaElettrNomi.access = "protected";
			tempUscitaMin.access = "protected";
			tempUscitaMax.access = "protected";
			tempFumiValleMin.access = "protected";
			tempFumiValleMax.access = "protected";
			tempIngressoMin.access = "protected";
			tempIngressoMax.access = "protected";
			tempFumiMonteMin.access = "protected";
			tempFumiMonteMax.access = "protected";
			tempMotoreMin.access = "protected";
			tempMotoreMax.access = "protected";
			emissioniMin.access = "protected";
			emissioniMax.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
		
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";
			
			try	{		
				// devo rendere invisibile il pulsante di RollBack della sostituzione
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
		
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					
					
					if (flagDismiss.rawValue == 1  ) {
						//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
						currentRow.button.presence = "invisible";
					}	
				}			
			}catch(e){ null;}		
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0].button[0].annullaRiga[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="104.758mm" y="16.581mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Tipologia</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tipologia[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Tipologia 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="tipologia" y="16.581mm" w="61.466mm" h="6mm" x="122.756mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tipologia"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="xindir" x="5.477mm" y="23.353mm" w="19.935mm" h="6mm">
                        <value>
                           <text>Alimentazione</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="combustibile[0]"/>
                        </traversal>
                        <?renderCache.bounds 56509 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 13 Alimentazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="combustibile" y="23.353mm" x="26.102mm" w="60.255mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on combustibile::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
		
		if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
			this.access = "protected";
	
}catch(e){xfa.host.messageBox("Exception on combustibile::init "+e);}

</script>
                        </event>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codCombu.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="codCombu[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="104.757mm" y="30.43mm" w="67.736mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Potenza elettrica nominale<span style="font-size:7pt"><span style="xfa-spacerun:yes"> </span></span><span style="font-size:6pt">ai morsetti del generatore</span></p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaElettrNomi[0]"/>
                        </traversal>
                     </draw>
                     <field name="potenzaElettrNomi" y="30.43mm" x="171.685mm" w="17.374mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6potElettrNom"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || potenzaTermNomi.rawValue != null
	|| dataInstallaz.rawValue != null || tempUscitaMin.rawValue != null || tempUscitaMax.rawValue != null || tempFumiValleMin.rawValue != null || tempFumiValleMax.rawValue != null
	|| tempIngressoMin.rawValue != null || tempIngressoMax.rawValue != null || tempFumiMonteMin.rawValue != null || tempFumiMonteMax.rawValue != null || tempMotoreMin.rawValue != null
	|| tempMotoreMax.rawValue != null || emissioniMin.rawValue != null || emissioniMax.rawValue != null  || tipologia.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Potenza elettrica nominale (sez 4.6)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="189.681mm" y="30.43mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="sf[0].txflag1[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform x="5.788mm" y="38.172mm" w="185.511mm" h="4.318mm" name="sf">
                        <bind match="none"/>
                        <draw name="txflag1" w="20.515mm" h="4.246mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="margin-left:0pt;text-decoration:none;letter-spacing:0in">Dati di targa</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="0pt"/>
                           <font size="8pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden">
                                 <color value="192,192,192"/>
                              </edge>
                              <corner thickness="0.176mm" presence="hidden">
                                 <color value="192,192,192"/>
                              </corner>
                           </border>
                           <traversal>
                              <traverse ref="txflag1[1]"/>
                           </traversal>
                        </draw>
                        <border>
                           <edge presence="hidden"/>
                           <fill>
                              <color value="239,239,239"/>
                           </fill>
                        </border>
                        <draw name="txflag1" w="15.974mm" h="4.246mm" x="61.967mm" y="0.072mm">
                           <value>
                              <text>min / max</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="0pt"/>
                           <font size="8pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden">
                                 <color value="192,192,192"/>
                              </edge>
                              <corner thickness="0.176mm" presence="hidden">
                                 <color value="192,192,192"/>
                              </corner>
                           </border>
                           <traversal>
                              <traverse ref="txflag1[2]"/>
                           </traversal>
                           <?renderCache.bounds 45281 12036 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 min / max 0 0 8366 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txflag1" w="15.973mm" h="4.246mm" x="167.313mm" y="0.072mm">
                           <value>
                              <text>min / max</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="0pt"/>
                           <font size="8pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden">
                                 <color value="192,192,192"/>
                              </edge>
                              <corner thickness="0.176mm" presence="hidden">
                                 <color value="192,192,192"/>
                              </corner>
                           </border>
                           <traversal>
                              <traverse ref="txcivico[4]"/>
                           </traversal>
                           <?renderCache.bounds 45278 12036 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 min / max 0 0 8366 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <traversal>
                           <traverse operation="first" ref="txflag1[0]"/>
                           <traverse ref="txcivico[4]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <draw name="txcivico" x="6.084mm" y="43.169mm" w="48.73mm" h="5.055mm">
                        <value>
                           <text>Temperatura acqua in uscita (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tempUscitaMin[0]"/>
                        </traversal>
                        <?renderCache.bounds 138132 14329 0 0 0 0 0 0?>
                        <?renderCache.textRun 33 Temperatura acqua in uscita (°C) 0 0 9512 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="tempUscitaMin" y="43.169mm" x="67.553mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempAcquaUscitaMIN"/>
                        <traversal>
                           <traverse ref="tempUscitaMax[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="tempUscitaMax" y="43.169mm" x="75.843mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempAcquaUscitaMAX"/>
                        <traversal>
                           <traverse ref="txcivico[5]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="104.959mm" y="43.169mm" w="60.105mm" h="5.055mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Temperatura fumi<span style="xfa-spacerun:yes"> </span><span style="font-size:6pt">a valle dello scambiatore</span> (°C)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tempFumiValleMin[0]"/>
                        </traversal>
                     </draw>
                     <field name="tempFumiValleMin" y="43.169mm" x="172.494mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempFumiValleMIN"/>
                        <traversal>
                           <traverse ref="tempFumiValleMax[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="tempFumiValleMax" y="43.169mm" x="180.784mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempFumiValleMAX"/>
                        <traversal>
                           <traverse ref="tempFumiMonteMin[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <draw name="txcivico" x="104.959mm" y="49.033mm" w="61.937mm" h="5.055mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Temperatura fumi<span style="xfa-spacerun:yes"> </span><span style="font-size:6pt">a monte dello scambiatore</span> (°C)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[9]"/>
                        </traversal>
                     </draw>
                     <draw name="txcivico" x="6.286mm" y="49.033mm" w="51.157mm" h="5.055mm">
                        <value>
                           <text>Temperatura acqua in ingresso (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tempIngressoMin[0]"/>
                        </traversal>
                        <?renderCache.bounds 145012 14329 0 0 0 0 0 0?>
                        <?renderCache.textRun 35 Temperatura acqua in ingresso (°C) 0 0 9512 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="6.286mm" y="58.535mm" w="59.879mm" h="5.055mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Temperatura acqua motore<span style="xfa-spacerun:yes"> </span><span style="font-size:6pt">(solo m.c.i.)</span> (°C)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tempMotoreMin[0]"/>
                        </traversal>
                     </draw>
                     <draw name="txcivico" x="105.162mm" y="55.705mm" w="61.671mm" h="7.481mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Emissioni di monossido di carbonio CO</p><p style="font-size:7pt;letter-spacing:0in">(mg/Nm<span style="vertical-align:2.17pt">3<span style="xfa-spacerun:yes"> </span></span>riportati al 5% di O<span style="vertical-align:-1.05pt;font-size:4.6pt">2<span style="xfa-spacerun:yes"> </span></span>nei fumi)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="emissioniMin[0]"/>
                        </traversal>
                     </draw>
                     <field name="tempIngressoMin" y="49.033mm" x="67.553mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempAcquaIngressoMIN"/>
                        <traversal>
                           <traverse ref="tempIngressoMax[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="tempIngressoMax" y="49.033mm" x="75.843mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempAcquaIngressoMAX"/>
                        <traversal>
                           <traverse ref="txcivico[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="tempMotoreMin" y="58.536mm" x="67.553mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempAcquaMotoreMIN"/>
                        <traversal>
                           <traverse ref="tempMotoreMax[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="tempMotoreMax" y="58.536mm" x="75.843mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempAcquaMotoreMAX"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="tempFumiMonteMin" y="48.83mm" x="172.494mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempFumiMonteMIN"/>
                        <traversal>
                           <traverse ref="tempFumiMonteMax[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="tempFumiMonteMax" y="48.83mm" x="180.784mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6tempFumiMonteMAX"/>
                        <traversal>
                           <traverse ref="txcivico[7]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="emissioniMin" y="58.132mm" x="172.494mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6emissioniMonossidoMIN"/>
                        <traversal>
                           <traverse ref="emissioniMax[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="emissioniMax" y="58.132mm" x="180.784mm" w="7.279mm" h="5.055mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="4"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_6emissioniMonossidoMAX"/>
                        <traversal>
                           <traverse ref="txcivico[8]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_6dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                     </field>
                     <field name="flagSost" y="74.307mm" x="34.998mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="rowSost[0].datiGT[0].L4_6dataControllo[0]"/>
                        </traversal>
                     </field>
                     <field name="codCombu" y="24.364mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_6combustibile"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.603mm" x="87.772mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_6fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagGiaPresenteDB" y="74.307mm" x="7.297mm" w="28mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton>
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>false</text>
                        </value>
                        <caption placement="right" reserve="21mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>Flag Gia Presente D B</text>
                           </value>
                        </caption>
                        <items>
                           <text>true</text>
                           <text>false</text>
                        </items>
                        <bind match="dataRef" ref="$.flagGiaPresenteDB"/>
                        <traversal>
                           <traverse ref="flagDismiss[0]"/>
                        </traversal>
                     </field>
                     <field name="flagDismiss" y="74.509mm" x="141.558mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="flagAnnullaDismiss[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	flagDismiss.rawValue = "1";
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	matricola.access = "protected";
	tipologia.access = "protected";
	combustibile.access = "protected";
	potenzaTermNomi.access = "protected";
	potenzaElettrNomi.access = "protected";
	tempUscitaMin.access = "protected";
	tempUscitaMax.access = "protected";
	tempFumiValleMin.access = "protected";
	tempFumiValleMax.access = "protected";
	tempIngressoMin.access = "protected";
	tempIngressoMax.access = "protected";
	tempFumiMonteMin.access = "protected";
	tempFumiMonteMax.access = "protected";
	tempMotoreMin.access = "protected";
	tempMotoreMax.access = "protected";
	emissioniMin.access = "protected";
	emissioniMax.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}
	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}		
}
</script>
                        </event>
                     </field>
                     <field name="flagAnnullaDismiss" y="74.509mm" x="157.531mm" w="12.334mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="5.333mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagAnnullaDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 0 ) { 
	button.annullaDismiss.presence = "invisible";
}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="L4_6dataControllo" w="29.539mm" h="9mm" x="65.934mm" y="0.806mm" presence="hidden">
                        <ui>
                           <dateTimeEdit>
                              <border>
                                 <?templateDesigner StyleID aped3?>
                                 <edge stroke="lowered"/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="1.3575mm">
                           <para vAlign="middle"/>
                        </caption>
                        <bind match="dataRef" ref="$.L4_6dataControllo">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <traversal>
                           <traverse ref="flagGiaPresenteDB[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <field name="anniManutenzione" y="65.613mm" x="48.342mm" w="17.187mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <assist>
                           <toolTip>Potenza termica  (sez 4.1)</toolTip>
                        </assist>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                        </event>
                        <bind match="dataRef" ref="$.L4_6manutenzioneAnni">
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </bind>
                        <format>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </format>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                     </field>
                     <draw name="txtAnniManutenzione" x="5.881mm" y="65.613mm" w="40.439mm" h="6mm">
                        <value>
                           <text>Da manutenere ogni (anni)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="anniManutenzione[0]"/>
                        </traversal>
                        <?renderCache.bounds 114630 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 25 Da manutenere ogni (anni) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  </subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost">
                     <bind match="dataRef" ref="$.sezCGsostituite.rowCGsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm" presence="invisible">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

//DA AGGIUNGERE
if ( row.datiGT.L4_6dataControllo.rawValue != null ){	
	xfa.host.messageBox("Non è possibile sostituire annullare la sostituzione di un componente che ha la data controllo valorizzata.");
}else{
	row.datiGT.flagSost.rawValue = "0";
	row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
	//row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
	row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
	row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
	row.datiGT.codCombu.rawValue = 		datiGT.codCombu.rawValue;
	row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
	row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
	row.datiGT.tipologia.rawValue	= 		datiGT.tipologia.rawValue;
	row.datiGT.combustibile.rawValue =		datiGT.combustibile.rawValue;
	row.datiGT.potenzaTermNomi.rawValue =	datiGT.potenzaTermNomi.rawValue;
	row.datiGT.potenzaElettrNomi.rawValue =	datiGT.potenzaElettrNomi.rawValue;
	row.datiGT.tempUscitaMin.rawValue =		datiGT.tempUscitaMin.rawValue;
	row.datiGT.tempUscitaMax.rawValue =		datiGT.tempUscitaMax.rawValue;
	row.datiGT.tempFumiValleMin.rawValue =	datiGT.tempFumiValleMin.rawValue;
	row.datiGT.tempFumiValleMax.rawValue =	datiGT.tempFumiValleMax.rawValue;
	row.datiGT.tempIngressoMin.rawValue =	datiGT.tempIngressoMin.rawValue;
	row.datiGT.tempIngressoMax.rawValue =	datiGT.tempIngressoMax.rawValue;
	row.datiGT.tempFumiMonteMin.rawValue =	datiGT.tempFumiMonteMin.rawValue;
	row.datiGT.tempFumiMonteMax.rawValue =	datiGT.tempFumiMonteMax.rawValue;
	row.datiGT.tempMotoreMin.rawValue =		datiGT.tempMotoreMin.rawValue;
	row.datiGT.tempMotoreMax.rawValue =		datiGT.tempMotoreMax.rawValue;
	row.datiGT.emissioniMin.rawValue =		datiGT.emissioniMin.rawValue;
	row.datiGT.emissioniMax.rawValue =		datiGT.emissioniMax.rawValue;
	row.datiGT.L4_6dataControllo.rawValue =		datiGT.L4_6dataControllo.rawValue;
	
	if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.dataInstallaz.rawValue &lt;= row.datiGT.L4_6dataControllo.rawValue){
		row.datiGT.dataInstallaz.access = "protected";
		row.datiGT.fabbricante.access = "protected";
		row.datiGT.modello.access = "protected";
		row.datiGT.matricola.access = "protected";
		row.datiGT.tipologia.access = "protected";
		row.datiGT.combustibile.access = "protected";
		row.datiGT.potenzaTermNomi.access = "protected";
		row.datiGT.potenzaElettrNomi.access = "protected";
		row.datiGT.tempUscitaMin.access = "protected";
		row.datiGT.tempUscitaMax.access = "protected";
		row.datiGT.tempFumiValleMin.access = "protected";
		row.datiGT.tempFumiValleMax.access = "protected";
		row.datiGT.tempIngressoMin.access = "protected";
		row.datiGT.tempIngressoMax.access = "protected";
		row.datiGT.tempFumiMonteMin.access = "protected";
		row.datiGT.tempFumiMonteMax.access = "protected";
		row.datiGT.tempMotoreMin.access = "protected";
		row.datiGT.tempMotoreMax.access = "protected";
		row.datiGT.emissioniMin.access = "protected";
		row.datiGT.emissioniMax.access = "protected";
	}	
	//DA AGGIUNGERE2	
	//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
	if (vRowCount &gt; 1){
		var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
		firstRow.button.presence = "visible";
	}	
	// ...e poi rimuovo
	_rowSost.removeInstance(vIndex);
}

</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="txflag1[0]"/>
                           </traversal>
                        </field>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
/*
if (datiGT.flagEditSez4_6.rawValue == "true")
	this.presence = "invisible";	*/
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == 1 ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0].txtAnniManutenzione[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.514mm" h="71.342mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.055mm" x="24.281mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.055mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="14.896mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="14.896mm" w="62.323mm" h="6mm" x="24.281mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6matricola"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.375mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="136.908mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.578mm" y="8.155mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.155mm" w="60.659mm" h="6mm" x="124.776mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6modello"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.577mm" y="14.896mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Tipologia</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tipologia[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Tipologia 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="tipologia" y="14.896mm" w="61.466mm" h="6mm" x="124.575mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tipologia"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="5.477mm" y="28.679mm" w="61.267mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Potenza termica nominale (<span style="font-size:6pt">massimo recupero</span>)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaTermNomi[0]"/>
                           </traversal>
                        </draw>
                        <field name="potenzaTermNomi" y="28.679mm" x="66.339mm" w="17.374mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6potTermNom"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="83.526mm" y="28.679mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="106.779mm" y="28.679mm" w="67.736mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Potenza elettrica nominale<span style="font-size:7pt"><span style="xfa-spacerun:yes"> </span></span><span style="font-size:6pt">ai morsetti del generatore</span></p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaElettrNomi[0]"/>
                           </traversal>
                        </draw>
                        <field name="potenzaElettrNomi" y="28.679mm" x="173.303mm" w="17.374mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6potElettrNom"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="190.49mm" y="28.679mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sf[0].txflag1[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <subform x="5.586mm" y="36.421mm" w="185.511mm" h="4.318mm" name="sf">
                           <bind match="none"/>
                           <draw name="txflag1" w="20.515mm" h="4.246mm">
                              <value>
                                 <exData contentType="text/html">
                                    <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="margin-left:0pt;text-decoration:none;letter-spacing:0in">Dati di targa</p></body>
                                 </exData>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" marginLeft="0pt"/>
                              <font size="8pt" typeface="Verdana"/>
                              <border>
                                 <edge presence="hidden">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <corner thickness="0.176mm" presence="hidden">
                                    <color value="192,192,192"/>
                                 </corner>
                              </border>
                              <traversal>
                                 <traverse ref="txflag1[1]"/>
                              </traversal>
                           </draw>
                           <border>
                              <edge presence="hidden"/>
                              <fill>
                                 <color value="239,239,239"/>
                              </fill>
                           </border>
                           <draw name="txflag1" w="15.974mm" h="4.246mm" x="61.967mm" y="0.072mm">
                              <value>
                                 <text>min / max</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" marginLeft="0pt"/>
                              <font size="8pt" typeface="Verdana"/>
                              <border>
                                 <edge presence="hidden">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <corner thickness="0.176mm" presence="hidden">
                                    <color value="192,192,192"/>
                                 </corner>
                              </border>
                              <traversal>
                                 <traverse ref="txflag1[2]"/>
                              </traversal>
                              <?renderCache.bounds 45281 12036 0 0 0 0 0 0?>
                              <?renderCache.textRun 9 min / max 0 0 8366 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                           <draw name="txflag1" w="15.973mm" h="4.246mm" x="167.313mm" y="0.072mm">
                              <value>
                                 <text>min / max</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" marginLeft="0pt"/>
                              <font size="8pt" typeface="Verdana"/>
                              <border>
                                 <edge presence="hidden">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <corner thickness="0.176mm" presence="hidden">
                                    <color value="192,192,192"/>
                                 </corner>
                              </border>
                              <traversal>
                                 <traverse ref="txcivico[4]"/>
                              </traversal>
                              <?renderCache.bounds 45278 12036 0 0 0 0 0 0?>
                              <?renderCache.textRun 9 min / max 0 0 8366 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                           <traversal>
                              <traverse operation="first" ref="txflag1[0]"/>
                              <traverse ref="txcivico[4]"/>
                           </traversal>
                           <?templateDesigner expand 0?></subform>
                        <draw name="txcivico" x="5.882mm" y="41.418mm" w="48.73mm" h="5.055mm">
                           <value>
                              <text>Temperatura acqua in uscita (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tempUscitaMin[0]"/>
                           </traversal>
                           <?renderCache.bounds 138132 14329 0 0 0 0 0 0?>
                           <?renderCache.textRun 33 Temperatura acqua in uscita (°C) 0 0 9512 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="tempUscitaMin" y="41.418mm" x="67.351mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <traversal>
                              <traverse ref="tempUscitaMax[0]"/>
                           </traversal>
                           <bind match="dataRef" ref="$.L4_6tempAcquaUscitaMIN"/>
                        </field>
                        <field name="tempUscitaMax" y="41.418mm" x="75.641mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempAcquaUscitaMAX"/>
                           <traversal>
                              <traverse ref="txcivico[5]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="104.757mm" y="41.418mm" w="60.105mm" h="5.055mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Temperatura fumi<span style="xfa-spacerun:yes"> </span><span style="font-size:6pt">a valle dello scambiatore</span> (°C)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tempFumiValleMin[0]"/>
                           </traversal>
                        </draw>
                        <field name="tempFumiValleMin" y="41.418mm" x="172.292mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempFumiValleMIN"/>
                           <traversal>
                              <traverse ref="tempFumiValleMax[0]"/>
                           </traversal>
                        </field>
                        <field name="tempFumiValleMax" y="41.418mm" x="180.582mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempFumiValleMAX"/>
                           <traversal>
                              <traverse ref="tempFumiMonteMin[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="104.757mm" y="47.282mm" w="61.937mm" h="5.055mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Temperatura fumi<span style="xfa-spacerun:yes"> </span><span style="font-size:6pt">a monte dello scambiatore</span> (°C)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[9]"/>
                           </traversal>
                        </draw>
                        <draw name="txcivico" x="6.084mm" y="47.282mm" w="51.157mm" h="5.055mm">
                           <value>
                              <text>Temperatura acqua in ingresso (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tempIngressoMin[0]"/>
                           </traversal>
                           <?renderCache.bounds 145012 14329 0 0 0 0 0 0?>
                           <?renderCache.textRun 35 Temperatura acqua in ingresso (°C) 0 0 9512 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="6.084mm" y="56.784mm" w="59.879mm" h="5.055mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Temperatura acqua motore<span style="xfa-spacerun:yes"> </span><span style="font-size:6pt">(solo m.c.i.)</span> (°C)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tempMotoreMin[0]"/>
                           </traversal>
                        </draw>
                        <draw name="txcivico" x="104.96mm" y="53.954mm" w="61.671mm" h="7.481mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Emissioni di monossido di carbonio CO</p><p style="font-size:7pt;letter-spacing:0in">(mg/Nm<span style="vertical-align:2.17pt">3<span style="xfa-spacerun:yes"> </span></span>riportati al 5% di O<span style="vertical-align:-1.05pt;font-size:4.6pt">2<span style="xfa-spacerun:yes"> </span></span>nei fumi)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="emissioniMin[0]"/>
                           </traversal>
                        </draw>
                        <field name="tempIngressoMin" y="47.282mm" x="67.351mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempAcquaIngressoMIN"/>
                           <traversal>
                              <traverse ref="tempIngressoMax[0]"/>
                           </traversal>
                        </field>
                        <field name="tempIngressoMax" y="47.282mm" x="75.641mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempAcquaIngressoMAX"/>
                           <traversal>
                              <traverse ref="txcivico[6]"/>
                           </traversal>
                        </field>
                        <field name="tempMotoreMin" y="56.785mm" x="67.351mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempAcquaMotoreMIN"/>
                           <traversal>
                              <traverse ref="tempMotoreMax[0]"/>
                           </traversal>
                        </field>
                        <field name="tempMotoreMax" y="56.785mm" x="75.641mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempAcquaMotoreMAX"/>
                           <traversal>
                              <traverse ref="datiGT[0].txtAnniManutenzione[0]"/>
                           </traversal>
                        </field>
                        <field name="tempFumiMonteMin" y="47.079mm" x="172.292mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempFumiMonteMIN"/>
                           <traversal>
                              <traverse ref="tempFumiMonteMax[0]"/>
                           </traversal>
                        </field>
                        <field name="tempFumiMonteMax" y="47.079mm" x="180.582mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6tempFumiMonteMAX"/>
                           <traversal>
                              <traverse ref="txcivico[7]"/>
                           </traversal>
                        </field>
                        <field name="emissioniMin" y="56.381mm" x="172.292mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6emissioniMonossidoMIN"/>
                           <traversal>
                              <traverse ref="emissioniMax[0]"/>
                           </traversal>
                        </field>
                        <field name="emissioniMax" y="56.381mm" x="180.582mm" w="7.279mm" h="5.055mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="4"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_6emissioniMonossidoMAX"/>
                           <traversal>
                              <traverse ref="txcivico[8]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.679mm" y="21.602mm" w="19.935mm" h="6mm">
                           <value>
                              <text>Alimentazione</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="combustibile[0]"/>
                           </traversal>
                           <?renderCache.bounds 56509 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 13 Alimentazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="combustibile" y="21.602mm" x="26.304mm" w="60.255mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on combustibile::init "+e);}

</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="flagEditSez4_6[0]"/>
                           </traversal>
                        </field>
                        <field name="flagEditSez4_6" y="21.804mm" x="106.577mm" w="28mm" h="6mm" presence="invisible">
                           <ui>
                              <checkButton>
                                 <border>
                                    <?templateDesigner StyleID apcb2?>
                                    <edge stroke="lowered"/>
                                    <fill/>
                                 </border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>false</text>
                           </value>
                           <caption placement="right" reserve="21mm">
                              <para vAlign="middle"/>
                              <value>
                                 <text>Flag Edit Sez4_6</text>
                              </value>
                           </caption>
                           <items>
                              <text>true</text>
                              <text>false</text>
                           </items>
                           <bind match="dataRef" ref="$.flagRollBack4_6"/>
                           <traversal>
                              <traverse ref="codCombu[0]"/>
                           </traversal>
                        </field>
                        <field name="codCombu" y="23.017mm" x="87.368mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_6combustibile"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <field name="codFabbricante" y="7.852mm" x="87.368mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_6fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[1]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <field name="L4_6dataControllo" w="29.539mm" h="9mm" x="57.038mm" y="0.202mm" presence="hidden">
                           <ui>
                              <dateTimeEdit>
                                 <border>
                                    <?templateDesigner StyleID aped3?>
                                    <edge stroke="lowered"/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="1.3575mm">
                              <para vAlign="middle"/>
                           </caption>
                           <bind match="dataRef" ref="$.L4_6dataControllo">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <traversal>
                              <traverse ref="xindir[0]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <field name="anniManutenzione" y="63.391mm" x="48.342mm" w="17.187mm" h="6mm">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <assist>
                              <toolTip>Potenza termica  (sez 4.1)</toolTip>
                           </assist>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="prePrint" ref="$host" name="event__prePrint">
                              <script contentType="application/x-javascript">

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                           </event>
                           <event activity="initialize" name="event__initialize">
                              <script contentType="application/x-javascript">
if (dataInstallaz.rawValue != null &amp;&amp; dataInstallaz.rawValue &lt;= L4_1dataControllo.rawValue)
	this.access = "protected";
</script>
                           </event>
                           <bind match="dataRef" ref="$.L4_6manutenzioneAnni">
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </bind>
                           <format>
                              <picture>num{zzzzzzzzzzzz9}</picture>
                           </format>
                           <validate>
                              <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || combustibile.rawValue != null || fluidoTermoVet.rawValue != null
	|| dataInstallaz.rawValue != null || RendimentoTermico.rawValue != null || flagGTsingle.rawValue != 0 || flagGTmod.rawValue != 0 || numAnalisi.rawValue != null || flagTubo.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                           </validate>
                        </field>
                        <draw name="txtAnniManutenzione" x="5.881mm" y="63.391mm" w="40.439mm" h="6mm">
                           <value>
                              <text>Da manutenere ogni (anni)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="anniManutenzione[0]"/>
                           </traversal>
                           <?renderCache.bounds 114630 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 25 Da manutenere ogni (anni) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori4_7" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaCS"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>4. GENERATORI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 13 4. GENERATORI 0 235995 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="196.758mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezCS"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>4.7 CAMPI SOLARI TERMICI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="invisible">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null ){ 
	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = schedaGeneratori4_7.generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo CS.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <?templateDesigner expand 0?>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
               </subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowCS[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="invisible">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.754mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	

if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.collettori.rawValue = null;
	datiGT.superfTotApert.rawValue = null;
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina CS corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.collettori.access = "open";
datiGT.superfTotApert.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";

this.presence = "hidden";
annullaDismiss.presence  = "hidden";

//01/12/2015
datiGT.dataDismiss.rawValue = null;
try{
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		
	
		/*if (currentRow.datiGT.flagEditSez4_7.rawValue != "true" ) {
			//xfa.host.messageBox("[currentRow.datiGT.flagEditSez4_1.rawValue ?? "+currentRow.datiGT.flagEditSez4_1.rawValue);		
			currentRow.button.presence = "visible";
		}*/
		//01/12/2015
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}	
		
	}	
}catch(e){ null;}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == 1 ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="24.726mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="0.973458in" h="6.209mm">
                        <value>
                           <text>Campo Solare</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 70089 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 12 Campo Solare 0 2835 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>CS</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L4_7numCS"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;		
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}	
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="167.22mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 474009 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="31.441mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.504mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || collettori.rawValue != null || superfTotApert.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}

</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">

try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante (sez 4.7)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_7dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || collettori.rawValue != null || superfTotApert.rawValue != null  )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}else	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }else{
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
    } 	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 4.7)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.504mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="107.386mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.224mm" x="137.514mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_7dataDismissione">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
}else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 4.7)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="107.386mm" y="16.581mm" w="42.664mm" h="6mm">
                        <value>
                           <text>Superficie totale di apertura</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="superfTotApert[0]"/>
                        </traversal>
                        <?renderCache.bounds 120937 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 29 Superficie totale di apertura 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="superfTotApert" y="16.581mm" x="150.859mm" w="27.701mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_7superfTotApertura"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || collettori.rawValue != null || dataInstallaz.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Superficie totale (sez 4.7)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                     </field>
                     <field name="sostComp" y="24.162mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || superfTotApert.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {


		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		superfTotApert.execEvent("validate");
		if(controlli.isOk(fCheckValidi)){		
			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;			
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.collettori.rawValue = collettori.rawValue;
			newRow.datiGT.superfTotApert.rawValue = superfTotApert.rawValue;
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;
			
			fabbricante.rawValue = null;
			collettori.rawValue = null;
			dataDismiss.rawValue = null;
			superfTotApert.rawValue = null;

			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="24.162mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || superfTotApert.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		superfTotApert.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){	

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			collettori.access = "protected";
			superfTotApert.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
		
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";
			
			try	{		
				// devo rendere invisibile il pulsante di RollBack della sostituzione
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
		
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					
					
					if (flagDismiss.rawValue == 1  ) {
						//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
						currentRow.button.presence = "invisible";
					}	
				}			
			}catch(e){ null;}	
			
	}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "Bozza")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="77.258mm" y="16.276mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(n°)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="collettori[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 (n°) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="collettori" y="16.478mm" x="23.675mm" w="52.977mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5" fracDigits="0"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_7collettori"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="5.275mm" y="16.276mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Collettori</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 10 Collettori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="178.56mm" y="16.681mm" w="7.103mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">(m<span style="vertical-align:3.41pt">2</span>)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </draw>
                     <field name="flagSost" y="23.758mm" x="36.211mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="10.008mm" x="87.57mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_7fabbricante"/>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="23.959mm" x="139.536mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	flagDismiss.rawValue = "1";
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	collettori.access = "protected";
	superfTotApert.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}
	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}		
}
</script>
                        </event>
                     </field>
                     <field name="flagAnnullaDismiss" y="23.959mm" x="155.509mm" w="12.334mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="5.333mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagAnnullaDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 0 ) { 
	button.annullaDismiss.presence = "invisible";
}	
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost">
                     <bind match="dataRef" ref="$.sezCSvariate.rowCSvar[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm" presence="invisible">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.collettori.rawValue = 		datiGT.collettori.rawValue;
row.datiGT.superfTotApert.rawValue =	datiGT.superfTotApert.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	

// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla variazione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
/*
if (datiGT.flagEditSez4_7.rawValue == "true")
	this.presence = "invisible";
*/
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == 1 ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL CAMPO SOLARE TERMICO</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 37 SOSTITUZIONE DEL CAMPO SOLARE TERMICO 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="24.366mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.291mm" x="24.281mm" w="59.245mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="56.439mm" h="6mm">
                           <value>
                              <text>Data installazione nuova configurazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 159985 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 40 Data installazione nuova configurazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="62.902mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_7dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="107.993mm" y="1.315mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.315mm" x="138.526mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_7dataDismissione">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="txcivico" x="107.79mm" y="15.977mm" w="42.664mm" h="6mm">
                           <value>
                              <text>Superficie totale di apertura</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="superfTotApert[0]"/>
                           </traversal>
                           <?renderCache.bounds 120937 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 29 Superficie totale di apertura 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="superfTotApert" y="15.977mm" x="151.263mm" w="27.701mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_7superfTotApertura"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="77.662mm" y="15.672mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(n°)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="collettori[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 (n°) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="collettori" y="15.874mm" x="24.281mm" w="52.977mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_7collettori"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="5.679mm" y="15.672mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Collettori</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 10 Collettori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="178.964mm" y="16.077mm" w="7.103mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">(m<span style="vertical-align:3.41pt">2</span>)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                        </draw>
                        <field name="flagEditSez4_7" y="8.797mm" x="108.195mm" w="28mm" h="6mm" presence="invisible">
                           <ui>
                              <checkButton>
                                 <border>
                                    <?templateDesigner StyleID apcb2?>
                                    <edge stroke="lowered"/>
                                    <fill/>
                                 </border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>false</text>
                           </value>
                           <caption placement="right" reserve="21mm">
                              <para vAlign="middle"/>
                              <value>
                                 <text>Flag Edit Sez4_7</text>
                              </value>
                           </caption>
                           <items>
                              <text>true</text>
                              <text>false</text>
                           </items>
                           <bind match="dataRef" ref="$.flagRollBack4_7"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </field>
                        <field name="codFabbricante" y="8.595mm" x="84.133mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_7fabbricante"/>
                           <traversal>
                              <traverse ref="flagEditSez4_7[0]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori4_8" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaAG"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>4. GENERATORI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 13 4. GENERATORI 0 235995 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="196.758mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezAG"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>4.8 ALTRI GENERATORI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){ 
	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = schedaGeneratori4_8.generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo AG.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowAG[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.754mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	

if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.tipologia.rawValue = null;
	datiGT.potenzaUtile.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina AG corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";
datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.matricola.access = "open";
datiGT.tipologia.access = "open";
datiGT.potenzaUtile.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";
//01/12/2015
datiGT.dataDismiss.rawValue = null;
try{
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		
	
		/*if (currentRow.datiGT.flagEditSez4_8.rawValue != "true" ) {
			//xfa.host.messageBox("[currentRow.datiGT.flagEditSez4_1.rawValue ?? "+currentRow.datiGT.flagEditSez4_1.rawValue);		
			currentRow.button.presence = "visible";
		}*/
		//01/12/2015
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	
}catch(e){ null;}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == 1 ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="24.726mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="0.973458in" h="6.209mm">
                        <value>
                           <text>Altro Generatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 70089 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 16 Altro Generatore 0 2835 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>AG</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L4_8numAG"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;		
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}	
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="167.22mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 474009 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="39.933mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.504mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || matricola.rawValue != null || tipologia.rawValue != null || potenzaUtile.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">

try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante (sez 4.8)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}

</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_8dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || tipologia.rawValue != null || potenzaUtile.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}else
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }else{
	    controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 4.8)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.504mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.276mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.276mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_8matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || dataInstallaz.rawValue != null || tipologia.rawValue != null || potenzaUtile.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Matricola (sez 4.8)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L4_8dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
}else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 4.8)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.604mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.604mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_8modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || matricola.rawValue != null || tipologia.rawValue != null || potenzaUtile.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Modello (sez 4.8)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="txcivico" x="106.982mm" y="23.048mm" w="19.006mm" h="6mm">
                        <value>
                           <text>Potenza utile</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaUtile[0]"/>
                        </traversal>
                        <?renderCache.bounds 53875 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 13 Potenza utile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potenzaUtile" y="23.048mm" x="126.191mm" w="20.018mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_8potUtile"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || tipologia.rawValue != null || dataInstallaz.rawValue != null)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Potenza utile (sez 4.8)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="146.816mm" y="23.048mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="sostComp" y="32.25mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || potenzaUtile.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potenzaUtile.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;			
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;
			newRow.datiGT.tipologia.rawValue = tipologia.rawValue;		
			newRow.datiGT.potenzaUtile.rawValue = potenzaUtile.rawValue;

			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
	
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;

			dataDismiss.rawValue = null;
			fabbricante.rawValue = null;
			modello.rawValue = null;
			matricola.rawValue = null;
			tipologia.rawValue = null;			
			potenzaUtile.rawValue = null;

			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}	
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="32.25mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || matricola.rawValue == null ||  modello.rawValue == null || potenzaUtile.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		potenzaUtile.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){	

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			matricola.access = "protected";
			tipologia.access = "protected";	
			potenzaUtile.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";
			
			try	{		
				// devo rendere invisibile il pulsante di RollBack della sostituzione
				var vIndice = rowSost.index;
				var vRowCount = _rowSost.count;			
		
				for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
					var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
					var vIndex = currentRow.index;
					
					
					if (flagDismiss.rawValue == 1  ) {
						//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
						currentRow.button.presence = "invisible";
					}	
				}			
			}catch(e){ null;}	
			
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.679mm" y="23.048mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Tipologia</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tipologia[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Tipologia 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="tipologia" y="23.048mm" w="62.68mm" h="6mm" x="23.677mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L4_8tipologia"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="31.846mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="10.008mm" x="87.57mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L4_8fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="32.25mm" x="142.164mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	flagDismiss.rawValue = "1";
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	matricola.access = "protected";
	tipologia.access = "protected";	
	potenzaUtile.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}
	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}		
}
</script>
                        </event>
                     </field>
                     <field name="flagAnnullaDismiss" y="32.25mm" x="158.137mm" w="12.334mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="5.333mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagAnnullaDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 0 ) { 
	button.annullaDismiss.presence = "invisible";
}	
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 1?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost">
                     <bind match="dataRef" ref="$.sezAGsostituite.rowAGsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
row.datiGT.tipologia.rawValue =			datiGT.tipologia.rawValue;
row.datiGT.potenzaUtile.rawValue =		datiGT.potenzaUtile.rawValue;

//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
/*
if (datiGT.flagEditSez4_8.rawValue == "true")
	this.presence = "invisible";
*/
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == 1 ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="29.422mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.291mm" x="23.473mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_8dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="15.066mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="15.066mm" w="62.323mm" h="6mm" x="23.473mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_8matricola"/>
                           <traversal>
                              <traverse ref="flagEditSez4_8[0]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L4_8dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.391mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.391mm" w="60.659mm" h="6mm" x="125.988mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_8modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <draw name="txcivico" x="106.982mm" y="22.143mm" w="19.006mm" h="6mm">
                           <value>
                              <text>Potenza utile</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaUtile[0]"/>
                           </traversal>
                           <?renderCache.bounds 53875 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 13 Potenza utile 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potenzaUtile" y="22.143mm" x="126.393mm" w="20.018mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_8potUtile"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="147.018mm" y="22.143mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.477mm" y="22.143mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Tipologia</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tipologia[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Tipologia 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="tipologia" y="22.143mm" w="62.076mm" h="6mm" x="23.473mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L4_8tipologia"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <field name="flagEditSez4_8" y="21.334mm" x="166.024mm" w="28mm" h="6mm" presence="invisible">
                           <ui>
                              <checkButton>
                                 <border>
                                    <?templateDesigner StyleID apcb2?>
                                    <edge stroke="lowered"/>
                                    <fill/>
                                 </border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>false</text>
                           </value>
                           <caption placement="right" reserve="21mm">
                              <para vAlign="middle"/>
                              <value>
                                 <text>Flag Edit Sez4_8</text>
                              </value>
                           </caption>
                           <items>
                              <text>true</text>
                              <text>false</text>
                           </items>
                           <bind match="dataRef" ref="$.flagRollBack4_8"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </field>
                        <field name="codFabbricante" y="8.595mm" x="86.155mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L4_8fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori5_1" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaSistemiRegolaz.regolazionePrimaria"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>5. SISTEMI DI REGOLAZIONE E CONTABILIZZAZIONE</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 45 5. SISTEMI DI REGOLAZIONE E CONTABILIZZAZIONE 0 130426 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="#subform[1]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="#subform[1]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="92.305mm" h="6mm">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_4_1" w="50.972mm" minH="6mm">
                  <value>
                     <text>5.1 REGOLAZIONE PRIMARIA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="nota5_1[0]"/>
                  </traversal>
               </draw>
               <field name="nota5_1" w="5.257mm" h="4.65mm" x="50.972mm" presence="invisible">
                  <ui>
                     <button highlight="inverted"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("Nel caso di sistemi integrati nel generatore compilare solamente i campi: 'Numero punti di regolazione' e 'Numero livelli di temperatura'.");
</script>
                  </event>
                  <traversal>
                     <traverse ref="img5_1[0]"/>
                  </traversal>
               </field>
               <draw name="img5_1" w="5.055mm" h="4.044mm" x="51.174mm" y="0.606mm" presence="invisible">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="subF[0]"/>
                  </traversal>
               </draw>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
                  <traverse ref="subF[0]"/>
               </traversal>
            </subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="subF">
               <bind match="none"/>
               <field name="flagRegolazOnOff" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L5_1flagRegolazOnOff"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == 1 &amp;&amp; generatori.presence == "hidden")
	generatori.presence = "visible";
else if (this.rawValue == 0 &amp;&amp; flagRegolazCurvaIntegr.rawValue == 0 &amp;&amp; flagRegolazCurvaIndip.rawValue == 0)
	generatori.presence = "hidden";	
*/
</script>
                  </event>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*
if (this.rawValue == 1 )
	generatori.presence = "visible";
*/
</script>
                  </event>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.17mm" h="6mm">
                  <value>
                     <text>Sistema di regolazione ON - OFF</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagRegolazCurvaIntegr[0]"/>
                  </traversal>
                  <?renderCache.bounds 530560 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 31 Sistema di regolazione ON - OFF 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <margin leftInset="2mm"/>
               <field name="flagRegolazCurvaIntegr" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L5_1flagRegolazCurvaIntegr"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == 1 &amp;&amp; generatori.presence == "hidden")
	generatori.presence = "visible";
else if (this.rawValue == 0 &amp;&amp; flagRegolazOnOff.rawValue == 0 &amp;&amp; flagRegolazCurvaIndip.rawValue == 0)
	generatori.presence = "hidden";	
*/
</script>
                  </event>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == 1 )
	generatori.presence = "visible";
*/
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Sistema di regolazione con impostazione della curva climatica integrata nel generatore</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagRegolazCurvaIndip[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 86 Sistema di regolazione con impostazione della curva climatica integrata nel generatore 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagRegolazCurvaIndip" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L5_1flagRegolazCurvaIndipen"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == 1 &amp;&amp; generatori.presence == "hidden")
	generatori.presence = "visible";
else if (this.rawValue == 0 &amp;&amp; flagRegolazCurvaIntegr.rawValue == 0 &amp;&amp; flagRegolazOnOff.rawValue == 0)
	generatori.presence = "hidden";	
*/
</script>
                  </event>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
/*
generatori.presence = "visible";
*/
</script>
                  </event>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == 1 )
	generatori.presence = "visible";
*/
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Sistema di regolazione con impostazione della curva climatica indipendente</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="generatori[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 74 Sistema di regolazione con impostazione della curva climatica indipendente 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <traversal>
                  <traverse operation="first" ref="flagRegolazOnOff[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <subform y="10.717mm" w="196.758mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezSR"/>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){ 
	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = schedaGeneratori5_1.generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo SR.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowSR[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="invisible">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.685mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	

if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.numPuntiReg.rawValue = null;
	datiGT.numLivelliTemp.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina SR corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.806mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.603mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.numPuntiReg.access = "open";
datiGT.numLivelliTemp.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="24.726mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="0.973458in" h="6.209mm">
                        <value>
                           <text>Sistema reg.ne</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 70089 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 14 Sistema reg.ne 0 2835 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>SR</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L5_1numSR"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );	
	
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;		
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="167.22mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 474009 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="32.787mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.13mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || numPuntiReg.rawValue != null || numLivelliTemp.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <assist>
                           <toolTip>(SR)Fabbricante (sez 5.1)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L5_1dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || numPuntiReg.rawValue != null || numLivelliTemp.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>(SR)Data installazione (sez 5.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.072mm" y="9.13mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L5_1dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	

	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>(SR)Data dismissione (sez 5.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.23mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.23mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L5_1modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || numPuntiReg.rawValue != null || numLivelliTemp.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>(SR)Modello (sez 5.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="txcivico" x="5.072mm" y="16.237mm" w="40.231mm" h="6mm">
                        <value>
                           <text>Numero punti di regolazione</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numPuntiReg[0]"/>
                        </traversal>
                        <?renderCache.bounds 114041 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 Numero punti di regolazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="numPuntiReg" y="16.237mm" x="45.917mm" w="18.602mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="3" fracDigits="0"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L5_1numPuntiReg"/>
                     </field>
                     <field name="sostComp" y="24.497mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null  ||  modello.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		dataInstallaz.execEvent("exit");
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.numPuntiReg.rawValue = numPuntiReg.rawValue;		
			newRow.datiGT.numLivelliTemp.rawValue = numLivelliTemp.rawValue;

			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();			
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;
			fabbricante.rawValue = null;
			modello.rawValue = null;
			numPuntiReg.rawValue = null;			
			numLivelliTemp.rawValue = null;
			
			flagSost.rawValue = "1";

			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="24.497mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null ||  modello.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		dataInstallaz.execEvent("exit");
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			numPuntiReg.access = "protected";	
			numLivelliTemp.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}	
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="106.981mm" y="16.237mm" w="41.649mm" h="6mm">
                        <value>
                           <text>Numero livelli di temperatura</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numLivelliTemp[0]"/>
                        </traversal>
                        <?renderCache.bounds 118060 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 29 Numero livelli di temperatura 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="numLivelliTemp" y="16.237mm" x="149.645mm" w="20.018mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="3" fracDigits="0"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L5_1numLivTemp"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="24.295mm" x="34.796mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.736mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L5_1fabbricante"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="24.901mm" x="138.929mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	numPuntiReg.access = "protected";	
	numLivelliTemp.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost">
                     <bind match="dataRef" ref="$.sezSRsostituite.rowSRsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm" presence="invisible">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.numPuntiReg.rawValue =		datiGT.numPuntiReg.rawValue;
row.datiGT.numLivelliTemp.rawValue =	datiGT.numLivelliTemp.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="23.355mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.291mm" x="23.473mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L5_1dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.072mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L5_1dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.391mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.391mm" w="60.659mm" h="6mm" x="125.988mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L5_1modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <draw name="txcivico" x="5.072mm" y="15.267mm" w="40.231mm" h="6mm">
                           <value>
                              <text>Numero punti di regolazione</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="numPuntiReg[0]"/>
                           </traversal>
                           <?renderCache.bounds 114041 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 27 Numero punti di regolazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="numPuntiReg" y="15.267mm" x="45.917mm" w="18.602mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="3" fracDigits="0"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                           <bind match="dataRef" ref="$.L5_1numPuntiReg"/>
                        </field>
                        <draw name="txcivico" x="106.981mm" y="15.267mm" w="41.649mm" h="6mm">
                           <value>
                              <text>Numero livelli di temperatura</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="numLivelliTemp[0]"/>
                           </traversal>
                           <?renderCache.bounds 118060 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 29 Numero livelli di temperatura 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="numLivelliTemp" y="15.267mm" x="149.645mm" w="20.018mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="3" fracDigits="0"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L5_1numLivTemp"/>
                        </field>
                        <field name="codFabbricante" y="8.999mm" x="86.155mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L5_1fabbricante"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <event activity="initialize" name="event__initialize">
                  <script contentType="application/x-javascript">/*
this.presence = "hidden";
*/
</script>
               </event>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="subF2">
               <bind match="none"/>
               <field name="flagValvRegolaz" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L5_1flagValvoleReg"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == 1 &amp;&amp; generatori2.presence == "hidden")
	generatori2.presence = "visible";
else if (this.rawValue == 0 )
	generatori2.presence = "hidden";	
*/
</script>
                  </event>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
/*
generatori2.presence = "visible";
*/
</script>
                  </event>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == 1 )
	generatori2.presence = "visible";
*/
</script>
                  </event>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.17mm" h="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Valvole di regolazione<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt;font-weight:normal">(se non incorporate nel generatore)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="generatori2[0]"/>
                  </traversal>
               </draw>
               <margin leftInset="2mm"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="flagValvRegolaz[0]"/>
                  <traverse ref="generatori2[0]"/>
               </traversal>
            </subform>
            <subform w="196.758mm" layout="lr-tb" name="generatori2">
               <bind match="dataRef" ref="$.sezVR"/>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){ 
	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = schedaGeneratori5_1.generatori2.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo VR.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowVR[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.69mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	

if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.numVie.rawValue = null;
	datiGT.servomotore.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina VR corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.811mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.608mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.numVie.access = "open";
datiGT.servomotore.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";


    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	
	
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="24.726mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="0.973458in" h="6.209mm">
                        <value>
                           <text>Valvola reg.ne</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 70089 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 14 Valvola reg.ne 0 2835 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>VR</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L5_1numVR"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori2.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;		
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="167.22mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 474009 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="32.787mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.13mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList textEntry="1">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || numVie.rawValue != null || servomotore.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <assist>
                           <toolTip>(VR)Fabbricante (sez 5.1)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L5_1dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || numVie.rawValue != null || servomotore.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>(VR)Data installazione (sez 5.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.13mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L5_1dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	

	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>(VR)Data dismissione (sez 5.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.23mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.23mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L5_1modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || numVie.rawValue != null || servomotore.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>(VR)Modello (sez 5.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="txcivico" x="5.275mm" y="16.237mm" w="22.646mm" h="6mm">
                        <value>
                           <text>Numero di vie</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numVie[0]"/>
                        </traversal>
                        <?renderCache.bounds 64193 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 13 Numero di vie 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="numVie" y="16.237mm" x="28.326mm" w="10.919mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal fracDigits="0" leadDigits="3"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L5_1numVie"/>
                     </field>
                     <field name="sostComp" y="24.497mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null  ||  modello.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		dataInstallaz.execEvent("exit");
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.numVie.rawValue = numVie.rawValue;		
			newRow.datiGT.servomotore.rawValue = servomotore.rawValue;
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;
			dataDismiss.rawValue = null;
			fabbricante.rawValue = "";
			modello.rawValue = "";
			numVie.rawValue = "";			
			servomotore.rawValue = "";
			
			flagSost.rawValue = "1";

			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "Bozza")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="24.497mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null ||  modello.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		dataInstallaz.execEvent("exit");
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			numVie.access = "protected";	
			servomotore.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}	
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <draw name="txcivico" x="106.981mm" y="16.237mm" w="20.221mm" h="6mm">
                        <value>
                           <text>Servomotore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="servomotore[0]"/>
                        </traversal>
                        <?renderCache.bounds 57319 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Servomotore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="servomotore" y="16.237mm" x="128.212mm" w="57.627mm" h="6mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L5_1servomotore"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="24.502mm" x="35.403mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.539mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L5_1fabbricante"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="24.501mm" x="138.727mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	numVie.access = "protected";	
	servomotore.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                  </subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost">
                     <bind match="dataRef" ref="$.sezVRsostituite.rowVRsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.numVie.rawValue =			datiGT.numVie.rawValue;
row.datiGT.servomotore.rawValue =		datiGT.servomotore.rawValue;

//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="23.355mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.291mm" x="23.473mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L5_1dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L5_1dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.391mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.391mm" w="59.852mm" h="6mm" x="125.988mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L5_1modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <draw name="txcivico" x="5.275mm" y="15.474mm" w="22.646mm" h="6mm">
                           <value>
                              <text>Numero di vie</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="numVie[0]"/>
                           </traversal>
                           <?renderCache.bounds 64193 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 13 Numero di vie 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="numVie" y="15.474mm" x="28.528mm" w="12.941mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal fracDigits="0" leadDigits="3"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                           <bind match="dataRef" ref="$.L5_1numVie"/>
                        </field>
                        <draw name="txcivico" x="107.183mm" y="15.474mm" w="20.221mm" h="6mm">
                           <value>
                              <text>Servomotore</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="servomotore[0]"/>
                           </traversal>
                           <?renderCache.bounds 57319 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Servomotore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="servomotore" y="15.474mm" x="128.414mm" w="57.627mm" h="6mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L5_1servomotore"/>
                        </field>
                        <field name="codFabbricante" y="9.408mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L5_1fabbricante"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <event activity="initialize" name="event__initialize">
                  <script contentType="application/x-javascript">
//this.presence = "hidden";

</script>
               </event>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="subF3">
               <bind match="none"/>
               <field name="flagRegolazMultiGrad" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L5_1flagRegMultiGrad"/>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.17mm" h="6mm">
                  <value>
                     <text>Sistema di regolazione multigradino</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagRegolazInverter[0]"/>
                  </traversal>
                  <?renderCache.bounds 530560 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 35 Sistema di regolazione multigradino 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <margin leftInset="2mm"/>
               <field name="flagRegolazInverter" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L5_1flagRegInverter"/>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Sistema di regolazione a Inverter del generatore</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagRegolazAltri[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 48 Sistema di regolazione a Inverter del generatore 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagRegolazAltri" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L5_1flagAltriSistRegPrim"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">/*
if (this.rawValue == 1)
	altro.presence = "visible";
else { 	
	altro.descrSistema.rawValue = "";
	altro.presence = "hidden";
}
*/
if (this.rawValue != 1)
	altro.descrSistema.rawValue = "";

</script>
                  </event>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
//altro.presence = "visible";
</script>
                  </event>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*
if (this.rawValue == 1)
	altro.presence = "visible";
*/
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Altri sistemi di regolazione primaria<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt;font-weight:normal">(</span><span style="font-size:7pt;font-weight:normal;text-decoration:none">Riportare descrizione del sistema, fabbricanti, modelli, etc.</span><span style="font-size:7pt;font-weight:normal">)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
               </draw>
               <subform x="2mm" y="-234.815mm" w="194.152mm" minH="254.772mm" layout="lr-tb" name="altro">
                  <bind match="none"/>
                  <draw name="Rectangle6" w="194.152mm" h="1.957mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <draw name="txcivico" w="35.425mm" h="10.248mm">
                     <value>
                        <text>Descrizione del sistema</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="descrSistema[0]"/>
                     </traversal>
                     <?renderCache.bounds 100417 29049 0 0 0 0 0 0?>
                     <?renderCache.textRun 23 Descrizione del sistema 0 2835 16872 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="descrSistema" w="158.322mm" minH="9.843mm">
                     <ui>
                        <textEdit multiLine="1">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L5_1descrSistema"/>
                     <value>
                        <text maxChars="500"/>
                     </value>
                  </field>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
//this.presence = "hidden";

</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="txcivico[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="altro[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <traversal>
               <traverse operation="first" ref="subF3[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaSistemiRegolaz5_2" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaSistemiRegolaz.regolazioneSingoloAmb"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>5. SISTEMI DI REGOLAZIONE E CONTABILIZZAZIONE</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 45 5. SISTEMI DI REGOLAZIONE E CONTABILIZZAZIONE 0 130426 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="sfTit[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="sfTit[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="92.305mm" h="6.268mm" name="sfTit">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_4_1" w="91.816mm" h="5.864mm">
                  <value>
                     <text>5.2 REGOLAZIONE SINGOLO AMBIENTE DI ZONA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="subF[0]"/>
                  </traversal>
                  <?renderCache.bounds 258849 16622 0 0 1417 0 0 0?>
                  <?renderCache.textRun 40 5.2 REGOLAZIONE SINGOLO AMBIENTE DI ZONA 0 1417 10659 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
                  <traverse ref="subF[0]"/>
               </traversal>
            </subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="subF">
               <bind match="none"/>
               <field name="flagTermostOnOff" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagTermostatoOnOff"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	subF.flagTermostProporz.rawValue = "0";
	subF.flagControlloEntalp.rawValue = "0";
	subF.flagControlloPortata.rawValue = "0";
}	
</script>
                  </event>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.17mm" h="6mm">
                  <value>
                     <text>Termostato di zona o ambiente con controllo ON-OFF</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagTermostProporz[0]"/>
                  </traversal>
                  <?renderCache.bounds 530560 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 50 Termostato di zona o ambiente con controllo ON-OFF 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <margin leftInset="2mm"/>
               <field name="flagTermostProporz" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagTermostatoProporz"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	subF.flagTermostOnOff.rawValue = "0";
	subF.flagControlloEntalp.rawValue = "0";
	subF.flagControlloPortata.rawValue = "0";
}	
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Termostato di zona o ambiente con controllo proporzionale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagControlloEntalp[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 57 Termostato di zona o ambiente con controllo proporzionale 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagControlloEntalp" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagControlEntalpico"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	subF.flagTermostOnOff.rawValue = "0";
	subF.flagTermostProporz.rawValue = "0";
	subF.flagControlloPortata.rawValue = "0";
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Controllo entalpico su serranda aria esterna</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagControlloPortata[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 44 Controllo entalpico su serranda aria esterna 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagControlloPortata" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagControlPortata"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	subF.flagTermostOnOff.rawValue = "0";
	subF.flagTermostProporz.rawValue = "0";
	subF.flagControlloEntalp.rawValue = "0";
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.17mm" h="6mm">
                  <value>
                     <text>Controllo portata aria variabile per aria canalizzata</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" weight="bold" baselineShift="0pt"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="cognome[0]"/>
                  </traversal>
                  <?renderCache.bounds 530560 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 53 Controllo portata aria variabile per aria canalizzata 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <draw name="Rectangle6" w="194.152mm" h="8.893mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <draw name="xindir" w="86.581mm" h="6mm">
                  <value>
                     <text>Valvole Termostatiche (rif. UNI EN 215)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagValvTermostPresente[0]"/>
                  </traversal>
                  <?renderCache.bounds 239757 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 39 Valvole Termostatiche (rif. UNI EN 215) 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagValvTermostPresente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagValvTermostSI"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagValvTermostAssente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagValvTermostAssente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Valvole Termostatiche presente (sez 5.2)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="24.753mm" h="6mm">
                  <value>
                     <text>Presenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagValvTermostAssente[0]"/>
                  </traversal>
                  <?renderCache.bounds 64497 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 8 Presenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagValvTermostAssente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagValvTermostNO"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagValvTermostPresente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagValvTermostPresente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Valvole Termostatiche assente (sez 5.2)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="23.338mm" h="6mm">
                  <value>
                     <text>Assenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="valDataContrattoAl[0]"/>
                  </traversal>
                  <?renderCache.bounds 60486 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 7 Assenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="xindir" w="86.581mm" h="6mm">
                  <value>
                     <text>Valvole a due vie</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagValvDueViePresente[0]"/>
                  </traversal>
                  <?renderCache.bounds 239757 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 17 Valvole a due vie 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagValvDueViePresente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagValvDueVieSI"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagValvDueVieAssente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagValvDueVieAssente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Valvole due vie presente (sez 5.2)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[2]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="24.753mm" h="6mm">
                  <value>
                     <text>Presenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagValvDueVieAssente[0]"/>
                  </traversal>
                  <?renderCache.bounds 64497 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 8 Presenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagValvDueVieAssente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagValvDueVieNO"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagValvDueViePresente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagValvDueViePresente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Valvole due vie assente (sez 5.2)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[3]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="23.338mm" h="6mm">
                  <value>
                     <text>Assenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="xindir[2]"/>
                  </traversal>
                  <?renderCache.bounds 60486 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 7 Assenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="xindir" w="86.581mm" h="6mm">
                  <value>
                     <text>Valvole a tre vie</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagValvTreViePresente[0]"/>
                  </traversal>
                  <?renderCache.bounds 239757 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 17 Valvole a tre vie 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagValvTreViePresente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagValvTreVieSI"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagValvTreVieAssente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagValvTreVieAssente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Valvole tre vie presente (sez 5.2)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[4]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="24.753mm" h="6mm">
                  <value>
                     <text>Presenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagValvTreVieAssente[0]"/>
                  </traversal>
                  <?renderCache.bounds 64497 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 8 Presenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagValvTreVieAssente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_2flagValvTreVieNO"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagValvTreViePresente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagValvTreViePresente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Valvole tre vie assente (sez 5.2)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[5]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="23.338mm" h="6mm">
                  <value>
                     <text>Assenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="txcivico[6]"/>
                  </traversal>
                  <?renderCache.bounds 60486 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 7 Assenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="Rectangle6" w="194.152mm" h="1.957mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <draw name="txcivico" w="15.811mm" h="10.248mm">
                  <value>
                     <text>Note</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="2.835pt"/>
                  <font size="8pt" typeface="Verdana"/>
                  <traversal>
                     <traverse ref="note[0]"/>
                  </traversal>
                  <?renderCache.bounds 44819 29049 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 Note 0 2835 16872 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="note" w="177.936mm" minH="9.843mm">
                  <ui>
                     <textEdit multiLine="1">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L5_2note"/>
                  <value>
                     <text maxChars="1000"/>
                  </value>
                  <traversal>
                     <traverse ref="sfTit[1]"/>
                  </traversal>
               </field>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="flagTermostOnOff[0]"/>
                  <traverse ref="sfTit[1]"/>
               </traversal>
            </subform>
            <draw name="Rectangle6" w="194.152mm" h="7.606mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="194.192mm" h="6.268mm" name="sfTit">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_4_1" w="96.063mm" h="5.864mm">
                  <value>
                     <text>5.3 SISTEMI TELEMATICI DI TELELETTURA E TELEGESTIONE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="subF3[0]"/>
                  </traversal>
                  <?renderCache.bounds 270888 16622 0 0 1417 0 0 0?>
                  <?renderCache.textRun 52 5.3 SISTEMI TELEMATICI DI TELELETTURA E TELEGESTIONE 0 1417 10659 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
                  <traverse ref="subF3[0]"/>
               </traversal>
            </subform>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="subF3">
               <bind match="none"/>
               <draw name="Rectangle6" w="194.152mm" h="5.184mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <draw name="xindir" w="86.581mm" h="6mm">
                  <value>
                     <text>Telelettura</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagTeleLettPresente[0]"/>
                  </traversal>
                  <?renderCache.bounds 239757 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 11 Telelettura 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTeleLettPresente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_3flagTeleLetturaSI"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTeleLettAssente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTeleLettAssente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Telelettura presente (sez 5.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="24.753mm" h="6mm">
                  <value>
                     <text>Presenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagTeleLettAssente[0]"/>
                  </traversal>
                  <?renderCache.bounds 64497 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 8 Presenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTeleLettAssente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_3flagTeleLetturaNO"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTeleLettPresente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTeleLettPresente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Telelettura assente (sez 5.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="23.338mm" h="6mm">
                  <value>
                     <text>Assenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="valDataContrattoAl[0]"/>
                  </traversal>
                  <?renderCache.bounds 60486 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 7 Assenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="xindir" w="86.581mm" h="6mm">
                  <value>
                     <text>Telegestione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagTeleGestPresente[0]"/>
                  </traversal>
                  <?renderCache.bounds 239757 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 12 Telegestione 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTeleGestPresente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_3flagTeleGestioneSI"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTeleGestAssente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTeleGestAssente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Telegestione presente (sez 5.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[2]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="24.753mm" h="6mm">
                  <value>
                     <text>Presenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagTeleGestAssente[0]"/>
                  </traversal>
                  <?renderCache.bounds 64497 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 8 Presenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagTeleGestAssente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_3flagTeleGestioneNO"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagTeleGestPresente.rawValue = "0";

}
</script>
                  </event>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTeleGestPresente.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Telegestione assente (sez 5.3)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txcivico[3]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="23.338mm" h="6mm">
                  <value>
                     <text>Assenti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="txcivico[4]"/>
                  </traversal>
                  <?renderCache.bounds 60486 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 7 Assenti 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <margin leftInset="2mm"/>
               <draw name="txcivico" w="193.343mm" h="8.496mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">Descrizione del sistema<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt">(situazione alla prima installazione o alla ristrutturazione dell'impianto termico)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="bottom" marginLeft="2.835pt" spaceBelow="4pt"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="descrSistema[0]"/>
                  </traversal>
               </draw>
               <field name="descrSistema" w="193.747mm" minH="9.843mm">
                  <ui>
                     <textEdit multiLine="1">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="2mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L5_3descrSistema"/>
                  <value>
                     <text maxChars="1000"/>
                  </value>
                  <traversal>
                     <traverse ref="xindir[2]"/>
                  </traversal>
               </field>
               <draw name="Rectangle6" w="194.152mm" h="1.957mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <draw name="xindir" w="32.594mm" h="6mm">
                  <value>
                     <text>Data di sostituzione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="dataSostituzione[0]"/>
                  </traversal>
                  <?renderCache.bounds 86723 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 20 Data di sostituzione 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="dataSostituzione" w="20.22mm" h="6mm">
                  <ui>
                     <dateTimeEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </dateTimeEdit>
                     <picture>date{DD/MM/YYYY}</picture>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle" hAlign="center"/>
                  <value>
                     <date/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle" hAlign="center"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L5_3dataSostituzione">
                     <picture>date{YYYY-MM-DD}</picture>
                  </bind>
                  <format>
                     <picture>date{DD/MM/YYYY}</picture>
                  </format>
                  <validate formatTest="error">
                     <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValido";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere maggiore di quella odierna.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString() ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     <message>
                        <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                     </message>
                     <picture>date{DD/MM/YYYY}</picture>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[5]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="193.343mm" h="8.496mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Descrizione del sistema<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt">(sostituzione del sistema)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="bottom" marginLeft="2.835pt" spaceBelow="4pt"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="descrSistemaSostituz[0]"/>
                  </traversal>
               </draw>
               <field name="descrSistemaSostituz" w="193.747mm" minH="9.843mm">
                  <ui>
                     <textEdit multiLine="1">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="2mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L5_3descrSistemaSost"/>
                  <value>
                     <text maxChars="1000"/>
                  </value>
                  <traversal>
                     <traverse ref="sfTit[2]"/>
                  </traversal>
               </field>
               <subform x="2mm" y="-234.815mm" w="194.152mm" minH="254.772mm" layout="lr-tb" name="altro">
                  <bind match="none"/>
                  <?templateDesigner expand 1?></subform>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="xindir[0]"/>
                  <traverse ref="sfTit[2]"/>
               </traversal>
            </subform>
            <draw name="Rectangle6" w="194.152mm" h="7.606mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="194.192mm" h="6.268mm" name="sfTit">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_4_1" w="96.063mm" h="5.864mm">
                  <value>
                     <text>5.4 CONTABILIZZAZIONE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="subF4[0]"/>
                  </traversal>
                  <?renderCache.bounds 270888 16622 0 0 1417 0 0 0?>
                  <?renderCache.textRun 21 5.4 CONTABILIZZAZIONE 0 1417 10659 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
                  <traverse ref="subF4[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="subF4">
               <bind match="none"/>
               <draw name="Rectangle6" w="194.152mm" h="5.184mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <draw name="xindir" w="86.581mm" h="6mm">
                  <value>
                     <text>Unita' Immobiliari Contabilizzate</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagUICsi[0]"/>
                  </traversal>
                  <?renderCache.bounds 239757 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 33 Unita' Immobiliari Contabilizzate 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagUICsi" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_4flagUIcontabilizzSI"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagUICno.rawValue = "0";
	//subF3.presence = "visible";
}else {
	subF3.flagRiscald.rawValue = "0";
	subF3.flagRaffresc.rawValue = "0";
	subF3.flagACS.rawValue = "0";
	//subF3.presence = "hidden";
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txcivico[0]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="24.753mm" h="6mm">
                  <value>
                     <text>SI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagUICno[0]"/>
                  </traversal>
                  <?renderCache.bounds 64497 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 2 SI 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagUICno" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_4flagUIcontabilizzNO"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagUICsi.rawValue = "0";
	
	subF3.flagRiscald.rawValue = "0";
	subF3.flagRaffresc.rawValue = "0";
	subF3.flagACS.rawValue = "0";
	//subF3.presence = "hidden";
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txcivico[1]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="23.338mm" h="6mm">
                  <value>
                     <text>NO</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="subF3[0]"/>
                  </traversal>
                  <?renderCache.bounds 60486 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 2 NO 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <subform w="194.758mm" minH="6mm" layout="lr-tb" name="subF3">
                  <bind match="none"/>
                  <draw name="Rectangle6" w="192.556mm" h="1.955mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <draw name="xindir" w="45.961mm" h="6mm">
                     <value>
                        <text>Se contabilizzate</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <margin leftInset="0mm"/>
                     <traversal>
                        <traverse ref="flagRiscald[0]"/>
                     </traversal>
                     <?renderCache.bounds 130283 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 17 Se contabilizzate 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="flagRiscald" w="5.577mm" h="6mm">
                     <ui>
                        <checkButton mark="cross" size="3.175mm">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb2?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L5_4flagRiscald"/>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" w="33.043mm" h="6mm">
                     <value>
                        <text>Riscaldamento</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="flagRaffresc[0]"/>
                     </traversal>
                     <?renderCache.bounds 90830 17008 0 0 2835 0 0 0?>
                     <?renderCache.textRun 13 Riscaldamento 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <margin leftInset="2mm"/>
                  <field name="flagRaffresc" w="5.577mm" h="6mm">
                     <ui>
                        <checkButton mark="cross" size="3.175mm">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb2?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L5_4flagRaffresc"/>
                     <traversal>
                        <traverse ref="txflag1[1]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" w="24.753mm" h="6mm">
                     <value>
                        <text>Raffrescamento</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="flagACS[0]"/>
                     </traversal>
                     <?renderCache.bounds 67331 17008 0 0 2835 0 0 0?>
                     <?renderCache.textRun 14 Raffrescamento 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="flagACS" w="5.577mm" h="6mm">
                     <ui>
                        <checkButton mark="cross" size="3.175mm">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb2?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L5_4flagACS"/>
                     <traversal>
                        <traverse ref="txflag1[2]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" w="39.918mm" h="6mm">
                     <value>
                        <text>Acqua calda sanitaria</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="valDataContrattoAl[0]"/>
                     </traversal>
                     <?renderCache.bounds 110318 17008 0 0 2835 0 0 0?>
                     <?renderCache.textRun 21 Acqua calda sanitaria 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="Rectangle6" w="192.759mm" h="2.152mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <?templateDesigner expand 1?>
                  <traversal>
                     <traverse operation="first" ref="xindir[0]"/>
                     <traverse ref="xindir[1]"/>
                  </traversal>
               </subform>
               <draw name="xindir" w="86.581mm" h="6mm">
                  <value>
                     <text>Tipologia sistema</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagSistemaDiretto[0]"/>
                  </traversal>
                  <?renderCache.bounds 239757 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 17 Tipologia sistema 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagSistemaDiretto" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_4flagSistemaDiretto"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagSistemaIndiretto.rawValue = "0";

}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txcivico[2]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="24.753mm" h="6mm">
                  <value>
                     <text>diretto</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="flagSistemaIndiretto[0]"/>
                  </traversal>
                  <?renderCache.bounds 64497 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 7 diretto 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="flagSistemaIndiretto" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="circle" size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L5_4flagSistemaIndiretto"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagSistemaDiretto.rawValue = "0";

}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txcivico[3]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="23.338mm" h="6mm">
                  <value>
                     <text>indiretto</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="txcivico[4]"/>
                  </traversal>
                  <?renderCache.bounds 60486 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 9 indiretto 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <margin leftInset="2mm"/>
               <draw name="txcivico" w="193.343mm" h="8.496mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">Descrizione del sistema<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt">(situazione alla prima installazione o alla ristrutturazione dell'impianto termico)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="bottom" marginLeft="2.835pt" spaceBelow="4pt"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="descrSistema[0]"/>
                  </traversal>
               </draw>
               <field name="descrSistema" w="193.747mm" minH="9.843mm">
                  <ui>
                     <textEdit multiLine="1">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="2mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L5_4descrSistema"/>
                  <value>
                     <text maxChars="1000"/>
                  </value>
                  <traversal>
                     <traverse ref="xindir[2]"/>
                  </traversal>
               </field>
               <draw name="Rectangle6" w="194.152mm" h="1.957mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <draw name="xindir" w="32.594mm" h="6mm">
                  <value>
                     <text>Data di sostituzione</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="2mm"/>
                  <traversal>
                     <traverse ref="dataSostituzione[0]"/>
                  </traversal>
                  <?renderCache.bounds 86723 17008 0 0 5669 0 0 0?>
                  <?renderCache.textRun 20 Data di sostituzione 0 5669 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <field name="dataSostituzione" w="20.22mm" h="6mm">
                  <ui>
                     <dateTimeEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </dateTimeEdit>
                     <picture>date{DD/MM/YYYY}</picture>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle" hAlign="center"/>
                  <value>
                     <date/>
                  </value>
                  <caption reserve="0.01in">
                     <para vAlign="middle" hAlign="center"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L5_4dataSostituzione">
                     <picture>date{YYYY-MM-DD}</picture>
                  </bind>
                  <format>
                     <picture>date{DD/MM/YYYY}</picture>
                  </format>
                  <validate formatTest="error">
                     <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValido";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere maggiore di quella odierna.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString() ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     <message>
                        <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                     </message>
                     <picture>date{DD/MM/YYYY}</picture>
                  </validate>
                  <traversal>
                     <traverse ref="txcivico[5]"/>
                  </traversal>
               </field>
               <draw name="txcivico" w="193.343mm" h="8.496mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Descrizione del sistema<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt">(sostituzione del sistema)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="bottom" marginLeft="2.835pt" spaceBelow="4pt"/>
                  <font size="8pt" typeface="Verdana"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="descrSistemaSostituz[0]"/>
                  </traversal>
               </draw>
               <field name="descrSistemaSostituz" w="193.747mm" minH="9.843mm">
                  <ui>
                     <textEdit multiLine="1">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="2mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L5_4descrSistemaSost"/>
                  <value>
                     <text maxChars="1000"/>
                  </value>
               </field>
               <subform x="2mm" y="-234.815mm" w="194.152mm" minH="254.772mm" layout="lr-tb" name="altro">
                  <bind match="none"/>
                  <?templateDesigner expand 1?></subform>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="xindir[0]"/>
               </traversal>
            </subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaGeneratori6" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaSistemiDistrib"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>6. SISTEMI DI DISTRIBUZIONE</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 27 6. SISTEMI DI DISTRIBUZIONE 0 192345 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="sftit[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="sftit[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="92.305mm" h="6mm" name="sftit">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_4_1" w="83.324mm" minH="6mm">
                  <value>
                     <text>6.1 TIPO DI DISTRIBUZIONE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="sf6_1[0]"/>
                  </traversal>
               </draw>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
                  <traverse ref="sf6_1[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="sf6_1">
               <bind match="none"/>
               <field name="flagVertic" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L6_1flagVerticale"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	flagOrizz.rawValue = "0";
	flagCanali.rawValue = "0";
	flagAltro.rawValue = "0";
	note.rawValue = "";
	note.access = "protected";	
}	
</script>
                  </event>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.17mm" h="6mm">
                  <value>
                     <text>Verticale a colonne montanti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagOrizz[0]"/>
                  </traversal>
                  <?renderCache.bounds 530560 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 28 Verticale a colonne montanti 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <margin leftInset="2mm"/>
               <field name="flagOrizz" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L6_1flagOrizzontale"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	flagVertic.rawValue = "0";
	flagCanali.rawValue = "0";
	flagAltro.rawValue = "0";
	note.rawValue = "";
	note.access = "protected";	
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Orizzontale a zone</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagCanali[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 18 Orizzontale a zone 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagCanali" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L6_1flagCanaliAria"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	flagOrizz.rawValue = "0";
	flagVertic.rawValue = "0";
	flagAltro.rawValue = "0";
	note.rawValue = "";
	note.access = "protected";	
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Canali d'aria</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagAltro[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 13 Canali d'aria 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagAltro" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L6_1flagAltro"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	flagOrizz.rawValue = "0";
	flagCanali.rawValue = "0";
	flagVertic.rawValue = "0";
	altroTipoDistrib.access = "open";
}else {
	altroTipoDistrib.rawValue = "";
	altroTipoDistrib.access = "protected";
}
</script>
                  </event>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	altroTipoDistrib.access = "open";
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="11.043mm" h="6mm">
                  <value>
                     <text>Altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" weight="bold" baselineShift="0pt"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="altroTipoDistrib[0]"/>
                  </traversal>
                  <?renderCache.bounds 28468 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 5 Altro 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="altroTipoDistrib" w="177.329mm" h="6.062mm">
                  <ui>
                     <textEdit hScrollPolicy="off">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L6_1DescrAltro"/>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.access = "protected";
</script>
                  </event>
                  <keep intact="contentArea"/>
                  <traversal>
                     <traverse ref="sftit[1]"/>
                  </traversal>
               </field>
               <traversal>
                  <traverse operation="first" ref="flagVertic[0]"/>
                  <traverse ref="sftit[1]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="194.152mm" h="6.268mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="92.305mm" h="6mm" name="sftit">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_4_1" w="83.324mm" minH="6mm">
                  <value>
                     <text>6.2 COIBENTAZIONE RETE DI DISTRIBUZIONE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="sf6_2[0]"/>
                  </traversal>
               </draw>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
                  <traverse ref="sf6_2[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="sf6_2">
               <bind match="none"/>
               <field name="flagCoibentAssente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L6_2flagCoibentNO"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	flagCoibentPresente.rawValue = "0";
}	
</script>
                  </event>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.17mm" h="6mm">
                  <value>
                     <text>Assente</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagCoibentPresente[0]"/>
                  </traversal>
                  <?renderCache.bounds 530560 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 7 Assente 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <margin leftInset="2mm"/>
               <field name="flagCoibentPresente" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton size="3.175mm" shape="round">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb4?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <bind match="dataRef" ref="$.L6_2flagCoibentSI"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	flagCoibentAssente.rawValue = "0";
}
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Presente</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 8 Presente 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <draw name="Rectangle6" w="194.758mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <draw name="txflag1" w="11.043mm" h="9.838mm">
                  <value>
                     <text>Note</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" weight="bold" baselineShift="0pt"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="note[0]"/>
                  </traversal>
                  <?renderCache.bounds 28468 27887 0 0 2835 0 0 0?>
                  <?renderCache.textRun 4 Note 0 2835 16291 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="note" w="182.906mm" minH="10mm">
                  <ui>
                     <textEdit multiLine="1">
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                        </border>
                        <margin/>
                     </textEdit>
                  </ui>
                  <font typeface="Verdana" size="8pt"/>
                  <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                  <para vAlign="middle"/>
                  <caption reserve="0.01in">
                     <para vAlign="middle"/>
                  </caption>
                  <border>
                     <edge presence="hidden"/>
                     <corner/>
                  </border>
                  <bind match="dataRef" ref="$.L6_2note"/>
                  <keep intact="contentArea"/>
                  <value>
                     <text maxChars="1000"/>
                  </value>
                  <traversal>
                     <traverse ref="sftit[2]"/>
                  </traversal>
               </field>
               <traversal>
                  <traverse operation="first" ref="flagCoibentAssente[0]"/>
                  <traverse ref="sftit[2]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="194.152mm" h="6.268mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="197.181mm" h="6mm" name="sftit">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_4_1" w="83.324mm" minH="6mm">
                  <value>
                     <text>6.3 VASI DI ESPANSIONE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="sf6_3[0]"/>
                  </traversal>
               </draw>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
                  <traverse ref="sf6_3[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="197.567mm" minH="30.205mm" layout="lr-tb" name="sf6_3">
               <bind match="none"/>
               <subform w="197.163mm" minH="6mm" layout="lr-tb" name="vasi">
                  <bind match="none"/>
                  <subform w="197.181mm" name="button" h="5.56mm">
                     <bind match="none"/>
                     <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                        <value>
                           <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Aggiungi riga.</toolTip>
                        </assist>
                        <margin leftInset="1mm"/>
                        <traversal>
                           <traverse ref="btAdd[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
	row.instanceManager.addInstance();



</script>
                        </event>
                        <assist>
                           <toolTip>Aggiungi nuovo GT.</toolTip>
                        </assist>
                        <margin leftInset="1mm"/>
                        <traversal>
                           <traverse ref="row[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="addRiga[0]"/>
                        <traverse ref="row[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="195.747mm" minH="6mm" layout="lr-tb" name="row">
                     <bind match="dataRef" ref="$.sezVasi.rowVasi[*]"/>
                     <subform w="4.93mm" name="button" h="5.772mm">
                        <bind match="none"/>
                        <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Cancella riga.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btCancella[0]"/>
                           </traversal>
                        </draw>
                        <field name="btCancella" w="4.535mm" h="4.832mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	

if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	capacita.rawValue = "";
	flagAperto.rawValue = "0";
	flagChiuso.rawValue = "0";
	pressione.rawValue = "";
}	

</script>
                           </event>
                           <assist>
                              <toolTip>Elimina GT corrente.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="cancellaRiga[0]"/>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <draw name="txcivico" w="6.613mm" h="6mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt" weight="bold"/>
                        <margin leftInset="2mm"/>
                        <value>
                           <text>VX</text>
                        </value>
                        <traversal>
                           <traverse ref="codice[0]"/>
                        </traversal>
                        <?renderCache.bounds 13077 17008 0 0 5669 0 0 0?>
                        <?renderCache.textRun 2 VX 0 5669 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
                     <field name="codice" w="5.661mm" h="6mm" access="readOnly">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L6_3codice"/>
                        <traversal>
                           <traverse ref="cognome[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index ;
			//xfa.host.messageBox("vIdx : "+vIdx );
				var currentRow = vasi.resolveNode("row["+ nItemCount +"]");
				
				//currentRow.codice.rawValue  = vIdx+1;	
				var vNum = currentRow.codice.rawValue;		
			}
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception vasi.row.codice::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <draw name="xindir" w="21.544mm" h="6mm">
                        <value>
                           <text> - Capacità (l)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <margin leftInset="0mm"/>
                        <traversal>
                           <traverse ref="capacita[0]"/>
                        </traversal>
                        <?renderCache.bounds 61070 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 16  - Capacità (l) 0 0 10954 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="capacita" w="18.915mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L6_3capacita"/>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" w="3.731mm" h="6mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="2mm"/>
                        <traversal>
                           <traverse ref="flagAperto[0]"/>
                        </traversal>
                        <?renderCache.bounds 4907 17008 0 0 5669 0 0 0?></draw>
                     <field name="flagAperto" w="5.577mm" h="6mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L6_3vasoAperto"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagChiuso.rawValue = "0";
	pressione.rawValue = "";
	pressione.access = "protected";	
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" w="11.93mm" h="6mm">
                        <value>
                           <text>Aperto</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="0mm"/>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                        <?renderCache.bounds 33817 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 6 Aperto 0 3588 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" w="6.555mm" h="6mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="2mm"/>
                        <traversal>
                           <traverse ref="flagChiuso[0]"/>
                        </traversal>
                        <?renderCache.bounds 12912 17008 0 0 5669 0 0 0?></draw>
                     <field name="flagChiuso" w="5.577mm" h="6mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L6_3vasoChiuso"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagAperto.rawValue = "0";
	pressione.access = "open";	
}else{
	pressione.rawValue = "";
	pressione.access = "protected";	
}
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") 
	pressione.access = "open";	
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[4]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" w="11.727mm" h="6mm">
                        <value>
                           <text>Chiuso</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="0mm"/>
                        <traversal>
                           <traverse ref="txcivico[5]"/>
                        </traversal>
                        <?renderCache.bounds 33242 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 6 Chiuso 0 3156 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <occur max="-1"/>
                     <draw name="txcivico" w="61.161mm" h="6mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="2mm"/>
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Pressione di precarica<span style="font-size:7pt"> (solo per vasi chiusi)</span></p></body>
                           </exData>
                        </value>
                        <traversal>
                           <traverse ref="pressione[0]"/>
                        </traversal>
                     </draw>
                     <field name="pressione" w="19.491mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L6_3pressione"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[6]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" w="8.18mm" h="6mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="0mm"/>
                        <value>
                           <text>(bar)</text>
                        </value>
                        <?renderCache.bounds 23187 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 (bar) 0 1359 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="Rectangle6" w="194.152mm" h="1.957mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <traversal>
                  <traverse operation="first" ref="vasi[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="112.643mm" h="6mm" name="sftit2">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="tx_4_1" w="112.643mm" minH="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">6.4 POMPE DI CIRCOLAZIONE<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt">(se non incorporate nel generatore)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="generatori2[0]"/>
                  </traversal>
               </draw>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
                  <traverse ref="generatori2[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.758mm" layout="lr-tb" name="generatori2">
               <bind match="dataRef" ref="$.sezPO"/>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){ 
	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = schedaGeneratori6.generatori2.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo PO.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowPO[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.76mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	

if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.flagSI.rawValue = "0";
	datiGT.flagNO.rawValue = "0";
	datiGT.potNominale.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina PO corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.881mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.678mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.flagSI.access = "open";
datiGT.flagNO.access = "open";
datiGT.potNominale.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

//01/12/2015
datiGT.dataDismiss.rawValue = null;

	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;

		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	

</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="24.726mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="0.973458in" h="6.209mm">
                        <value>
                           <text>Pompa</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 70089 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 Pompa 0 2835 10854 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.88mm">
                           <value>
                              <text>PO</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L6_4numPO"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori2.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;		
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}	
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="167.22mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 474009 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.181mm" h="32.787mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="9.13mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || flagSI.rawValue != 0 || flagNO.rawValue != 0 || potNominale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">

try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante (sez 6.4)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">

if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L6_4dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || flagSI.rawValue != 0 || flagNO.rawValue != 0 || potNominale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	}else
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }	else {
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 6.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="9.13mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L6_4dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 6.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.23mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.23mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L6_4modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || flagSI.rawValue != 0 || flagNO.rawValue != 0 || potNominale.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Modello (sez 6.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="txcivico" x="5.275mm" y="16.237mm" w="18.804mm" h="6mm">
                        <value>
                           <text>Giri variabili</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                        <?renderCache.bounds 53303 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 14 Giri variabili 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="sostComp" y="24.497mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null  ||  modello.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.flagSI.rawValue = flagSI.rawValue;
			newRow.datiGT.flagNO.rawValue = flagNO.rawValue;
			newRow.datiGT.potNominale.rawValue = potNominale.rawValue;

			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );

		
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;
			fabbricante.rawValue = null;
			modello.rawValue = null;
			flagSI.rawValue = "0";	
			flagNO.rawValue = "0";		
			potNominale.rawValue = null;
			
			flagSost.rawValue = "1";

			//--------------------------------------------------------------
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}	
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="24.497mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null ||  modello.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){	

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			flagSI.access = "protected";
			flagNO.access = "protected";	
			potNominale.access = "protected";
		
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
					currentRow.button.presence = "invisible";
				}	
			}		
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="106.981mm" y="16.237mm" w="25.119mm" h="6mm">
                        <value>
                           <text>Potenza nominale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potNominale[0]"/>
                        </traversal>
                        <?renderCache.bounds 71203 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 16 Potenza nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potNominale" y="16.237mm" x="133.065mm" w="20.827mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L6_4potNominale"/>
                        <traversal>
                           <traverse ref="flagSI[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" w="8.18mm" h="6mm" x="154.701mm" y="16.282mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="0mm"/>
                        <value>
                           <text>(kW)</text>
                        </value>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                        <?renderCache.bounds 23187 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 1638 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagSI" w="5.577mm" h="6mm" x="24.484mm" y="16.282mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L6_4GiriVarSI"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagNO.rawValue = "0";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" w="11.93mm" h="6mm" x="30.061mm" y="16.282mm">
                        <value>
                           <text>SI</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="0mm"/>
                        <traversal>
                           <traverse ref="flagNO[0]"/>
                        </traversal>
                        <?renderCache.bounds 33817 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 2 SI 0 12491 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagNO" w="5.577mm" h="6mm" x="42.48mm" y="16.282mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L6_4GiriVarNO"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagSI.rawValue = "0";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[4]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" w="11.727mm" h="6mm" x="48.057mm" y="16.282mm">
                        <value>
                           <text>NO</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <margin leftInset="0mm"/>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                        <?renderCache.bounds 33242 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 2 NO 0 10480 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagSost" y="24.37mm" x="34.998mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.747mm" x="87.57mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L6_4fabbricante"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="24.508mm" x="137.918mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	flagSI.access = "protected";
	flagNO.access = "protected";	
	potNominale.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost">
                     <bind match="dataRef" ref="$.sezPOsostituite.rowPOsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.flagSI.rawValue =			datiGT.flagSI.rawValue;
row.datiGT.flagNO.rawValue =			datiGT.flagNO.rawValue;
row.datiGT.potNominale.rawValue =		datiGT.potNominale.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="23.355mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.291mm" x="23.473mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L6_4dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.291mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L6_4dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.391mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.391mm" w="59.852mm" h="6mm" x="125.988mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L6_4modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="5.275mm" y="15.14mm" w="18.804mm" h="6mm">
                           <value>
                              <text>Giri variabili</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                           <?renderCache.bounds 53303 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 14 Giri variabili 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="106.981mm" y="15.14mm" w="25.119mm" h="6mm">
                           <value>
                              <text>Potenza nominale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potNominale[0]"/>
                           </traversal>
                           <?renderCache.bounds 71203 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 16 Potenza nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potNominale" y="15.14mm" x="133.065mm" w="20.827mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L6_4potNominale"/>
                           <traversal>
                              <traverse ref="flagSI[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="8.18mm" h="6mm" x="154.701mm" y="15.185mm">
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <value>
                              <text>(kW)</text>
                           </value>
                           <?renderCache.bounds 23187 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 1638 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagSI" w="5.577mm" h="6mm" x="24.484mm" y="15.185mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L6_4GiriVarSI"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagNO.rawValue = "0";
}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="11.93mm" h="6mm" x="30.061mm" y="15.185mm">
                           <value>
                              <text>SI</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagNO[0]"/>
                           </traversal>
                           <?renderCache.bounds 33817 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 SI 0 12491 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagNO" w="5.577mm" h="6mm" x="42.48mm" y="15.185mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L6_4GiriVarNO"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagSI.rawValue = "0";
}
</script>
                           </event>
                           <traversal>
                              <traverse ref="txcivico[4]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="11.727mm" h="6mm" x="48.057mm" y="15.185mm">
                           <value>
                              <text>NO</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                           <?renderCache.bounds 33242 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 NO 0 10480 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="codFabbricante" y="8.808mm" x="85.953mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L6_4fabbricante"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaSistEmissione7" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaSistemaEmissione"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>7. SISTEMA DI EMISSIONE</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 23 7. SISTEMA DI EMISSIONE 0 205013 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="subF3[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="subF3[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.152mm" minH="6mm" layout="lr-tb" name="subF3">
               <bind match="none"/>
               <field name="flagRadiatori" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTermoConv.rawValue != "1" &amp;&amp; flagVentilConv.rawValue != "1" &amp;&amp; flagPannelliRadia.rawValue != "1" &amp;&amp; flagBocchette.rawValue != "1" &amp;&amp;
    flagStrisceRadia.rawValue != "1" &amp;&amp; flagTravi.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false" ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L7flagRadiatori"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Radiatori (sez 7)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="xindir[6]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.17mm" h="6mm">
                  <value>
                     <text>Radiatori</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagTermoConv[0]"/>
                  </traversal>
                  <?renderCache.bounds 530560 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 9 Radiatori 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <margin leftInset="2mm"/>
               <field name="flagTermoConv" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagRadiatori.rawValue != "1" &amp;&amp; flagVentilConv.rawValue != "1" &amp;&amp; flagPannelliRadia.rawValue != "1" &amp;&amp; flagBocchette.rawValue != "1" &amp;&amp;
    flagStrisceRadia.rawValue != "1" &amp;&amp; flagTravi.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L7flagTermoConvett"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Termoconvertitori (sez 7)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Termoconvettori</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagVentilConv[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 15 Termoconvettori 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagVentilConv" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTermoConv.rawValue != "1" &amp;&amp; flagRadiatori.rawValue != "1" &amp;&amp; flagPannelliRadia.rawValue != "1" &amp;&amp; flagBocchette.rawValue != "1" &amp;&amp;
    flagStrisceRadia.rawValue != "1" &amp;&amp; flagTravi.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L7flagVentilConvett"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Ventilconvettori (sez 7)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Ventilconvettori</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagPannelliRadia[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 16 Ventilconvettori 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagPannelliRadia" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTermoConv.rawValue != "1" &amp;&amp; flagVentilConv.rawValue != "1" &amp;&amp; flagRadiatori.rawValue != "1" &amp;&amp; flagBocchette.rawValue != "1" &amp;&amp;
    flagStrisceRadia.rawValue != "1" &amp;&amp; flagTravi.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L7flagPannelRadianti"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Pannelli radianti (sez 7)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Pannelli radianti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagBocchette[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 17 Pannelli radianti 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagBocchette" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTermoConv.rawValue != "1" &amp;&amp; flagVentilConv.rawValue != "1" &amp;&amp; flagPannelliRadia.rawValue != "1" &amp;&amp; flagRadiatori.rawValue != "1" &amp;&amp;
    flagStrisceRadia.rawValue != "1" &amp;&amp; flagTravi.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L7flagBocchette"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Bocchette (sez 7)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[4]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Bocchette</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagStrisceRadia[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 9 Bocchette 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagStrisceRadia" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTermoConv.rawValue != "1" &amp;&amp; flagVentilConv.rawValue != "1" &amp;&amp; flagPannelliRadia.rawValue != "1" &amp;&amp; flagBocchette.rawValue != "1" &amp;&amp;
    flagRadiatori.rawValue != "1" &amp;&amp; flagTravi.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L7flagStrisce"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Strisce radianti (sez 7)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="txflag1[5]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Strisce radianti</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagTravi[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 16 Strisce radianti 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagTravi" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTermoConv.rawValue != "1" &amp;&amp; flagVentilConv.rawValue != "1" &amp;&amp; flagPannelliRadia.rawValue != "1" &amp;&amp; flagBocchette.rawValue != "1" &amp;&amp;
    flagStrisceRadia.rawValue != "1" &amp;&amp; flagRadiatori.rawValue != "1" &amp;&amp; flagAltro.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L7flagTravi"/>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Travi fredde (sez 7)</toolTip>
                  </assist>
                  <traversal>
                     <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Travi fredde</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="flagAltro[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 12 Travi fredde 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <field name="flagAltro" w="5.577mm" h="6mm">
                  <ui>
                     <checkButton mark="cross" size="3.175mm">
                        <border>
                           <edge stroke="lowered"/>
                           <fill>
                              <color value="255, 255, 255"/>
                           </fill>
                           <?templateDesigner StyleID apcb2?></border>
                     </checkButton>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <margin leftInset="1mm" rightInset="1mm"/>
                  <para vAlign="middle"/>
                  <value>
                     <text>0</text>
                  </value>
                  <items>
                     <text>1</text>
                     <text>0</text>
                  </items>
                  <validate>
                     <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTermoConv.rawValue != "1" &amp;&amp; flagVentilConv.rawValue != "1" &amp;&amp; flagPannelliRadia.rawValue != "1" &amp;&amp; flagBocchette.rawValue != "1" &amp;&amp;
    flagStrisceRadia.rawValue != "1" &amp;&amp; flagTravi.rawValue != "1" &amp;&amp; flagRadiatori.rawValue != "1" &amp;&amp; versioneStampa.rawValue == "false") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                  </validate>
                  <bind match="dataRef" ref="$.L7flagAltro"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1)
	altro.presence = "visible";
else { 	
	altro.altroSistema.rawValue = "";
	altro.presence = "hidden";
}
</script>
                  </event>
                  <event activity="prePrint" ref="$host" name="event__prePrint">
                     <script contentType="application/x-javascript">
altro.presence = "visible";

var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                  </event>
                  <assist>
                     <toolTip>Altro (sez 7)</toolTip>
                  </assist>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
if (this.rawValue == 1)
	altro.presence = "visible";
</script>
                  </event>
                  <traversal>
                     <traverse ref="txflag1[7]"/>
                  </traversal>
               </field>
               <draw name="txflag1" w="188.372mm" h="6mm">
                  <value>
                     <text>Altro</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font size="8pt" typeface="Verdana" weight="bold"/>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="altro[0]"/>
                  </traversal>
                  <?renderCache.bounds 531133 17008 0 0 2835 0 0 0?>
                  <?renderCache.textRun 5 Altro 0 2835 10852 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
               <subform x="2mm" y="-234.815mm" w="194.152mm" minH="254.772mm" layout="lr-tb" name="altro">
                  <bind match="none"/>
                  <draw name="Rectangle6" w="194.152mm" h="1.957mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <draw name="txcivico" w="11.969mm" h="10.248mm">
                     <value>
                        <text>Altro</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="2.835pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="altroSistema[0]"/>
                     </traversal>
                     <?renderCache.bounds 33928 29049 0 0 0 0 0 0?>
                     <?renderCache.textRun 5 Altro 0 2835 16872 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="altroSistema" w="181.98mm" minH="9.843mm">
                     <ui>
                        <textEdit multiLine="1">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L7descrAltro"/>
                     <value>
                        <text maxChars="2000"/>
                     </value>
                     <validate>
                        <script contentType="application/x-javascript">
var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; flagAltro.rawValue == "1" ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",formValido);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
}
</script>
                     </validate>
                     <assist>
                        <toolTip>Descrizione Altro (sez 7)</toolTip>
                     </assist>
                  </field>
                  <event activity="initialize" name="event__initialize">
                     <script contentType="application/x-javascript">
this.presence = "hidden";

</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="txcivico[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <traversal>
                  <traverse operation="first" ref="flagRadiatori[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaSistAccumulo8" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiSchedaSistemaAC"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>8. SISTEMA DI ACCUMULO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 22 8. SISTEMA DI ACCUMULO 0 206217 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezAC"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">8.1 ACCUMULI<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt;font-weight:normal">(se non incorporati nel gruppo termico o caldaia)</span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null ){ 

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo AC.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <?templateDesigner expand 0?>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
               </subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowAC[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.754mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.capacita.rawValue = null;
	datiGT.flagACS.rawValue = "0";
	datiGT.flagRiscald.rawValue = "0";
	datiGT.flagRaffresc.rawValue = "0";
	datiGT.flagCoibentAssente.rawValue = "0";
	datiGT.flagCoibentPresente.rawValue = "0";
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina AC corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.matricola.access = "open";
datiGT.capacita.access = "open";
datiGT.flagACS.access = "open";
datiGT.flagRiscald.access = "open";
datiGT.flagRaffresc.access = "open";
datiGT.flagCoibentAssente.access = "open";
datiGT.flagCoibentPresente.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";
//01/12/2015
datiGT.dataDismiss.rawValue = null;

	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	

</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Accumulo</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 8 Accumulo 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>AC</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L8_1numAC"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.272mm" h="52.874mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="8.997mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
*/
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">

try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">

if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L8_1dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || capacita.rawValue != null || flagACS.rawValue != 0
	|| flagRiscald.rawValue != 0 || flagRaffresc.rawValue != 0 || flagCoibentAssente.rawValue != 0 || flagCoibentPresente.rawValue != 0 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	} else	
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }else{
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
    }
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 8.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="8.997mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.276mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.276mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L8_1matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L8_1dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	

	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 8.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.097mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.097mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L8_1modello"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="xindir" x="107.184mm" y="25.375mm" w="21.231mm" h="6mm">
                        <value>
                           <text>Coibentazione</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagCoibentAssente[0]"/>
                        </traversal>
                        <?renderCache.bounds 60182 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 13 Coibentazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagCoibentAssente" w="5.577mm" h="6mm" x="129.628mm" y="25.375mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L8_1flagCoibentNO"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagCoibentPresente.rawValue = "0";

}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <field name="sostComp" y="45.595mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	 //|| fabbricante.rawValue == null || matricola.rawValue == null || modello.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		*/
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;			
			newRow.datiGT.capacita.rawValue = capacita.rawValue;
			newRow.datiGT.flagACS.rawValue = flagACS.rawValue;
			newRow.datiGT.flagRiscald.rawValue = flagRiscald.rawValue;	
			newRow.datiGT.flagRaffresc.rawValue	 = flagRaffresc.rawValue;	
			newRow.datiGT.flagCoibentAssente.rawValue	 = flagCoibentAssente.rawValue;	
			newRow.datiGT.flagCoibentPresente.rawValue	 = flagCoibentPresente.rawValue;	
					
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
						
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;
				
			dataDismiss.rawValue = null;			
			fabbricante.rawValue = null;
			modello.rawValue = null;
			matricola.rawValue = null;
			capacita.rawValue = null;
			flagACS.rawValue = "0";
			flagRiscald.rawValue = "0";
			flagRaffresc.rawValue = "0";
			flagCoibentAssente.rawValue = "0";
			flagCoibentPresente.rawValue = "0";
			
			flagSost.rawValue = "1";

			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="45.595mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	 //|| fabbricante.rawValue == null || matricola.rawValue == null || modello.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		*/
		
		if(controlli.isOk(fCheckValidi)){

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			matricola.access = "protected";
			capacita.access = "protected";
			flagACS.access = "protected";
			flagRiscald.access = "protected";
			flagRaffresc.access = "protected";
			flagCoibentAssente.access = "protected";
			flagCoibentPresente.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
					currentRow.button.presence = "invisible";
				}	
			}		
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="136.098mm" y="25.375mm" w="19.007mm" h="6mm">
                        <value>
                           <text>Assente</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagRiscald[0]"/>
                        </traversal>
                        <?renderCache.bounds 53878 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Assente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagCoibentPresente" w="5.577mm" h="6mm" x="129.628mm" y="32.452mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L8_1flagCoibentSI"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagCoibentAssente.rawValue = "0";

}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="136.098mm" y="32.452mm" w="18.805mm" h="6mm">
                        <value>
                           <text>Presente</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagRaffresc[0]"/>
                        </traversal>
                        <?renderCache.bounds 53306 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 8 Presente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="107.184mm" y="16.276mm" w="17.389mm" h="6mm">
                        <value>
                           <text>Capacita'</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="capacita[0]"/>
                        </traversal>
                        <?renderCache.bounds 49292 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Capacita' 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="capacita" y="16.276mm" x="125.179mm" w="17.548mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L8_1capacita"/>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="139.738mm" y="16.276mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(l)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="right"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagACS[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 3 (l) 0 10450 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txflag1" w="36.278mm" h="6mm" x="11.256mm" y="25.375mm">
                        <value>
                           <text>Acqua calda sanitaria</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <margin leftInset="1mm"/>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                        <?renderCache.bounds 100000 17008 0 0 2835 0 0 0?>
                        <?renderCache.textRun 21 Acqua calda sanitaria 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagACS" w="5.577mm" h="6mm" x="5.679mm" y="25.375mm">
                        <ui>
                           <checkButton mark="cross" size="3.175mm">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb2?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <validate>
                           <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                        </validate>
                        <bind match="dataRef" ref="$.L8_1flagACS"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                     </field>
                     <field name="flagRiscald" w="5.577mm" h="6mm" x="5.679mm" y="31.441mm">
                        <ui>
                           <checkButton mark="cross" size="3.175mm">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb2?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <validate>
                           <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                        </validate>
                        <bind match="dataRef" ref="$.L8_1flagRiscald"/>
                        <traversal>
                           <traverse ref="txflag1[1]"/>
                        </traversal>
                     </field>
                     <draw name="txflag1" w="36.278mm" h="6mm" x="11.256mm" y="31.441mm">
                        <value>
                           <text>Riscaldamento</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <margin leftInset="1mm"/>
                        <traversal>
                           <traverse ref="flagCoibentPresente[0]"/>
                        </traversal>
                        <?renderCache.bounds 100000 17008 0 0 2835 0 0 0?>
                        <?renderCache.textRun 13 Riscaldamento 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagRaffresc" w="5.577mm" h="6mm" x="5.679mm" y="38.114mm">
                        <ui>
                           <checkButton mark="cross" size="3.175mm">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb2?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <validate>
                           <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                        </validate>
                        <bind match="dataRef" ref="$.L8_1flagRaffresc"/>
                        <traversal>
                           <traverse ref="txflag1[2]"/>
                        </traversal>
                     </field>
                     <draw name="txflag1" w="36.278mm" h="6mm" x="11.256mm" y="38.114mm">
                        <value>
                           <text>Raffrescamento</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <margin leftInset="1mm"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                        <?renderCache.bounds 100000 17008 0 0 2835 0 0 0?>
                        <?renderCache.textRun 14 Raffrescamento 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagSost" y="45.191mm" x="34.796mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="8.997mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L8_1fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="45.595mm" x="138.524mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	matricola.access = "protected";
	capacita.access = "protected";
	flagACS.access = "protected";
	flagRiscald.access = "protected";
	flagRaffresc.access = "protected";
	flagCoibentAssente.access = "protected";
	flagCoibentPresente.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1">
                     <bind match="dataRef" ref="$.sezACsostituite.rowACsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
row.datiGT.capacita.rawValue =			datiGT.capacita.rawValue;
row.datiGT.flagACS.rawValue =			datiGT.flagACS.rawValue;
row.datiGT.flagRiscald.rawValue =		datiGT.flagRiscald.rawValue;
row.datiGT.flagRaffresc.rawValue =		datiGT.flagRaffresc.rawValue;
row.datiGT.flagCoibentAssente.rawValue =	datiGT.flagCoibentAssente.rawValue;
row.datiGT.flagCoibentPresente.rawValue =	datiGT.flagCoibentPresente.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="47.012mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.256mm" x="24.281mm" w="62.323mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L8_1dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.256mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.478mm" y="14.929mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="14.929mm" w="62.323mm" h="6mm" x="24.281mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L8_1matricola"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L8_1dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.356mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.356mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L8_1modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.981mm" y="26.59mm" w="21.231mm" h="6mm">
                           <value>
                              <text>Coibentazione</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagCoibentAssente[0]"/>
                           </traversal>
                           <?renderCache.bounds 60182 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 13 Coibentazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagCoibentAssente" w="5.577mm" h="6mm" x="129.426mm" y="26.59mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L8_1flagCoibentNO"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="135.896mm" y="26.59mm" w="19.007mm" h="6mm">
                           <value>
                              <text>Assente</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagRiscald[0]"/>
                           </traversal>
                           <?renderCache.bounds 53878 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Assente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagCoibentPresente" w="5.577mm" h="6mm" x="129.426mm" y="33.667mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L8_1flagCoibentSI"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="135.896mm" y="33.667mm" w="18.805mm" h="6mm">
                           <value>
                              <text>Presente</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagRaffresc[0]"/>
                           </traversal>
                           <?renderCache.bounds 53306 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 8 Presente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="106.982mm" y="17.491mm" w="17.389mm" h="6mm">
                           <value>
                              <text>Capacita'</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="capacita[0]"/>
                           </traversal>
                           <?renderCache.bounds 49292 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Capacita' 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="capacita" y="17.491mm" x="124.977mm" w="17.548mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L8_1capacita"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="139.536mm" y="17.491mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(l)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="right"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagACS[0]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 3 (l) 0 10450 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txflag1" w="36.278mm" h="6mm" x="11.458mm" y="26.59mm">
                           <value>
                              <text>Acqua calda sanitaria</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <margin leftInset="1mm"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                           <?renderCache.bounds 100000 17008 0 0 2835 0 0 0?>
                           <?renderCache.textRun 21 Acqua calda sanitaria 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagACS" w="5.577mm" h="6mm" x="5.881mm" y="26.388mm" access="protected">
                           <ui>
                              <checkButton mark="cross" size="3.175mm">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb2?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <validate>
                              <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                           </validate>
                           <bind match="dataRef" ref="$.L8_1flagACS"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <field name="flagRiscald" w="5.577mm" h="6mm" x="5.881mm" y="32.454mm" access="protected">
                           <ui>
                              <checkButton mark="cross" size="3.175mm">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb2?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <validate>
                              <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                           </validate>
                           <bind match="dataRef" ref="$.L8_1flagRiscald"/>
                           <traversal>
                              <traverse ref="txflag1[1]"/>
                           </traversal>
                        </field>
                        <draw name="txflag1" w="36.278mm" h="6mm" x="11.458mm" y="32.656mm">
                           <value>
                              <text>Riscaldamento</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <margin leftInset="1mm"/>
                           <traversal>
                              <traverse ref="flagCoibentPresente[0]"/>
                           </traversal>
                           <?renderCache.bounds 100000 17008 0 0 2835 0 0 0?>
                           <?renderCache.textRun 13 Riscaldamento 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagRaffresc" w="5.577mm" h="6mm" x="5.881mm" y="39.127mm" access="protected">
                           <ui>
                              <checkButton mark="cross" size="3.175mm">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb2?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <validate>
                              <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                           </validate>
                           <bind match="dataRef" ref="$.L8_1flagRaffresc"/>
                           <traversal>
                              <traverse ref="txflag1[2]"/>
                           </traversal>
                        </field>
                        <draw name="txflag1" w="36.278mm" h="6mm" x="11.458mm" y="39.329mm">
                           <value>
                              <text>Raffrescamento</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <margin leftInset="1mm"/>
                           <?renderCache.bounds 100000 17008 0 0 2835 0 0 0?>
                           <?renderCache.textRun 14 Raffrescamento 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="codFabbricante" y="8.797mm" x="88.379mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L8_1fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp9_1" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiAltriComponentiTE"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>9. ALTRI COMPONENTI DELL'IMPIANTO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 33 9. ALTRI COMPONENTI DELL'IMPIANTO 0 168895 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezTE"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>9.1 TORRI EVAPORATIVE </text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null ){ 

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <?templateDesigner expand 0?>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
               </subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowTE[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.754mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.capacita.rawValue = null;
	datiGT.numVentilatori.rawValue = null;
	datiGT.tipoVentilatori.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.matricola.access = "open";
datiGT.capacita.access = "open";
datiGT.numVentilatori.access = "open";
datiGT.tipoVentilatori.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";
    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                  </subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Torre</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 Torre 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>TE</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L9_1numTE"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}	
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.272mm" h="39.933mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="8.997mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
*/
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_1dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || capacita.rawValue != null || numVentilatori.rawValue != null
	|| tipoVentilatori.rawValue != null  )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	} else
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }else{
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
    }	
}

</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 9.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="8.997mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.276mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.276mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_1matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_1dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 9.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.097mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.097mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_1modello"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="xindir" x="107.184mm" y="23.555mm" w="21.274mm" h="6mm">
                        <value>
                           <text>Tipo ventilatori</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tipoVentilatori[0]"/>
                        </traversal>
                        <?renderCache.bounds 60304 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 16 Tipo ventilatori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="sostComp" y="32.048mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	 //|| fabbricante.rawValue == null || matricola.rawValue == null || modello.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		*/
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;			
			newRow.datiGT.capacita.rawValue = capacita.rawValue;
			newRow.datiGT.numVentilatori.rawValue = numVentilatori.rawValue;
			newRow.datiGT.tipoVentilatori.rawValue = tipoVentilatori.rawValue;	
				
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;			
			fabbricante.rawValue = null;
			modello.rawValue = null;
			matricola.rawValue = null;
			capacita.rawValue = null;
			numVentilatori.rawValue = null;
			tipoVentilatori.rawValue = null;

			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="32.048mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	 //|| fabbricante.rawValue == null || matricola.rawValue == null || modello.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		*/
		if(controlli.isOk(fCheckValidi)){

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			matricola.access = "protected";
			capacita.access = "protected";
			numVentilatori.access = "protected";
			tipoVentilatori.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}		
	}			
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="107.184mm" y="16.276mm" w="28.914mm" h="6mm">
                        <value>
                           <text>Capacita' nominale</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="capacita[0]"/>
                        </traversal>
                        <?renderCache.bounds 81961 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 18 Capacita' nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="capacita" y="16.276mm" x="136.503mm" w="17.592mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_1capacita"/>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="153.285mm" y="16.276mm" w="5.055mm" h="6mm">
                        <value>
                           <text>(l)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="right"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <?renderCache.bounds 14329 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 3 (l) 0 4868 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.477mm" y="23.555mm" w="26.53mm" h="6mm">
                        <value>
                           <text>Numero ventilatori</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numVentilatori[0]"/>
                        </traversal>
                        <?renderCache.bounds 75203 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 18 Numero ventilatori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="numVentilatori" y="23.555mm" x="33.179mm" w="12.738mm" h="6mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L9_1numVentilatori"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <value>
                           <text maxChars="3"/>
                        </value>
                     </field>
                     <field name="tipoVentilatori" y="23.555mm" w="51.763mm" h="6mm" x="134.076mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_1tipoVentilatori"/>
                     </field>
                     <field name="nota" y="24.364mm" x="128.819mm" w="5.257mm" h="4.65mm" presence="invisible">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
xfa.host.messageBox("Indicare assiali, centrifughi, etc.");
</script>
                        </event>
                        <traversal>
                           <traverse ref="imgNota[0]"/>
                        </traversal>
                     </field>
                     <draw name="imgNota" y="24.768mm" x="128.819mm" w="5.055mm" h="4.044mm" presence="invisible">
                        <value>
                           <image href="..\resources\comment.png" contentType="image/png"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </draw>
                     <field name="flagSost" y="31.846mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.199mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L9_1fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="32.048mm" x="138.322mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	matricola.access = "protected";
	capacita.access = "protected";
	numVentilatori.access = "protected";
	tipoVentilatori.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 1?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1">
                     <bind match="dataRef" ref="$.sezTEsostituite.rowTEsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
row.datiGT.capacita.rawValue =			datiGT.capacita.rawValue;
row.datiGT.numVentilatori.rawValue =	datiGT.numVentilatori.rawValue;
row.datiGT.tipoVentilatori.rawValue =	datiGT.tipoVentilatori.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="30.028mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.256mm" x="23.271mm" w="62.884mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_1dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.256mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_1dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.356mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.356mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_1modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="15.267mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="15.267mm" w="62.953mm" h="6mm" x="23.274mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_1matricola"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="22.546mm" w="21.274mm" h="6mm">
                           <value>
                              <text>Tipo ventilatori</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tipoVentilatori[0]"/>
                           </traversal>
                           <?renderCache.bounds 60304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 16 Tipo ventilatori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="106.982mm" y="15.267mm" w="28.914mm" h="6mm">
                           <value>
                              <text>Capacita' nominale</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="capacita[0]"/>
                           </traversal>
                           <?renderCache.bounds 81961 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 18 Capacita' nominale 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="capacita" y="15.267mm" x="136.098mm" w="17.591mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_1capacita"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="152.476mm" y="15.267mm" w="5.055mm" h="6mm">
                           <value>
                              <text>(l)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="right"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                           <?renderCache.bounds 14329 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 3 (l) 0 4868 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.275mm" y="22.546mm" w="26.53mm" h="6mm">
                           <value>
                              <text>Numero ventilatori</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="numVentilatori[0]"/>
                           </traversal>
                           <?renderCache.bounds 75203 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 18 Numero ventilatori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="numVentilatori" y="22.546mm" x="32.977mm" w="13.951mm" h="6mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                           <bind match="dataRef" ref="$.L9_1numVentilatori"/>
                           <value>
                              <text maxChars="3"/>
                           </value>
                        </field>
                        <field name="tipoVentilatori" y="22.546mm" w="57.425mm" h="6mm" x="128.819mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_1tipoVentilatori"/>
                        </field>
                        <field name="codFabbricante" y="8.797mm" x="86.964mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L9_1fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 1?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp9_2" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiAltriComponentiRV"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>9. ALTRI COMPONENTI DELL'IMPIANTO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 33 9. ALTRI COMPONENTI DELL'IMPIANTO 0 168895 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezRV"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">9.2 RAFFREDDATORI DI LIQUIDO<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt;font-weight:normal">(a circuito chiuso)</span><span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null ){ 

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <?templateDesigner expand 0?>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
               </subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowRV[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.numVentilatori.rawValue = null;
	datiGT.tipoVentilatori.rawValue = null;
	
	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.matricola.access = "open";
datiGT.numVentilatori.access = "open";
datiGT.tipoVentilatori.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";


    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Raffreddatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 13 Raffreddatore 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>RV</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L9_2numRV"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.272mm" h="40.338mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="8.997mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
*/
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_2dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);


if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || matricola.rawValue != null || numVentilatori.rawValue != null 
	|| tipoVentilatori.rawValue != null)) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	} else
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }else{
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	}	
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 9.2)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="8.997mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.478mm" y="16.276mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.276mm" w="62.953mm" h="6mm" x="23.476mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_2matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_2dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 9.2)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.097mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.097mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_2modello"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="xindir" x="107.184mm" y="23.758mm" w="21.274mm" h="6mm">
                        <value>
                           <text>Tipo ventilatori</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tipoVentilatori[0]"/>
                        </traversal>
                        <?renderCache.bounds 60304 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 16 Tipo ventilatori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="sostComp" y="32.856mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	//|| fabbricante.rawValue == null || matricola.rawValue == null || modello.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		*/
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;			
			newRow.datiGT.numVentilatori.rawValue = numVentilatori.rawValue;
			newRow.datiGT.tipoVentilatori.rawValue = tipoVentilatori.rawValue;	
				
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();			
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;			
			fabbricante.rawValue = null;
			modello.rawValue = null;
			matricola.rawValue = null;
			numVentilatori.rawValue = null;
			tipoVentilatori.rawValue = null;

			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}			
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="32.856mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	 //|| fabbricante.rawValue == null || matricola.rawValue == null || modello.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		matricola.execEvent("validate");
		modello.execEvent("validate");
		*/
		if(controlli.isOk(fCheckValidi)){		

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			matricola.access = "protected";
			numVentilatori.access = "protected";
			tipoVentilatori.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}	
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.477mm" y="23.758mm" w="26.53mm" h="6mm">
                        <value>
                           <text>Numero ventilatori</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="numVentilatori[0]"/>
                        </traversal>
                        <?renderCache.bounds 75203 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 18 Numero ventilatori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="numVentilatori" y="23.758mm" x="33.179mm" w="22.848mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal fracDigits="0" leadDigits="3"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_2numVentilatori"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                     </field>
                     <field name="tipoVentilatori" y="23.758mm" w="51.763mm" h="6mm" x="134.076mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_2tipoVentilatori"/>
                     </field>
                     <field name="nota" y="24.567mm" x="128.819mm" w="5.257mm" h="4.65mm" presence="invisible">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
xfa.host.messageBox("Indicare assiali, centrifughi, etc.");
</script>
                        </event>
                        <traversal>
                           <traverse ref="imgNota[0]"/>
                        </traversal>
                     </field>
                     <draw name="imgNota" y="24.971mm" x="128.819mm" w="5.055mm" h="4.044mm" presence="invisible">
                        <value>
                           <image href="..\resources\comment.png" contentType="image/png"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </draw>
                     <field name="flagSost" y="32.452mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.401mm" x="86.762mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L9_2fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="33.059mm" x="138.12mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	matricola.access = "protected";
	numVentilatori.access = "protected";
	tipoVentilatori.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1">
                     <bind match="dataRef" ref="$.sezRVsostituite.rowRVsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
row.datiGT.numVentilatori.rawValue =	datiGT.numVentilatori.rawValue;
row.datiGT.tipoVentilatori.rawValue =	datiGT.tipoVentilatori.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
//}	

</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="30.634mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.256mm" x="23.271mm" w="62.884mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_2dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.256mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_2dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.356mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.356mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_2modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="15.267mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="15.267mm" w="62.953mm" h="6mm" x="23.274mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_2matricola"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="22.748mm" w="21.274mm" h="6mm">
                           <value>
                              <text>Tipo ventilatori</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tipoVentilatori[0]"/>
                           </traversal>
                           <?renderCache.bounds 60304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 16 Tipo ventilatori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.275mm" y="22.748mm" w="26.53mm" h="6mm">
                           <value>
                              <text>Numero ventilatori</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="numVentilatori[0]"/>
                           </traversal>
                           <?renderCache.bounds 75203 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 18 Numero ventilatori 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="numVentilatori" y="22.748mm" x="32.977mm" w="22.848mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal fracDigits="0" leadDigits="3"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_2numVentilatori"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </field>
                        <field name="tipoVentilatori" y="22.748mm" w="57.425mm" h="6mm" x="128.819mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_2tipoVentilatori"/>
                        </field>
                        <field name="codFabbricante" y="8.797mm" x="86.357mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L9_2fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp9_3" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiAltriComponentiSC"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>9. ALTRI COMPONENTI DELL'IMPIANTO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 33 9. ALTRI COMPONENTI DELL'IMPIANTO 0 168895 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezSC"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">9.3 SCAMBIATORI DI CALORE INTERMEDI<span style="xfa-spacerun:yes"> </span><span style="font-size:7pt;font-weight:normal">(per acqua di superficie o di falda)</span><span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null ){ 

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowSCcal[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                  </subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Scambiatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Scambiatore 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>SC</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L9_3numSC"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.272mm" h="27.195mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="8.997mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList textEntry="1">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
*/
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_3dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null  )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	} else
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }else{
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );    
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 9.3)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="8.997mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_3dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 9.3)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.097mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.097mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_3modello"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <field name="sostComp" y="19.309mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	 //|| fabbricante.rawValue == null || modello.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		*/
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
				
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();			
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;			
			fabbricante.rawValue = null;
			modello.rawValue = null;

			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="19.309mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	//|| fabbricante.rawValue == null ||  modello.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		*/
		if(controlli.isOk(fCheckValidi)){

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}	
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="19.107mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="codFabbricante" y="9.401mm" x="86.762mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L9_3fabbricante"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="19.309mm" x="138.12mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1">
                     <bind match="dataRef" ref="$.sezSCsostituite.rowSCcalsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
//}	

</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="16.885mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.256mm" x="23.271mm" w="62.884mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_3dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.256mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_3dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.356mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.356mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_3modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <field name="codFabbricante" y="9.201mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L9_3fabbricante"/>
                        </field>
                        <?templateDesigner expand 1?>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp9_4" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiAltriComponentiCI"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>9. ALTRI COMPONENTI DELL'IMPIANTO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 33 9. ALTRI COMPONENTI DELL'IMPIANTO 0 168895 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezCI"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>9.4 CIRCUITI INTERRATI A CONDENSAZIONE / ESPANSIONE DIRETTA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null ){ 

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowCI[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.lungCircuito.rawValue = null;
	datiGT.superfScamb.rawValue = null;
	datiGT.profondita.rawValue = null;

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.lungCircuito.access = "open";
datiGT.superfScamb.access = "open";
datiGT.profondita.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Circuito</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 8 Circuito 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>CI</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L9_4numCI"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.272mm" h="32.184mm">
                     <bind match="none"/>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_4dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (lungCircuito.rawValue != null || superfScamb.rawValue != null || profondita.rawValue != null 	 )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione  non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	} else
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    } else {
    	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 9.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.072mm" y="8.997mm" w="29.522mm" h="6mm">
                        <value>
                           <text>Lunghezza circuito</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="lungCircuito[0]"/>
                        </traversal>
                        <?renderCache.bounds 83684 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 18 Lunghezza circuito 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_4dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 9.4)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="16.68mm" w="40.057mm" h="6mm">
                        <value>
                           <text>Superficie dello scambiatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="superfScamb[0]"/>
                        </traversal>
                        <?renderCache.bounds 113547 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Superficie dello scambiatore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="superfScamb" y="16.68mm" x="46.119mm" w="35.182mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_4superfScamb"/>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <field name="sostComp" y="25.375mm" x="60.939mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.lungCircuito.rawValue = lungCircuito.rawValue;
			newRow.datiGT.superfScamb.rawValue = superfScamb.rawValue;
			newRow.datiGT.profondita = profondita.rawValue;
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();				
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;			
			lungCircuito.rawValue = null;
			superfScamb.rawValue = null;
			profondita.rawValue = null;

			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="25.375mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");

		
		if(controlli.isOk(fCheckValidi)){

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			lungCircuito.access = "protected";
			superfScamb.access = "protected";
			profondita.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
		
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}		
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="25.173mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="lungCircuito" y="9.199mm" x="35.605mm" w="34.981mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_4lungCircuito"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="71.394mm" y="9.401mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(m)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 3 (m) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txcivico" x="82.111mm" y="16.68mm" w="7.103mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">(m<span style="vertical-align:3.41pt">2</span>)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </draw>
                     <draw name="xindir" x="106.981mm" y="16.68mm" w="35.496mm" h="6mm">
                        <value>
                           <text>Profondità d'installazione</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="profondita[0]"/>
                        </traversal>
                        <?renderCache.bounds 100619 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 Profondità d'installazione 0 0 10954 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="profondita" y="16.68mm" x="143.579mm" w="34.981mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_4profInstallaz"/>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="179.368mm" y="16.68mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(m)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 3 (m) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="25.375mm" x="138.12mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	lungCircuito.access = "protected";
	superfScamb.access = "protected";
	profondita.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1_copy1">
                     <bind match="dataRef" ref="$.sezCIsostituite.rowCIsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.lungCircuito.rawValue =		datiGT.lungCircuito.rawValue;
row.datiGT.superfScamb.rawValue = 		datiGT.superfScamb.rawValue;
row.datiGT.profondita.rawValue = 		datiGT.profondita.rawValue;	


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="23.354mm">
                        <bind match="none"/>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_4dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_4dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="8.053mm" w="29.522mm" h="6mm">
                           <value>
                              <text>Lunghezza circuito</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="lungCircuito[0]"/>
                           </traversal>
                           <?renderCache.bounds 83684 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 18 Lunghezza circuito 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.074mm" y="15.736mm" w="40.057mm" h="6mm">
                           <value>
                              <text>Superficie dello scambiatore</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="superfScamb[0]"/>
                           </traversal>
                           <?renderCache.bounds 113547 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 28 Superficie dello scambiatore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="superfScamb" y="15.736mm" x="46.12mm" w="35.182mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_4superfScamb"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <field name="lungCircuito" y="8.255mm" x="35.606mm" w="34.981mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_4lungCircuito"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="71.395mm" y="8.457mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(m)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 3 (m) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="82.112mm" y="15.736mm" w="7.103mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">(m<span style="vertical-align:3.41pt">2</span>)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="106.982mm" y="15.736mm" w="35.496mm" h="6mm">
                           <value>
                              <text>Profondità d'installazione</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="profondita[0]"/>
                           </traversal>
                           <?renderCache.bounds 100619 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 27 Profondità d'installazione 0 0 10954 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="profondita" y="15.736mm" x="143.58mm" w="34.981mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_4profInstallaz"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="179.369mm" y="15.736mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(m)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 3 (m) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp9_5" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiAltriComponentiUT"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>9. ALTRI COMPONENTI DELL'IMPIANTO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 33 9. ALTRI COMPONENTI DELL'IMPIANTO 0 168895 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezUT"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>9.5 UNITA' DI TRATTAMENTO ARIA </text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null ){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <?templateDesigner expand 0?>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
               </subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowUT[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.matricola.rawValue = null;
	datiGT.portataVenMandata.rawValue = null;
	datiGT.potenzaVenMandata.rawValue = null;
	datiGT.portataVenRipresa.rawValue = null;
	datiGT.potenzaVenRipresa.rawValue = null;

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.matricola.access = "open";
datiGT.portataVenMandata.access = "open";
datiGT.potenzaVenMandata.access = "open";
datiGT.portataVenRipresa.access = "open";
datiGT.potenzaVenRipresa.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Unità T.A.</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Unità T.A. 0 2835 10647 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>UT</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L9_5numUT"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 0?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.272mm" h="45.126mm">
                     <bind match="none"/>
                     <field name="fabbricante" y="8.997mm" x="23.476mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
*/
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_5dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || 
	matricola.rawValue != null || portataVenMandata.rawValue != null || potenzaVenMandata.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione  non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	} else	
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }	else{
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );    
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 9.5)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.276mm" y="8.997mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_5dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);


if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 9.5)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.982mm" y="9.097mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.097mm" w="60.659mm" h="6mm" x="125.18mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_5modello"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <field name="sostComp" y="38.72mm" x="61.284mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){  //|| fabbricante.rawValue == null || modello.rawValue == null || matricola.rawValue == null	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		matricola.execEvent("validate");
		*/
		
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.matricola.rawValue = matricola.rawValue;
			newRow.datiGT.portataVenMandata.rawValue = portataVenMandata.rawValue;
			newRow.datiGT.potenzaVenMandata.rawValue = potenzaVenMandata.rawValue;
			newRow.datiGT.portataVenRipresa.rawValue = portataVenRipresa.rawValue;
			newRow.datiGT.potenzaVenRipresa.rawValue = potenzaVenRipresa.rawValue;
				
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;			
			fabbricante.rawValue = null;
			modello.rawValue = null;
			matricola.rawValue = null;
			portataVenMandata.rawValue = null;
			potenzaVenMandata.rawValue = null;
			portataVenRipresa.rawValue = null;
			potenzaVenRipresa.rawValue = null;

			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
	
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "Bozza")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="38.518mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	 //|| fabbricante.rawValue == null ||  modello.rawValue == null || matricola.rawValue == null
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		/*
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		matricola.execEvent("validate");
		*/
		
		if(controlli.isOk(fCheckValidi)){
		
			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			matricola.access = "protected";
			portataVenMandata.access = "protected";
			potenzaVenMandata.access = "protected";
			portataVenRipresa.access = "protected";
			potenzaVenRipresa.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}		
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="38.72mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.275mm" y="16.276mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Matricola</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="matricola[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="matricola" y="16.276mm" w="62.953mm" h="6mm" x="23.273mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_5matricola"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                        <value>
                           <text maxChars="30"/>
                        </value>
                     </field>
                     <draw name="xindir" x="5.275mm" y="23.555mm" w="43.433mm" h="6mm">
                        <value>
                           <text>Portata ventilatore di mandata</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="portataVenMandata[0]"/>
                        </traversal>
                        <?renderCache.bounds 123117 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Portata ventilatore di mandata 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="portataVenMandata" y="23.555mm" x="49.557mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_5portataVentMandata"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="79.685mm" y="23.555mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(l/s)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 (l/s) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="106.577mm" y="23.96mm" w="44.372mm" h="6mm">
                        <value>
                           <text>Potenza ventilatore di mandata</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaVenMandata[0]"/>
                        </traversal>
                        <?renderCache.bounds 125779 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Potenza ventilatore di mandata 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potenzaVenMandata" y="23.96mm" x="151.668mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_5potenzaVentMandata"/>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="181.796mm" y="23.96mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[8]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.477mm" y="31.037mm" w="43.474mm" h="6mm">
                        <value>
                           <text>Portata ventilatore di ripresa</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="portataVenRipresa[0]"/>
                        </traversal>
                        <?renderCache.bounds 123233 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Portata ventilatore di ripresa 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="portataVenRipresa" y="31.037mm" x="49.759mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_5portataVentRipresa"/>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="79.887mm" y="31.037mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(l/s)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 (l/s) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="106.779mm" y="30.633mm" w="44.372mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Potenza<span style="text-decoration:none"> ventilatore di ripresa</span></p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaVenRipresa[0]"/>
                        </traversal>
                     </draw>
                     <field name="potenzaVenRipresa" y="30.633mm" x="151.87mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_5potenzaVentRipresa"/>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="181.998mm" y="30.633mm" w="7.024mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">(<span style="text-decoration:none">kW</span>)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[7]"/>
                        </traversal>
                     </draw>
                     <field name="codFabbricante" y="8.997mm" x="87.166mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L9_5fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="38.72mm" x="137.918mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	matricola.access = "protected";
	portataVenMandata.access = "protected";
	potenzaVenMandata.access = "protected";
	portataVenRipresa.access = "protected";
	potenzaVenRipresa.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1_copy2">
                     <bind match="dataRef" ref="$.sezUTsostituite.rowUTsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.matricola.rawValue =			datiGT.matricola.rawValue;
row.datiGT.portataVenMandata.rawValue =	datiGT.portataVenMandata.rawValue;
row.datiGT.potenzaVenMandata.rawValue =	datiGT.potenzaVenMandata.rawValue;
row.datiGT.portataVenRipresa.rawValue =	datiGT.portataVenRipresa.rawValue;
row.datiGT.potenzaVenRipresa.rawValue =	datiGT.potenzaVenRipresa.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="38.383mm">
                        <bind match="none"/>
                        <field name="fabbricante" y="8.256mm" x="23.271mm" w="62.884mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_5dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.276mm" y="8.256mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_5dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.982mm" y="8.356mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.356mm" w="60.659mm" h="6mm" x="125.18mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_5modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.477mm" y="15.535mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Matricola</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="matricola[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Matricola 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="matricola" y="15.535mm" w="62.953mm" h="6mm" x="23.475mm">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_5matricola"/>
                           <validate>
                              <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                           </validate>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.477mm" y="22.814mm" w="43.433mm" h="6mm">
                           <value>
                              <text>Portata ventilatore di mandata</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="portataVenMandata[0]"/>
                           </traversal>
                           <?renderCache.bounds 123117 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Portata ventilatore di mandata 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="portataVenMandata" y="22.814mm" x="49.759mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_5portataVentMandata"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="79.887mm" y="22.814mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(l/s)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 (l/s) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="106.779mm" y="23.219mm" w="44.372mm" h="6mm">
                           <value>
                              <text>Potenza ventilatore di mandata</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaVenMandata[0]"/>
                           </traversal>
                           <?renderCache.bounds 125779 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Potenza ventilatore di mandata 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potenzaVenMandata" y="23.219mm" x="151.668mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_5potenzaVentMandata"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="181.796mm" y="23.219mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[8]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.679mm" y="30.296mm" w="43.474mm" h="6mm">
                           <value>
                              <text>Portata ventilatore di ripresa</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="portataVenRipresa[0]"/>
                           </traversal>
                           <?renderCache.bounds 123233 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Portata ventilatore di ripresa 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="portataVenRipresa" y="30.296mm" x="49.961mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_5portataVentRipresa"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="80.089mm" y="30.296mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(l/s)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 (l/s) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="106.981mm" y="29.892mm" w="44.372mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Potenza<span style="text-decoration:none"> ventilatore di ripresa</span></p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaVenRipresa[0]"/>
                           </traversal>
                        </draw>
                        <field name="potenzaVenRipresa" y="29.892mm" x="151.87mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_5potenzaVentRipresa"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="181.998mm" y="29.892mm" w="7.024mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">(<span style="text-decoration:none">kW</span>)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[7]"/>
                           </traversal>
                        </draw>
                        <field name="codFabbricante" y="8.862mm" x="86.559mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L9_5fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 1?>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                     </subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp9_6" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiAltriComponentiRC"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>9. ALTRI COMPONENTI DELL'IMPIANTO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 33 9. ALTRI COMPONENTI DELL'IMPIANTO 0 168895 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezRC"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>9.6 RECUPERATORI DI CALORE (aria ambiente)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null ){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <?templateDesigner expand 0?>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
               </subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowRCcal[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.tipologia.rawValue = null;
	datiGT.flagInstallato.rawValue = "0";
	datiGT.flagIndipendente.rawValue = "0";	
	datiGT.portataVenMandata.rawValue = null;
	datiGT.potenzaVenMandata.rawValue = null;
	datiGT.portataVenRipresa.rawValue = null;
	datiGT.potenzaVenRipresa.rawValue = null;

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.tipologia.access = "open";
datiGT.flagInstallato.access = "open";
datiGT.flagIndipendente.access = "open";
datiGT.portataVenMandata.access = "open";
datiGT.potenzaVenMandata.access = "open";
datiGT.portataVenRipresa.access = "open";
datiGT.potenzaVenRipresa.access = "open";

datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Recuperatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 12 Recuperatore 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>RC</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L9_6numRC"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.272mm" h="54.694mm">
                     <bind match="none"/>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_6dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (tipologia.rawValue != null || flagInstallato.rawValue != 0 || flagIndipendente.rawValue != 0 || portataVenMandata.rawValue != null
	|| potenzaVenMandata.rawValue != null || portataVenRipresa.rawValue != null || potenzaVenRipresa.rawValue != null  )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione  non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	} else
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    } else{
       controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 9.6)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L9_6dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);


if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 9.6)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <field name="sostComp" y="47.415mm" x="61.284mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		if(controlli.isOk(fCheckValidi)){		

			//sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.tipologia.rawValue = tipologia.rawValue;
			newRow.datiGT.flagInstallato.rawValue = flagInstallato.rawValue;
			newRow.datiGT.flagIndipendente.rawValue = flagIndipendente.rawValue;
			newRow.datiGT.portataVenMandata.rawValue = portataVenMandata.rawValue;
			newRow.datiGT.potenzaVenMandata.rawValue = potenzaVenMandata.rawValue;
			newRow.datiGT.portataVenRipresa.rawValue = portataVenRipresa.rawValue;
			newRow.datiGT.potenzaVenRipresa.rawValue = potenzaVenRipresa.rawValue;
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();						
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;			
			tipologia.rawValue = null;
			flagInstallato.rawValue = "0";
			flagIndipendente.rawValue = "0";
			portataVenMandata.rawValue = null;
			potenzaVenMandata.rawValue = null;
			portataVenRipresa.rawValue = null;
			potenzaVenRipresa.rawValue = null;

			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="47.213mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null ){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		if(controlli.isOk(fCheckValidi)){
		
			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			tipologia.access = "protected";
			flagInstallato.access = "protected";
			flagIndipendente.access = "protected";
			portataVenMandata.access = "protected";
			potenzaVenMandata.access = "protected";
			portataVenRipresa.access = "protected";
			potenzaVenRipresa.access = "protected";
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";	
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}	
			
	}		
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="47.011mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.275mm" y="9.401mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Tipologia</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="tipologia[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 9 Tipologia 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="tipologia" y="9.401mm" w="62.953mm" h="6mm" x="23.273mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_6tipologia"/>
                        <traversal>
                           <traverse ref="flagInstallato[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.275mm" y="32.25mm" w="43.433mm" h="6mm">
                        <value>
                           <text>Portata ventilatore di mandata</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="portataVenMandata[0]"/>
                        </traversal>
                        <?renderCache.bounds 123117 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Portata ventilatore di mandata 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="portataVenMandata" y="32.25mm" x="49.557mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_6portataVentMandata"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="79.685mm" y="32.25mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(l/s)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 (l/s) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="106.577mm" y="32.655mm" w="44.372mm" h="6mm">
                        <value>
                           <text>Potenza ventilatore di mandata</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaVenMandata[0]"/>
                        </traversal>
                        <?renderCache.bounds 125779 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Potenza ventilatore di mandata 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="potenzaVenMandata" y="32.655mm" x="151.668mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_6potenzaVentMandata"/>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="181.796mm" y="32.655mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.477mm" y="39.732mm" w="43.474mm" h="6mm">
                        <value>
                           <text>Portata ventilatore di ripresa</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="portataVenRipresa[0]"/>
                        </traversal>
                        <?renderCache.bounds 123233 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Portata ventilatore di ripresa 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="portataVenRipresa" y="39.732mm" x="49.759mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_6portataVentRipresa"/>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="79.887mm" y="39.732mm" w="7.024mm" h="6mm">
                        <value>
                           <text>(l/s)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                        <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 (l/s) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="106.779mm" y="39.328mm" w="44.372mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Potenza<span style="text-decoration:none"> ventilatore di ripresa</span></p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="potenzaVenRipresa[0]"/>
                        </traversal>
                     </draw>
                     <field name="potenzaVenRipresa" y="39.328mm" x="151.87mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="6"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L9_6potenzaVentRipresa"/>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="181.998mm" y="39.328mm" w="7.024mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">(<span style="text-decoration:none">kW</span>)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                     </draw>
                     <field name="flagInstallato" w="5.577mm" h="6mm" x="5.477mm" y="17.287mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L9_6flagInstallato"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagIndipendente.rawValue = "0";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[4]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="11.947mm" y="17.287mm" w="40.727mm" h="6mm">
                        <value>
                           <text>Installato in  U.T.A. o V.M.C.</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagIndipendente[0]"/>
                        </traversal>
                        <?renderCache.bounds 115447 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Installato in  U.T.A. o V.M.C. 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagIndipendente" w="5.577mm" h="6mm" x="5.477mm" y="24.364mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L9_6flagIndipendente"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagInstallato.rawValue = "0";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[5]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="11.947mm" y="24.364mm" w="18.805mm" h="6mm">
                        <value>
                           <text>Indipendente</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <?renderCache.bounds 53306 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 12 Indipendente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="47.213mm" x="137.109mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	tipologia.access = "protected";
	flagInstallato.access = "protected";
	flagindipendente.access = "protected";
	portataVenMandata.access = "protected";
	potenzaVenMandata.access = "protected";
	portataVenRipresa.access = "protected";
	potenzaVenRipresa.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1_copy2_copy1">
                     <bind match="dataRef" ref="$.sezRCsostituite.rowRCcalsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.tipologia.rawValue =			datiGT.tipologia.rawValue;
row.datiGT.flagInstallato.rawValue = 	datiGT.flagInstallato.rawValue;
row.datiGT.flagIndipendente.rawValue =	datiGT.flagIndipendente.rawValue;
row.datiGT.portataVenMandata.rawValue =	datiGT.portataVenMandata.rawValue;
row.datiGT.potenzaVenMandata.rawValue =	datiGT.potenzaVenMandata.rawValue;
row.datiGT.portataVenRipresa.rawValue =	datiGT.portataVenRipresa.rawValue;
row.datiGT.potenzaVenRipresa.rawValue =	datiGT.potenzaVenRipresa.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
	
/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="46.001mm">
                        <bind match="none"/>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_6dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L9_6dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.477mm" y="8.458mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Tipologia</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="tipologia[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 Tipologia 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="tipologia" y="8.458mm" w="62.953mm" h="6mm" x="23.475mm">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_6tipologia"/>
                           <validate>
                              <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                           </validate>
                           <traversal>
                              <traverse ref="flagInstallato[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.477mm" y="31.508mm" w="43.433mm" h="6mm">
                           <value>
                              <text>Portata ventilatore di mandata</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="portataVenMandata[0]"/>
                           </traversal>
                           <?renderCache.bounds 123117 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Portata ventilatore di mandata 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="portataVenMandata" y="31.508mm" x="49.759mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_6portataVentMandata"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="79.887mm" y="31.508mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(l/s)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 (l/s) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="106.779mm" y="31.913mm" w="44.372mm" h="6mm">
                           <value>
                              <text>Potenza ventilatore di mandata</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaVenMandata[0]"/>
                           </traversal>
                           <?renderCache.bounds 125779 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Potenza ventilatore di mandata 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="potenzaVenMandata" y="31.913mm" x="151.668mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_6potenzaVentMandata"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="181.796mm" y="31.913mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 4 (kW) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.679mm" y="38.99mm" w="43.474mm" h="6mm">
                           <value>
                              <text>Portata ventilatore di ripresa</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="portataVenRipresa[0]"/>
                           </traversal>
                           <?renderCache.bounds 123233 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Portata ventilatore di ripresa 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="portataVenRipresa" y="38.99mm" x="49.961mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_6portataVentRipresa"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="80.089mm" y="38.99mm" w="7.024mm" h="6mm">
                           <value>
                              <text>(l/s)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <?renderCache.bounds 19911 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 (l/s) 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="106.981mm" y="38.586mm" w="44.372mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Potenza<span style="text-decoration:none"> ventilatore di ripresa</span></p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="potenzaVenRipresa[0]"/>
                           </traversal>
                        </draw>
                        <field name="potenzaVenRipresa" y="38.586mm" x="151.87mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="6"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L9_6potenzaVentRipresa"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="181.998mm" y="38.586mm" w="7.024mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">(<span style="text-decoration:none">kW</span>)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </draw>
                        <field name="flagInstallato" w="5.577mm" h="6mm" x="5.477mm" y="16.14mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L9_6flagInstallato"/>
                           <traversal>
                              <traverse ref="txcivico[4]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="11.947mm" y="16.14mm" w="40.727mm" h="6mm">
                           <value>
                              <text>Installato in  U.T.A. o V.M.C.</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagIndipendente[0]"/>
                           </traversal>
                           <?renderCache.bounds 115447 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Installato in  U.T.A. o V.M.C. 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagIndipendente" w="5.577mm" h="6mm" x="5.477mm" y="23.217mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L9_6flagIndipendente"/>
                           <traversal>
                              <traverse ref="txcivico[5]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="11.947mm" y="23.217mm" w="18.805mm" h="6mm">
                           <value>
                              <text>Indipendente</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                           <?renderCache.bounds 53306 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 12 Indipendente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp10_1" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiVentilazMeccanicaVM"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>10. IMPIANTO DI VENTILAZIONE MECCANICA CONTROLLATA</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 50 10. IMPIANTO DI VENTILAZIONE MECCANICA CONTROLLATA 0 108588 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezVM"/>
               <draw name="tx_4_1" w="166.007mm" minH="6mm">
                  <value>
                     <text>10.1 IMPIANTO DI VENTILAZIONE MECCANICA CONTROLLATA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="button[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.maxPortataAria.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                  </field>
                  <?templateDesigner expand 0?>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="row[0]"/>
                  </traversal>
               </subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.rowVM[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = null;
	datiGT.modello.rawValue = null;
	datiGT.flagSolaEstraz.rawValue = "0";
	datiGT.flagFlussoIncrociato.rawValue = "0";
	datiGT.flagflussoTermodinamico.rawValue = "0";
	datiGT.flagAltro.rawValue = "0";
	datiGT.descrAltro.rawValue = null;
	datiGT.descrAltro.access = "protected";
	datiGT.maxPortataAria.rawValue = null;
	datiGT.rendimentoRecup.rawValue = null;

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btAnnullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.flagSolaEstraz.access = "open";
datiGT.flagFlussoIncrociato.access = "open";
datiGT.flagflussoTermodinamico.access = "open";
datiGT.flagAltro.access = "open";
datiGT.maxPortataAria.access = "open";
datiGT.rendimentoRecup.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";

    //01/12/2015
    datiGT.dataDismiss.rawValue = null;
	// devo rendere visibile il pulsante di RollBack della sostituzione
	var vIndice = rowSost.index;
	var vRowCount = _rowSost.count;			
	
	for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
		var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
		var vIndex = currentRow.index;
		if (vIndex == 0){
			currentRow.button.presence = "visible";
		}else{
			currentRow.button.presence = "invisible";		
		}		
	}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="annullaDismiss[0]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if ( datiGT.flagDismiss.rawValue == "1" ){
	btAnnullaDismiss.presence = "visible";
	annullaDismiss.presence = "visible";
}else {
	btAnnullaDismiss.presence = "invisible";
	annullaDismiss.presence = "invisible";
}*/
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="42.519mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="41.711mm" h="6mm">
                        <value>
                           <text>Impianto</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 118236 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 8 Impianto 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="readOnly">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>VM</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L10_1numVM"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">if (this.rawValue == null){
	try{
			var vRowCount = _row.count;
			//xfa.host.messageBox("vRowCount (dopo) "+vRowCount );		
			for (nItemCount = 0; nItemCount &lt; vRowCount-1 ; nItemCount++) {
				var vIdx =  row.index;

				//var currentRow = generatori.resolveNode("row["+ vIdx +"]");
				var currentRow = generatori.resolveNode("row["+ nItemCount +"]");
				
				var vNum = currentRow.sf.num.rawValue;
				//xfa.host.messageBox("currentRow.gt.numGruppoT.rawValue: "+currentRow.gt.numGruppoT.rawValue);
				
				//currentRow.sf.num.rawValue  = vIdx +1;			
			}	
			if (vRowCount &gt; 1)
				this.rawValue  = parseInt(vNum)   + 1;
			else
				this.rawValue  = 1;	
		//}	
	}catch(e){xfa.host.messageBox("exception row.sf.num::initialize "+e)};	
}
</script>
                        </event>
                     </field>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <draw name="txflag1" w="149.831mm" h="11.121mm">
                     <value>
                        <text>Situazione alla prima installazione o alla ristrutturazione dell'impianto termico</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="datiGT[0]"/>
                     </traversal>
                     <?renderCache.bounds 424718 31524 0 0 0 0 0 0?>
                     <?renderCache.textRun 81 Situazione alla prima installazione o alla ristrutturazione dell'impianto termico 0 5669 18110 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform name="datiGT" w="197.272mm" h="60.493mm">
                     <bind match="none"/>
                     <draw name="xindir" x="5.073mm" y="2.224mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di installazione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataInstallaz[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataInstallaz" y="2.224mm" x="35.606mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L10_1dataInstallaz">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || flagSolaEstraz.rawValue != 0 || flagFlussoIncrociato.rawValue != 0 
	|| flagflussoTermodinamico.rawValue != 0 || flagAltro.rawValue != 0 || maxPortataAria.rawValue != null || rendimentoRecup.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
		var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di installazione  non è corretto.";	
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
	} else
	//controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
	if (this.rawValue != null &amp;&amp; this.rawValue &gt; scriptsJS.getDataString()){
		var VALIDATION_MSG = "Errore!"+'\n'
			+"Data installazione maggiore di quella odierna.";		
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);	 	
    }	else{
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );    
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var nPage = xfa.layout.page(this);
		
		var vMessageSuffix = "pag. "+nPage;
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
</script>
                        </event>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Data installazione (sez 10.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                     </field>
                     <border>
                        <edge>
                           <color value="128,128,128"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="128,128,128"/>
                        </corner>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <draw name="xindir" x="106.779mm" y="2.324mm" w="29.926mm" h="6mm">
                        <value>
                           <text>Data di dismissione </text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="dataDismiss[0]"/>
                        </traversal>
                        <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="dataDismiss" y="2.324mm" x="137.312mm" w="20.22mm" h="6mm">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L10_1dataDismiss">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <validate formatTest="error">
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( this.rawValue != null &amp;&amp; !regExp.checkDateFormat(this.editValue) ){
	var VALIDATION_MSG = "Errore!"+'\n'	+"Il formato della data di dismissione non è corretto.";	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else if (this.rawValue != null &amp;&amp; (this.rawValue &lt; dataInstallaz.rawValue || this.rawValue &gt; scriptsJS.getDataString() ) ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
	
	var fullPathValidationField2 = "Richiesta.formValido";
	var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);		
	if (this.rawValue != null &amp;&amp; (flagSost.rawValue == 1 || flagDismiss.rawValue == 1))
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
	else if (this.rawValue != null &amp;&amp; flagSost.rawValue == 0 &amp;&amp; flagDismiss.rawValue == 0) {
		var VALIDATION_MSG = "Errore!"+'\n'
				+"Se si valorizza la &lt;data di dismissione&gt; e' necessario dismettere o sostituire il componente.";
			
		controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);	
	}
}
</script>
                           <message>
                              <text name="formatTest">Il formato data deve essere: gg/mm/aaaa .</text>
                           </message>
                           <picture>date{DD/MM/YYYY}</picture>
                        </validate>
                        <assist>
                           <toolTip>Data dismissione (sez 10.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </field>
                     <field name="sostComp" y="53.884mm" x="61.284mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>sostituzione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">//
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null || modello.rawValue == null || maxPortataAria.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else {
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		maxPortataAria.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){		
	try{	
		    //sostituzione
			//------------------------------------------------------------
			var newRow = _rowSost.addInstance(true);
		
			newRow.datiGT.dataInstallaz.rawValue = dataInstallaz.rawValue;
			newRow.datiGT.dataDismiss.rawValue = dataDismiss.rawValue;
			newRow.datiGT.fabbricante.rawValue = fabbricante.rawValue;
			newRow.datiGT.codFabbricante.rawValue = codFabbricante.rawValue;
			newRow.datiGT.modello.rawValue = modello.rawValue;
			newRow.datiGT.flagSolaEstraz.rawValue = flagSolaEstraz.rawValue;
			newRow.datiGT.flagFlussoIncrociato.rawValue = flagFlussoIncrociato.rawValue;
			newRow.datiGT.flagflussoTermodinamico.rawValue = flagflussoTermodinamico.rawValue;
			newRow.datiGT.flagAltro.rawValue = flagAltro.rawValue;
			newRow.datiGT.maxPortataAria.rawValue = maxPortataAria.rawValue;
			newRow.datiGT.rendimentoRecup.rawValue = rendimentoRecup.rawValue;
				
			//DA AGGIUNGERE
			_rowSost.moveInstance (newRow.index,0 );
			
			//DA AGGIUNGERE
			dataInstallaz.rawValue = scriptsJS.getDataString();			
			//dataInstallaz.rawValue = null;
			
			dataDismiss.rawValue = null;			
			fabbricante.rawValue = null;
			modello.rawValue = null;
			flagSolaEstraz.rawValue = "0";
			flagFlussoIncrociato.rawValue = "0";
			flagflussoTermodinamico.rawValue = "0";
			flagAltro.rawValue = "0";
			descrAltro.rawValue = null;
			descrAltro.access = "protected";
			maxPortataAria.rawValue = null;
			rendimentoRecup.rawValue = null;


			flagSost.rawValue = "1";
			//--------------------------------------------------------------
			
			//DA AGGIUNGERE	
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				if (vIndex == 0){
					currentRow.button.presence = "visible";
				}else{
					currentRow.button.presence = "invisible";		
				}	
			}
	}catch(e){ 
		xfa.host.messageBox("Errore durante la sostituzione componente:\n"+ e);	
	}
	
		}
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="flagSost[0]"/>
                        </traversal>
                     </field>
                     <field name="dismissComp" y="53.682mm" x="100.165mm" w="37.608mm" h="6mm" relevant="-print">
                        <ui>
                           <button highlight="inverted"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <caption>
                           <value>
                              <text>dismissione componente</text>
                           </value>
                           <para vAlign="middle" hAlign="center"/>
                           <font size="8pt" typeface="Verdana"/>
                        </caption>
                        <border hand="right">
                           <edge stroke="raised"/>
                           <fill>
                              <radial type="toCenter">
                                 <color value="212,208,200"/>
                              </radial>
                           </fill>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

if (dataDismiss.rawValue == null) {
	xfa.host.messageBox("ATTENZIONE! E' necessario inserire la data di dismissione.");
}else if (dataInstallaz.rawValue == null || fabbricante.rawValue == null ||  modello.rawValue == null || maxPortataAria.rawValue == null){	
	xfa.host.messageBox("Compilare i dati obbligatori evidenziati in rosso!");	
}else if (dataDismiss.rawValue != null &amp;&amp; (dataDismiss.rawValue &lt; dataInstallaz.rawValue || dataDismiss.rawValue &gt; scriptsJS.getDataString())){	
	xfa.host.messageBox("La data di dismissione non puo' essere inferiore a quella di installazione o maggiore di quella odierna.!");
}else{
		fCheckValidi.rawValue = 0;
		
		dataInstallaz.execEvent("validate");		
		dataDismiss.execEvent("validate");
		dataInstallaz.execEvent("exit");
		fabbricante.execEvent("validate");
		modello.execEvent("validate");
		maxPortataAria.execEvent("validate");
		
		if(controlli.isOk(fCheckValidi)){	

			flagDismiss.rawValue = "1";
			dataInstallaz.access = "protected";
			dataDismiss.access = "protected";
			fabbricante.access = "protected";
			modello.access = "protected";
			flagSolaEstraz.access = "protected";
			flagFlussoIncrociato.access = "protected";
			flagflussoTermodinamico.access = "protected";
			flagAltro.access = "protected";
			descrAltro.access = "protected";
			maxPortataAria.access = "protected";
			rendimentoRecup.access = "protected";
		
			
			sostComp.access = "protected";
			button.btCancella.access = "protected";
			button.btAnnullaDismiss.presence = "visible";
			button.annullaDismiss.presence  = "visible";
			
			// devo rendere invisibile il pulsante di RollBack della sostituzione
			var vIndice = rowSost.index;
			var vRowCount = _rowSost.count;			
		
			for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
				var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
				var vIndex = currentRow.index;
				
				if (flagDismiss.rawValue == "1"  ) {
					currentRow.button.presence = "invisible";
				}	
			}	
	}			
}
</script>
                        </event>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse ref="sostComp[0]"/>
                        </traversal>
                     </field>
                     <field name="flagSost" y="54.087mm" x="34.594mm" w="24.668mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="17.668mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagSost</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="none"/>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </field>
                     <field name="fabbricante" y="9.401mm" x="23.271mm" w="62.953mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (dataInstallaz.rawValue != null || modello.rawValue != null || flagSolaEstraz.rawValue != 0 || flagFlussoIncrociato.rawValue != 0 
	|| flagflussoTermodinamico.rawValue != 0 || flagAltro.rawValue != 0 || maxPortataAria.rawValue != null || rendimentoRecup.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
</script>
                        </validate>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){null; // xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on fabbricante::enter "+e);}
</script>
                        </event>
                        <assist>
                           <toolTip>Fabbricante (sez 10.1)</toolTip>
                        </assist>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codFabbricante.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="modello[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="5.073mm" y="9.199mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Fabbricante</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="106.779mm" y="9.299mm" w="17.187mm" h="6mm">
                        <value>
                           <text>Modello</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="fabbricante[0]"/>
                        </traversal>
                        <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="modello" y="9.501mm" w="60.659mm" h="6mm" x="124.975mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L10_1modello"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || dataInstallaz.rawValue != null || flagSolaEstraz.rawValue != 0 || flagFlussoIncrociato.rawValue != 0 
	|| flagflussoTermodinamico.rawValue != 0 || flagAltro.rawValue != 0 || maxPortataAria.rawValue != null || rendimentoRecup.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <assist>
                           <toolTip>Modello (sez 10.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="codFabbricante[0]"/>
                        </traversal>
                        <value>
                           <text maxChars="255"/>
                        </value>
                     </field>
                     <draw name="xindir" x="5.275mm" y="18.298mm" w="16.985mm" h="6mm">
                        <value>
                           <text>Tipologia :</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="flagSolaEstraz[0]"/>
                        </traversal>
                        <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Tipologia : 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="xindir" x="5.477mm" y="46.201mm" w="32.554mm" h="6mm">
                        <value>
                           <text>Massima portata aria</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="maxPortataAria[0]"/>
                        </traversal>
                        <?renderCache.bounds 92279 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 20 Massima portata aria 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="maxPortataAria" y="46.201mm" x="38.031mm" w="29.52mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L10_1maxPortataAria"/>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == null &amp;&amp; (fabbricante.rawValue != null || modello.rawValue != null || flagSolaEstraz.rawValue != 0 || flagFlussoIncrociato.rawValue != 0 
	|| flagflussoTermodinamico.rawValue != 0 || flagAltro.rawValue != 0 || dataInstallaz.rawValue != null || rendimentoRecup.rawValue != null )) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
</script>
                        </validate>
                        <assist>
                           <toolTip>Massima portata aria (sez 10.1)</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="dismissComp[0]"/>
                        </traversal>
                     </field>
                     <draw name="xindir" x="106.779mm" y="45.797mm" w="44.372mm" h="6mm">
                        <value>
                           <text>Rendimento di recupero / COP</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="rendimentoRecup[0]"/>
                        </traversal>
                        <?renderCache.bounds 125779 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Rendimento di recupero / COP 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="rendimentoRecup" y="45.797mm" x="151.87mm" w="33.565mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <decimal leadDigits="5"/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L10_1rendimentoRecupero"/>
                        <traversal>
                           <traverse ref="txcivico[4]"/>
                        </traversal>
                     </field>
                     <field name="flagSolaEstraz" w="5.577mm" h="6mm" x="24.686mm" y="18.298mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L10_1flagSolaEstraz"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagFlussoIncrociato.rawValue = "0";
	flagflussoTermodinamico.rawValue = "0";
	flagAltro.rawValue = "0";
	descrAltro.rawValue = "";
	descrAltro.access = "protected";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="31.156mm" y="18.298mm" w="40.727mm" h="6mm">
                        <value>
                           <text>Sola estrazione</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagFlussoIncrociato[0]"/>
                        </traversal>
                        <?renderCache.bounds 115447 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 15 Sola estrazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagFlussoIncrociato" w="5.577mm" h="6mm" x="24.686mm" y="24.567mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L10_1flagFlussoIncrociato"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagSolaEstraz.rawValue = "0";
	flagflussoTermodinamico.rawValue = "0";
	flagAltro.rawValue = "0";
	descrAltro.rawValue = "";
	descrAltro.access = "protected";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[1]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="31.156mm" y="24.567mm" w="93.098mm" h="6mm">
                        <value>
                           <text>Flusso doppio con recupero tramite scambiatore a flussi incrociati</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagflussoTermodinamico[0]"/>
                        </traversal>
                        <?renderCache.bounds 263900 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 66 Flusso doppio con recupero tramite scambiatore a flussi incrociati 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagflussoTermodinamico" w="5.577mm" h="6mm" x="24.686mm" y="30.835mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L10_1flagFlussoTermoDinamico"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagFlussoIncrociato.rawValue = "0";
	flagSolaEstraz.rawValue = "0";
	flagAltro.rawValue = "0";
	descrAltro.rawValue = "";
	descrAltro.access = "protected";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[2]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="31.156mm" y="30.835mm" w="93.098mm" h="6mm">
                        <value>
                           <text>Flusso doppio con recupero termodinamico</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="flagAltro[0]"/>
                        </traversal>
                        <?renderCache.bounds 263900 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 40 Flusso doppio con recupero termodinamico 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagAltro" w="5.577mm" h="6mm" x="24.686mm" y="37.103mm">
                        <ui>
                           <checkButton mark="circle" size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <bind match="dataRef" ref="$.L10_1flagAltro"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	flagFlussoIncrociato.rawValue = "0";
	flagflussoTermodinamico.rawValue = "0";
	flagSolaEstraz.rawValue = "0";
	descrAltro.access = "open";
}else{
	descrAltro.rawValue = "";
	descrAltro.access = "protected";
}	
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == "1") {
	descrAltro.access = "open";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txcivico[3]"/>
                        </traversal>
                     </field>
                     <draw name="txcivico" x="31.156mm" y="37.103mm" w="9.706mm" h="6mm">
                        <value>
                           <text>Altro</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="descrAltro[0]"/>
                        </traversal>
                        <?renderCache.bounds 27513 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 Altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="descrAltro" y="37.103mm" w="144.573mm" h="6mm" x="40.862mm" access="protected">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L10_1descrAltro"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <value>
                           <text maxChars="100"/>
                        </value>
                     </field>
                     <draw name="txcivico" x="67.754mm" y="46mm" w="11.162mm" h="6.085mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">(m<span style="vertical-align:3.41pt">3</span>/ h)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                     </draw>
                     <field name="codFabbricante" y="9.603mm" x="86.559mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L10_1fabbricante"/>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                     <field name="flagDismiss" y="53.481mm" x="138.12mm" w="14.76mm" h="6mm" presence="invisible">
                        <ui>
                           <checkButton size="2.8222mm">
                              <border>
                                 <?templateDesigner StyleID apcb2?>
                                 <edge stroke="lowered"/>
                                 <fill/>
                              </border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <integer>0</integer>
                        </value>
                        <caption placement="right" reserve="7.76mm">
                           <para vAlign="middle"/>
                           <value>
                              <text>flagDismiss</text>
                           </value>
                        </caption>
                        <items>
                           <integer>1</integer>
                           <integer>0</integer>
                           <integer>2</integer>
                        </items>
                        <bind match="dataRef" ref="$.flagDismissione"/>
                        <traversal>
                           <traverse ref="rowSostGT[0]"/>
                        </traversal>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if(this.rawValue == 1){
	
	dataInstallaz.access = "protected";
	dataDismiss.access = "protected";
	fabbricante.access = "protected";
	modello.access = "protected";
	flagSolaEstraz.access = "protected";
	flagFlussoIncrociato.access = "protected";
	flagflussoTermodinamico.access = "protected";
	flagAltro.access = "protected";
	descrAltro.access = "protected";
	maxPortataAria.access = "protected";
	rendimentoRecup.access = "protected";
	
	sostComp.access = "protected";
	button.btCancella.access = "protected";
	/*
	if (flagAnnullaDismiss.rawValue == 1) { 
		button.annullaDismiss.presence  = "visible";
	}

	
	try{
		// devo rendere invisibile il pulsante di RollBack della sostituzione
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			
	
		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (flagDismiss.rawValue == 1  ) {
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				currentRow.button.presence = "invisible";
			}	
		}	
	}catch(e){ null;}
   */		
}
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 0?></subform>
                  <draw name="Rectangle6" w="197.163mm" h="4.751mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform w="196.758mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1_copy2_copy1_copy1">
                     <bind match="dataRef" ref="$.sezVMsostituite.rowVMsost[*]"/>
                     <subform w="4.93mm" name="button" h="6.132mm">
                        <bind match="none"/>
                        <draw name="annullaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\images.jpg" contentType="image/jpg"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Annulla</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btAnnulla[0]"/>
                           </traversal>
                        </draw>
                        <field name="btAnnulla" w="4.535mm" h="4.957mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowSost.index;
var vRowCount = _rowSost.count;

row.datiGT.flagSost.rawValue = "0";
row.datiGT.dataInstallaz.rawValue =		datiGT.dataInstallaz.rawValue;
row.datiGT.dataDismiss.rawValue = 		datiGT.dataDismiss.rawValue;
row.datiGT.fabbricante.rawValue =		datiGT.fabbricante.rawValue;
row.datiGT.codFabbricante.rawValue =	datiGT.codFabbricante.rawValue;
row.datiGT.modello.rawValue = 			datiGT.modello.rawValue;
row.datiGT.flagSolaEstraz.rawValue =	datiGT.flagSolaEstraz.rawValue;
row.datiGT.flagFlussoIncrociato.rawValue =		datiGT.flagFlussoIncrociato.rawValue;
row.datiGT.flagflussoTermodinamico.rawValue =	datiGT.flagflussoTermodinamico.rawValue;
row.datiGT.flagAltro.rawValue =					datiGT.flagAltro.rawValue;
row.datiGT.descrAltro.rawValue =				datiGT.descrAltro.rawValue;
row.datiGT.maxPortataAria.rawValue =	datiGT.maxPortataAria.rawValue;
row.datiGT.rendimentoRecup.rawValue =	datiGT.rendimentoRecup.rawValue;


//prima di eliminare la riga, verifico rendo visible il pulsante annulla della riga sottostante ...
if (vRowCount &gt; 1){
	var firstRow = this.parent.parent.parent.resolveNode("rowSost["+ 1 +"]");
	firstRow.button.presence = "visible";
}	
// ...e poi rimuovo
_rowSost.removeInstance(vIndex);
</script>
                           </event>
                           <assist>
                              <toolTip>Annulla sostituzione.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

/*
//06/07/2016 correzzione funzionamento rollback
if (this.parent.index == 0 ){
	if ( row.datiGT.flagDismiss.rawValue == "1" ){
    	this.presence = "invisible";
    }else{ 	
    	this.presence = "visible";
    }	
}else{
	this.presence = "invisible";
}*/
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="annullaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="191.828mm" h="7.279mm">
                        <value>
                           <text>SOSTITUZIONE DEL COMPONENTE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="14.173pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="datiGT[0]"/>
                        </traversal>
                        <?renderCache.bounds 543764 20633 0 0 0 0 0 0?>
                        <?renderCache.textRun 27 SOSTITUZIONE DEL COMPONENTE 0 14173 12664 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <subform name="datiGT" w="197.225mm" h="51.46mm">
                        <bind match="none"/>
                        <draw name="xindir" x="5.073mm" y="1.213mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di installazione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataInstallaz[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Data di installazione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataInstallaz" y="1.213mm" x="35.606mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L10_1dataInstallaz">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                        </field>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden"/>
                        </border>
                        <draw name="xindir" x="106.779mm" y="1.313mm" w="29.926mm" h="6mm">
                           <value>
                              <text>Data di dismissione </text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="dataDismiss[0]"/>
                           </traversal>
                           <?renderCache.bounds 84830 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Data di dismissione  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="dataDismiss" y="1.313mm" x="137.312mm" w="20.22mm" h="6mm" access="protected">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle" hAlign="center"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L10_1dataDismiss">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                        </field>
                        <field name="fabbricante" y="8.257mm" x="22.662mm" w="62.884mm" h="6mm" access="protected">
                           <ui>
                              <choiceList>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </choiceList>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <event activity="ready" ref="$form" name="event__form_ready">
                              <script contentType="application/x-javascript">

try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.fabbricante" precompilata ---------
		var oItems = Richiesta.resolveNode("web.fabbricante.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.fabbricante.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codFabbricante.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codFabbricante.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){ null; //xfa.host.messageBox("Exception on fabbricante::init "+e);
}
</script>
                           </event>
                           <bind match="none"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="4.87mm" y="8.257mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Fabbricante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="fabbricante[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Fabbricante 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="106.576mm" y="8.357mm" w="17.187mm" h="6mm">
                           <value>
                              <text>Modello</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="modello[0]"/>
                           </traversal>
                           <?renderCache.bounds 48719 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 7 Modello 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="modello" y="8.357mm" w="60.659mm" h="6mm" x="124.571mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L10_1modello"/>
                           <traversal>
                              <traverse ref="codFabbricante[0]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="5.072mm" y="17.356mm" w="16.985mm" h="6mm">
                           <value>
                              <text>Tipologia :</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="flagSolaEstraz[0]"/>
                           </traversal>
                           <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 11 Tipologia : 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <draw name="xindir" x="5.274mm" y="44.046mm" w="32.554mm" h="6mm">
                           <value>
                              <text>Massima portata aria</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="maxPortataAria[0]"/>
                           </traversal>
                           <?renderCache.bounds 92279 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Massima portata aria 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="maxPortataAria" y="44.046mm" x="37.828mm" w="29.52mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L10_1maxPortataAria"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <draw name="xindir" x="106.576mm" y="44.046mm" w="44.372mm" h="6mm">
                           <value>
                              <text>Rendimento di recupero / COP</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="rendimentoRecup[0]"/>
                           </traversal>
                           <?renderCache.bounds 125779 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 28 Rendimento di recupero / COP 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="rendimentoRecup" y="44.046mm" x="151.667mm" w="33.565mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L10_1rendimentoRecupero"/>
                        </field>
                        <field name="flagSolaEstraz" w="5.577mm" h="6mm" x="24.483mm" y="17.356mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L10_1flagSolaEstraz"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="30.953mm" y="17.356mm" w="40.727mm" h="6mm">
                           <value>
                              <text>Sola estrazione</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagFlussoIncrociato[0]"/>
                           </traversal>
                           <?renderCache.bounds 115447 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 15 Sola estrazione 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagFlussoIncrociato" w="5.577mm" h="6mm" x="24.483mm" y="23.625mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L10_1flagFlussoIncrociato"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="30.953mm" y="23.625mm" w="93.098mm" h="6mm">
                           <value>
                              <text>Flusso doppio con recupero tramite scambiatore a flussi incrociati</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagflussoTermodinamico[0]"/>
                           </traversal>
                           <?renderCache.bounds 263900 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 66 Flusso doppio con recupero tramite scambiatore a flussi incrociati 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagflussoTermodinamico" w="5.577mm" h="6mm" x="24.483mm" y="29.893mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L10_1flagFlussoTermoDinamico"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="30.953mm" y="29.893mm" w="93.098mm" h="6mm">
                           <value>
                              <text>Flusso doppio con recupero termodinamico</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="flagAltro[0]"/>
                           </traversal>
                           <?renderCache.bounds 263900 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 40 Flusso doppio con recupero termodinamico 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="flagAltro" w="5.577mm" h="6mm" x="24.483mm" y="36.161mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L10_1flagAltro"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" x="30.953mm" y="36.161mm" w="9.706mm" h="6mm">
                           <value>
                              <text>Altro</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="descrAltro[0]"/>
                           </traversal>
                           <?renderCache.bounds 27513 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 Altro 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                        <field name="descrAltro" y="36.161mm" w="144.573mm" h="6mm" x="40.659mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge>
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner>
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L10_1descrAltro"/>
                           <event activity="initialize" name="event__initialize">
                              <script contentType="application/x-javascript">
this.access = "protected";
</script>
                           </event>
                           <traversal>
                              <traverse ref="txcivico[4]"/>
                           </traversal>
                           <value>
                              <text maxChars="100"/>
                           </value>
                        </field>
                        <draw name="txcivico" x="67.551mm" y="44.004mm" w="11.162mm" h="6.085mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">(m<span style="vertical-align:3.41pt">3</span>/ h)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="8pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                        </draw>
                        <field name="codFabbricante" y="8.862mm" x="86.155mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                           <ui>
                              <textEdit>
                                 <border presence="hidden">
                                    <?templateDesigner StyleID aped0?></border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Myriad Pro" size="7pt"/>
                           <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <bind match="dataRef" ref="$.L10_1fabbricante"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <occur max="-1" min="0"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <?templateDesigner expand 0?>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                  </subform>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <occur max="-1"/>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="200.398mm" name="schedaAltriComp11_1" layout="lr-tb">
            <bind match="none"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <exData contentType="text/html">
                           <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">11. RISULTATI DELLA PRIMA VERIFICA EFFETTUATA DALL'INSTALLATORE E DELLE<span style="xfa-spacerun:yes">  </span></p><p style="letter-spacing:0in">VERIFICHE<span style="xfa-spacerun:yes"> </span><span style="text-decoration:none">PERIODICHE SUCCESSIVE EFFETTUATE DAL MANUTENTORE</span></p></body>
                        </exData>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                  </draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].tx_4_1[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="200.802mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.Richiesta.datiRisultatiGT.sezGruppiTermici"/>
               <draw name="tx_4_1" w="195.949mm" minH="6mm">
                  <value>
                     <text>11.1 GRUPPI TERMICI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="row[0]"/>
                  </traversal>
               </draw>
               <subform y="6mm" w="200.6mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.L11_1rowGT[*]"/>
                  <subform w="197.163mm" minH="12.031mm" layout="lr-tb" name="sfRiferimento">
                     <bind match="none"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="sf[0]"/>
                     </traversal>
                     <draw name="txflag1" w="28.932mm" h="6mm">
                        <value>
                           <text>Riferimento:</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="22.677pt"/>
                        <font size="8pt" typeface="Verdana"/>
                        <margin leftInset="1mm"/>
                        <traversal>
                           <traverse ref="flagNorma[0]"/>
                        </traversal>
                        <?renderCache.bounds 79177 17008 0 0 2835 0 0 0?>
                        <?renderCache.textRun 12 Riferimento: 0 25512 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagNorma" w="5.577mm" h="6mm">
                        <ui>
                           <checkButton size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <validate>
                           <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                        </validate>
                        <bind match="dataRef" ref="$.L11_1flagNorma"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	flagAltro.rawValue = "0";
	descrAltro.rawValue = "";
	descrAltro.access = "protected";
}	
</script>
                        </event>
                        <traversal>
                           <traverse ref="txflag1[1]"/>
                        </traversal>
                     </field>
                     <draw name="txflag1" w="42.682mm" h="6mm">
                        <value>
                           <text>norma UNI-10389-1</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <margin leftInset="1mm"/>
                        <traversal>
                           <traverse ref="flagAltro[0]"/>
                        </traversal>
                        <?renderCache.bounds 118153 17008 0 0 2835 0 0 0?>
                        <?renderCache.textRun 17 norma UNI-10389-1 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="flagAltro" w="5.577mm" h="6mm">
                        <ui>
                           <checkButton size="3.175mm" shape="round">
                              <border>
                                 <edge stroke="lowered"/>
                                 <fill>
                                    <color value="255, 255, 255"/>
                                 </fill>
                                 <?templateDesigner StyleID apcb4?></border>
                           </checkButton>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <margin leftInset="1mm" rightInset="1mm"/>
                        <para vAlign="middle"/>
                        <value>
                           <text>0</text>
                        </value>
                        <items>
                           <text>1</text>
                           <text>0</text>
                        </items>
                        <validate>
                           <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                        </validate>
                        <bind match="dataRef" ref="$.L11_1flagAltro"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	flagNorma.rawValue = "0";
	descrAltro.access = "open";
}else{ 
	descrAltro.rawValue = "";
	descrAltro.access = "protected";	
}
</script>
                        </event>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
if (this.rawValue == 1 ){ 
	descrAltro.access = "open";
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="txflag1[2]"/>
                        </traversal>
                     </field>
                     <draw name="txflag1" w="10.868mm" h="6mm">
                        <value>
                           <text>altro</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle"/>
                        <font size="8pt" typeface="Verdana"/>
                        <margin leftInset="1mm"/>
                        <traversal>
                           <traverse ref="descrAltro[0]"/>
                        </traversal>
                        <?renderCache.bounds 27972 17008 0 0 2835 0 0 0?>
                        <?renderCache.textRun 5 altro 0 2835 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="descrAltro" w="81.487mm" h="6mm" access="protected">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <bind match="dataRef" ref="$.L11_1descrAltro"/>
                        <event activity="initialize" name="event__initialize">
                           <script contentType="application/x-javascript">
this.access = "protected";
</script>
                        </event>
                        <traversal>
                           <traverse ref="sf[0]"/>
                        </traversal>
                     </field>
                     <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <subform w="197.181mm" name="button" h="5.56mm" presence="hidden">
                        <bind match="none"/>
                        <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                           <value>
                              <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Aggiungi riga.</toolTip>
                           </assist>
                           <margin leftInset="1mm"/>
                        </draw>
                        <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                           </event>
                           <assist>
                              <toolTip>Aggiungi nuovo elemento.</toolTip>
                           </assist>
                           <margin leftInset="1mm"/>
                        </field>
                        <?templateDesigner expand 0?></subform>
                     <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <?templateDesigner expand 0?></subform>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="hidden">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = "";
	datiGT.modello.rawValue = "";
	datiGT.flagSolaEstraz.rawValue = "0";
	datiGT.flagFlussoIncrociato.rawValue = "0";
	datiGT.flagflussoTermodinamico.rawValue = "0";
	datiGT.flagAltro.rawValue = "0";
	datiGT.descrAltro.rawValue = "";
	datiGT.descrAltro.access = "protected";
	datiGT.maxPortataAria.rawValue = "";
	datiGT.rendimentoRecup.rawValue = "";

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                     </field>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.flagSolaEstraz.access = "open";
datiGT.flagFlussoIncrociato.access = "open";
datiGT.flagflussoTermodinamico.access = "open";
datiGT.flagAltro.access = "open";
datiGT.maxPortataAria.access = "open";
datiGT.rendimentoRecup.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";
</script>
                        </event>
                     </field>
                     <?templateDesigner expand 1?></subform>
                  <subform w="35.2mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="24.281mm" h="6mm">
                        <value>
                           <text>Gruppo termico</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 68828 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 14 Gruppo termico 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="protected">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>GT</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L11_1numGT"/>
                        <traversal>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </field>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <keep intact="contentArea"/>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <draw name="txflag1" w="165.198mm" h="11.121mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="rowData[0].xindir[0]"/>
                     </traversal>
                     <?renderCache.bounds 468278 31524 0 0 0 0 0 0?></draw>
                  <draw name="Rectangle6" w="197.163mm" h="3.199mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform y="14.32mm" w="199.993mm" minH="142.753mm" layout="lr-tb" name="rowData">
                     <bind match="dataRef" ref="$.sezDateGT.rowDateGT[*]"/>
                     <draw name="xindir" w="11.543mm" h="6mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="4.252pt"/>
                        <font size="8pt" typeface="Verdana"/>
                        <value>
                           <text>Data</text>
                        </value>
                        <traversal>
                           <traverse ref="data[0]"/>
                        </traversal>
                        <?renderCache.bounds 32720 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 Data 0 4252 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="data" w="20.22mm" h="6mm" access="protected">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L11_1data">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <traversal>
                           <traverse ref="etichette[0].xindir[0]"/>
                        </traversal>
                     </field>
                     <draw name="Rectangle6" w="197.163mm" h="2.088mm">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <draw name="Rectangle6" w="197.163mm" h="1.416mm">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <subform name="etichette" w="42.007mm" h="142.486mm">
                        <bind match="none"/>
                        <draw name="xindir" x="0.018mm" y="0.202mm" w="28.105mm" h="6mm">
                           <value>
                              <text>Numero modulo</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                           <?renderCache.bounds 79668 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 13 Numero modulo 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.335mm" y="20.22mm" w="39.103mm" h="6mm">
                           <value>
                              <text>Temperatura fumi (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                           <?renderCache.bounds 110843 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Temperatura fumi (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.018mm" y="7.481mm" w="34.98mm" h="6mm">
                           <value>
                              <text>Portata termica effettiva (kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                           <?renderCache.bounds 99156 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Portata termica effettiva (kW) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.176mm" y="13.952mm" w="41.334mm" h="6mm">
                           <value>
                              <text>VALORI MISURATI</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="7pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden"/>
                              <fill>
                                 <color value="221,221,221"/>
                              </fill>
                           </border>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                           <?renderCache.bounds 117167 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 15 VALORI MISURATI 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.176mm" y="77.847mm" w="41.334mm" h="6mm">
                           <value>
                              <text>VALORI CALCOLATI</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="7pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden"/>
                              <fill>
                                 <color value="221,221,221"/>
                              </fill>
                           </border>
                           <traversal>
                              <traverse ref="xindir[9]"/>
                           </traversal>
                           <?renderCache.bounds 117167 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 16 VALORI CALCOLATI 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="0.22mm" y="32.554mm" w="22.444mm" h="6.085mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">O<span style="vertical-align:-1.05pt">2</span><span style="xfa-spacerun:yes">  </span>(%)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                           <corner/>
                        </border>
                        <draw name="xindir" x="0.026mm" y="25.881mm" w="39.478mm" h="6mm">
                           <value>
                              <text>Temperatura aria comburente (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                           <?renderCache.bounds 111906 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 33 Temperatura aria comburente (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="txcivico" x="0.22mm" y="38.822mm" w="22.444mm" h="6.085mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">CO<span style="vertical-align:-1.05pt">2</span><span style="xfa-spacerun:yes">  </span>(%)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="0.22mm" y="45.899mm" w="28.105mm" h="6mm">
                           <value>
                              <text>Indice di Bacharach</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[7]"/>
                           </traversal>
                           <?renderCache.bounds 79668 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 19 Indice di Bacharach 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.018mm" y="52.774mm" w="38.568mm" h="6mm">
                           <value>
                              <text>CO nei fumi secchi (ppm v/v)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[8]"/>
                           </traversal>
                           <?renderCache.bounds 109327 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 28 CO nei fumi secchi (ppm v/v) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="60.255mm" w="38.418mm" h="7.271mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Portata combustibile<span style="xfa-spacerun:yes"> </span></p><p style="text-decoration:none;letter-spacing:0in">(m<span style="vertical-align:3.41pt">3</span>/ h oppure kg/h)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para marginLeft="2.835pt" spaceAbove="2pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[18]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="0.22mm" y="86.137mm" w="41.046mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">CO nei fumi secchi e senz'aria<span style="xfa-spacerun:yes"> </span></p><p style="text-decoration:none;letter-spacing:0in">(ppm v/v)</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[10]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="0.422mm" y="92.81mm" w="36.586mm" h="6.033mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Rendimento di combustione<span style="xfa-spacerun:yes"> </span><span style="vertical-align:0.5pt;font-family:Arial;font-size:10pt;text-decoration:none">η</span><span style="vertical-align:0.5pt;font-family:Arial;font-size:5.5pt;text-decoration:none">c</span></p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </draw>
                        <draw name="txcivico" x="37.425mm" y="93.012mm" w="3.841mm" h="6mm">
                           <value>
                              <text>(%)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle"/>
                           <font size="5pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[11]"/>
                           </traversal>
                           <?renderCache.bounds 10888 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 3 (%) 0 0 9971 0 0 0 "Verdana" 0 0 5000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.026mm" y="100.696mm" w="41.334mm" h="6mm">
                           <value>
                              <text>VERIFICHE</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="5.669pt"/>
                           <font size="7pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden"/>
                              <fill>
                                 <color value="221,221,221"/>
                              </fill>
                           </border>
                           <traversal>
                              <traverse ref="firma2[0]"/>
                           </traversal>
                           <?renderCache.bounds 117167 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 9 VERIFICHE 0 5669 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="106.964mm" w="38.391mm" h="6mm">
                           <value>
                              <text>Rispetta l'indice di Bacharach</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[13]"/>
                           </traversal>
                           <?renderCache.bounds 108825 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 Rispetta l'indice di Bacharach 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="114.446mm" w="38.215mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">CO nei fumi secchi e senz'aria<span style="xfa-spacerun:yes"> </span></p><p style="letter-spacing:0in">&lt;= 1.000 ppm v/v</p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="ragSocialeImpianto[1]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="0.22mm" y="121.523mm" w="34.98mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="vertical-align:0.5pt;font-family:Arial;font-size:10pt;text-decoration:none;letter-spacing:0in">η<span style="font-family:Verdana;font-size:6pt"><span style="xfa-spacerun:yes"> </span></span><span style="vertical-align:baseline;font-family:Verdana;font-size:6pt">minimo di legge (%)</span></p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[15]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="0.22mm" y="128.397mm" h="6mm" w="9.705mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="vertical-align:0.5pt;font-family:Arial;font-size:10pt;letter-spacing:0in">η<span style="font-size:5.5pt">c</span><span style="font-family:Verdana;font-size:6pt"><span style="xfa-spacerun:yes"> </span></span><span style="vertical-align:baseline;font-family:Verdana;font-size:6pt">&gt;=</span></p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[16]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="10.33mm" y="128.397mm" w="13.345mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="margin-left:0pt;vertical-align:0.5pt;font-family:Arial;font-size:10pt;text-decoration:none;letter-spacing:0in">η<span style="font-family:Verdana;font-size:6pt"><span style="xfa-spacerun:yes"> </span></span><span style="vertical-align:baseline;font-family:Verdana;font-size:6pt">minimo<span style="xfa-spacerun:yes"> </span></span></p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="5.669pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[17]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="0.22mm" y="135.475mm" w="40.642mm" h="6mm">
                           <value>
                              <text>FIRMA</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt" hAlign="right"/>
                           <font size="6pt" typeface="Verdana" weight="bold"/>
                           <traversal>
                              <traverse ref="rowSost[0].datiGT[0].numModulo[0]"/>
                           </traversal>
                           <?renderCache.bounds 115206 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 FIRMA 0 92990 10265 0 0 0 "Verdana" 1 0 6000 ISO-8859-1?></draw>
                        <?templateDesigner expand 0?>
                        <draw name="xindir" x="0.22mm" y="69.961mm" w="38.568mm" h="6mm">
                           <value>
                              <text>NOx</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                           <?renderCache.bounds 109327 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 3 NOx 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </subform>
                     <subform w="45.682mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1_copy2_copy1_copy1_copy1">
                        <bind match="dataRef" ref="$.sezNumeroModuliGT.rowNumModuliGT[*]"/>
                        <subform name="datiGT" w="45.468mm" h="142.283mm">
                           <bind match="none"/>
                           <border>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <corner thickness="0.176mm">
                                 <color value="192,192,192"/>
                              </corner>
                           </border>
                           <field name="numModulo" w="18.18mm" h="6mm" x="0.628mm" access="protected" y="0.202mm">
                              <ui>
                                 <textEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </textEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1numModulo"/>
                              <traversal>
                                 <traverse ref="portataEffettiva[0]"/>
                              </traversal>
                           </field>
                           <field name="tempFumi" y="20.22mm" x="0.628mm" w="18.321mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1tempFumi"/>
                              <traversal>
                                 <traverse ref="tempCombur[0]"/>
                              </traversal>
                           </field>
                           <field name="portataEffettiva" y="7.481mm" x="0.628mm" w="18.051mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="6"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1portataTermEff"/>
                              <traversal>
                                 <traverse ref="tempFumi[0]"/>
                              </traversal>
                           </field>
                           <field name="bacharach1" y="45.899mm" x="0.416mm" w="12.907mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit>
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="4"/>
                              </value>
                              <border>
                                 <edge presence="hidden"/>
                                 <corner/>
                              </border>
                              <event activity="initialize">
                                 <script contentType="application/x-javascript"/>
                              </event>
                              <traversal>
                                 <traverse ref="txcivico[0]"/>
                              </traversal>
                              <bind match="dataRef" ref="$.L11_1indBacharach1"/>
                           </field>
                           <draw name="txcivico" w="2.224mm" h="6mm" x="13.325mm" y="45.899mm">
                              <value>
                                 <text>/</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <traversal>
                                 <traverse ref="bacharach2[0]"/>
                              </traversal>
                              <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                              <?renderCache.textRun 1 / 0 1790 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="bacharach2" y="45.899mm" x="15.735mm" w="12.728mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit>
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="4"/>
                              </value>
                              <border>
                                 <edge presence="hidden"/>
                                 <corner/>
                              </border>
                              <event activity="initialize">
                                 <script contentType="application/x-javascript"/>
                              </event>
                              <traversal>
                                 <traverse ref="txcivico[1]"/>
                              </traversal>
                              <bind match="dataRef" ref="$.L11_1indBacharach2"/>
                           </field>
                           <field name="bacharach3" y="45.899mm" x="30.72mm" w="12.748mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit>
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="4"/>
                              </value>
                              <border>
                                 <edge presence="hidden"/>
                                 <corner/>
                              </border>
                              <event activity="initialize">
                                 <script contentType="application/x-javascript"/>
                              </event>
                              <traversal>
                                 <traverse ref="COfumiSecchiAria[0]"/>
                              </traversal>
                              <bind match="dataRef" ref="$.L11_1indBacharach3"/>
                           </field>
                           <draw name="txcivico" w="2.022mm" h="6mm" x="28.598mm" y="45.899mm">
                              <value>
                                 <text>/</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <traversal>
                                 <traverse ref="bacharach3[0]"/>
                              </traversal>
                              <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                              <?renderCache.textRun 1 / 0 1504 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="tempCombur" y="25.881mm" x="0.628mm" w="18.321mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1tempAriaComb"/>
                              <traversal>
                                 <traverse ref="o2[0]"/>
                              </traversal>
                           </field>
                           <field name="o2" y="32.554mm" x="0.628mm" w="14.52mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1O2"/>
                              <traversal>
                                 <traverse ref="co2[0]"/>
                              </traversal>
                           </field>
                           <field name="co2" y="38.822mm" x="0.628mm" w="14.52mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1CO2"/>
                              <traversal>
                                 <traverse ref="bacharach1[0]"/>
                              </traversal>
                           </field>
                           <field name="portataCombu" y="61.468mm" x="0.628mm" w="17.915mm" h="6mm" access="protected">
                              <ui>
                                 <textEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </textEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <traversal>
                                 <traverse ref="nox[0]"/>
                              </traversal>
                              <bind match="dataRef" ref="$.L11_1portataCombu"/>
                           </field>
                           <field name="COfumiSecchiAria" y="52.774mm" x="0.628mm" w="17.915mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1CO"/>
                              <traversal>
                                 <traverse ref="portataCombu[0]"/>
                              </traversal>
                           </field>
                           <field name="COfumiSecchi" y="85.935mm" x="0.628mm" w="17.088mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1COsenzaAria"/>
                              <traversal>
                                 <traverse ref="rendimentoCombu[0]"/>
                              </traversal>
                           </field>
                           <field name="rendimentoCombu" y="93.012mm" x="0.628mm" w="14.52mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1rendimentoCombu"/>
                              <traversal>
                                 <traverse ref="flagIndiceBacharachSI[0]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="3.499mm" h="4.09mm" x="14.77mm" y="108.177mm">
                              <value>
                                 <text>NO</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagFumiSI[0]"/>
                              </traversal>
                              <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagIndiceBacharachNO" w="5.577mm" h="4.09mm" x="9.841mm" y="108.177mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_1flagIndBachNO"/>
                              <traversal>
                                 <traverse ref="txcivico[2]"/>
                              </traversal>
                           </field>
                           <field name="flagIndiceBacharachSI" w="5.662mm" h="4.09mm" x="0.809mm" y="108.177mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_1flagIndBachSI"/>
                              <traversal>
                                 <traverse ref="txcivico[3]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="4.784mm" h="4.09mm" x="6.134mm" y="108.177mm">
                              <value>
                                 <text>SI</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagIndiceBacharachNO[0]"/>
                              </traversal>
                              <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <draw name="txcivico" w="3.499mm" h="4.09mm" x="14.917mm" y="115.052mm">
                              <value>
                                 <text>NO</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="percMinimoLegge[0]"/>
                              </traversal>
                              <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagFumiNO" w="5.577mm" h="4.09mm" x="10.043mm" y="115.052mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_1flagfumiSecchiNO"/>
                              <traversal>
                                 <traverse ref="txcivico[4]"/>
                              </traversal>
                           </field>
                           <field name="flagFumiSI" w="5.662mm" h="4.09mm" x="1.011mm" y="115.052mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_1flagfumiSecchiSI"/>
                              <traversal>
                                 <traverse ref="txcivico[5]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="4.784mm" h="4.09mm" x="6.336mm" y="115.052mm">
                              <value>
                                 <text>SI</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagFumiNO[0]"/>
                              </traversal>
                              <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <draw name="txcivico" w="3.499mm" h="4.09mm" x="15.213mm" y="129.206mm">
                              <value>
                                 <text>NO</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="firma[0]"/>
                              </traversal>
                              <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagMinimoNO" w="5.577mm" h="4.09mm" x="10.447mm" y="129.206mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_1flagMinimoNO"/>
                              <traversal>
                                 <traverse ref="txcivico[6]"/>
                              </traversal>
                           </field>
                           <field name="flagMinimoSI" w="5.662mm" h="4.09mm" x="1.415mm" y="129.206mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_1flagMinimoSI"/>
                              <traversal>
                                 <traverse ref="txcivico[7]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="4.784mm" h="4.09mm" x="6.74mm" y="129.206mm">
                              <value>
                                 <text>SI</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagMinimoNO[0]"/>
                              </traversal>
                              <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="firma" w="18.18mm" h="6mm" x="0.473mm" access="protected" y="135.272mm">
                              <ui>
                                 <textEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </textEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1firma"/>
                           </field>
                           <field name="percMinimoLegge" y="121.321mm" x="0.877mm" w="14.52mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_1percMinimoLegge"/>
                              <traversal>
                                 <traverse ref="flagMinimoSI[0]"/>
                              </traversal>
                           </field>
                           <field name="nox" y="69.961mm" x="0.473mm" w="17.915mm" h="6mm" access="protected">
                              <ui>
                                 <textEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </textEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <traversal>
                                 <traverse ref="COfumiSecchi[0]"/>
                              </traversal>
                              <bind match="dataRef" ref="$.L11_1nox"/>
                           </field>
                           <traversal>
                              <traverse operation="first" ref="numModulo[0]"/>
                           </traversal>
                           <?templateDesigner expand 1?></subform>
                        <occur max="-1"/>
                        <breakAfter/>
                        <border>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <keep intact="contentArea"/>
                        <?templateDesigner expand 0?>
                        <traversal>
                           <traverse operation="first" ref="datiGT[0]"/>
                        </traversal>
                     </subform>
                     <occur max="-1"/>
                     <breakAfter targetType="pageArea" startNew="1">
                        <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                     </breakAfter>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="sfRiferimento[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 1?></subform>
         <subform w="200.398mm" name="schedaAltriComp11_2" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiRisultatiGF"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <exData contentType="text/html">
                           <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">11. RISULTATI DELLA PRIMA VERIFICA EFFETTUATA DALL'INSTALLATORE E DELLE<span style="xfa-spacerun:yes">  </span></p><p style="letter-spacing:0in">VERIFICHE<span style="xfa-spacerun:yes"> </span><span style="text-decoration:none">PERIODICHE SUCCESSIVE EFFETTUATE DAL MANUTENTORE</span></p></body>
                        </exData>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                  </draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="200.802mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezMacchineFrigo"/>
               <draw name="tx_4_1" w="195.949mm" minH="6mm">
                  <value>
                     <text>11.2 MACCHINE FRIGO / POMPE DI CALORE</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="row[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="hidden">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                  </field>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="200.6mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.L11_2rowGF[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="hidden">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = "";
	datiGT.modello.rawValue = "";
	datiGT.flagSolaEstraz.rawValue = "0";
	datiGT.flagFlussoIncrociato.rawValue = "0";
	datiGT.flagflussoTermodinamico.rawValue = "0";
	datiGT.flagAltro.rawValue = "0";
	datiGT.descrAltro.rawValue = "";
	datiGT.descrAltro.access = "protected";
	datiGT.maxPortataAria.rawValue = "";
	datiGT.rendimentoRecup.rawValue = "";

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                     </field>
                     <?templateDesigner expand 0?>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.flagSolaEstraz.access = "open";
datiGT.flagFlussoIncrociato.access = "open";
datiGT.flagflussoTermodinamico.access = "open";
datiGT.flagAltro.access = "open";
datiGT.maxPortataAria.access = "open";
datiGT.rendimentoRecup.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";
</script>
                        </event>
                     </field>
                  </subform>
                  <subform w="41.469mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="40.458mm" h="6mm">
                        <value>
                           <text>Gruppo frigo / Pompa di calore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 114684 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 30 Gruppo frigo / Pompa di calore 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="protected">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>GF</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L11_2numGF"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                     </field>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <?templateDesigner expand 0?>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="158.929mm" h="11.121mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="rowDate[0]"/>
                     </traversal>
                     <?renderCache.bounds 450507 31524 0 0 0 0 0 0?></draw>
                  <draw name="Rectangle6" w="197.163mm" h="3.199mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform y="14.32mm" w="200.802mm" minH="179.625mm" layout="lr-tb" name="rowDate">
                     <bind match="dataRef" ref="$.sezDateGF.rowDateGF[*]"/>
                     <draw name="xindir" w="11.543mm" h="6mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="4.252pt"/>
                        <font size="8pt" typeface="Verdana"/>
                        <value>
                           <text>Data</text>
                        </value>
                        <traversal>
                           <traverse ref="data[0]"/>
                        </traversal>
                        <?renderCache.bounds 32720 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 Data 0 4252 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="data" w="20.22mm" h="6mm" access="protected">
                        <ui>
                           <dateTimeEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </dateTimeEdit>
                           <picture>date{DD/MM/YYYY}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <date/>
                        </value>
                        <caption reserve="0.01in">
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L11_2data">
                           <picture>date{YYYY-MM-DD}</picture>
                        </bind>
                        <format>
                           <picture>date{DD/MM/YYYY}</picture>
                        </format>
                        <traversal>
                           <traverse ref="etichette[0]"/>
                        </traversal>
                     </field>
                     <draw name="Rectangle6" w="197.163mm" h="2.088mm">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <draw name="Rectangle6" w="197.163mm" h="1.416mm">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <subform name="etichette" w="43.692mm" h="170.121mm">
                        <bind match="none"/>
                        <draw name="xindir" x="0.018mm" y="0.202mm" w="28.105mm" h="6mm">
                           <value>
                              <text>Numero circuito</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[2]"/>
                           </traversal>
                           <?renderCache.bounds 79668 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 15 Numero circuito 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.335mm" y="20.22mm" w="39.103mm" h="6mm">
                           <value>
                              <text>Surriscaldamento (K)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[4]"/>
                           </traversal>
                           <?renderCache.bounds 110843 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 Surriscaldamento (K) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.018mm" y="7.481mm" w="34.98mm" h="6mm">
                           <value>
                              <text>Assenza perdite refrigerante</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[7]"/>
                           </traversal>
                           <?renderCache.bounds 99156 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 28 Assenza perdite refrigerante 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.183mm" y="71.31mm" w="43.398mm" h="8.492mm">
                           <value>
                              <text>Se usata Torre di raffreddamento o raffreddatore a fluido</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="7pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden"/>
                              <fill>
                                 <color value="221,221,221"/>
                              </fill>
                           </border>
                           <traversal>
                              <traverse ref="ragSocialeImpianto[1]"/>
                           </traversal>
                           <?renderCache.bounds 123018 24072 0 0 0 0 0 0?>
                           <?renderCache.textRun 33 Se usata Torre di raffreddamento  0 2835 9890 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?>
                           <?renderCache.textRun 24 o raffreddatore a fluido 0 2835 18290 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                           <corner/>
                        </border>
                        <draw name="xindir" x="0.026mm" y="25.881mm" w="39.478mm" h="6mm">
                           <value>
                              <text>Sottoraffreddamento (K)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[8]"/>
                           </traversal>
                           <?renderCache.bounds 111906 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 23 Sottoraffreddamento (K) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.027mm" y="93.755mm" w="43.554mm" h="6mm">
                           <value>
                              <text>Se usato Scambiatore di calore intermedio</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="5.669pt"/>
                           <font size="7pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden"/>
                              <fill>
                                 <color value="221,221,221"/>
                              </fill>
                           </border>
                           <traversal>
                              <traverse ref="xindir[19]"/>
                           </traversal>
                           <?renderCache.bounds 123460 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 31 Se usato Scambiatore di calore  0 5669 6358 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?>
                           <?renderCache.textRun 10 intermedio 0 5669 14758 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="162.301mm" w="43.27mm" h="6mm">
                           <value>
                              <text>FIRMA</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt" hAlign="right" marginRight="1.417pt"/>
                           <font size="6pt" typeface="Verdana" weight="bold"/>
                           <traversal>
                              <traverse ref="rowSost[0]"/>
                           </traversal>
                           <?renderCache.bounds 122655 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 5 FIRMA 0 99022 10265 0 0 0 "Verdana" 1 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.018mm" y="13.683mm" w="34.98mm" h="6mm">
                           <value>
                              <text>Modalita' di funzionamento</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="valDataContrattoAl[0]"/>
                           </traversal>
                           <?renderCache.bounds 99156 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 26 Modalita' di funzionamento 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="32.286mm" w="39.478mm" h="6mm">
                           <value>
                              <text>T condensazione (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[9]"/>
                           </traversal>
                           <?renderCache.bounds 111906 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 21 T condensazione (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="38.756mm" w="39.478mm" h="6mm">
                           <value>
                              <text>T evaporazione (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[10]"/>
                           </traversal>
                           <?renderCache.bounds 111906 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 20 T evaporazione (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="45.024mm" w="1.645153in" h="6mm">
                           <value>
                              <text>T sorgente ingresso lato esterno (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[11]"/>
                           </traversal>
                           <?renderCache.bounds 118451 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 38 T sorgente ingresso lato esterno (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="51.697mm" w="1.637208in" h="6mm">
                           <value>
                              <text>T sorgente uscita lato esterno (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="firma2[0]"/>
                           </traversal>
                           <?renderCache.bounds 117879 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 36 T sorgente uscita lato esterno (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="58.37mm" w="1.645153in" h="6mm">
                           <value>
                              <text>T ingresso fluido utenze (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[13]"/>
                           </traversal>
                           <?renderCache.bounds 118451 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 30 T ingresso fluido utenze (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="64.84mm" w="1.645153in" h="6mm">
                           <value>
                              <text>T uscita fluido utenze (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[3]"/>
                           </traversal>
                           <?renderCache.bounds 118451 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 28 T uscita fluido utenze (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <?templateDesigner expand 0?>
                        <draw name="xindir" x="0.22mm" y="80.409mm" w="1.645153in" h="6mm">
                           <value>
                              <text>T uscita fluido (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[15]"/>
                           </traversal>
                           <?renderCache.bounds 118451 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 21 T uscita fluido (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="87.082mm" w="1.645153in" h="6mm">
                           <value>
                              <text>T bulbo umido aria (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[5]"/>
                           </traversal>
                           <?renderCache.bounds 118451 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 24 T bulbo umido aria (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.019mm" y="154.212mm" w="43.554mm" h="6mm">
                           <value>
                              <exData contentType="text/html">
                                 <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">Se<span style="xfa-spacerun:yes"> </span><span style="font-weight:bold">NO</span>, l'efficienza dell'impianto va ripristinata entro la data del<span style="xfa-spacerun:yes"> </span></p></body>
                              </exData>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="0pt" hAlign="right" marginRight="1.417pt"/>
                           <font size="7pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden"/>
                              <fill>
                                 <color value="221,221,221"/>
                              </fill>
                           </border>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </draw>
                        <draw name="xindir" x="0.22mm" y="140.26mm" w="1.645153in" h="6mm">
                           <value>
                              <text>Filtri puliti</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[18]"/>
                           </traversal>
                           <?renderCache.bounds 118451 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 13 Filtri puliti 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="146.73mm" w="1.645153in" h="6mm">
                           <value>
                              <text>Verifica superata</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[16]"/>
                           </traversal>
                           <?renderCache.bounds 118451 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 17 Verifica superata 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="100.832mm" w="43.472mm" h="6mm">
                           <value>
                              <text>T ingresso fluido sorgente esterna (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[20]"/>
                           </traversal>
                           <?renderCache.bounds 123228 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 40 T ingresso fluido sorgente esterna (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="107.505mm" w="42.95mm" h="6mm">
                           <value>
                              <text>T uscita fluido sorgente esterna (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="xindir[21]"/>
                           </traversal>
                           <?renderCache.bounds 121748 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 38 T uscita fluido sorgente esterna (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="114.178mm" w="43.159mm" h="6mm">
                           <value>
                              <text>T ingresso fluido alla macchina (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[22]"/>
                           </traversal>
                           <?renderCache.bounds 122340 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 37 T ingresso fluido alla macchina (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.22mm" y="120.648mm" w="43.159mm" h="6mm">
                           <value>
                              <text>T uscita fluido dalla macchina (°C)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[23]"/>
                           </traversal>
                           <?renderCache.bounds 122340 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 36 T uscita fluido dalla macchina (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="xindir" x="0.018mm" y="127.522mm" w="43.675mm" h="4.585mm">
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="5.669pt"/>
                           <font size="7pt" typeface="Verdana"/>
                           <border>
                              <edge presence="hidden"/>
                              <fill>
                                 <color value="221,221,221"/>
                              </fill>
                           </border>
                           <traversal>
                              <traverse ref="xindir[24]"/>
                           </traversal>
                           <?renderCache.bounds 123803 12997 0 0 0 0 0 0?></draw>
                        <draw name="xindir" x="0.22mm" y="133.386mm" w="1.645153in" h="6mm">
                           <value>
                              <text>Potenza assorbita (kW)</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" marginLeft="2.835pt"/>
                           <font size="6pt" typeface="Verdana"/>
                           <traversal>
                              <traverse ref="xindir[17]"/>
                           </traversal>
                           <?renderCache.bounds 118451 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 22 Potenza assorbita (kW) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <traversal>
                           <traverse operation="first" ref="xindir[0]"/>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                     </subform>
                     <subform w="19.682mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1_copy2_copy1_copy1_copy1_copy1">
                        <bind match="dataRef" ref="$.sezCircuitiGF.rowCircuitiGF[*]"/>
                        <subform name="datiGT" w="20.288mm" h="169.918mm">
                           <bind match="none"/>
                           <border>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <corner thickness="0.176mm">
                                 <color value="192,192,192"/>
                              </corner>
                           </border>
                           <keep intact="none"/>
                           <field name="numCircuito" w="18.18mm" h="6mm" x="0.442mm" access="protected" y="0.202mm">
                              <ui>
                                 <textEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </textEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2numCircuito"/>
                              <traversal>
                                 <traverse ref="flagPerditeSI[0]"/>
                              </traversal>
                           </field>
                           <field name="flagPerditeSI" w="5.644mm" h="4.09mm" x="0.27mm" y="7.415mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_2flagAssenzaPerditeSI"/>
                              <traversal>
                                 <traverse ref="txcivico[0]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="4.784mm" h="4.09mm" x="5.931mm" y="7.415mm">
                              <value>
                                 <text>SI</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagPerditeNO[0]"/>
                              </traversal>
                              <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagPerditeNO" w="5.559mm" h="4.09mm" x="9.572mm" y="7.415mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_2flagAssenzaPerditeNO"/>
                              <traversal>
                                 <traverse ref="txcivico[1]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="3.499mm" h="4.09mm" x="14.636mm" y="7.415mm">
                              <value>
                                 <text>NO</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagRaffr[0]"/>
                              </traversal>
                              <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagRaffr" w="5.662mm" h="4.09mm" x="0.472mm" y="14.29mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_2flagRaffr"/>
                              <traversal>
                                 <traverse ref="txcivico[2]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="4.784mm" h="4.09mm" x="5.527mm" y="14.29mm">
                              <value>
                                 <text>Raff</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagRisc[0]"/>
                              </traversal>
                              <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 4 Raff 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagRisc" w="5.577mm" h="4.09mm" x="9.803mm" y="14.29mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_2flagRisc"/>
                              <traversal>
                                 <traverse ref="txcivico[3]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="4.258mm" h="4.09mm" x="14.783mm" y="14.29mm">
                              <value>
                                 <text>Risc</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="surriscald[0]"/>
                              </traversal>
                              <?renderCache.bounds 12070 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 4 Risc 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="surriscald" y="20.22mm" x="0.442mm" w="18.121mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2surrisc"/>
                              <traversal>
                                 <traverse ref="sottoraffr[0]"/>
                              </traversal>
                           </field>
                           <field name="sottoraffr" y="25.881mm" x="0.442mm" w="18.121mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2sottoraffr"/>
                              <traversal>
                                 <traverse ref="condensazione[0]"/>
                              </traversal>
                           </field>
                           <field name="condensazione" y="32.149mm" x="0.442mm" w="18.121mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2condens"/>
                              <traversal>
                                 <traverse ref="evaporaz[0]"/>
                              </traversal>
                           </field>
                           <field name="evaporaz" y="38.756mm" x="0.442mm" w="18.121mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2evaporaz"/>
                              <traversal>
                                 <traverse ref="sorgenteIngresso[0]"/>
                              </traversal>
                           </field>
                           <field name="sorgenteIngresso" y="45.024mm" x="0.442mm" w="17.915mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2sorgenteIngresso"/>
                              <traversal>
                                 <traverse ref="sorgenteUscita[0]"/>
                              </traversal>
                           </field>
                           <field name="sorgenteUscita" y="51.697mm" x="0.442mm" w="17.915mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2sorgenteUscita"/>
                              <traversal>
                                 <traverse ref="ingressoUtenze[0]"/>
                              </traversal>
                           </field>
                           <field name="ingressoUtenze" y="58.37mm" x="0.442mm" w="18.038mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2ingressoUtenze"/>
                              <traversal>
                                 <traverse ref="uscitaUtenze[0]"/>
                              </traversal>
                           </field>
                           <field name="uscitaUtenze" y="65.043mm" x="0.442mm" w="17.789mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2usciteUtenze"/>
                              <traversal>
                                 <traverse ref="uscitaFluido[0]"/>
                              </traversal>
                           </field>
                           <field name="uscitaFluido" y="80.612mm" x="0.442mm" w="17.789mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2uscitaFluido"/>
                              <traversal>
                                 <traverse ref="bulboUmido[0]"/>
                              </traversal>
                           </field>
                           <field name="bulboUmido" y="87.082mm" x="0.442mm" w="17.789mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2bulboUmido"/>
                              <traversal>
                                 <traverse ref="ingressoFluido[0]"/>
                              </traversal>
                           </field>
                           <field name="ingressoFluido" y="100.832mm" x="0.442mm" w="17.789mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2ingressoFluido"/>
                              <traversal>
                                 <traverse ref="uscitaFluidoSorg[0]"/>
                              </traversal>
                           </field>
                           <field name="uscitaFluidoSorg" y="107.504mm" x="0.442mm" w="17.789mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2uscitaFluidoSorg"/>
                              <traversal>
                                 <traverse ref="ingressoFluidoMacch[0]"/>
                              </traversal>
                           </field>
                           <field name="ingressoFluidoMacch" y="114.379mm" x="0.442mm" w="17.789mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2ingressoFluidoMacc"/>
                              <traversal>
                                 <traverse ref="uscitaFluidoMacch[0]"/>
                              </traversal>
                           </field>
                           <field name="uscitaFluidoMacch" y="120.849mm" x="0.442mm" w="17.789mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2uscitaFluidoMacc"/>
                              <traversal>
                                 <traverse ref="potAssorbita[0]"/>
                              </traversal>
                           </field>
                           <field name="potAssorbita" y="133.183mm" x="0.406mm" w="17.789mm" h="6mm" access="protected">
                              <ui>
                                 <numericEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </numericEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <decimal leadDigits="5"/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2potAssorbita"/>
                              <traversal>
                                 <traverse ref="flagFiltriPulitiSI[0]"/>
                              </traversal>
                           </field>
                           <field name="flagFiltriPulitiSI" w="5.662mm" h="4.09mm" x="1.213mm" y="140.932mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_2flagFiltriSI"/>
                              <traversal>
                                 <traverse ref="txcivico[4]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="4.784mm" h="4.09mm" x="6.538mm" y="140.932mm">
                              <value>
                                 <text>SI</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagFiltriPulitiNO[0]"/>
                              </traversal>
                              <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagFiltriPulitiNO" w="5.577mm" h="4.09mm" x="10.245mm" y="140.932mm" access="protected">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_2flagFiltriNO"/>
                              <traversal>
                                 <traverse ref="txcivico[5]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="3.499mm" h="4.09mm" x="15.065mm" y="140.932mm">
                              <value>
                                 <text>NO</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagVerificaSupSI[0]"/>
                              </traversal>
                              <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagVerificaSupSI" w="5.662mm" h="4.09mm" access="protected" y="147.807mm" x="1.415mm">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_2flagVerificaSI"/>
                              <traversal>
                                 <traverse ref="txcivico[7]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="3.499mm" h="4.09mm" y="147.807mm" x="15.213mm">
                              <value>
                                 <text>NO</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="dataRipristino[0]"/>
                              </traversal>
                              <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="flagVerificaSupNO" w="5.577mm" h="4.09mm" access="protected" y="147.807mm" x="10.447mm">
                              <ui>
                                 <checkButton mark="circle" size="3.175mm" shape="round">
                                    <border>
                                       <edge stroke="lowered"/>
                                       <fill>
                                          <color value="255, 255, 255"/>
                                       </fill>
                                       <?templateDesigner StyleID apcb4?></border>
                                 </checkButton>
                              </ui>
                              <font typeface="Myriad Pro"/>
                              <margin leftInset="1mm" rightInset="1mm"/>
                              <para vAlign="middle"/>
                              <value>
                                 <text>0</text>
                              </value>
                              <items>
                                 <text>1</text>
                                 <text>0</text>
                              </items>
                              <bind match="dataRef" ref="$.L11_2flagVerificaNO"/>
                              <traversal>
                                 <traverse ref="txcivico[6]"/>
                              </traversal>
                           </field>
                           <draw name="txcivico" w="4.784mm" h="4.09mm" y="147.807mm" x="6.74mm">
                              <value>
                                 <text>SI</text>
                              </value>
                              <ui>
                                 <textEdit/>
                              </ui>
                              <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                              <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                              <margin leftInset="0mm"/>
                              <traversal>
                                 <traverse ref="flagVerificaSupNO[0]"/>
                              </traversal>
                              <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                              <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                           <field name="dataRipristino" w="19.007mm" h="6mm" access="protected" x="0.203mm" y="154.212mm">
                              <ui>
                                 <dateTimeEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </dateTimeEdit>
                                 <picture>date{DD/MM/YYYY}</picture>
                              </ui>
                              <font typeface="Verdana" size="8pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle" hAlign="center"/>
                              <value>
                                 <date/>
                              </value>
                              <caption reserve="0.01in">
                                 <para vAlign="middle" hAlign="center"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                                 <corner/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2dataRispristino">
                                 <picture>date{YYYY-MM-DD}</picture>
                              </bind>
                              <format>
                                 <picture>date{DD/MM/YYYY}</picture>
                              </format>
                              <traversal>
                                 <traverse ref="firma[0]"/>
                              </traversal>
                           </field>
                           <field name="firma" w="18.804mm" h="6mm" x="0.473mm" access="protected" y="162.098mm">
                              <ui>
                                 <textEdit hScrollPolicy="off">
                                    <border>
                                       <edge presence="hidden"/>
                                       <edge presence="hidden"/>
                                       <edge stroke="dotted">
                                          <color value="192,192,192"/>
                                       </edge>
                                       <edge presence="hidden"/>
                                       <corner/>
                                       <corner/>
                                       <corner stroke="dotted">
                                          <color value="192,192,192"/>
                                       </corner>
                                       <corner/>
                                    </border>
                                    <margin/>
                                 </textEdit>
                              </ui>
                              <font typeface="Verdana" size="6pt"/>
                              <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                              <para vAlign="middle"/>
                              <caption reserve="0.01in">
                                 <para vAlign="middle"/>
                              </caption>
                              <border>
                                 <edge presence="hidden"/>
                              </border>
                              <bind match="dataRef" ref="$.L11_2firma"/>
                           </field>
                           <?templateDesigner expand 0?>
                           <traversal>
                              <traverse operation="first" ref="numCircuito[0]"/>
                           </traversal>
                        </subform>
                        <occur max="-1"/>
                        <breakAfter/>
                        <border>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <?templateDesigner expand 1?>
                        <traversal>
                           <traverse operation="first" ref="datiGT[0]"/>
                        </traversal>
                     </subform>
                     <occur max="-1"/>
                     <breakAfter targetType="pageArea" startNew="1">
                        <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                     </breakAfter>
                     <?templateDesigner expand 1?>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <?templateDesigner expand 1?>
                  <traversal>
                     <traverse operation="first" ref="sf[0]"/>
                  </traversal>
               </subform>
               <?templateDesigner expand 1?>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
            </subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="200.398mm" name="schedaAltriComp11_3" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiRisultatiSC"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <exData contentType="text/html">
                           <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">11. RISULTATI DELLA PRIMA VERIFICA EFFETTUATA DALL'INSTALLATORE E DELLE<span style="xfa-spacerun:yes">  </span></p><p style="letter-spacing:0in">VERIFICHE<span style="xfa-spacerun:yes"> </span><span style="text-decoration:none">PERIODICHE SUCCESSIVE EFFETTUATE DAL MANUTENTORE</span></p></body>
                        </exData>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                  </draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="200.802mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezScambiatori"/>
               <draw name="tx_4_1" w="195.949mm" minH="6mm">
                  <value>
                     <text>11.3 SCAMBIATORI DI CALORE DELLA SOTTOSTAZIONE DI TELERISCALDAMENTO / TELEFAFFRESCAMENTO</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="row[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="hidden">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                  </field>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="200.6mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.L11_3rowSC[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="hidden">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = "";
	datiGT.modello.rawValue = "";
	datiGT.flagSolaEstraz.rawValue = "0";
	datiGT.flagFlussoIncrociato.rawValue = "0";
	datiGT.flagflussoTermodinamico.rawValue = "0";
	datiGT.flagAltro.rawValue = "0";
	datiGT.descrAltro.rawValue = "";
	datiGT.descrAltro.access = "protected";
	datiGT.maxPortataAria.rawValue = "";
	datiGT.rendimentoRecup.rawValue = "";

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                     </field>
                     <?templateDesigner expand 0?>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.flagSolaEstraz.access = "open";
datiGT.flagFlussoIncrociato.access = "open";
datiGT.flagflussoTermodinamico.access = "open";
datiGT.flagAltro.access = "open";
datiGT.maxPortataAria.access = "open";
datiGT.rendimentoRecup.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";
</script>
                        </event>
                     </field>
                  </subform>
                  <subform w="35.2mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="24.281mm" h="6mm">
                        <value>
                           <text>Scambiatore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 68828 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 11 Scambiatore 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="protected">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>SC</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L11_3numSC"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                     </field>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <?templateDesigner expand 0?>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="165.198mm" h="11.121mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="etichette[0]"/>
                     </traversal>
                     <?renderCache.bounds 468278 31524 0 0 0 0 0 0?></draw>
                  <draw name="Rectangle6" w="197.163mm" h="3.199mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <draw name="Rectangle6" w="197.163mm" h="1.416mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform name="etichette" w="45.542mm" h="107.245mm">
                     <bind match="none"/>
                     <draw name="xindir" x="0.014mm" y="0.202mm" w="45.164mm" h="6mm">
                        <value>
                           <text>DATA</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" hAlign="right"/>
                        <font size="6pt" typeface="Verdana" weight="bold"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                        <?renderCache.bounds 128024 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 DATA 0 109637 10265 0 0 0 "Verdana" 1 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.358mm" y="14.492mm" w="44.82mm" h="6mm">
                        <value>
                           <text>Temperatura esterna (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[7]"/>
                        </traversal>
                        <?renderCache.bounds 127049 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 25 Temperatura esterna (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.233mm" y="7.011mm" w="44.818mm" h="6mm">
                        <value>
                           <text>VALORI MISURATI</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <border>
                           <edge presence="hidden"/>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                        </border>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                        <?renderCache.bounds 127043 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 15 VALORI MISURATI 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.185mm" y="65.043mm" w="44.818mm" h="6mm">
                        <value>
                           <text>ALTRE VERIFICHE EFFETTUATE</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <border>
                           <edge presence="hidden"/>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                        </border>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                        <?renderCache.bounds 127043 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 26 ALTRE VERIFICHE EFFETTUATE 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <draw name="xindir" x="0.233mm" y="72.863mm" w="45.288mm" h="6mm">
                        <value>
                           <text>Potenza compatibile con i dati di progetto</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                        <?renderCache.bounds 128375 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 42 Potenza compatibile con i dati di progetto 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.233mm" y="80.345mm" w="41.436mm" h="6mm">
                        <value>
                           <text>Stato dellle coibentazioni idoneo</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[13]"/>
                        </traversal>
                        <?renderCache.bounds 117456 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 33 Stato dellle coibentazioni idoneo 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="98.002mm" w="44.888mm" h="6mm">
                        <value>
                           <text>FIRMA</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" hAlign="right"/>
                        <font size="6pt" typeface="Verdana" weight="bold"/>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                        <?renderCache.bounds 127242 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 FIRMA 0 105026 10265 0 0 0 "Verdana" 1 0 6000 ISO-8859-1?></draw>
                     <?templateDesigner expand 0?>
                     <draw name="xindir" x="0.233mm" y="21.772mm" w="44.82mm" h="6mm">
                        <value>
                           <text>Temperatura mandata primario (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[8]"/>
                        </traversal>
                        <?renderCache.bounds 127049 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 34 Temperatura mandata primario (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.233mm" y="28.646mm" w="44.945mm" h="6mm">
                        <value>
                           <text>Temperatura ritorno primario (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[9]"/>
                        </traversal>
                        <?renderCache.bounds 127403 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 34 Temperatura ritorno primario (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.233mm" y="35.724mm" w="45.309mm" h="6mm">
                        <value>
                           <text>Temperatura mandata secondario (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[10]"/>
                        </traversal>
                        <?renderCache.bounds 128435 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 36 Temperatura mandata secondario (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="42.598mm" w="45.309mm" h="6mm">
                        <value>
                           <text>Temperatura ritorno secondario (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[11]"/>
                        </traversal>
                        <?renderCache.bounds 128435 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 36 Temperatura ritorno secondario (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="49.675mm" w="45.309mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Portata fluido primario<span style="xfa-spacerun:yes"> </span>(m<span style="vertical-align:3.41pt">3</span>/ h)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="firma2[0]"/>
                        </traversal>
                     </draw>
                     <draw name="xindir" x="0.22mm" y="56.752mm" w="45.309mm" h="6mm">
                        <value>
                           <text>Potenza termica nominale totale (kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                        <?renderCache.bounds 128435 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 36 Potenza termica nominale totale (kW) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="87.891mm" w="1.784319in" h="7.197mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Dispositivi di regolazione e controllo</p><p style="letter-spacing:0in">(<span style="font-style:italic">assenza di trafilamenti sulla valvola di regolazione</span>)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                     </draw>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                  </subform>
                  <subform w="25.343mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1_copy2_copy1_copy1_copy1_copy2">
                     <bind match="dataRef" ref="$.sezSC.rowDateSC[*]"/>
                     <subform name="datiGT" w="25.788mm" h="107.296mm">
                        <bind match="none"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <keep intact="none"/>
                        <field name="tempEsterna" y="14.695mm" x="0.628mm" w="18.321mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3tempEsterna"/>
                           <traversal>
                              <traverse ref="tempMandPrima[0]"/>
                           </traversal>
                        </field>
                        <field name="tempMandPrima" y="21.974mm" x="0.628mm" w="18.321mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3tempMandPrimario"/>
                           <traversal>
                              <traverse ref="tempRitPrima[0]"/>
                           </traversal>
                        </field>
                        <field name="tempRitPrima" y="28.849mm" x="0.617mm" w="18.47mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3tempRitPrimario"/>
                           <traversal>
                              <traverse ref="tempMandSecond[0]"/>
                           </traversal>
                        </field>
                        <field name="tempMandSecond" y="35.724mm" x="0.617mm" w="18.47mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3tempMandSecond"/>
                           <traversal>
                              <traverse ref="tempRitSecond[0]"/>
                           </traversal>
                        </field>
                        <field name="portataFluido" y="49.877mm" x="0.626mm" w="18.71mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3portataFluidoPrim"/>
                           <traversal>
                              <traverse ref="portataTermica[0]"/>
                           </traversal>
                        </field>
                        <field name="tempRitSecond" y="42.801mm" x="0.626mm" w="18.71mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3tempRitSecond"/>
                           <traversal>
                              <traverse ref="portataFluido[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="3.499mm" h="4.09mm" x="14.095mm" y="74.076mm">
                           <value>
                              <text>NO</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagCompatibNC[0]"/>
                           </traversal>
                           <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <field name="flagCompatibNO" w="5.577mm" h="4.09mm" x="8.636mm" y="74.076mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagPotCompatibNO"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <field name="flagCompatibSI" w="5.662mm" h="4.09mm" x="0.577mm" y="74.076mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagPotCompatibSI"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="4.784mm" h="4.09mm" x="5.603mm" y="74.076mm">
                           <value>
                              <text>SI</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagCompatibNO[0]"/>
                           </traversal>
                           <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <field name="firma" w="23.56mm" h="6mm" x="0.473mm" access="protected" y="97.799mm">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3firma"/>
                        </field>
                        <field name="data" w="19.007mm" h="6mm" access="protected" x="0.473mm" y="0.338mm">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                              <picture>date{DD/MM/YYYY}</picture>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3data">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="tempEsterna[0]"/>
                           </traversal>
                        </field>
                        <field name="portataTermica" y="56.55mm" x="0.626mm" w="18.71mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_3potTermica"/>
                           <traversal>
                              <traverse ref="flagCompatibSI[0]"/>
                           </traversal>
                        </field>
                        <field name="flagCompatibNC" w="5.577mm" h="4.09mm" x="16.724mm" y="74.141mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagPotCompatibNC"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="3.499mm" h="4.09mm" x="21.577mm" y="74.141mm">
                           <value>
                              <text>NC</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagStatoCoibSI[0]"/>
                           </traversal>
                           <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 NC 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <draw name="txcivico" w="3.499mm" h="4.09mm" x="21.577mm" y="81.081mm">
                           <value>
                              <text>NC</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagRegolazSI[0]"/>
                           </traversal>
                           <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 NC 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <field name="flagStatoCoibNC" w="5.577mm" h="4.09mm" x="16.724mm" y="81.081mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagStatoCoibNC"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="3.499mm" h="4.09mm" x="14.095mm" y="81.016mm">
                           <value>
                              <text>NO</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagStatoCoibNC[0]"/>
                           </traversal>
                           <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <field name="flagStatoCoibNO" w="5.577mm" h="4.09mm" x="8.636mm" y="81.016mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagStatoCoibNO"/>
                           <traversal>
                              <traverse ref="txcivico[4]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="4.784mm" h="4.09mm" x="5.603mm" y="81.016mm">
                           <value>
                              <text>SI</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagStatoCoibNO[0]"/>
                           </traversal>
                           <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <field name="flagStatoCoibSI" w="5.662mm" h="4.09mm" x="0.577mm" y="81.016mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagStatoCoibSI"/>
                           <traversal>
                              <traverse ref="txcivico[5]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="3.499mm" h="4.09mm" x="21.779mm" y="88.765mm">
                           <value>
                              <text>NC</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="firma[0]"/>
                           </traversal>
                           <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 NC 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <field name="flagRegolazNC" w="5.577mm" h="4.09mm" x="16.926mm" y="88.765mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagDispRegNC"/>
                           <traversal>
                              <traverse ref="txcivico[6]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="3.499mm" h="4.09mm" x="14.297mm" y="88.7mm">
                           <value>
                              <text>NO</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagRegolazNC[0]"/>
                           </traversal>
                           <?renderCache.bounds 9918 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 NO 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <field name="flagRegolazNO" w="5.577mm" h="4.09mm" x="8.838mm" y="88.7mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagDispRegNO"/>
                           <traversal>
                              <traverse ref="txcivico[7]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="4.784mm" h="4.09mm" x="5.805mm" y="88.7mm">
                           <value>
                              <text>SI</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                           <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                           <margin leftInset="0mm"/>
                           <traversal>
                              <traverse ref="flagRegolazNO[0]"/>
                           </traversal>
                           <?renderCache.bounds 13561 11594 0 0 0 0 0 0?>
                           <?renderCache.textRun 2 SI 0 0 7558 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                        <field name="flagRegolazSI" w="5.662mm" h="4.09mm" x="0.779mm" y="88.7mm" access="protected">
                           <ui>
                              <checkButton mark="circle" size="3.175mm" shape="round">
                                 <border>
                                    <edge stroke="lowered"/>
                                    <fill>
                                       <color value="255, 255, 255"/>
                                    </fill>
                                    <?templateDesigner StyleID apcb4?></border>
                              </checkButton>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <margin leftInset="1mm" rightInset="1mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <text>0</text>
                           </value>
                           <items>
                              <text>1</text>
                              <text>0</text>
                           </items>
                           <bind match="dataRef" ref="$.L11_3flagDispRegSI"/>
                           <traversal>
                              <traverse ref="txcivico[8]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="data[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <draw name="xindir" w="1.026889in" h="117.282mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="8.504pt" hAlign="right"/>
                        <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                        <?renderCache.bounds 73936 332453 0 0 0 0 0 0?></draw>
                     <occur max="-1"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse operation="first" ref="datiGT[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="sf[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="200.398mm" name="schedaAltriComp11_4" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiRisultatiCG"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <exData contentType="text/html">
                           <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">11. RISULTATI DELLA PRIMA VERIFICA EFFETTUATA DALL'INSTALLATORE E DELLE<span style="xfa-spacerun:yes">  </span></p><p style="letter-spacing:0in">VERIFICHE<span style="xfa-spacerun:yes"> </span><span style="text-decoration:none">PERIODICHE SUCCESSIVE EFFETTUATE DAL MANUTENTORE</span></p></body>
                        </exData>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                  </draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="200.802mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezCogen"/>
               <draw name="tx_4_1" w="195.949mm" minH="6mm">
                  <value>
                     <text>11.4 COGENERATORI / TRIGENERATORI</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle"/>
                  <font weight="bold" size="8pt" typeface="Verdana"/>
                  <margin leftInset="0.5mm"/>
                  <traversal>
                     <traverse ref="row[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle6" w="197.163mm" h="3.907mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="197.181mm" name="button" h="5.56mm" presence="hidden">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                  </draw>
                  <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.datiGT.dataInstallaz.rawValue != null &amp;&amp; row.datiGT.fabbricante.rawValue != null &amp;&amp; row.datiGT.matricola.rawValue != null &amp;&amp; row.datiGT.modello.rawValue !=null){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                  </field>
                  <?templateDesigner expand 0?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.124mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform y="6mm" w="200.6mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.L11_4rowCG[*]"/>
                  <subform w="5.015mm" name="button" h="11.425mm" presence="hidden">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	datiGT.dataInstallaz.rawValue = null;
	datiGT.dataDismiss.rawValue = null;
	datiGT.fabbricante.rawValue = "";
	datiGT.modello.rawValue = "";
	datiGT.flagSolaEstraz.rawValue = "0";
	datiGT.flagFlussoIncrociato.rawValue = "0";
	datiGT.flagflussoTermodinamico.rawValue = "0";
	datiGT.flagAltro.rawValue = "0";
	datiGT.descrAltro.rawValue = "";
	datiGT.descrAltro.access = "protected";
	datiGT.maxPortataAria.rawValue = "";
	datiGT.rendimentoRecup.rawValue = "";

	datiGT.flagSost.rawValue = "0";
	datiGT.flagDismiss.rawValue = "0";	
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                     </field>
                     <?templateDesigner expand 0?>
                     <draw name="annullaDismiss" w="4.535mm" h="4.535mm" x="0.422mm" y="6.875mm" presence="invisible">
                        <value>
                           <image href="..\resources\images.jpg" contentType="image/jpg"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Annulla Dismissione componente</toolTip>
                        </assist>
                     </draw>
                     <field name="btAnnullaDismiss" w="4.535mm" h="4.552mm" x="0.422mm" y="6.672mm" presence="invisible">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <assist>
                           <toolTip>Annulla Dismissione componente.</toolTip>
                        </assist>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
datiGT.flagDismiss.rawValue = "0";

datiGT.dataInstallaz.access = "open";
datiGT.dataDismiss.access = "open";
datiGT.fabbricante.access = "open";
datiGT.modello.access = "open";
datiGT.flagSolaEstraz.access = "open";
datiGT.flagFlussoIncrociato.access = "open";
datiGT.flagflussoTermodinamico.access = "open";
datiGT.flagAltro.access = "open";
datiGT.maxPortataAria.access = "open";
datiGT.rendimentoRecup.access = "open";


datiGT.sostComp.access = "open";
datiGT.dismissComp.access = "open";
button.btCancella.access = "open";
this.presence = "hidden";
annullaDismiss.presence  = "hidden";
</script>
                        </event>
                     </field>
                  </subform>
                  <subform w="38.638mm" minH="11mm" layout="lr-tb" name="sf">
                     <bind match="none"/>
                     <draw name="txflag1" w="37.829mm" h="6mm">
                        <value>
                           <text>Cogeneratore / Trigeneratore</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="num[0]"/>
                        </traversal>
                        <?renderCache.bounds 107232 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 28 Cogeneratore / Trigeneratore 0 2835 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                     <field name="num" h="5mm" w="23.513mm" access="protected">
                        <border>
                           <edge presence="hidden"/>
                        </border>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <para vAlign="middle"/>
                        <ui>
                           <textEdit>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                           </textEdit>
                        </ui>
                        <caption reserve="6.35mm">
                           <value>
                              <text>CG</text>
                           </value>
                           <font typeface="Verdana" size="8pt" baselineShift="0pt"/>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2.835pt" marginRight="0pt"/>
                        </caption>
                        <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                        <bind match="dataRef" ref="$.L11_4numCG"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                     </field>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <?templateDesigner expand 0?>
                     <traversal>
                        <traverse operation="first" ref="txflag1[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </subform>
                  <draw name="txflag1" w="161.76mm" h="11.121mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="5.669pt"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="etichette[0]"/>
                     </traversal>
                     <?renderCache.bounds 458532 31524 0 0 0 0 0 0?></draw>
                  <draw name="Rectangle6" w="197.163mm" h="3.199mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <draw name="Rectangle6" w="197.163mm" h="1.416mm">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <subform name="etichette" w="51.579mm" h="137.365mm">
                     <bind match="none"/>
                     <draw name="xindir" x="0.014mm" y="0.202mm" w="45.164mm" h="6mm">
                        <value>
                           <text>DATA</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" hAlign="right"/>
                        <font size="6pt" typeface="Verdana" weight="bold"/>
                        <traversal>
                           <traverse ref="valDataContrattoAl[0]"/>
                        </traversal>
                        <?renderCache.bounds 128024 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 4 DATA 0 109637 10265 0 0 0 "Verdana" 1 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.358mm" y="7.416mm" w="44.82mm" h="6mm">
                        <value>
                           <text>Temperatura aria comburente (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <?renderCache.bounds 127049 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 33 Temperatura aria comburente (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.185mm" y="65.043mm" w="50.989mm" h="8.396mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Protezione di interfaccia con la rete elettrica, verifica per ciascuna fase.<span style="xfa-spacerun:yes"> </span></p><p style="text-decoration:none;letter-spacing:0in">L1/L2/L3</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="7pt" typeface="Verdana"/>
                        <border>
                           <edge presence="hidden"/>
                           <fill>
                              <color value="221,221,221"/>
                           </fill>
                        </border>
                        <traversal>
                           <traverse ref="xindir[3]"/>
                        </traversal>
                     </draw>
                     <border>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <draw name="xindir" x="0.233mm" y="74.344mm" w="51.144mm" h="6mm">
                        <value>
                           <text>Sovrafrequenza: soglia di intervento (Hz)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[4]"/>
                        </traversal>
                        <?renderCache.bounds 144975 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 41 Sovrafrequenza: soglia di intervento (Hz) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.233mm" y="81.016mm" w="51.346mm" h="6mm">
                        <value>
                           <text>Sovrafrequenza: tempo di intervento (s)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[13]"/>
                        </traversal>
                        <?renderCache.bounds 145548 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 39 Sovrafrequenza: tempo di intervento (s) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <?templateDesigner expand 0?>
                     <draw name="xindir" w="50.752mm" h="6mm" y="129.342mm" x="0.22mm">
                        <value>
                           <text>FIRMA</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" hAlign="right"/>
                        <font size="6pt" typeface="Verdana" weight="bold"/>
                        <traversal>
                           <traverse ref="rowSost[0]"/>
                        </traversal>
                        <?renderCache.bounds 143864 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 5 FIRMA 0 121648 10265 0 0 0 "Verdana" 1 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.233mm" y="14.696mm" w="44.82mm" h="6mm">
                        <value>
                           <text>Temperatura acqua in uscita (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[7]"/>
                        </traversal>
                        <?renderCache.bounds 127049 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 33 Temperatura acqua in uscita (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.233mm" y="21.57mm" w="44.945mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Temperatura acqua in ingresso<span style="text-decoration:none"> (°C)</span></p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[8]"/>
                        </traversal>
                     </draw>
                     <draw name="xindir" x="0.233mm" y="28.648mm" w="50.537mm" h="6mm">
                        <value>
                           <text>Temperatura acqua motore [solo m.c.i.] (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[9]"/>
                        </traversal>
                        <?renderCache.bounds 143254 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 44 Temperatura acqua motore [solo m.c.i.] (°C) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="35.522mm" w="50.752mm" h="6mm">
                        <value>
                           <text>Temperatura fumi a valle dello scambiatore fumi (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[10]"/>
                        </traversal>
                        <?renderCache.bounds 143864 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 43 Temperatura fumi a valle dello scambiatore  0 2835 6665 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?>
                        <?renderCache.textRun 10 fumi (°C) 0 2835 13865 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="42.599mm" w="1.784319in" h="6mm">
                        <value>
                           <text>Temperatura fumi a monte dello scambiatore fumi (°C)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[11]"/>
                        </traversal>
                        <?renderCache.bounds 128471 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 31 Temperatura fumi a monte dello  0 2835 6665 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?>
                        <?renderCache.textRun 22 scambiatore fumi (°C) 0 2835 13865 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="49.676mm" w="45.309mm" h="6mm">
                        <value>
                           <text>Potenza elettrica ai morsetti (kW)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="txcivico[0]"/>
                        </traversal>
                        <?renderCache.bounds 128435 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 34 Potenza elettrica ai morsetti (kW) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="txcivico" w="45.322mm" h="6mm" x="0.018mm" y="56.55mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="letter-spacing:0in">Emissioni di monossido di carbonio CO</p><p style="letter-spacing:0in">(mg/Nm<span style="vertical-align:2.17pt">3<span style="xfa-spacerun:yes"> </span></span>riportati al 5% di O<span style="vertical-align:-1.05pt">2<span style="xfa-spacerun:yes"> </span></span>nei fumi)</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[2]"/>
                        </traversal>
                     </draw>
                     <draw name="xindir" x="0.22mm" y="94.563mm" w="51.346mm" h="6mm">
                        <value>
                           <text>Sottofrequenza: tempo di intervento (s)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[15]"/>
                        </traversal>
                        <?renderCache.bounds 145548 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 39 Sottofrequenza: tempo di intervento (s) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="87.891mm" w="51.144mm" h="6mm">
                        <value>
                           <text>Sottofrequenza: soglia di intervento (Hz)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="firma2[0]"/>
                        </traversal>
                        <?renderCache.bounds 144975 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 41 Sottofrequenza: soglia di intervento (Hz) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="107.908mm" w="51.346mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Sovratensione<span style="text-decoration:none">: tempo di intervento (s)</span></p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[17]"/>
                        </traversal>
                     </draw>
                     <draw name="xindir" x="0.22mm" y="101.236mm" w="51.144mm" h="6mm">
                        <value>
                           <text>Sovratensione: soglia di intervento (V)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="ragSocialeImpianto[1]"/>
                        </traversal>
                        <?renderCache.bounds 144975 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 39 Sovratensione: soglia di intervento (V) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="121.455mm" w="51.346mm" h="6mm">
                        <value>
                           <text>Sottotensione: tempo di intervento (s)</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                        <font size="6pt" typeface="Verdana" baselineShift="0pt"/>
                        <traversal>
                           <traverse ref="xindir[5]"/>
                        </traversal>
                        <?renderCache.bounds 145548 17008 0 0 0 0 0 0?>
                        <?renderCache.textRun 38 Sottotensione: tempo di intervento (s) 0 2835 10265 0 0 0 "Verdana" 0 0 6000 ISO-8859-1?></draw>
                     <draw name="xindir" x="0.22mm" y="114.783mm" w="51.144mm" h="6mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Sottotensione<span style="text-decoration:none">: soglia di intervento (V)</span></p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt"/>
                        <font size="6pt" typeface="Verdana"/>
                        <traversal>
                           <traverse ref="xindir[16]"/>
                        </traversal>
                     </draw>
                     <traversal>
                        <traverse operation="first" ref="xindir[0]"/>
                        <traverse ref="rowSost[0]"/>
                     </traversal>
                  </subform>
                  <subform w="26.083mm" layout="lr-tb" name="rowSost" id="rowSostGT_ID_copy1_copy1_copy1_copy1_copy1_copy2_copy1_copy1_copy1_copy2_copy1">
                     <bind match="dataRef" ref="$.sezCG.rowDateCG[*]"/>
                     <subform name="datiGT" w="25.788mm" h="137.162mm">
                        <bind match="none"/>
                        <border>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <keep intact="none"/>
                        <field name="data" w="19.007mm" h="6mm" access="protected" x="0.474mm" y="0.338mm">
                           <ui>
                              <dateTimeEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </dateTimeEdit>
                              <picture>date{DD/MM/YYYY}</picture>
                           </ui>
                           <font typeface="Verdana" size="8pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <date/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                              <corner/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4data">
                              <picture>date{YYYY-MM-DD}</picture>
                           </bind>
                           <format>
                              <picture>date{DD/MM/YYYY}</picture>
                           </format>
                           <traversal>
                              <traverse ref="tempEsterna[0]"/>
                           </traversal>
                        </field>
                        <field name="tempEsterna" y="7.619mm" x="0.629mm" w="18.321mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4tempAriaComb"/>
                           <traversal>
                              <traverse ref="tempMandPrima[0]"/>
                           </traversal>
                        </field>
                        <field name="tempMandPrima" y="14.898mm" x="0.629mm" w="18.321mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4tempH2Ouscita"/>
                           <traversal>
                              <traverse ref="tempRitPrima[0]"/>
                           </traversal>
                        </field>
                        <field name="tempRitPrima" y="21.773mm" x="0.618mm" w="18.47mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4tempH2Oingresso"/>
                           <traversal>
                              <traverse ref="tempMandSecond[0]"/>
                           </traversal>
                        </field>
                        <field name="tempMandSecond" y="28.648mm" x="0.618mm" w="18.47mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4tempH2Omotore"/>
                           <traversal>
                              <traverse ref="tempRitSecond[0]"/>
                           </traversal>
                        </field>
                        <field name="tempRitSecond" y="35.725mm" x="0.627mm" w="18.71mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4tempFumiValle"/>
                           <traversal>
                              <traverse ref="portataFluido[0]"/>
                           </traversal>
                        </field>
                        <field name="portataFluido" y="42.801mm" x="0.627mm" w="18.71mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4tempFumiMonte"/>
                           <traversal>
                              <traverse ref="portataTermica[0]"/>
                           </traversal>
                        </field>
                        <field name="firma" w="24.8mm" h="6mm" access="protected" y="129.139mm" x="0.474mm">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4firma"/>
                        </field>
                        <field name="portataTermica" y="49.474mm" x="0.627mm" w="18.71mm" h="6mm" access="protected">
                           <ui>
                              <numericEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </numericEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <value>
                              <decimal leadDigits="5"/>
                           </value>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <bind match="dataRef" ref="$.L11_4potElettricaMorsetti"/>
                           <traversal>
                              <traverse ref="emissioni[0]"/>
                           </traversal>
                        </field>
                        <field name="emissioni" y="56.752mm" x="0.627mm" w="18.71mm" h="6mm" access="protected">
                           <ui>
                              <textEdit hScrollPolicy="off">
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                                 <margin/>
                              </textEdit>
                           </ui>
                           <font typeface="Verdana" size="6pt"/>
                           <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                           <para vAlign="middle"/>
                           <caption reserve="0.01in">
                              <para vAlign="middle"/>
                           </caption>
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <traversal>
                              <traverse ref="sovraFreqSoglia1[0]"/>
                           </traversal>
                           <bind match="dataRef" ref="$.L11_4emissioniCO"/>
                        </field>
                        <field name="sovraFreqSoglia1" h="6mm" w="7.077mm" access="protected" x="0.203mm" y="74.546mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraFreqSoglia1"/>
                           <traversal>
                              <traverse ref="txcivico[0]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.224mm" h="6mm" x="7.28mm" y="74.546mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia2[0]"/>
                           </traversal>
                           <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1563 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia2" h="6mm" w="7.077mm" access="protected" x="9.504mm" y="74.546mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraFreqSoglia2"/>
                           <traversal>
                              <traverse ref="txcivico[1]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.022mm" h="6mm" x="16.581mm" y="74.546mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia3[0]"/>
                           </traversal>
                           <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1277 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia3" h="6mm" w="7.118mm" access="protected" x="18.603mm" y="74.546mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraFreqSoglia3"/>
                           <traversal>
                              <traverse ref="sovraFreqTempo1[0]"/>
                           </traversal>
                        </field>
                        <field name="sovraFreqTempo1" h="6mm" w="7.077mm" access="protected" x="0.203mm" y="81.016mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraFreqTempo1"/>
                           <traversal>
                              <traverse ref="txcivico[2]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.224mm" h="6mm" x="7.28mm" y="81.016mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqTempo2[0]"/>
                           </traversal>
                           <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1563 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqTempo2" h="6mm" w="7.077mm" access="protected" x="9.504mm" y="81.016mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraFreqTempo2"/>
                           <traversal>
                              <traverse ref="txcivico[3]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.022mm" h="6mm" x="16.581mm" y="81.016mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqTempo3[0]"/>
                           </traversal>
                           <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1277 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqTempo3" h="6mm" w="7.118mm" access="protected" x="18.603mm" y="81.016mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraFreqTempo3"/>
                           <traversal>
                              <traverse ref="sottoFreqSoglia1[0]"/>
                           </traversal>
                        </field>
                        <field name="sottoFreqSoglia1" h="6mm" w="7.077mm" access="protected" x="0.203mm" y="88.093mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoFreqSoglia1"/>
                           <traversal>
                              <traverse ref="txcivico[4]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.224mm" h="6mm" x="7.28mm" y="88.093mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sottoFreqSoglia2[0]"/>
                           </traversal>
                           <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1563 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sottoFreqSoglia2" h="6mm" w="7.077mm" access="protected" x="9.504mm" y="88.093mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoFreqSoglia2"/>
                           <traversal>
                              <traverse ref="txcivico[5]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.022mm" h="6mm" x="16.581mm" y="88.093mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sottoFreqSoglia3[0]"/>
                           </traversal>
                           <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1277 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sottoFreqSoglia3" h="6mm" w="7.118mm" access="protected" x="18.603mm" y="88.093mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoFreqSoglia3"/>
                           <traversal>
                              <traverse ref="sottoFreqTempo1[0]"/>
                           </traversal>
                        </field>
                        <field name="sottoFreqTempo1" h="6mm" w="7.077mm" access="protected" x="0.203mm" y="94.766mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoFreqTempo1"/>
                           <traversal>
                              <traverse ref="txcivico[6]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.224mm" h="6mm" x="7.28mm" y="94.766mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sottoFreqTempo2[0]"/>
                           </traversal>
                           <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1563 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sottoFreqTempo2" h="6mm" w="7.077mm" access="protected" x="9.504mm" y="94.766mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoFreqTempo2"/>
                           <traversal>
                              <traverse ref="txcivico[7]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.022mm" h="6mm" x="16.581mm" y="94.766mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sottoFreqTempo3[0]"/>
                           </traversal>
                           <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1277 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sottoFreqTempo3" h="6mm" w="7.118mm" access="protected" x="18.603mm" y="94.766mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoFreqTempo3"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia1[1]"/>
                           </traversal>
                        </field>
                        <field name="sovraFreqSoglia1" h="6mm" w="7.077mm" access="protected" x="0.203mm" y="101.439mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraTensSoglia1"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[8]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.224mm" h="6mm" x="7.28mm" y="101.439mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia2[1]"/>
                           </traversal>
                           <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1563 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia2" h="6mm" w="7.077mm" access="protected" x="9.504mm" y="101.439mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraTensSoglia2"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[9]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.022mm" h="6mm" x="16.581mm" y="101.439mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia3[1]"/>
                           </traversal>
                           <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1277 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia3" h="6mm" w="7.118mm" access="protected" x="18.603mm" y="101.439mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraTensSoglia3"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="sovraFreqSoglia1[2]"/>
                           </traversal>
                        </field>
                        <field name="sovraFreqSoglia1" h="6mm" w="7.077mm" access="protected" x="0.203mm" y="108.313mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraTensTempo1"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[10]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.224mm" h="6mm" x="7.28mm" y="108.313mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia2[2]"/>
                           </traversal>
                           <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1563 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia2" h="6mm" w="7.077mm" access="protected" x="9.504mm" y="108.313mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraTensTempo2"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[11]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.022mm" h="6mm" x="16.581mm" y="108.313mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia3[2]"/>
                           </traversal>
                           <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1277 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia3" h="6mm" w="7.118mm" access="protected" x="18.603mm" y="108.313mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sovraTensTempo3"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="sovraFreqSoglia1[3]"/>
                           </traversal>
                        </field>
                        <field name="sovraFreqSoglia1" h="6mm" w="7.077mm" access="protected" x="0.203mm" y="114.986mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoTensSoglia1"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[12]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.224mm" h="6mm" x="7.28mm" y="114.986mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia2[3]"/>
                           </traversal>
                           <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1563 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia2" h="6mm" w="7.077mm" access="protected" x="9.504mm" y="114.986mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoTensSoglia2"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[13]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.022mm" h="6mm" x="16.581mm" y="114.986mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia3[3]"/>
                           </traversal>
                           <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1277 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia3" h="6mm" w="7.118mm" access="protected" x="18.603mm" y="114.986mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoTensSoglia3"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="sovraFreqSoglia1[4]"/>
                           </traversal>
                        </field>
                        <field name="sovraFreqSoglia1" h="6mm" w="7.077mm" access="protected" x="0.202mm" y="121.456mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoTensTempo1"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[14]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.224mm" h="6mm" x="7.28mm" y="121.456mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia2[4]"/>
                           </traversal>
                           <?renderCache.bounds 6304 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1563 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia2" h="6mm" w="7.077mm" access="protected" x="9.504mm" y="121.456mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoTensTempo2"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="txcivico[15]"/>
                           </traversal>
                        </field>
                        <draw name="txcivico" w="2.022mm" h="6mm" x="16.581mm" y="121.456mm">
                           <value>
                              <text>/</text>
                           </value>
                           <ui>
                              <textEdit/>
                           </ui>
                           <para vAlign="middle" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt" hAlign="center"/>
                           <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                           <traversal>
                              <traverse ref="sovraFreqSoglia3[4]"/>
                           </traversal>
                           <?renderCache.bounds 5732 17008 0 0 0 0 0 0?>
                           <?renderCache.textRun 1 / 0 1277 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
                        <field name="sovraFreqSoglia3" h="6mm" w="7.118mm" access="protected" x="18.603mm" y="121.456mm">
                           <border>
                              <edge presence="hidden"/>
                           </border>
                           <font typeface="Verdana" size="6pt"/>
                           <para vAlign="middle"/>
                           <ui>
                              <textEdit>
                                 <border>
                                    <edge presence="hidden"/>
                                    <edge presence="hidden"/>
                                    <edge stroke="dotted">
                                       <color value="192,192,192"/>
                                    </edge>
                                    <edge presence="hidden"/>
                                    <corner/>
                                    <corner/>
                                    <corner stroke="dotted">
                                       <color value="192,192,192"/>
                                    </corner>
                                    <corner/>
                                 </border>
                              </textEdit>
                           </ui>
                           <event activity="initialize">
                              <script contentType="application/x-javascript"/>
                           </event>
                           <margin leftInset="0.5mm" topInset="0.5mm" bottomInset="0.5mm" rightInset="0.5mm"/>
                           <bind match="dataRef" ref="$.L11_4sottoTensTempo3"/>
                           <assist>
                              <speak disable="1"/>
                           </assist>
                           <traversal>
                              <traverse ref="firma[0]"/>
                           </traversal>
                        </field>
                        <traversal>
                           <traverse operation="first" ref="data[0]"/>
                        </traversal>
                        <?templateDesigner expand 0?></subform>
                     <draw name="xindir" w="1.026889in" h="84.383mm">
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="8.504pt" hAlign="right"/>
                        <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
                        <?renderCache.bounds 73936 239196 0 0 0 0 0 0?></draw>
                     <occur max="-1"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse operation="first" ref="datiGT[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <breakAfter targetType="pageArea" startNew="1">
                     <script contentType="application/x-javascript">this.instanceManager.count&gt;this.instanceIndex+1</script>
                  </breakAfter>
                  <traversal>
                     <traverse operation="first" ref="sf[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <traversal>
                  <traverse operation="first" ref="tx_4_1[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <draw name="xindir" w="200.195mm" h="6mm">
               <value>
                  <text>I valori delle temperature e delle emissioni di monossido di carbonio CO vanno confrontate con i valori limite riportati nella sezione 4.6 </text>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle" marginLeft="2.835pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="8.504pt" hAlign="right"/>
               <font size="7pt" typeface="Verdana" baselineShift="0pt"/>
               <?renderCache.bounds 567482 17008 0 0 0 0 0 0?>
               <?renderCache.textRun 139 I valori delle temperature e delle emissioni di monossido di carbonio CO vanno confrontate con i valori limite riportati nella sezione 4.6  0 83115 10558 0 0 0 "Verdana" 0 0 7000 ISO-8859-1?></draw>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp12" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiInterventiControllo"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>12. INTERVENTI DI CONTROLLO EFFICIENZA ENERGETICA</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 560554 26400 0 0 0 1417 0 0?>
                     <?renderCache.textRun 49 12. INTERVENTI DI CONTROLLO EFFICIENZA ENERGETICA 0 116268 17552 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].button[0].addRiga[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <draw name="tx_4_1" w="195.949mm" minH="6mm">
               <value>
                  <text>Allegare al presente libretto i relativi rapporti di intervento</text>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle" hAlign="center"/>
               <font size="8pt" typeface="Verdana" posture="italic"/>
               <margin leftInset="0.5mm"/>
               <traversal>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </draw>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="dataRef" ref="$.sezInterventi"/>
               <draw name="Rectangle6" w="197.163mm" h="0.5mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="5.275mm" name="button" h="5.56mm" presence="invisible">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.044mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
if (row.dataControllo.rawValue != null &amp;&amp; row.ragSociale.rawValue != null ){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	//xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="txflag1[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="txflag1" w="17.244mm" h="6.209mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Data<span style="xfa-spacerun:yes"> </span></p><p style="text-decoration:none;letter-spacing:0in">controllo</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </draw>
               <draw name="txflag1" w="69.039mm" h="6.209mm">
                  <value>
                     <text>Ragione sociale manutentore</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
                  <?renderCache.bounds 195701 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 27 Ragione sociale manutentore 0 40116 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="15.267mm" h="6.209mm">
                  <value>
                     <text>CCIAA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
                  <?renderCache.bounds 43277 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 CCIAA 0 9609 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="47.294mm" h="6.209mm">
                  <value>
                     <text>Tipo allegato</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[4]"/>
                  </traversal>
                  <?renderCache.bounds 134062 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 13 Tipo allegato 0 41972 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="25.679mm" h="6.209mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-align:left;letter-spacing:0in">Raccomandazioni</p><p style="text-align:left;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span>Si<span style="xfa-spacerun:yes">                 </span>No</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[5]"/>
                  </traversal>
               </draw>
               <draw name="txflag1" w="17.898mm" h="6.209mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Prescrizioni</p><p style="text-decoration:none;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span>Si<span style="xfa-spacerun:yes">         </span>No</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginRight="0pt"/>
                  <font size="8pt" typeface="Verdana" baselineShift="0pt"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="row[0]"/>
                  </traversal>
               </draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.intervControllo[*]"/>
                  <subform w="5.275mm" name="button" h="5.647mm" presence="invisible">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	dataControllo.rawValue = null;
	ragSociale.rawValue = null;
	cciaa.rawValue = null;
	tipoAllegato.rawValue = null;
	flagRaccSI.rawValue = "0";
	flagRaccNO.rawValue = "0";
	flagPrescrSI.rawValue = "0";
	flagPrescrNO.rawValue = "0";
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="dataControllo[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="dataControllo[0]"/>
                     </traversal>
                  </subform>
                  <field name="dataControllo" w="17.244mm" h="6mm" access="protected">
                     <ui>
                        <dateTimeEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dashDotDot">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dashDotDot">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </dateTimeEdit>
                        <picture>date{DD/MM/YYYY}</picture>
                     </ui>
                     <font typeface="Verdana" size="7pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <date/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <corner/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <bind match="dataRef" ref="$.L12dataControllo">
                        <picture>date{YYYY-MM-DD}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio o data installazione maggiore di quella odierna.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null || this.rawValue &gt; scriptsJS.getDataString()) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi );
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi );
}
*/
</script>
                        <message>
                           <text name="formatTest"/>
                        </message>
                        <picture>date{DD/MM/YYYY}</picture>
                     </validate>
                     <format>
                        <picture>date{DD/MM/YYYY}</picture>
                     </format>
                     <event activity="exit" name="event__exit">
                        <script contentType="application/x-javascript">/*
if (this.rawValue != null || this.rawValue != "" ) {
	
	var vValueSave =  this.rawValue;
	//xfa.host.messageBox("vValueSave: "+vValueSave);
	
	try{
		 
		var vMessageSuffix = "";
		var VALIDATION_MSG = "";			
				
		//--------- controllo data installazione e ultima dismissione o sostituzione ---------
		var vIndice = rowSost.index;
		var vRowCount = _rowSost.count;			

		for (nItemCount = 0; nItemCount &lt; vRowCount; nItemCount++){ 
			var currentRow = row.resolveNode("rowSost["+ nItemCount +"]");	
			var vIndex = currentRow.index;
			
			
			if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ) { //
				//xfa.host.messageBox("[vValueSave &lt;  currentRow.dataDismiss.rawValue] ?? "+vValueSave+" ----  "+currentRow.datiGT.dataDismiss.rawValue);
				break;
			}	
		}

		var sObj = this.parent.name+"."+ this.name;
		var oField = xfa.resolveNode(sObj);
			
		if (vValueSave &lt;= currentRow.datiGT.dataDismiss.rawValue ){  //
			var VALIDATION_MSG = "La data installazione deve essere maggiore rispetto all'ultimo dismesso. ";
			//xfa.host.messageBox(VALIDATION_MSG);			
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");

		} else {
			controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
		} 
	}catch(e){
			//xfa.host.messageBox("Exception: [dataInstallaz::exit] "+e);
	}	
}
//---------------------------------------------------------------------------
*/
</script>
                     </event>
                     <traversal>
                        <traverse ref="esercizio2[0]"/>
                     </traversal>
                  </field>
                  <field name="ragSociale" w="69.039mm" h="6mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dashDotDot">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dashDotDot">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="7pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L12ragioneSociale"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="xindir[10]"/>
                     </traversal>
                  </field>
                  <field name="cciaa" w="15.267mm" h="6mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dashDotDot">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dashDotDot">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="7pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L12cciaa"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="tipoAllegato[0]"/>
                     </traversal>
                  </field>
                  <field name="tipoAllegato" w="47.294mm" h="6mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dashDotDot">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dashDotDot">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="7pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L12tipoAllegato"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="flagRaccSI[0]"/>
                     </traversal>
                  </field>
                  <field name="flagRaccSI" w="5.577mm" h="6mm" access="protected">
                     <ui>
                        <checkButton size="3.175mm" shape="round">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb4?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <bind match="dataRef" ref="$.L12flagRaccSI"/>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" w="14.642mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="flagRaccNO[0]"/>
                     </traversal>
                     <?renderCache.bounds 41505 17600 0 0 0 0 0 0?></draw>
                  <field name="flagRaccNO" w="5.577mm" h="6mm" access="protected">
                     <ui>
                        <checkButton size="3.175mm" shape="round">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb4?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <bind match="dataRef" ref="$.L12flagRaccNO"/>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <traversal>
                        <traverse ref="flagPrescrSI[0]"/>
                     </traversal>
                  </field>
                  <draw name="Rectangle6" w="197.163mm" h="1.042mm" presence="hidden">
                     <value>
                        <rectangle>
                           <edge presence="hidden"/>
                           <corner radius="5.08mm" presence="hidden"/>
                        </rectangle>
                     </value>
                  </draw>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <field name="flagPrescrSI" w="5.577mm" h="6mm" access="protected">
                     <ui>
                        <checkButton size="3.175mm" shape="round">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb4?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <bind match="dataRef" ref="$.L12flagPrescrSI"/>
                     <traversal>
                        <traverse ref="txflag1[1]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" w="6.235mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="flagPrescrNO[0]"/>
                     </traversal>
                     <?renderCache.bounds 17674 17600 0 0 0 0 0 0?></draw>
                  <field name="flagPrescrNO" w="5.577mm" h="6mm" access="protected">
                     <ui>
                        <checkButton size="3.175mm" shape="round">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb4?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <validate>
                        <script contentType="application/x-javascript">/*
var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue != "1" &amp;&amp; flagTipoInterv2.rawValue != "1" &amp;&amp; flagTipoInterv3.rawValue != "1" &amp;&amp; flagTipoInterv4.rawValue != "1") {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
}
*/
</script>
                     </validate>
                     <bind match="dataRef" ref="$.L12flagPrescrNO"/>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <border>
                  <edge>
                     <color value="128,128,128"/>
                  </edge>
                  <corner thickness="0.176mm">
                     <color value="128,128,128"/>
                  </corner>
               </border>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <?templateDesigner expand 0?>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
         </subform>
         <subform w="197.902mm" name="schedaAltriComp13" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiRisultatiIspez"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="8.625mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="7.482mm" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>13. RISULTATI DELLE ISPEZIONI PERIODICHE EFFETTUATE A CURA DELL'ENTE COMPETENTE</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 557720 18375 0 0 1417 1417 0 0?>
                     <?renderCache.textRun 79 13. RISULTATI DELLE ISPEZIONI PERIODICHE EFFETTUATE A CURA DELL'ENTE COMPETENTE 0 19015 13539 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].button[0].addRiga[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="tx_4_1[0]"/>
               </traversal>
            </subform>
            <draw name="txflag1" w="197.365mm" h="2.224mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
               <ui>
                  <defaultUi/>
               </ui>
               <font size="8pt" typeface="Verdana"/>
               <para vAlign="middle"/>
            </draw>
            <draw name="tx_4_1" w="195.949mm" minH="6mm" presence="invisible">
               <value>
                  <text>........</text>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle" hAlign="center"/>
               <font size="8pt" typeface="Verdana" posture="italic"/>
               <margin leftInset="0.5mm"/>
               <traversal>
                  <traverse ref="row[0].datiIspe[0].xindir[5]"/>
               </traversal>
            </draw>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform w="197.181mm" name="button" h="5.56mm" presence="hidden">
               <bind match="none"/>
               <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                  <value>
                     <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <assist>
                     <toolTip>Aggiungi riga.</toolTip>
                  </assist>
                  <margin leftInset="1mm"/>
               </draw>
               <field name="btAdd" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                  <ui>
                     <button highlight="none"/>
                  </ui>
                  <font typeface="Myriad Pro"/>
                  <border hand="right">
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">

	row.instanceManager.addInstance();

</script>
                  </event>
                  <assist>
                     <toolTip>Aggiungi riga.</toolTip>
                  </assist>
                  <margin leftInset="1mm"/>
                  <traversal>
                     <traverse ref="rowGT[0]"/>
                  </traversal>
               </field>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="2.124mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform w="196.758mm" layout="lr-tb" name="row">
               <bind match="dataRef" ref="$.sezRisultati.rowRisultatiIspez[*]"/>
               <subform w="4.93mm" name="button" h="6.116mm" presence="hidden">
                  <bind match="none"/>
                  <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                     <value>
                        <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Cancella riga.</toolTip>
                     </assist>
                  </draw>
                  <field name="btCancella" w="4.535mm" h="5.022mm" relevant="-print" x="0.395mm" y="0.907mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;


if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{

	datiIspe.cognome.rawValue = "";
	datiIspe.nome.rawValue = "";
	datiIspe.cf.rawValue = "";
    datiIspe.flagPositivo.rawValue = "0";
    datiIspe.flagNegativo.rawValue = "0";
	datiIspe.dataIspezione.rawValue = "";
	datiIspe.firmaIspettore.rawValue = "";
	datiIspe.nomeTecnicoIspezione.rawValue = "";
	datiIspe.note.rawValue = "";
	datiIspe.numRapporto.rawValue = "";
}	

</script>
                     </event>
                     <assist>
                        <toolTip>Cancella riga.</toolTip>
                     </assist>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="cancellaRiga[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <subform name="datiIspe" w="197.272mm" h="65.142mm">
                  <bind match="none"/>
                  <draw name="xindir" x="10.128mm" y="10.346mm" w="16.985mm" h="6mm">
                     <value>
                        <text>Cognome</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[2]"/>
                     </traversal>
                     <?renderCache.bounds 48146 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 7 Cognome 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="cognome" y="10.346mm" w="54.996mm" h="6mm" x="28.126mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L13cognomeTecnico"/>
                     <traversal>
                        <traverse ref="valDataContrattoAl[0]"/>
                     </traversal>
                  </field>
                  <field name="flagPositivo" w="5.577mm" h="6mm" x="61.082mm" y="35.014mm" access="protected">
                     <ui>
                        <checkButton mark="circle" size="3.175mm" shape="round">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb4?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L13flagPositivo"/>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" x="67.553mm" y="35.014mm" w="20.22mm" h="6mm">
                     <value>
                        <text>Positivo</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="flagNegativo[0]"/>
                     </traversal>
                     <?renderCache.bounds 57317 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 8 Positivo 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden"/>
                     <edge presence="hidden"/>
                     <edge presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden"/>
                  </border>
                  <draw name="xindir" x="84.942mm" y="10.346mm" w="10.716mm" h="6mm">
                     <value>
                        <text>Nome</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[3]"/>
                     </traversal>
                     <?renderCache.bounds 30376 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 4 Nome 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="nome" y="10.346mm" w="44.684mm" h="6mm" x="95.659mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L13nomeTecnico"/>
                     <traversal>
                        <traverse ref="xindir[2]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="143.58mm" y="10.346mm" w="7.077mm" h="6mm">
                     <value>
                        <text>CF</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[5]"/>
                     </traversal>
                     <?renderCache.bounds 20061 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 2 CF 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="cf" y="10.346mm" w="43.068mm" h="6mm" x="152.881mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L13codiceFiscale"/>
                     <traversal>
                        <traverse ref="xindir[3]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="9.723mm" y="19.041mm" w="24.264mm" h="6mm">
                     <value>
                        <text>per conto di  </text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[7]"/>
                     </traversal>
                     <?renderCache.bounds 68780 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 14 per conto di   0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="enteCompetente" y="22.68mm" w="106.56mm" h="6mm" x="33.987mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L13enteCompetente"/>
                     <traversal>
                        <traverse ref="xindir[8]"/>
                     </traversal>
                  </field>
                  <field name="flagNegativo" w="5.577mm" h="6mm" x="88.582mm" y="35.216mm" access="protected">
                     <ui>
                        <checkButton mark="circle" size="3.175mm" shape="round">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb4?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L13flagNegativo"/>
                     <traversal>
                        <traverse ref="txflag1[1]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" x="95.053mm" y="35.216mm" w="21.712mm" h="6mm">
                     <value>
                        <text>Negativo</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="xindir[9]"/>
                     </traversal>
                     <?renderCache.bounds 61546 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 8 Negativo 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="dataIspezione" y="3.269mm" x="45.311mm" w="20.22mm" h="6mm" access="protected">
                     <ui>
                        <dateTimeEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </dateTimeEdit>
                        <picture>date{DD/MM/YYYY}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <date/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L13dataIspez">
                        <picture>date{YYYY-MM-DD}</picture>
                     </bind>
                     <format>
                        <picture>date{DD/MM/YYYY}</picture>
                     </format>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="93.232mm" y="57.594mm" w="31.341mm" h="6mm">
                     <value>
                        <text>Firma dell'ispettore</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="firmaIspettore[0]"/>
                     </traversal>
                     <?renderCache.bounds 88841 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 20 Firma dell'ispettore 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="firmaIspettore" y="57.594mm" w="71.377mm" h="6mm" x="124.573mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dashDotDot">
                                 <color value="128,128,128"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dashDotDot">
                                 <color value="128,128,128"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L13firmaIspettore"/>
                  </field>
                  <draw name="xindir" x="10.128mm" y="3.067mm" w="33.969mm" h="6mm">
                     <value>
                        <text>Ispezione eseguita il </text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="dataIspezione[0]"/>
                     </traversal>
                     <?renderCache.bounds 96290 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 22 Ispezione eseguita il  0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="xindir" x="66.339mm" y="3.269mm" w="10.716mm" h="6mm">
                     <value>
                        <text>da:</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" hAlign="right"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="nomeTecnicoIspezione[0]"/>
                     </traversal>
                     <?renderCache.bounds 30376 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 3 da: 0 16954 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="nomeTecnicoIspezione" y="3.269mm" w="62.48mm" h="6mm" x="77.662mm" access="protected" presence="invisible">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="cognome[0]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="9.723mm" y="22.68mm" w="25.882mm" h="6mm">
                     <value>
                        <text>Ente Competente</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="enteCompetente[0]"/>
                     </traversal>
                     <?renderCache.bounds 73366 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 15 Ente Competente 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="xindir" x="9.926mm" y="31.375mm" w="7.375819in" h="9.301mm">
                     <value>
                        <text>La verifica della documentazione impianto, dell'avvenuto controllo ed eventuale manutenzione e, ove previsto, del rendimento della combustione, ha avuto esito:</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="flagPositivo[0]"/>
                     </traversal>
                     <?renderCache.bounds 531059 26365 0 0 0 0 0 0?>
                     <?renderCache.textRun 125 La verifica della documentazione impianto, dell'avvenuto controllo ed eventuale manutenzione e, ove previsto, del rendimento  0 0 10730 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?>
                     <?renderCache.textRun 34 della combustione, ha avuto esito: 0 0 20330 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="xindir" x="9.723mm" y="42.9mm" w="10.717mm" h="6mm">
                     <value>
                        <text>Note</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="note[0]"/>
                     </traversal>
                     <?renderCache.bounds 30379 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 4 Note 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="note" y="42.9mm" w="176.318mm" x="19.429mm" access="protected" minH="10.312mm">
                     <ui>
                        <textEdit multiLine="1">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.4434mm">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L13note"/>
                     <value>
                        <text maxChars="2000"/>
                     </value>
                     <traversal>
                        <traverse ref="xindir[10]"/>
                     </traversal>
                  </field>
                  <draw name="xindir" x="10.128mm" y="56.852mm" w="57.425mm" h="6mm">
                     <value>
                        <text>Si allega copia del Rapporto di prova n°</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle"/>
                     <font size="8pt" typeface="Verdana"/>
                     <traversal>
                        <traverse ref="numRapporto[0]"/>
                     </traversal>
                     <?renderCache.bounds 162780 17008 0 0 0 0 0 0?>
                     <?renderCache.textRun 41 Si allega copia del Rapporto di prova n° 0 0 10852 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <field name="numRapporto" y="57.054mm" w="17.996mm" h="6mm" x="67.553mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                     </border>
                     <bind match="dataRef" ref="$.L13rapportoProva"/>
                     <traversal>
                        <traverse ref="xindir[4]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="xindir[5]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="Rectangle6" w="197.163mm" h="2.042mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <occur max="-1"/>
               <breakAfter/>
               <border>
                  <edge>
                     <color value="192,192,192"/>
                  </edge>
                  <corner thickness="0.176mm">
                     <color value="192,192,192"/>
                  </corner>
               </border>
               <traversal>
                  <traverse operation="first" ref="datiNomina[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp14_1" layout="lr-tb">
            <bind match="dataRef" ref="$.Richiesta.datiConsumoCombu"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 560554 26400 0 0 0 1417 0 0?>
                     <?renderCache.textRun 47 14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI 0 125126 17552 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <field name="nota" y="3.438mm" x="154.7mm" w="5.257mm" h="4.65mm" presence="invisible">
                     <ui>
                        <button highlight="inverted"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
xfa.host.messageBox("Le tabelle dei consumi vanno compilate solamente in presenza di misuratori dedicati al solo impianto termico.");
</script>
                     </event>
                     <traversal>
                        <traverse ref="imgNota[0]"/>
                     </traversal>
                  </field>
                  <draw name="imgNota" y="3.842mm" x="154.7mm" w="5.055mm" h="4.044mm" presence="invisible">
                     <value>
                        <image href="..\resources\comment.png" contentType="image/png"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <traversal>
                        <traverse ref="generatori[0].button[0].addRiga[0]"/>
                     </traversal>
                  </draw>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <draw name="tx_4_1" w="58.049mm" minH="6mm">
               <value>
                  <text>14.1 CONSUMO DI COMBUSTIBILE</text>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle"/>
               <font size="8pt" typeface="Verdana" weight="bold"/>
               <margin leftInset="0.5mm"/>
            </draw>
            <subform x="66.541mm" y="10.717mm" w="5.617mm" name="nota" h="6.47mm" presence="invisible">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="imgNota" w="5.055mm" h="4.044mm" x="0.203mm" y="0.809mm" relevant="-print">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="generatori[0]"/>
                  </traversal>
               </draw>
               <field name="nota" w="5.257mm" h="4.65mm" y="0.809mm" relevant="-print">
                  <ui>
                     <button highlight="inverted"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("Va redatta una scheda per ogni combustibile.");
</script>
                  </event>
                  <traversal>
                     <traverse ref="imgNota[0]"/>
                  </traversal>
               </field>
               <traversal>
                  <traverse operation="first" ref="nota[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="none"/>
               <subform w="5.275mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.044mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
//if (rowCombu.sfCombu.tipoCombu.rawValue != null &amp;&amp; rowCombu.sfCombu.unitaMis.rawValue != null ){

	rowCombu.instanceManager.addInstance();


	//var vIndex = _row.count-1;
	//var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	//xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

//}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="rowCombu[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="rowCombu[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="Rectangle6" w="197.163mm" h="0.5mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform x="5.275mm" y="0.5mm" w="197.972mm" layout="lr-tb" name="rowCombu">
                  <bind match="dataRef" ref="$.sezCombu.rowCombu[*]"/>
                  <subform name="sfCombu" w="197.972mm" h="6.714mm">
                     <bind match="none"/>
                     <border>
                        <edge presence="hidden"/>
                        <fill>
                           <color value="221,221,221"/>
                        </fill>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge/>
                        <corner/>
                     </border>
                     <subform w="5.015mm" name="button" h="5.504mm" y="0.042mm">
                        <bind match="none"/>
                        <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <value>
                              <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Cancella riga.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="btCancella[0]"/>
                           </traversal>
                        </draw>
                        <field name="btCancella" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  rowCombu.index;
var vRowCount = _rowCombu.count;
	

if (vRowCount &gt; 1 ) {
	_rowCombu.removeInstance(vIndex);
}else{
	tipoCombu.rawValue = null;
	unitaMis.rawValue = null;
}	

</script>
                           </event>
                           <assist>
                              <toolTip>Cancella riga.</toolTip>
                           </assist>
                           <traversal>
                              <traverse ref="xindir[6]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";

</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="cancellaRiga[0]"/>
                           <traverse ref="txflag1[0]"/>
                        </traversal>
                     </subform>
                     <draw name="txflag1" w="28.308mm" h="6.209mm" x="8.897mm" y="0.346mm">
                        <value>
                           <text>Tipo combustibile</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana"/>
                        <border>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="txflag1[1]"/>
                        </traversal>
                        <?renderCache.bounds 80243 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 17 Tipo combustibile 0 5687 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <draw name="txflag1" w="28.308mm" h="6.209mm" x="129.004mm" y="0.346mm">
                        <value>
                           <text>Unita' di misura</text>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana"/>
                        <border>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <corner thickness="0.176mm" presence="hidden"/>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="tipoCombu[0]"/>
                        </traversal>
                        <?renderCache.bounds 80243 17600 0 0 0 0 0 0?>
                        <?renderCache.textRun 16 Unita' di misura 0 9105 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                     <field name="tipoCombu" y="0.346mm" x="36.818mm" w="62.328mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="none"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on tipoCombu::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.combustibile.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.combustibile.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codCombu.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codCombu.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on tipoCombu::init "+e);}
</script>
                        </event>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codCombu.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <traversal>
                           <traverse ref="codCombu[0]"/>
                        </traversal>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( (this.rawValue == null || this.rawValue == "") &amp;&amp; (row.esercizio1.rawValue != null || row.esercizio2.rawValue != null || row.acquisti.rawValue != null 
	  || row.lettIniziale.rawValue != null || row.lettFinale.rawValue != null || row.consumo.rawValue != null) 
	  &amp;&amp; versioneStampa.rawValue == "false" ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
}
</script>
                        </validate>
                        <assist>
                           <toolTip>Tipo combustibile (sez 14.1)</toolTip>
                        </assist>
                     </field>
                     <subform x="100.511mm" y="0.75mm" w="5.257mm" minH="4.65mm" name="nota" presence="invisible">
                        <bind match="none"/>
                        <draw name="img" y="0.404mm" w="5.055mm" h="4.044mm" relevant="-print">
                           <value>
                              <image href="..\resources\comment.png" contentType="image/png"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                        </draw>
                        <field name="nota" y="0mm" w="5.257mm" h="4.65mm">
                           <ui>
                              <button highlight="inverted"/>
                           </ui>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
xfa.host.messageBox("Per i combustibili liquidi quantificare in base agli approvvigionamenti effettuati ed alle letture di livello del combustibile nei serbatoi.\n"+
					"Per i combustibili gassosi indicare le letture effettive del contatore (quando questo esista).\n"+ 
					"Indicare accanto al numero l'unità di misura: per esempio m3 per gas naturale, kg oppure l per GPL e combustibili liquidi, "+
					"kg per i combustibili solidi, kWh per teleriscaldamento / teleraffrescamento.");
</script>
                           </event>
                           <traversal>
                              <traverse ref="img[0]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <traversal>
                           <traverse operation="first" ref="nota[0]"/>
                        </traversal>
                     </subform>
                     <field name="unitaMis" y="0.346mm" x="157.734mm" w="33.785mm" h="6mm">
                        <ui>
                           <choiceList>
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge>
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner>
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </choiceList>
                        </ui>
                        <font typeface="Verdana" size="8pt" weight="bold"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <caption reserve="0.01in">
                           <para vAlign="middle"/>
                        </caption>
                        <border>
                           <edge presence="hidden"/>
                           <corner/>
                        </border>
                        <bind match="none"/>
                        <event activity="prePrint" ref="$host" name="event__prePrint">
                           <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                        </event>
                        <event activity="enter" name="event__enter">
                           <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.unitaMisura.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.unitaMisura.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on unitaMis::enter "+e);}
</script>
                        </event>
                        <event activity="ready" ref="$form" name="event__form_ready">
                           <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.unitaMisura.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.unitaMisura.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codUM.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codUM.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on unitaMis::init "+e);}
</script>
                        </event>
                        <items/>
                        <items save="1" presence="hidden"/>
                        <event activity="exit" name="event__exit">
                           <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codUM.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                        </event>
                        <validate>
                           <script contentType="application/x-javascript">
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( (this.rawValue == null || this.rawValue == "") &amp;&amp; (row.esercizio1.rawValue != null || row.esercizio2.rawValue != null || row.acquisti.rawValue != null 
	|| row.lettIniziale.rawValue != null || row.lettFinale.rawValue != null || row.consumo.rawValue != null) 
	  &amp;&amp; versioneStampa.rawValue == "false" ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);
} else {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
}
</script>
                        </validate>
                        <assist>
                           <toolTip>Unita' di misura (sez 14.1)</toolTip>
                        </assist>
                     </field>
                     <margin leftInset="0mm"/>
                     <field name="codCombu" y="0.85mm" x="100.079mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L14_1tipoCombu"/>
                        <traversal>
                           <traverse ref="dataManutenz[0]"/>
                        </traversal>
                     </field>
                     <field name="codUM" y="1.154mm" x="115.07mm" w="12.003mm" h="4.853mm" access="protected" presence="invisible">
                        <ui>
                           <textEdit>
                              <border presence="hidden">
                                 <?templateDesigner StyleID aped0?></border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Myriad Pro" size="7pt"/>
                        <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle"/>
                        <bind match="dataRef" ref="$.L14_1unitaMisura"/>
                        <traversal>
                           <traverse ref="button[0]"/>
                        </traversal>
                     </field>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                        <traverse ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <subform w="7.903mm" name="button" h="6.09mm">
                     <bind match="none"/>
                     <draw name="addRiga" w="4.535mm" h="4.535mm" x="0.018mm" y="0.809mm" presence="hidden">
                        <value>
                           <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Aggiungi riga.</toolTip>
                        </assist>
                        <margin leftInset="1mm"/>
                     </draw>
                     <field name="btAdd" relevant="-print" x="2.444mm" y="0.809mm" minW="5.257mm" minH="4.751mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
//if (row.dataControllo.rawValue != null &amp;&amp; row.ragSociale.rawValue != null ){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	//xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

//}
</script>
                        </event>
                        <assist>
                           <toolTip>Aggiungi nuovo elemento.</toolTip>
                        </assist>
                        <margin leftInset="1mm"/>
                        <caption>
                           <value>
                              <text>+</text>
                           </value>
                           <font typeface="Verdana" weight="bold" size="14pt">
                              <fill>
                                 <color value="0,128,128"/>
                              </fill>
                           </font>
                           <para vAlign="middle" hAlign="center"/>
                        </caption>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                     </field>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="btAdd[0]"/>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <draw name="txflag1" w="34.507mm" h="6.209mm">
                     <value>
                        <text>Esercizio</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="txflag1[1]"/>
                     </traversal>
                     <?renderCache.bounds 97815 17600 0 0 0 0 0 0?>
                     <?renderCache.textRun 9 Esercizio 0 32104 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="txflag1" w="51.82mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <value>
                        <text>Acquisti</text>
                     </value>
                     <traversal>
                        <traverse ref="txflag1[2]"/>
                     </traversal>
                     <?renderCache.bounds 146891 17600 0 0 0 0 0 0?>
                     <?renderCache.textRun 8 Acquisti 0 58457 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="txflag1" w="35.789mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <value>
                        <text>Scorta o lettura iniziale</text>
                     </value>
                     <traversal>
                        <traverse ref="txflag1[3]"/>
                     </traversal>
                     <?renderCache.bounds 101449 17600 0 0 0 0 0 0?>
                     <?renderCache.textRun 25 Scorta o lettura iniziale 0 4773 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="txflag1" w="35.385mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <value>
                        <text>Scorta o lettura finale</text>
                     </value>
                     <traversal>
                        <traverse ref="txflag1[4]"/>
                     </traversal>
                     <?renderCache.bounds 100304 17600 0 0 0 0 0 0?>
                     <?renderCache.textRun 23 Scorta o lettura finale 0 7091 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <draw name="txflag1" w="28.454mm" h="6.209mm">
                     <value>
                        <text>Consumo</text>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="row[0]"/>
                     </traversal>
                     <?renderCache.bounds 80657 17600 0 0 0 0 0 0?>
                     <?renderCache.textRun 7 Consumo 0 22351 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
                  <subform w="198.174mm" layout="lr-tb" name="row">
                     <bind match="dataRef" ref="$.sezRowConsumo.rowConsumo[*]"/>
                     <subform w="5.731mm" name="button" h="6.09mm">
                        <bind match="none"/>
                        <draw name="cancellaRiga" w="4.535mm" h="4.535mm" x="0.395mm" y="0.907mm" presence="hidden">
                           <value>
                              <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                           </value>
                           <ui>
                              <imageEdit/>
                           </ui>
                           <assist>
                              <toolTip>Cancella riga.</toolTip>
                           </assist>
                        </draw>
                        <field name="btCancella" relevant="-print" x="0.395mm" y="0.907mm" minW="5.257mm" minH="4.751mm">
                           <ui>
                              <button highlight="none"/>
                           </ui>
                           <font typeface="Myriad Pro"/>
                           <border hand="right">
                              <edge presence="hidden"/>
                           </border>
                           <bind match="none"/>
                           <event activity="click" name="event__click">
                              <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	esercizio1.rawValue = null;
	esercizio2.rawValue = null;
	acquisti.rawValue = null;
	lettIniziale.rawValue = null;
	lettFinale.rawValue = null;
	consumo.rawValue = null;
}	

</script>
                           </event>
                           <assist>
                              <toolTip>Elimina AC corrente.</toolTip>
                           </assist>
                           <caption>
                              <value>
                                 <text>x</text>
                              </value>
                              <font typeface="Myriad Pro" weight="bold" size="14pt">
                                 <fill>
                                    <color value="128,0,0"/>
                                 </fill>
                              </font>
                              <para vAlign="middle" hAlign="center"/>
                           </caption>
                           <traversal>
                              <traverse ref="esercizio1[0]"/>
                           </traversal>
                        </field>
                        <?templateDesigner expand 0?>
                        <event activity="docReady" ref="$host" name="event__docReady">
                           <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                        </event>
                        <traversal>
                           <traverse operation="first" ref="btCancella[0]"/>
                           <traverse ref="esercizio1[0]"/>
                        </traversal>
                     </subform>
                     <field name="esercizio1" w="17.751mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge stroke="dotted">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner stroke="dotted">
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <integer/>
                        </value>
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <corner/>
                           <corner presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="xindir[6]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L14_1esercizio1">
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </bind>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <format>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </format>
                     </field>
                     <draw name="txflag1" w="3.235mm" h="6.209mm">
                        <value>
                           <exData contentType="text/html">
                              <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-align:left;letter-spacing:0in">/</p></body>
                           </exData>
                        </value>
                        <ui>
                           <textEdit/>
                        </ui>
                        <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                        <font size="8pt" typeface="Verdana"/>
                        <border>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <corner thickness="0.176mm" presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                        </border>
                        <traversal>
                           <traverse ref="esercizio2[0]"/>
                        </traversal>
                     </draw>
                     <field name="esercizio2" w="13.763mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge stroke="dotted">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner stroke="dotted">
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <integer/>
                        </value>
                        <border>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                           <corner/>
                        </border>
                        <traversal>
                           <traverse ref="acquisti[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L14_1esercizio2">
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </bind>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <format>
                           <picture>num{zzzzzzzzzzzz9}</picture>
                        </format>
                     </field>
                     <field name="acquisti" w="51.763mm" h="6mm">
                        <ui>
                           <textEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge stroke="dotted">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner stroke="dotted">
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </textEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <border>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L14_1acquisti"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                        <traversal>
                           <traverse ref="lettIniziale[0]"/>
                        </traversal>
                     </field>
                     <draw name="Rectangle6" w="197.163mm" h="1.042mm" presence="hidden">
                        <value>
                           <rectangle>
                              <edge presence="hidden"/>
                              <corner radius="5.08mm" presence="hidden"/>
                           </rectangle>
                        </value>
                     </draw>
                     <occur max="-1"/>
                     <breakAfter/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <field name="lettIniziale" w="35.789mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge stroke="dotted">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner stroke="dotted">
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <decimal fracDigits="-1"/>
                        </value>
                        <border>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                           <corner/>
                        </border>
                        <traversal>
                           <traverse ref="lettFinale[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L14_1letturaIniz"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                     </field>
                     <field name="lettFinale" w="35.254mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge stroke="dotted">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner stroke="dotted">
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <decimal fracDigits="-1"/>
                        </value>
                        <border>
                           <edge presence="hidden"/>
                           <edge>
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner>
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                           <corner/>
                        </border>
                        <traversal>
                           <traverse ref="consumo[0]"/>
                        </traversal>
                        <bind match="dataRef" ref="$.L14_1letturaFinale"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                     </field>
                     <field name="consumo" w="29.046mm" h="6mm">
                        <ui>
                           <numericEdit hScrollPolicy="off">
                              <border>
                                 <edge presence="hidden"/>
                                 <edge presence="hidden"/>
                                 <edge stroke="dotted">
                                    <color value="192,192,192"/>
                                 </edge>
                                 <edge presence="hidden"/>
                                 <corner/>
                                 <corner/>
                                 <corner stroke="dotted">
                                    <color value="192,192,192"/>
                                 </corner>
                                 <corner/>
                              </border>
                              <margin/>
                           </numericEdit>
                        </ui>
                        <font typeface="Verdana" size="8pt"/>
                        <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                        <para vAlign="middle" hAlign="center"/>
                        <value>
                           <decimal fracDigits="-1"/>
                        </value>
                        <border>
                           <edge presence="hidden"/>
                           <edge presence="hidden">
                              <color value="192,192,192"/>
                           </edge>
                           <edge presence="hidden"/>
                           <edge presence="hidden"/>
                           <corner/>
                           <corner presence="hidden">
                              <color value="192,192,192"/>
                           </corner>
                           <corner/>
                           <corner/>
                        </border>
                        <bind match="dataRef" ref="$.L14_1consumo"/>
                        <validate>
                           <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        </validate>
                     </field>
                     <margin leftInset="2mm"/>
                     <traversal>
                        <traverse operation="first" ref="button[0]"/>
                     </traversal>
                     <?templateDesigner expand 1?></subform>
                  <occur max="-1"/>
                  <traversal>
                     <traverse operation="first" ref="sfCombu[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <border>
                  <edge>
                     <color value="128,128,128"/>
                  </edge>
                  <corner thickness="0.176mm">
                     <color value="128,128,128"/>
                  </corner>
               </border>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 1?></subform>
         <subform w="197.902mm" name="schedaAltriComp14_2" layout="lr-tb">
            <bind match="none"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 560554 26400 0 0 0 1417 0 0?>
                     <?renderCache.textRun 47 14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI 0 125126 17552 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].button[0].addRiga[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <draw name="tx_4_1" w="63.711mm" minH="6mm">
               <value>
                  <text>14.2 CONSUMO DI ENERGIA ELETTRICA</text>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle"/>
               <font size="8pt" typeface="Verdana" weight="bold"/>
               <margin leftInset="0.5mm"/>
               <traversal>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </draw>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="none"/>
               <draw name="Rectangle6" w="197.163mm" h="0.5mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="5.275mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.044mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
//if (row.esercizio1.rawValue != null &amp;&amp; row.esercizio2.rawValue != null ){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	//xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

//}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="txflag1[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="txflag1" w="44.686mm" h="6.209mm">
                  <value>
                     <text>Esercizio</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
                  <?renderCache.bounds 126669 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 9 Esercizio 0 46531 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="46.304mm" h="6.209mm">
                  <value>
                     <text>Lettura iniziale (kWh)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
                  <?renderCache.bounds 131255 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 22 Lettura iniziale (kWh) 0 22826 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="45.899mm" h="6.209mm">
                  <value>
                     <text>Lettura finale (kWh)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
                  <?renderCache.bounds 130107 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 20 Lettura finale (kWh) 0 25143 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="55.808mm" h="6.209mm">
                  <value>
                     <text>Consumo totale (kWh)</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?renderCache.bounds 158196 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 20 Consumo totale (kWh) 0 34359 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <subform y="6mm" w="198.174mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.Richiesta.datiConsumoEE.sezConsumo.rowConsumoEE[*]"/>
                  <subform w="5.275mm" name="button" h="5.647mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	esercizio1.rawValue = null;
	esercizio2.rawValue = null;
	lettIniziale.rawValue = null;
	lettFinale.rawValue = null;
	consumo.rawValue = null;
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="esercizio1[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="esercizio1[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <field name="esercizio1" w="23.808mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <integer/>
                     </value>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner/>
                        <corner presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                     <bind match="dataRef" ref="$.L14_2esercizio1">
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <format>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </format>
                  </field>
                  <draw name="txflag1" w="3.235mm" h="6.209mm">
                     <value>
                        <exData contentType="text/html">
                           <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-align:left;letter-spacing:0in">/</p></body>
                        </exData>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="esercizio2[0]"/>
                     </traversal>
                  </draw>
                  <field name="esercizio2" w="17.643mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <integer/>
                     </value>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <traversal>
                        <traverse ref="lettIniziale[0]"/>
                     </traversal>
                     <bind match="dataRef" ref="$.L14_2esercizio2">
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <format>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </format>
                  </field>
                  <field name="lettIniziale" w="46.304mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <decimal leadDigits="6"/>
                     </value>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L14_2letturaIniz"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="lettFinale[0]"/>
                     </traversal>
                  </field>
                  <field name="lettFinale" w="45.899mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <decimal leadDigits="6"/>
                     </value>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L14_2letturaFinale"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="consumo[0]"/>
                     </traversal>
                  </field>
                  <field name="consumo" w="55.605mm" h="6.036mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <decimal leadDigits="6"/>
                     </value>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L14_2consumoTot"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <border>
                  <edge>
                     <color value="128,128,128"/>
                  </edge>
                  <corner thickness="0.176mm">
                     <color value="128,128,128"/>
                  </corner>
               </border>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp14_3" layout="lr-tb">
            <bind match="none"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 560554 26400 0 0 0 1417 0 0?>
                     <?renderCache.textRun 47 14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI 0 125126 17552 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].button[0].addRiga[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <draw name="Rectangle6" w="197.163mm" h="2.022mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <draw name="tx_4_1" w="137.918mm" h="6.268mm">
               <value>
                  <text>14.3 CONSUMO DI ACQUA DI REINTEGRO NEL CIRCUITO DELL'IMPIANTO TERMICO</text>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle"/>
               <font size="8pt" typeface="Verdana" weight="bold"/>
               <margin leftInset="0.5mm"/>
               <traversal>
                  <traverse ref="xindir[6]"/>
               </traversal>
               <?renderCache.bounds 389532 17768 0 0 1417 0 0 0?>
               <?renderCache.textRun 69 14.3 CONSUMO DI ACQUA DI REINTEGRO NEL CIRCUITO DELL'IMPIANTO TERMICO 0 1417 11232 0 0 0 "Verdana" 1 0 8000 ISO-8859-1?></draw>
            <draw name="txflag1" w="25.073mm" h="6.209mm">
               <value>
                  <text>Unita' di misura</text>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
               <font size="8pt" typeface="Verdana"/>
               <border>
                  <edge presence="hidden">
                     <color value="192,192,192"/>
                  </edge>
                  <corner thickness="0.176mm" presence="hidden">
                     <color value="192,192,192"/>
                  </corner>
                  <edge presence="hidden">
                     <color value="192,192,192"/>
                  </edge>
                  <edge presence="hidden"/>
                  <edge presence="hidden">
                     <color value="192,192,192"/>
                  </edge>
                  <corner thickness="0.176mm" presence="hidden">
                     <color value="192,192,192"/>
                  </corner>
                  <corner thickness="0.176mm" presence="hidden"/>
                  <corner thickness="0.176mm" presence="hidden">
                     <color value="192,192,192"/>
                  </corner>
               </border>
               <traversal>
                  <traverse ref="dataManutenz[0]"/>
               </traversal>
               <?renderCache.bounds 71073 17600 0 0 0 0 0 0?>
               <?renderCache.textRun 16 Unita' di misura 0 4520 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
            <field name="unitaMis" w="30.532mm" h="6mm">
               <ui>
                  <choiceList>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                     </border>
                     <margin/>
                  </choiceList>
               </ui>
               <font typeface="Verdana" size="8pt" weight="bold"/>
               <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
               <para vAlign="middle"/>
               <caption reserve="0.01in">
                  <para vAlign="middle"/>
               </caption>
               <border>
                  <edge presence="hidden"/>
                  <corner/>
               </border>
               <bind match="none"/>
               <event activity="prePrint" ref="$host" name="event__prePrint">
                  <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
               </event>
               <event activity="enter" name="event__enter">
                  <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.unitaMisura.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.unitaMisura.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on unitaMis::enter "+e);}
</script>
               </event>
               <event activity="ready" ref="$form" name="event__form_ready">
                  <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.unitaMisura.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.unitaMisura.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codUM.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codUM.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on unitaMis::init "+e);}
</script>
               </event>
               <items/>
               <items save="1" presence="hidden"/>
               <event activity="exit" name="event__exit">
                  <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codUM.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
               </event>
               <validate>
                  <script contentType="application/x-javascript">
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( (this.rawValue == null || this.rawValue == "") &amp;&amp; (generatori.row.esercizio1.rawValue != null || generatori.row.esercizio2.rawValue != null 
     || generatori.row.lettIniziale.rawValue != null || generatori.row.lettFinale.rawValue != null || generatori.row.consumo.rawValue != null) 
	  &amp;&amp; versioneStampa.rawValue == "false" ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);
} else {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
}
</script>
               </validate>
               <assist>
                  <toolTip>Unita' di misura (sez 14.3)</toolTip>
               </assist>
            </field>
            <field name="codUM" w="3.455mm" h="4.853mm" access="protected" presence="invisible">
               <ui>
                  <textEdit>
                     <border presence="hidden">
                        <?templateDesigner StyleID aped0?></border>
                     <margin/>
                  </textEdit>
               </ui>
               <font typeface="Myriad Pro" size="7pt"/>
               <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
               <para vAlign="middle"/>
               <bind match="dataRef" ref="$.Richiesta.datiConsumoH2O.L14_3unitaMisura"/>
               <traversal>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </field>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="none"/>
               <draw name="Rectangle6" w="197.163mm" h="0.5mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="5.275mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.044mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
//if (row.esercizio1.rawValue != null &amp;&amp; row.esercizio2.rawValue != null ){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	//xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

//}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="txflag1[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <draw name="txflag1" w="44.686mm" h="6.209mm">
                  <value>
                     <text>Esercizio</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
                  <?renderCache.bounds 126669 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 9 Esercizio 0 46531 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="46.304mm" h="6.209mm">
                  <value>
                     <text>Lettura iniziale</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
                  <?renderCache.bounds 131255 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 16 Lettura iniziale 0 36719 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="45.899mm" h="6.209mm">
                  <value>
                     <text>Lettura finale </text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
                  <?renderCache.bounds 130107 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 15 Lettura finale  0 39035 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="55.808mm" h="6.209mm">
                  <value>
                     <text>Consumo totale </text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?renderCache.bounds 158196 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 15 Consumo totale  0 48252 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <subform y="6mm" w="197.567mm" layout="lr-tb" name="row">
                  <bind match="none"/>
                  <subform w="5.275mm" name="button" h="5.647mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	esercizio1.rawValue = null;
	esercizio2.rawValue = null;
	lettIniziale.rawValue = null;
	lettFinale.rawValue = null;
	consumo.rawValue = null;
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="esercizio1[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="esercizio1[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <field name="esercizio1" w="24.062mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <integer/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner/>
                        <corner presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                     <bind match="dataRef" ref="$.Richiesta.datiConsumoH2O.sezConsumo.rowConsumoH2O[*].L14_3esercizio1">
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <format>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </format>
                  </field>
                  <draw name="txflag1" w="3.235mm" h="6.209mm">
                     <value>
                        <exData contentType="text/html">
                           <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-align:left;letter-spacing:0in">/</p></body>
                        </exData>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="esercizio2[0]"/>
                     </traversal>
                  </draw>
                  <field name="esercizio2" w="17.389mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <integer/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <traversal>
                        <traverse ref="lettIniziale[0]"/>
                     </traversal>
                     <bind match="dataRef" ref="$.Richiesta.datiConsumoH2O.sezConsumo.rowConsumoH2O[*].L14_3esercizio2">
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <format>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </format>
                  </field>
                  <field name="lettIniziale" w="46.304mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <decimal leadDigits="5"/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.Richiesta.datiConsumoH2O.sezConsumo.rowConsumoH2O[*].L14_3letturaIniz"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="lettFinale[0]"/>
                     </traversal>
                  </field>
                  <field name="lettFinale" w="45.899mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <decimal leadDigits="5"/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.Richiesta.datiConsumoH2O.sezConsumo.rowConsumoH2O[*].L14_3letturaFinale"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="consumo[0]"/>
                     </traversal>
                  </field>
                  <field name="consumo" w="55.201mm" h="6.036mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <decimal fracDigits="-1"/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.Richiesta.datiConsumoH2O.sezConsumo.rowConsumoH2O[*].L14_3consumoTot"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <border>
                  <edge>
                     <color value="128,128,128"/>
                  </edge>
                  <corner thickness="0.176mm">
                     <color value="128,128,128"/>
                  </corner>
               </border>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp14_4" layout="lr-tb">
            <bind match="none"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 560554 26400 0 0 0 1417 0 0?>
                     <?renderCache.textRun 47 14. REGISTRAZIONE DEI CONSUMI NEI VARI ESERCIZI 0 125126 17552 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].button[0].addRiga[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </subform>
            <draw name="tx_4_1" w="178.762mm" minH="6mm">
               <value>
                  <text>14.4 CONSUMO DI PRODOTTI CHIMICI PER IL TRATTAMENTO ACQUA DEL CIRCUITO DELL'IMPIANTO TERMICO</text>
               </value>
               <ui>
                  <textEdit/>
               </ui>
               <para vAlign="middle"/>
               <font size="8pt" typeface="Verdana" weight="bold"/>
               <margin leftInset="0.5mm"/>
               <traversal>
                  <traverse ref="generatori[0]"/>
               </traversal>
            </draw>
            <subform w="5.56mm" name="nota" h="5.539mm" presence="invisible">
               <bind match="none"/>
               <keep intact="none"/>
               <draw name="imgNota" w="5.055mm" h="4.044mm" x="0.203mm" y="0.809mm" relevant="-print">
                  <value>
                     <image href="..\resources\comment.png" contentType="image/png"/>
                  </value>
                  <ui>
                     <imageEdit/>
                  </ui>
                  <traversal>
                     <traverse ref="generatori[0]"/>
                  </traversal>
               </draw>
               <field name="nota" w="5.257mm" h="4.65mm" y="0.809mm" relevant="-print">
                  <ui>
                     <button highlight="inverted"/>
                  </ui>
                  <bind match="none"/>
                  <event activity="click" name="event__click">
                     <script contentType="application/x-javascript">
xfa.host.messageBox("Quantitativi di sale per il trattamento anticalcare dell’acs, quantitativi di prodotti anticorrosivi, etc");
</script>
                  </event>
                  <traversal>
                     <traverse ref="imgNota[0]"/>
                  </traversal>
               </field>
               <traversal>
                  <traverse operation="first" ref="nota[0]"/>
               </traversal>
               <?templateDesigner expand 0?></subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="none"/>
               <draw name="Rectangle6" w="197.163mm" h="0.5mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="5.275mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.044mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
//if (row.esercizio1.rawValue != null &amp;&amp; row.esercizio2.rawValue != null ){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	//xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

//}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="txflag1[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="txflag1" w="44.686mm" h="6.209mm">
                  <value>
                     <text>Esercizio</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
                  <?renderCache.bounds 126669 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 9 Esercizio 0 46531 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="26.084mm" h="6.209mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Circuito<span style="xfa-spacerun:yes"> </span></p><p style="text-decoration:none;letter-spacing:0in">impianto termico</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
               </draw>
               <draw name="txflag1" w="15.165mm" h="6.209mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="letter-spacing:0in">Circuito<span style="xfa-spacerun:yes"> </span></p><p style="letter-spacing:0in">ACS</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
               </draw>
               <draw name="txflag1" w="18.602mm" h="6.209mm">
                  <value>
                     <text>Altri circuiti ausiliari</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[4]"/>
                  </traversal>
                  <?renderCache.bounds 52730 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 15 Altri circuiti  0 4179 6348 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?>
                  <?renderCache.textRun 9 ausiliari 0 11556 15948 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="51.651mm" h="6.209mm">
                  <value>
                     <text>Nome prodotto</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[5]"/>
                  </traversal>
                  <?renderCache.bounds 146412 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 13 Nome prodotto 0 43688 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="17.464mm" h="6.209mm">
                  <value>
                     <text>Quantita' consumata</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                  </traversal>
                  <?renderCache.bounds 49504 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 10 Quantita'  0 7121 6348 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?>
                  <?renderCache.textRun 9 consumata 0 3531 15948 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="19.044mm" h="6.209mm">
                  <value>
                     <text>Unita' di misura</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="row[0]"/>
                  </traversal>
                  <?renderCache.bounds 53983 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 10 Unita' di  0 11095 6348 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?>
                  <?renderCache.textRun 6 misura 0 13987 15948 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <subform y="6mm" w="197.769mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.Richiesta.datiConsumoProdottiChimici.sezConsumo.rowConsumoPROD[*]"/>
                  <subform w="5.275mm" name="button" h="5.647mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	esercizio1.rawValue = null;
	esercizio2.rawValue = null;
	flagCircuitoIT.rawValue = "0";
	flagCircuitoACS.rawValue = "0";
	flagCircuitoAus.rawValue = "0";
	nomeProdotto.rawValue = null;
	qtaConsumata.rawValue = null;
	uMisura.rawValue = null;
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="dataManutenz[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="codUM[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <field name="esercizio1" w="24.062mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <integer/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner/>
                        <corner presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="xindir[6]"/>
                     </traversal>
                     <bind match="dataRef" ref="$.L14_4esercizio1">
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <format>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </format>
                  </field>
                  <draw name="txflag1" w="3.235mm" h="6.209mm">
                     <value>
                        <exData contentType="text/html">
                           <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-align:left;letter-spacing:0in">/</p></body>
                        </exData>
                     </value>
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="esercizio2[0]"/>
                     </traversal>
                  </draw>
                  <field name="esercizio2" w="17.389mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <integer/>
                     </value>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <traversal>
                        <traverse ref="txflag1[1]"/>
                     </traversal>
                     <bind match="dataRef" ref="$.L14_4esercizio2">
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <format>
                        <picture>num{zzzzzzzzzzzz9}</picture>
                     </format>
                  </field>
                  <draw name="txflag1" w="10.514mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="txflag1[2]"/>
                     </traversal>
                     <?renderCache.bounds 29803 17600 0 0 0 0 0 0?></draw>
                  <field name="flagCircuitoIT" w="5.577mm" h="6mm">
                     <ui>
                        <checkButton mark="cross" size="3.175mm">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb2?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L14_4flagCircuitoIT"/>
                     <traversal>
                        <traverse ref="txflag1[2]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" w="9.993mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <traversal>
                        <traverse ref="txflag1[3]"/>
                     </traversal>
                     <?renderCache.bounds 28327 17600 0 0 0 0 0 0?></draw>
                  <draw name="txflag1" w="4.65mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <?renderCache.bounds 13181 17600 0 0 0 0 0 0?></draw>
                  <field name="flagCircuitoACS" w="5.577mm" h="6mm">
                     <ui>
                        <checkButton mark="cross" size="3.175mm">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb2?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L14_4flagCircuitoACS"/>
                     <traversal>
                        <traverse ref="txflag1[4]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" w="4.938mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <traversal>
                        <traverse ref="txflag1[5]"/>
                     </traversal>
                     <?renderCache.bounds 13997 17600 0 0 0 0 0 0?></draw>
                  <draw name="txflag1" w="5.864mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="txflag1[5]"/>
                     </traversal>
                     <?renderCache.bounds 16622 17600 0 0 0 0 0 0?></draw>
                  <field name="flagCircuitoAus" w="5.577mm" h="6mm">
                     <ui>
                        <checkButton mark="cross" size="3.175mm">
                           <border>
                              <edge stroke="lowered"/>
                              <fill>
                                 <color value="255, 255, 255"/>
                              </fill>
                              <?templateDesigner StyleID apcb2?></border>
                        </checkButton>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <margin leftInset="1mm" rightInset="1mm"/>
                     <para vAlign="middle"/>
                     <value>
                        <text>0</text>
                     </value>
                     <items>
                        <text>1</text>
                        <text>0</text>
                     </items>
                     <bind match="dataRef" ref="$.L14_4flagCircuitoAltri"/>
                     <traversal>
                        <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                     </traversal>
                  </field>
                  <draw name="txflag1" w="7.161mm" h="6.209mm">
                     <ui>
                        <textEdit/>
                     </ui>
                     <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                     <font size="8pt" typeface="Verdana"/>
                     <border>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <corner thickness="0.176mm" presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <corner thickness="0.176mm" presence="hidden"/>
                        <corner thickness="0.176mm" presence="hidden"/>
                     </border>
                     <traversal>
                        <traverse ref="qtaConsumata[0]"/>
                     </traversal>
                     <?renderCache.bounds 20299 17600 0 0 0 0 0 0?></draw>
                  <field name="nomeProdotto" w="51.561mm" h="6mm">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L14_4nomeProdotto"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="unitaMis[0]"/>
                     </traversal>
                  </field>
                  <field name="qtaConsumata" w="17.592mm" h="6mm">
                     <ui>
                        <numericEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </numericEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L14_4qtaConsumata"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                  </field>
                  <field name="unitaMis" w="18.366mm" h="6mm">
                     <ui>
                        <choiceList>
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge>
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner>
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </choiceList>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0.01in">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <corner/>
                     </border>
                     <bind match="none"/>
                     <event activity="prePrint" ref="$host" name="event__prePrint">
                        <script contentType="application/x-javascript">
var vMessageSuffix = "";
var VALIDATION_MSG = "";

var sObj = this.parent.name+"[*]."+ this.name;
var oField = xfa.resolveNode(sObj);

controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR","formValido");
</script>
                     </event>
                     <event activity="enter" name="event__enter">
                        <script contentType="application/x-javascript">
try{
	//if (this.rawValue != null ) { 
	//	var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.unitaMisura.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.unitaMisura.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}
//	}
	
}catch(e){xfa.host.messageBox("Exception on unitaMis::enter "+e);}
</script>
                     </event>
                     <event activity="ready" ref="$form" name="event__form_ready">
                        <script contentType="application/x-javascript">
try{
	   var vValueSave =  this.rawValue;
	
		//xfa.host.messageBox("vValueSave: "+vValueSave);
		this.clearItems();

		//recupero da listBox "web.combustibile" precompilata ---------
		var oItems = Richiesta.resolveNode("web.unitaMisura.#items");
		var nItemsLength = oItems.nodes.length;
				
		for (nItemCount = 0; nItemCount &lt; nItemsLength; nItemCount++){ 
			var itemName = oItems.nodes.item(nItemCount).value;
			var itemValueSaved = web.unitaMisura.getSaveItem(nItemCount);
				

			this.addItem(itemName,itemValueSaved);
				
			nItemsLength = oItems.nodes.length;
		}

		if (codUM.rawValue != null) {
			var vItems = xfa.resolveNode("this.#items");
			var vItemsLength = vItems.nodes.length;		  
			for (vItemCount = 0; vItemCount &lt; vItemsLength; vItemCount++){ 
				var itemName = vItems.nodes.item(vItemCount).value;
				var itemValueSaved = this.getSaveItem(vItemCount);
					
				if (codUM.rawValue == itemValueSaved)
					break;
					
				vItemsLength = vItems.nodes.length;
			}
			this.rawValue = itemName ;
		}
	
}catch(e){xfa.host.messageBox("Exception on unitaMis::init "+e);}
</script>
                     </event>
                     <items/>
                     <items save="1" presence="hidden"/>
                     <event activity="exit" name="event__exit">
                        <script contentType="application/x-javascript">
if (this.rawValue != null) {
	var vChoice = this.selectedIndex; 
	var vText = this.getDisplayItem(vChoice);
	codUM.rawValue = this.boundItem(vText);
  //xfa.host.messageBox("this.boundItem(vText): "+this.boundItem(vText));
}
</script>
                     </event>
                     <validate>
                        <script contentType="application/x-javascript">
var fullPathValidationField2 = "Richiesta.formValido";
var fCheckValidi2 = xfa.resolveNode(fullPathValidationField2);

var nPage = xfa.layout.page(this);

var vMessageSuffix = "pag. "+nPage;
var VALIDATION_MSG = "Errore!"+'\n'
				+"Campo obbligatorio.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if ( (this.rawValue == null || this.rawValue == "") &amp;&amp; qtaConsumata.rawValue != null &amp;&amp; versioneStampa.rawValue == "false" ) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi2);
} else {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi2);
}
</script>
                     </validate>
                     <assist>
                        <toolTip>Unita' di misura (sez 14.4)</toolTip>
                     </assist>
                  </field>
                  <field name="codUM" w="3.455mm" h="4.853mm" access="protected" presence="hidden">
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Myriad Pro" size="7pt"/>
                     <margin topInset="1mm" bottomInset="1mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <bind match="dataRef" ref="$.L14_4unitaMisura"/>
                     <traversal>
                        <traverse ref="esercizio1[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <border>
                  <edge>
                     <color value="128,128,128"/>
                  </edge>
                  <corner thickness="0.176mm">
                     <color value="128,128,128"/>
                  </corner>
               </border>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform w="197.902mm" name="schedaAltriComp15" layout="lr-tb" y="3mm">
            <bind match="none"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.717mm" name="intestazInizialeRipSF" w="197.769mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" x="0.018mm" y="0.404mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>15. INTERVENTI DI MANUTENZIONE</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                     <?renderCache.bounds 560554 26400 0 0 0 1417 0 0?>
                     <?renderCache.textRun 30 15. INTERVENTI DI MANUTENZIONE 0 177992 17552 0 0 0 "Verdana" 1 0 10000 ISO-8859-1?></draw>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="0.422mm" y="2.427mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generatori[0].button[0].addRiga[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="0.607mm" x="193.333mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="192.903mm" y="0.607mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <bind match="none"/>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
                  <traverse ref="generatori[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <draw name="Rectangle6" w="197.163mm" h="3.907mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform y="10.717mm" w="198.174mm" layout="lr-tb" name="generatori">
               <bind match="none"/>
               <draw name="Rectangle6" w="197.163mm" h="0.5mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <subform w="5.275mm" name="button" h="5.56mm">
                  <bind match="none"/>
                  <draw name="addRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <value>
                        <image href="..\resources\list2-add.png" contentType="image/png" aspect="none"/>
                     </value>
                     <ui>
                        <imageEdit/>
                     </ui>
                     <assist>
                        <toolTip>Aggiungi riga.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="btAdd[0]"/>
                     </traversal>
                  </draw>
                  <field name="btAdd" w="4.044mm" h="4.535mm" relevant="-print" x="0.018mm" y="0.809mm">
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <font typeface="Myriad Pro"/>
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
//if (row.esercizio1.rawValue != null &amp;&amp; row.esercizio2.rawValue != null ){

	row.instanceManager.addInstance();


	var vIndex = _row.count-1;
	var currentRow = generatori.resolveNode("row["+ vIndex +"]");
	//xfa.host.messageBox("vIndex :"+vIndex );
	
	Focus.init();
	//xfa.host.setFocus(currentRow.datiGT.dataInstallaz);

//}
</script>
                     </event>
                     <assist>
                        <toolTip>Aggiungi nuovo elemento.</toolTip>
                     </assist>
                     <margin leftInset="1mm"/>
                     <traversal>
                        <traverse ref="txflag1[0]"/>
                     </traversal>
                  </field>
                  <event activity="docReady" ref="$host" name="event__docReady">
                     <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                  </event>
                  <traversal>
                     <traverse operation="first" ref="addRiga[0]"/>
                     <traverse ref="txflag1[0]"/>
                  </traversal>
                  <?templateDesigner expand 0?></subform>
               <draw name="txflag1" w="21.231mm" h="6.209mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Data</p><p style="text-decoration:none;letter-spacing:0in">manutenzione</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[1]"/>
                  </traversal>
               </draw>
               <draw name="txflag1" w="41.735mm" h="6.209mm">
                  <value>
                     <text>Ragione sociale manutentore</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[2]"/>
                  </traversal>
                  <?renderCache.bounds 118304 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 27 Ragione sociale manutentore 0 1417 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="16.296mm" h="6.209mm">
                  <value>
                     <text>CCIAA</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[3]"/>
                  </traversal>
                  <?renderCache.bounds 46193 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 5 CCIAA 0 11067 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="38.014mm" h="6.209mm">
                  <value>
                     <text>Tipo intervento</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[4]"/>
                  </traversal>
                  <?renderCache.bounds 107756 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 15 Tipo intervento 0 24118 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <draw name="txflag1" w="36.395mm" h="6.209mm">
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in">Intervento manutentivo</p><p style="text-decoration:none;letter-spacing:0in">entro il</p></body>
                     </exData>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="txflag1[5]"/>
                  </traversal>
               </draw>
               <draw name="txflag1" w="39.025mm" h="6.209mm">
                  <value>
                     <text>Note</text>
                  </value>
                  <ui>
                     <textEdit/>
                  </ui>
                  <para vAlign="middle" marginLeft="1.417pt" hAlign="center"/>
                  <font size="8pt" typeface="Verdana"/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <color value="221,221,221"/>
                     </fill>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <edge presence="hidden"/>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <corner thickness="0.176mm" presence="hidden"/>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="row[0].button[0].cancellaRiga[0]"/>
                  </traversal>
                  <?renderCache.bounds 110622 17600 0 0 0 0 0 0?>
                  <?renderCache.textRun 4 Note 0 46641 11148 0 0 0 "Verdana" 0 0 8000 ISO-8859-1?></draw>
               <subform y="6mm" w="197.769mm" layout="lr-tb" name="row">
                  <bind match="dataRef" ref="$.Richiesta.datiInterventiManutenzione.sezInterventi.rowIntervento[*]"/>
                  <subform w="5.275mm" name="button" h="5.647mm">
                     <bind match="none"/>
                     <draw name="cancellaRiga" w="4.535mm" h="4.535mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <value>
                           <image href="..\resources\b_drop.png" contentType="image/png" aspect="none"/>
                        </value>
                        <ui>
                           <imageEdit/>
                        </ui>
                        <assist>
                           <toolTip>Cancella riga.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="btCancella[0]"/>
                        </traversal>
                     </draw>
                     <field name="btCancella" w="4.535mm" h="4.552mm" relevant="-print" x="0.395mm" y="0.907mm">
                        <ui>
                           <button highlight="none"/>
                        </ui>
                        <font typeface="Myriad Pro"/>
                        <border hand="right">
                           <edge presence="hidden"/>
                        </border>
                        <bind match="none"/>
                        <event activity="click" name="event__click">
                           <script contentType="application/x-javascript">
var vIndex =  row.index;
var vRowCount = _row.count;
	
if (vRowCount &gt; 1) {
	_row.removeInstance(vIndex);
}else{
	esercizio1.rawValue = null;
	esercizio2.rawValue = null;
	flagCircuitoIT.rawValue = "0";
	flagCircuitoACS.rawValue = "0";
	flagCircuitoAus.rawValue = "0";
	nomeProdotto.rawValue = null;
	qtaConsumata.rawValue = null;
	uMisura.rawValue = null;
}	

</script>
                        </event>
                        <assist>
                           <toolTip>Elimina elemento corrente.</toolTip>
                        </assist>
                        <traversal>
                           <traverse ref="dataManutenz[0]"/>
                        </traversal>
                     </field>
                     <?templateDesigner expand 0?>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse operation="first" ref="cancellaRiga[0]"/>
                        <traverse ref="dataManutenz[0]"/>
                     </traversal>
                  </subform>
                  <occur max="-1"/>
                  <breakAfter/>
                  <border>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm" presence="hidden">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <field name="dataManutenz" w="21.231mm" h="5.9mm" access="protected">
                     <ui>
                        <dateTimeEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </dateTimeEdit>
                        <picture>date{DD/MM/YYYY}</picture>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <date/>
                     </value>
                     <caption reserve="0mm">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <corner/>
                        <corner presence="hidden">
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                     </border>
                     <traversal>
                        <traverse ref="ragSocManutent[0]"/>
                     </traversal>
                     <bind match="dataRef" ref="$.L15_dataManutenzione">
                        <picture>date{YYYY-MM-DD}</picture>
                     </bind>
                     <format>
                        <picture>date{DD/MM/YYYY}</picture>
                     </format>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                        <picture>date{DD/MM/YYYY}</picture>
                     </validate>
                  </field>
                  <field name="ragSocManutent" w="41.855mm" h="6mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0mm">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <traversal>
                        <traverse ref="cciaa[0]"/>
                     </traversal>
                     <bind match="dataRef" ref="$.L15_ragSocManutentore"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                  </field>
                  <field name="cciaa" w="16.176mm" h="6mm" access="protected" y="3mm">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0mm">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L15_cciaa"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="tipoIntervento[0]"/>
                     </traversal>
                  </field>
                  <field name="tipoIntervento" w="38.216mm" h="6mm" access="protected" y="6mm">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0mm">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L15_tipoIntervento"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <traversal>
                        <traverse ref="intManEntroIl[0]"/>
                     </traversal>
                  </field>
                  <field name="intManEntroIl" y="6mm" x="16.176mm" w="36.194mm" h="6mm" access="protected">
                     <ui>
                        <dateTimeEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </dateTimeEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle" hAlign="center"/>
                     <value>
                        <date/>
                     </value>
                     <caption reserve="0mm">
                        <para vAlign="middle" hAlign="center"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L15_intManEntroIl">
                        <picture>date{YYYY-MM-DD}</picture>
                     </bind>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                     <format>
                        <picture>date{DD/MM/YYYY}</picture>
                     </format>
                     <traversal>
                        <traverse ref="note[0]"/>
                     </traversal>
                  </field>
                  <field name="note" y="9mm" x="16.176mm" w="38.822mm" h="6mm" access="protected">
                     <ui>
                        <textEdit hScrollPolicy="off">
                           <border>
                              <edge presence="hidden"/>
                              <edge presence="hidden"/>
                              <edge stroke="dotted">
                                 <color value="192,192,192"/>
                              </edge>
                              <edge presence="hidden"/>
                              <corner/>
                              <corner/>
                              <corner stroke="dotted">
                                 <color value="192,192,192"/>
                              </corner>
                              <corner/>
                           </border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <font typeface="Verdana" size="8pt"/>
                     <margin topInset="0mm" bottomInset="0mm" leftInset="0mm" rightInset="0mm"/>
                     <para vAlign="middle"/>
                     <caption reserve="0mm">
                        <para vAlign="middle"/>
                     </caption>
                     <border>
                        <edge presence="hidden"/>
                        <edge>
                           <color value="192,192,192"/>
                        </edge>
                        <edge presence="hidden"/>
                        <edge presence="hidden"/>
                        <corner/>
                        <corner>
                           <color value="192,192,192"/>
                        </corner>
                        <corner/>
                        <corner/>
                     </border>
                     <bind match="dataRef" ref="$.L15_note"/>
                     <validate>
                        <script contentType="application/x-javascript">/*
var fullPathValidationField = "Richiesta.formValidoParz";
var fCheckValidi = xfa.resolveNode(fullPathValidationField);

var vMessageSuffix = "";
var VALIDATION_MSG = "Errore!"+'\n'
				+"Compilare i campi obbligatori (evidenziati) prima di continuare.";

var sObj = this.parent.name+"."+ this.name;
var oField = xfa.resolveNode(sObj);

if (this.rawValue == "" || this.rawValue == null) {
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR",fCheckValidi);
} else {	
	controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR",fCheckValidi);
}
*/
</script>
                     </validate>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="button[0]"/>
                  </traversal>
                  <?templateDesigner expand 1?></subform>
               <border>
                  <edge>
                     <color value="128,128,128"/>
                  </edge>
                  <corner thickness="0.176mm">
                     <color value="128,128,128"/>
                  </corner>
               </border>
               <traversal>
                  <traverse operation="first" ref="button[0]"/>
               </traversal>
               <?templateDesigner expand 1?></subform>
            <traversal>
               <traverse operation="first" ref="PageHeaderLogo[0]"/>
            </traversal>
            <?templateDesigner expand 0?></subform>
         <subform name="sfIstruzioni" w="197.365mm" layout="lr-tb" presence="hidden">
            <bind match="none"/>
            <breakBefore targetType="pageArea" startNew="1"/>
            <subform w="197.902mm" name="PageHeaderLogo" layout="tb">
               <subform h="10.919mm" name="intestazInizialeRipSF" w="200.213mm">
                  <border>
                     <corner presence="hidden"/>
                     <edge presence="hidden"/>
                  </border>
                  <bind match="none"/>
                  <draw h="0.406028in" name="Text1" w="197.751mm" y="0mm">
                     <border>
                        <corner presence="hidden" thickness="0.176mm">
                           <color value="192,192,192"/>
                        </corner>
                        <edge presence="hidden">
                           <color value="192,192,192"/>
                        </edge>
                        <fill>
                           <linear type="toTop">
                              <color value="192,192,192"/>
                           </linear>
                        </fill>
                     </border>
                     <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                     <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                     <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                     <ui>
                        <textEdit/>
                     </ui>
                     <value>
                        <text>ISTRUZIONE PER LA COMPILAZIONE DEL LIBRETTO</text>
                     </value>
                     <traversal>
                        <traverse ref="TocButton[0]"/>
                     </traversal>
                  </draw>
                  <?templateDesigner expand 0?>
                  <field access="protected" h="5mm" name="Bookmark" w="0.1mm" x="2.452mm" y="3.639mm">
                     <font typeface="Myriad Pro"/>
                     <margin bottomInset="0mm" leftInset="0mm" rightInset="0mm" topInset="0mm"/>
                     <para vAlign="middle"/>
                     <ui>
                        <textEdit>
                           <border presence="hidden">
                              <?templateDesigner StyleID aped0?></border>
                           <margin/>
                        </textEdit>
                     </ui>
                     <bind match="none"/>
                     <traversal>
                        <traverse ref="generale[0]"/>
                     </traversal>
                  </field>
                  <field name="TocImage" y="1.819mm" x="194.559mm" w="4mm" h="4mm" relevant="-print">
                     <ui>
                        <imageEdit/>
                     </ui>
                     <value>
                        <image contentType="image/png" href="..\resources\arrowUp-red.png"/>
                     </value>
                     <?templateDesigner expand 1?>
                     <assist>
                        <toolTip>quadri</toolTip>
                     </assist>
                     <bind match="none"/>
                     <event activity="docReady" ref="$host" name="event__docReady">
                        <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;

if (editableField.rawValue != "BOZZA")*/
	this.presence = "invisible";
</script>
                     </event>
                     <traversal>
                        <traverse ref="Bookmark[0]"/>
                     </traversal>
                  </field>
                  <field h="4.247mm" name="TocButton" w="5mm" x="193.559mm" y="1.819mm" relevant="-print">
                     <border hand="right">
                        <edge presence="hidden"/>
                     </border>
                     <font typeface="Myriad Pro"/>
                     <ui>
                        <button highlight="none"/>
                     </ui>
                     <bind match="none"/>
                     <event activity="click" name="event__click">
                        <script contentType="application/x-javascript">
try{
	//this.parent.parent.parent.parent.TOC.presence = "visible";
	xfa.host.setFocus(modelli.elencoModuli.Bookmark);
}catch(e){xfa.host.messageBox("Exception on TocButton::click "+e);}
</script>
                     </event>
                     <assist>
                        <toolTip>vai all'elenco sezioni</toolTip>
                     </assist>
                     <traversal>
                        <traverse ref="TocImage[0]"/>
                     </traversal>
                  </field>
                  <traversal>
                     <traverse operation="first" ref="Text1[0]"/>
                  </traversal>
               </subform>
               <bind match="none"/>
               <keep intact="contentArea"/>
               <?templateDesigner expand 1?>
               <traversal>
                  <traverse operation="first" ref="intestazInizialeRipSF[0]"/>
               </traversal>
            </subform>
            <draw name="Rectangle7" w="200.398mm" h="4.449mm">
               <value>
                  <rectangle>
                     <edge presence="hidden"/>
                     <corner radius="5.08mm" presence="hidden"/>
                  </rectangle>
               </value>
            </draw>
            <subform name="generale" w="197.567mm" layout="tb">
               <bind match="none"/>
               <draw name="Text95" w="197.365mm" h="158.12mm">
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="line-height:13.3pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="line-height:13.3pt;letter-spacing:0in">Il libretto di impianto per gli impianti di climatizzazione invernale e/o estiva è disponibile in forma cartacea o elettronica. Nel primo caso viene conservato dal responsabile dell'impianto o eventuale terzo responsabile, che ne cura l'aggiornamento<span style="xfa-spacerun:yes">  </span>dove previsto o mettendolo a disposizione degli operatori<span style="xfa-spacerun:yes">  </span>di volta in volta interessati.<span style="xfa-spacerun:yes">  </span>Il libretto<span style="xfa-spacerun:yes">  </span>di<span style="xfa-spacerun:yes">  </span>impianto<span style="xfa-spacerun:yes">  </span>elettronico<span style="xfa-spacerun:yes">  </span>è<span style="xfa-spacerun:yes">  </span>conservato presso<span style="xfa-spacerun:yes">  </span>il<span style="xfa-spacerun:yes">  </span>catasto<span style="xfa-spacerun:yes">  </span>informatico<span style="xfa-spacerun:yes">  </span>dell'autorità competente o presso altro catasto accessibile all'autorità competente, e viene aggiornato di volta in volta dagli operatori interessati, che possono accedere mediante una password personale al libretto. Il libretto di impianto è obbligatorio per tutti gli impianti di climatizzazione invernale e/o estiva, indipendentemente dalla loro potenza termica, sia esistenti che di nuova installazione.</p><p style="margin-top:0.3pt;line-height:6.5pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="line-height:13.3pt;letter-spacing:0in">Per gli impianti in servizio alla data di pubblicazione del presente libretto di impianto, questo sostituisce gli esistenti “libretto di impianto” e “libretto di centrale” di cui all'art. 11 comma 9 del DPR n. 412/1993 e s.m.i., che vanno comunque conservati dal responsabile dell'impianto.</p><p style="margin-top:0.3pt;line-height:6.5pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="line-height:13.3pt;letter-spacing:0in">Il libretto<span style="xfa-spacerun:yes">  </span>di impianto viene generato dall'installatore<span style="xfa-spacerun:yes">  </span>assemblando<span style="xfa-spacerun:yes">  </span>le<span style="xfa-spacerun:yes">  </span>schede pertinenti<span style="xfa-spacerun:yes">  </span>alla<span style="xfa-spacerun:yes">  </span>tipologia di impianto installata; in caso di successivi interventi che comportano la sostituzione e/o l'inserimento di nuovi sistemi di generazione del calore e/o del freddo, di regolazione, di distribuzione, di emissione, al libretto di impianto andranno aggiunte e/o aggiornate, a cura dell'installatore dei nuovi sistemi, le relative schede. in tal modo si avrà la descrizione completa nel tempo dell'impianto, comprensiva degli elementi dismessi, di quelli sostituiti e di quelli installati in un secondo tempo.</p><p style="margin-top:0.25pt;line-height:6.5pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="line-height:13.35pt;letter-spacing:0in">Se un<span style="xfa-spacerun:yes">  </span>edificio<span style="xfa-spacerun:yes">  </span>è<span style="xfa-spacerun:yes">  </span>servito<span style="xfa-spacerun:yes">  </span>da due impianti<span style="xfa-spacerun:yes">  </span>distinti,<span style="xfa-spacerun:yes">  </span>uno<span style="xfa-spacerun:yes">  </span>per<span style="xfa-spacerun:yes">  </span>la<span style="xfa-spacerun:yes">  </span>climatizzazione<span style="xfa-spacerun:yes">  </span>invernale<span style="xfa-spacerun:yes">  </span>e<span style="xfa-spacerun:yes">  </span>uno<span style="xfa-spacerun:yes">  </span>per<span style="xfa-spacerun:yes">  </span>la climatizzazione estiva, che in comune hanno soltanto il sistema di rilevazione delle temperature nei locali riscaldati e raffreddati, sono necessari due libretti di impianto distinti; in tutti gli altri casi è sufficiente un solo libretto di impianto.</p><p style="margin-top:0.25pt;line-height:6.5pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="line-height:13.3pt;letter-spacing:0in">La compilazione iniziale, comprensiva dei risultati della prima verifica, deve essere effettuata all'atto della prima<span style="xfa-spacerun:yes">  </span>messa in<span style="xfa-spacerun:yes">  </span>servizio a cura<span style="xfa-spacerun:yes">  </span>della<span style="xfa-spacerun:yes">  </span>impresa<span style="xfa-spacerun:yes">  </span>installatrice;<span style="xfa-spacerun:yes">  </span>per<span style="xfa-spacerun:yes">  </span>gli impianti<span style="xfa-spacerun:yes">  </span>già esistenti<span style="xfa-spacerun:yes">  </span>alla<span style="xfa-spacerun:yes">  </span>data di pubblicazione<span style="xfa-spacerun:yes">  </span>del<span style="xfa-spacerun:yes">  </span>presente<span style="xfa-spacerun:yes">  </span>libretto<span style="xfa-spacerun:yes">  </span>la<span style="xfa-spacerun:yes">  </span>compilazione<span style="xfa-spacerun:yes">  </span>iniziale<span style="xfa-spacerun:yes">  </span>deve essere<span style="xfa-spacerun:yes">  </span>effettuata<span style="xfa-spacerun:yes">  </span>dal<span style="xfa-spacerun:yes">  </span>responsabile dell'impianto o eventuale terzo responsabile.</p><p style="margin-top:2.15pt;line-height:13.25pt;letter-spacing:0in">Le<span style="xfa-spacerun:yes">  </span>informazioni<span style="xfa-spacerun:yes">  </span>contenute<span style="xfa-spacerun:yes">  </span>nella<span style="xfa-spacerun:yes">  </span>scheda identificativa<span style="xfa-spacerun:yes">  </span>dell'impianto<span style="xfa-spacerun:yes">  </span>si<span style="xfa-spacerun:yes">  </span>intendono<span style="xfa-spacerun:yes">  </span>relative<span style="xfa-spacerun:yes">  </span>alla<span style="xfa-spacerun:yes">  </span>data<span style="xfa-spacerun:yes">  </span>di compilazione della scheda medesima.</p><p style="margin-top:0.35pt;line-height:6.5pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="line-height:13.4pt;letter-spacing:0in">La compilazione e l'aggiornamento successivo, per le diverse parti del Libretto di impianto, devono essere effettuate da:</p><p style="margin-top:0.45pt;line-height:5.5pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-top:0.55pt;line-height:11pt;letter-spacing:0in"><span style="xfa-tab-count:1">         </span>A cura del Responsabile che la firma<span style="xfa-tab-count:2">                  </span>Scheda<span style="xfa-tab-count:1">         </span>1<span style="xfa-tab-count:1">         </span><br/><span style="xfa-tab-count:1">         </span>Installatore<span style="xfa-tab-count:4">                                    </span>Schede<span style="xfa-tab-count:1">         </span>2, 4, 5, 6, 7, 8, 9, 10<span style="xfa-tab-count:1">         </span><br/><span style="xfa-tab-count:1">         </span>Responsabile (con firma 3° Responsabile)<span style="xfa-tab-count:1">         </span>Scheda<span style="xfa-tab-count:1">         </span>3<span style="xfa-tab-count:1">         </span><br/><span style="xfa-tab-count:1">         </span>Manutentore<span style="xfa-tab-count:4">                                    </span>Schede<span style="xfa-tab-count:1">         </span>11, 12<span style="xfa-tab-count:1">         </span><br/><span style="xfa-tab-count:1">         </span>Ispettore<span style="xfa-tab-count:5">                                             </span>Scheda<span style="xfa-tab-count:1">         </span>13<span style="xfa-tab-count:1">         </span><br/><span style="xfa-tab-count:1">         </span>Responsabile o eventuale 3° Responsabile<span style="xfa-tab-count:1">         </span>Scheda<span style="xfa-tab-count:1">         </span>14<span style="xfa-tab-count:1">         </span><br/><br/></p><p style="margin-top:1.4pt;line-height:15.3pt;letter-spacing:0in">Il libretto di impianto in formato cartaceo va consegnato dal responsabile uscente a quello subentrante in caso di trasferimento<span style="xfa-spacerun:yes">  </span>dell'immobile, a qualsiasi titolo, a cui è asservito l'impianto; in caso di nomina del terzo responsabile, a fine contratto il terzo responsabile ha l'obbligo<span style="xfa-spacerun:yes">  </span>di riconsegnare al<span style="xfa-spacerun:yes">  </span>responsabile<span style="xfa-spacerun:yes">   </span>il libretto di impianto, debitamente aggiornato, con relativi allegati.</p></body>
                     </exData>
                  </value>
                  <font size="7pt" typeface="Verdana" baselineShift="0pt">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                  <para spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="8.504pt" marginRight="8.504pt"/>
                  <keep intact="none"/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
               </draw>
               <draw name="Rectangle7" w="200.398mm" h="4.449mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="Text95[0]"/>
               </traversal>
            </subform>
            <subform name="scheda1" w="197.365mm" layout="tb">
               <bind match="none"/>
               <draw h="0.406028in" name="Text1" w="197.751mm">
                  <border>
                     <corner presence="hidden" thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <linear type="toTop">
                           <color value="192,192,192"/>
                        </linear>
                     </fill>
                  </border>
                  <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                  <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                  <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>SCHEDA 1</text>
                  </value>
                  <keep intact="none"/>
                  <traversal>
                     <traverse ref="Text95[0]"/>
                  </traversal>
               </draw>
               <draw name="Text95" w="7.770278in" h="4.171306in">
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="margin-left:2pt;line-height:11.1pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-left:2pt;line-height:11.1pt;letter-spacing:0in">Sezione 1.2</p><p style="margin-top:0.8pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">Legenda delle Categorie della destinazione dell’edificio</p><p style="margin-right:0pt;margin-left:0pt;line-height:10pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-top:1.55pt;margin-right:207.95pt;margin-left:16.15pt;line-height:13.35pt;letter-spacing:0in">E.1<span style="xfa-spacerun:yes">     </span>Edifici di tutte le tipologie adibiti a residenza e assimilabili:<span style="xfa-spacerun:yes"> </span></p><p style="margin-top:1.55pt;margin-right:207.95pt;margin-left:16.15pt;line-height:13.35pt;letter-spacing:0in">E.2<span style="xfa-spacerun:yes">     </span>Edifici adibiti a residenze collettive, a uffici e assimilabili:</p><p style="margin-right:207.95pt;margin-left:16.15pt;line-height:12pt;letter-spacing:0in">E.3<span style="xfa-spacerun:yes">     </span>Edifici adibiti a ospedali, cliniche o case di cura e assimilabili:</p><p style="margin-top:1.15pt;margin-right:164.55pt;margin-left:16.15pt;line-height:13.35pt;letter-spacing:0in">E.4<span style="xfa-spacerun:yes">     </span>Edifici adibiti ad attività ricreative, associative o di culto e assimilabili:<span style="xfa-spacerun:yes"> </span></p><p style="margin-top:1.15pt;margin-right:164.55pt;margin-left:16.15pt;line-height:13.35pt;letter-spacing:0in">E.5<span style="xfa-spacerun:yes">     </span>Edifici adibiti ad attività commerciali e assimilabili:</p><p style="margin-right:164.55pt;margin-left:16.15pt;line-height:10.25pt;letter-spacing:0in">E.6<span style="xfa-spacerun:yes">     </span>Edifici adibiti ad attività sportive:</p><p style="margin-top:1.15pt;margin-right:190.65pt;margin-left:16.15pt;line-height:13.35pt;letter-spacing:0in">E.7<span style="xfa-spacerun:yes">     </span>Edifici adibiti ad attività scolastiche a tutti i livelli e assimilabili;<span style="xfa-spacerun:yes"> </span></p><p style="margin-top:1.15pt;margin-right:190.65pt;margin-left:16.15pt;line-height:13.35pt;letter-spacing:0in">E.8<span style="xfa-spacerun:yes">     </span>Edifici adibiti ad attività industriali ed artigianali e assimilabili.</p><p style="margin-right:190.65pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">.</p><p style="margin-right:190.65pt;margin-left:2pt;line-height:11.1pt;letter-spacing:0in">Sezione 1.3</p><p style="margin-top:3.35pt;margin-right:2.8pt;margin-left:2pt;line-height:13.3pt;text-decoration:underline;letter-spacing:0in">Potenza utile:<span style="text-decoration:none"> annotare la potenza massima resa per ciascun servizio; in caso di più generatori annotare il valore più alto fra quelli ottenibili sommando le potenze massime rese dei generatori che possono funzionare contemporaneamente; in caso di generatori che funzionano l’uno in sostituzione dell’altro considerare solo quello avente la potenza utile più elevata.</span></p><p style="margin-top:0.25pt;margin-right:0pt;margin-left:0pt;line-height:6pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-right:0pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">Sezione 1.5</p><p style="margin-top:3.35pt;margin-right:0pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">Nel caso di impianti con più generatori di tipologie diverse è possibile selezionare più campi.</p><p style="margin-top:0.35pt;margin-right:0pt;margin-left:0pt;line-height:7pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-right:0pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">Sezione 1.6</p><p style="margin-top:3.25pt;margin-right:0pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">Se persona fisica compilare<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Cognome Nome</span> e<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Codice Fiscale</span>, se persona giuridica compilare anche<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Ragione Sociale</span> e<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">P.IVA</span>.</p><p style="margin-right:0pt;margin-left:2pt;line-height:12pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <font size="7pt" typeface="Verdana" baselineShift="0pt">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                  <para spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="8.504pt" marginRight="8.504pt"/>
                  <keep intact="none"/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="scheda3[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle7" w="200.398mm" h="4.449mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <breakBefore targetType="pageArea" startNew="1"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="Text1[0]"/>
               </traversal>
            </subform>
            <subform name="scheda3" w="197.365mm" layout="tb">
               <bind match="none"/>
               <draw h="0.406028in" name="Text1" w="7.770278in">
                  <border>
                     <corner presence="hidden" thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <linear type="toTop">
                           <color value="192,192,192"/>
                        </linear>
                     </fill>
                  </border>
                  <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                  <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                  <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>SCHEDA 3</text>
                  </value>
                  <keep intact="none"/>
                  <traversal>
                     <traverse ref="Text95[0]"/>
                  </traversal>
               </draw>
               <draw name="Text95" w="197.365mm" h="7.682mm">
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="text-decoration:none;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="text-decoration:none;letter-spacing:0in">Se persona fisica compilare<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Cognome Nome</span> e<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Codice Fiscale</span>, se persona giuridica compilare anche<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Ragione Sociale</span> e<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">P.IVA</span>.</p></body>
                     </exData>
                  </value>
                  <font size="7pt" typeface="Verdana" baselineShift="0pt">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                  <para spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <keep intact="none"/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="scheda4[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle7" w="200.398mm" h="4.449mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <breakBefore/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="Text1[0]"/>
               </traversal>
            </subform>
            <subform name="scheda4" w="197.365mm" layout="tb">
               <bind match="none"/>
               <draw h="0.406028in" name="Text1" w="7.770278in">
                  <border>
                     <corner presence="hidden" thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <linear type="toTop">
                           <color value="192,192,192"/>
                        </linear>
                     </fill>
                  </border>
                  <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                  <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                  <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>SCHEDA 4</text>
                  </value>
                  <keep intact="none"/>
                  <traversal>
                     <traverse ref="Text95[0]"/>
                  </traversal>
               </draw>
               <draw name="Text95" w="7.770278in" h="74.042mm">
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="margin-left:2pt;line-height:11.1pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-left:2pt;line-height:11.1pt;letter-spacing:0in">Sezione 4.1</p><p style="margin-top:1.25pt;margin-left:23.65pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Su<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Combustibile</span> specificare: gas naturale, GPL, gasolio, olio combustibile, pellet, legna, etc.</p><p style="margin-top:1.15pt;margin-left:23.65pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Su<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Fluido Termovettore</span> specificare: acqua calda, acqua surriscaldata, vapore, aria, olio diatermico,etc.</p><p style="margin-top:0.35pt;line-height:7pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-left:5.65pt;line-height:12pt;letter-spacing:0in">Sezione 4.2</p><p style="margin-top:3.35pt;margin-left:5.65pt;line-height:12pt;letter-spacing:0in">Su<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Combustibile</span> specificare: gas naturale, GPL, gasolio, olio combustibile, pellet, legna, etc.</p><p style="margin-top:0.55pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">Sezione 4.4</p><p style="margin-top:0.55pt;margin-left:2pt;line-height:12pt;letter-spacing:0in"><span style="xfa-spacerun:yes">       </span>•<span style="xfa-spacerun:yes">    </span>La voce<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Ad assorbimento per recupero di calore</span> deve essere barrata anche nel caso di recupero dai fumi di impianti di cogenerazione</p><p style="margin-right:10.95pt;margin-left:20pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Su<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">GUE</span> indicare i valori nominali come da UNI EN 12309-2.</p><p style="margin-top:1.15pt;margin-right:10.95pt;margin-left:20pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Su<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Rendimento</span> e<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Potenza assorbita nominale</span> indicare dati da progetto o schede tecniche macchina come da</p><p style="margin-top:1.15pt;margin-right:10.95pt;margin-left:38pt;line-height:12pt;letter-spacing:0in">UNI EN 14511.</p><p style="margin-top:1.15pt;margin-right:10.95pt;margin-left:20pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Su<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">EER</span> e<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">COP</span> indicare i valori nominali come da UNI EN 14511. Qualora i dati non fossero disponibili indicare ND.</p><p style="margin-top:1.15pt;margin-right:10.95pt;margin-left:20pt;line-height:12pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-top:0.55pt;margin-right:10.95pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">Sezione 4.5</p><p style="margin-top:0.8pt;margin-right:10.95pt;margin-left:2pt;line-height:12pt;letter-spacing:0in">Per potenza termica nominale totale si intende quella verificata con lettura sul contatore</p><p style="margin-top:0.8pt;margin-right:10.95pt;margin-left:2pt;line-height:12pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <font size="7pt" typeface="Verdana" baselineShift="0pt">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                  <para spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <keep intact="none"/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="scheda5[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle7" w="200.398mm" h="4.449mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <breakBefore/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="Text1[0]"/>
               </traversal>
            </subform>
            <subform name="scheda5" w="197.365mm" layout="tb">
               <bind match="none"/>
               <draw h="0.406028in" name="Text1" w="7.770278in">
                  <border>
                     <corner presence="hidden" thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <linear type="toTop">
                           <color value="192,192,192"/>
                        </linear>
                     </fill>
                  </border>
                  <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                  <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                  <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>SCHEDA 5</text>
                  </value>
                  <keep intact="none"/>
                  <traversal>
                     <traverse ref="Text95[0]"/>
                  </traversal>
               </draw>
               <draw name="Text95" w="197.365mm" h="15.161mm">
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="margin-left:2pt;line-height:11.1pt;letter-spacing:0in">Paragrafo 5.1</p><p style="margin-top:1.35pt;margin-left:10pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Nel caso di sistemi integrati nel generatore compilare solamente i campi: “Numero punti di regolazione” e “Numero livelli di temperatura”.</p><p style="margin-top:1.15pt;margin-left:10pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span><span style="text-decoration:underline">Altri sistemi di regolazione primaria</span>: riportare descrizione del sistema, fabbricanti, modelli, etc.</p></body>
                     </exData>
                  </value>
                  <font size="7pt" typeface="Verdana" baselineShift="0pt">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                  <para spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <keep intact="none"/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
               </draw>
               <draw name="Rectangle7" w="200.398mm" h="0.809mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <breakBefore/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="Text1[0]"/>
               </traversal>
            </subform>
            <subform name="scheda9" w="197.365mm" layout="tb">
               <bind match="none"/>
               <draw h="0.406028in" name="Text1" w="7.770278in">
                  <border>
                     <corner presence="hidden" thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <linear type="toTop">
                           <color value="192,192,192"/>
                        </linear>
                     </fill>
                  </border>
                  <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                  <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                  <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>SCHEDA 9</text>
                  </value>
                  <keep intact="none"/>
                  <traversal>
                     <traverse ref="Text95[0]"/>
                  </traversal>
               </draw>
               <draw name="Text95" w="7.770278in" h="25.679mm">
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/"><p style="line-height:11.1pt"><span style="xfa-spacerun:yes"> </span></p><p style="line-height:11.1pt">Sezione 9.1</p><p style="margin-top:0.8pt;line-height:12pt;text-decoration:underline">Tipo ventilatori<span style="text-decoration:none"> indicare assiali, centrifughi, etc.</span></p><p style="margin-top:0.55pt;line-height:12pt">Sezione 9.2</p><p style="margin-top:0.8pt;line-height:12pt;text-decoration:underline">Tipo ventilatori<span style="text-decoration:none"> indicare assiali, centrifughi, etc.</span></p><p style="margin-top:0.8pt;line-height:12pt"><span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <font size="7pt" typeface="Verdana" baselineShift="0pt">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                  <para spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2pt" marginRight="8.504pt"/>
                  <keep intact="none"/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="scheda11[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle7" w="200.398mm" h="4.449mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <breakBefore targetType="pageArea" startNew="1"/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="Text1[0]"/>
               </traversal>
            </subform>
            <subform name="scheda11" w="197.365mm" layout="tb">
               <bind match="none"/>
               <draw h="0.406028in" name="Text1" w="7.770278in">
                  <border>
                     <corner presence="hidden" thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <linear type="toTop">
                           <color value="192,192,192"/>
                        </linear>
                     </fill>
                  </border>
                  <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                  <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                  <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>SCHEDA 11</text>
                  </value>
                  <keep intact="none"/>
                  <traversal>
                     <traverse ref="Text95[0]"/>
                  </traversal>
               </draw>
               <draw name="Text95" w="7.770278in" h="125.362mm">
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="margin-left:2pt;line-height:11.1pt;text-decoration:none;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-left:2pt;line-height:11.1pt;text-decoration:none;letter-spacing:0in">Sezione 11.1</p><p style="margin-top:1.35pt;margin-right:10.4pt;margin-left:28pt;line-height:13.35pt;text-decoration:none;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Su<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Temperatura fumi</span><span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Temperatura aria comburente</span>,<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">O2</span> oppure<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">CO2</span><span style="xfa-spacerun:yes">  </span>e<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">CO nei fumi secchi</span> riportare la media di tre misurazioni significative.</p><p style="margin-right:19.5pt;margin-left:28pt;line-height:13.2pt;text-decoration:none;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Compilare in alternativa il campo O2 o CO2 a seconda del parametro di cui è stata effettivamente misurata la concentrazione.</p><p style="margin-top:0.15pt;margin-right:19.5pt;margin-left:10pt;line-height:12pt;text-decoration:none;letter-spacing:0in"><span style="xfa-spacerun:yes">       </span>•<span style="xfa-spacerun:yes">    </span>Il valore<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Indice di Bacharach</span> e la rispettiva verifica vanno riportati solo per i combustibili liquidi</p><p style="margin-top:1.05pt;margin-right:19.5pt;margin-left:10pt;line-height:12pt;text-decoration:none;letter-spacing:0in"><span style="xfa-spacerun:yes">       </span>•<span style="xfa-spacerun:yes">    </span>Su<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">Rendimento di combustione</span> il dato ηc è il valore calcolato</p><p style="margin-top:0.55pt;margin-right:19.5pt;margin-left:2pt;line-height:12pt;text-decoration:none;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-top:0.55pt;margin-right:19.5pt;margin-left:2pt;line-height:12pt;text-decoration:none;letter-spacing:0in">Sezione 11.2</p><p style="margin-top:3.35pt;margin-right:19.35pt;margin-left:38pt;line-height:13.3pt;text-decoration:none;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Macchine frigorifere / pompe di calore con ciclo reversibile: se la prima verifica effettuata a cura dell’installatore è avvenuta con funzionamento in modalità“riscaldamento, tutte le verifiche periodiche dovranno essere effettuate in modalità “riscaldamento; se è avvenuta in modalità “raffrescamento”, tutte le successive verifiche periodiche dovranno essere effettuate in modalità “raffrescamento”.</p><p style="margin-top:0.05pt;margin-right:5.75pt;margin-left:38pt;line-height:13.35pt;text-decoration:none;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Riportare l'esito “Assenza perdite di refrigerante” qualora già presente sul “Registro dell’Apparecchiatura” prescritto da DPR 43/2012, art.15.1 e 15.3 per applicazioni fisse di refrigerazione, condizionamento d'aria e pompe di calore, contenenti 3 kg o più di gas fluorurati ad effetto serra e da D.Lgs. 26/2013, art.3 commi 4, 5, 6. In caso contrario la verifica va effettuata.</p><p style="margin-right:4.65pt;margin-left:38pt;line-height:13.3pt;text-decoration:none;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>“Surriscaldamento” è la differenza fra la temperatura del fluido frigorigeno rilevata all’ingresso del compressore (tubazione di aspirazione) e la temperatura manometrica di evaporazione; “Sottoraffreddamento” è la differenza fra la temperatura manometrica di condensazione e la temperatura del fluido frigorigeno liquido all’uscita del condensatore; la combinazione di questi due parametri costituisce una rilevazione indiretta di eventuali fughe del fluido frigorigeno.</p><p style="margin-top:0.05pt;margin-right:3.1pt;margin-left:38pt;line-height:13.3pt;text-decoration:none;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>“Temperatura di condensazione” e “Temperatura di evaporazione” sono le temperature manometriche rispettivamente del lato alta pressione e del lato bassa pressione del circuito frigorifero. Se non vengono rilevate con strumentazione fissa a bordo macchina, possono essere rilevate soltanto da personale qualificato e iscritto al “Registro nazionale delle persone e delle imprese certificate” istituito dal Ministero Ambiente e gestito dalle Camere di commercio come da DPR 43/2012, art.8 e 13, in conformità al al Regolamento (CE) n°</p><p style="margin-top:0.05pt;margin-right:3.1pt;margin-left:38pt;line-height:12pt;text-decoration:none;letter-spacing:0in">842/2006 e conseguente Regolamento (CE) n° 303/2008.</p><p style="margin-top:1.15pt;margin-right:8.9pt;margin-left:38pt;line-height:13.35pt;text-decoration:none;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Temperature di ingresso e di uscita fluido lato esterno: se aria, in modalità riscaldamento, mettere la temperatura di bulbo umido; lato utenze: se aria, in modalità raffrescamento, mettere la temperatura di bulbo umido.</p><p style="margin-right:8.9pt;margin-left:20pt;line-height:12pt;text-decoration:none;letter-spacing:0in"><span style="xfa-spacerun:yes">       </span>•<span style="xfa-spacerun:yes">    </span>Verifica pulizia filtri: si intendono i filtri sui circuiti aeraulici che servono le utenze.</p><p style="margin-right:8.9pt;margin-left:20pt;line-height:12pt;text-decoration:none;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <font size="7pt" typeface="Verdana" baselineShift="0pt">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                  <para spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="0pt" marginRight="0pt"/>
                  <keep intact="none"/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
                  <traversal>
                     <traverse ref="scheda14[0]"/>
                  </traversal>
               </draw>
               <draw name="Rectangle7" w="200.398mm" h="4.449mm">
                  <value>
                     <rectangle>
                        <edge presence="hidden"/>
                        <corner radius="5.08mm" presence="hidden"/>
                     </rectangle>
                  </value>
               </draw>
               <breakBefore/>
               <?templateDesigner expand 1?>
               <traversal>
                  <traverse operation="first" ref="Text1[0]"/>
               </traversal>
            </subform>
            <subform name="scheda14" w="197.365mm" layout="tb">
               <bind match="none"/>
               <draw h="0.406028in" name="Text1" w="7.770278in">
                  <border>
                     <corner presence="hidden" thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                     <edge presence="hidden">
                        <color value="192,192,192"/>
                     </edge>
                     <fill>
                        <linear type="toTop">
                           <color value="192,192,192"/>
                        </linear>
                     </fill>
                  </border>
                  <font typeface="Verdana" baselineShift="0pt" weight="bold"/>
                  <margin bottomInset="0.5mm" leftInset="0mm" rightInset="0mm" topInset="0.5mm"/>
                  <para marginLeft="0pt" marginRight="0pt" spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" hAlign="center" vAlign="middle"/>
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <text>SCHEDA 14</text>
                  </value>
                  <keep intact="none"/>
                  <traversal>
                     <traverse ref="Text95[0]"/>
                  </traversal>
               </draw>
               <draw name="Text95" w="7.770278in" h="64.501mm">
                  <ui>
                     <textEdit/>
                  </ui>
                  <value>
                     <exData contentType="text/html">
                        <body xmlns="http://www.w3.org/1999/xhtml" xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" xfa:APIVersion="2.7.0.0"><p style="line-height:8.95pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="line-height:8.95pt;letter-spacing:0in">Le tabelle dei consumi vanno compilate solamente in presenza di misuratori dedicati al solo impianto termico.</p><p style="line-height:12pt;text-decoration:underline;letter-spacing:0in">Esercizio<span style="text-decoration:none">: indicare la stagione di riscaldamento / raffrescamento.</span></p><p style="margin-top:0.55pt;margin-left:5.65pt;line-height:12pt;letter-spacing:0in">Sezione 14.1</p><p style="margin-top:3.35pt;margin-left:23.65pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span>Va redatta una scheda per ogni combustibile.</p><p style="margin-top:1.15pt;margin-left:23.65pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">    </span><span style="text-decoration:underline">Esercizio</span>: va indicata la stagione di riscaldamento<span style="xfa-spacerun:yes"> </span></p><p style="margin-top:1.15pt;margin-left:23.65pt;line-height:12pt;letter-spacing:0in">•<span style="xfa-spacerun:yes">     </span>Per i<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">combustibili liquidi</span> quantificare in base agli approvvigionamenti effettuati ed alle letture di livello del combustibile nei serbatoi.</p><p style="margin-right:19.85pt;margin-left:41.65pt;line-height:10.25pt;letter-spacing:0in">Per i<span style="xfa-spacerun:yes"> </span><span style="text-decoration:underline">combustibili gassosi</span> indicare le letture effettive del contatore (quando questo esista). Indicare accanto al</p><p style="margin-top:1.15pt;margin-right:2.75pt;margin-left:41.65pt;line-height:13.35pt;letter-spacing:0in">numero l’unità di misura: per esempio m<span style="vertical-align:2.5pt">3<span style="xfa-spacerun:yes"> </span></span>per gas naturale, kg oppure l per GPL e combustibili liquidi, kg per i combustibili solidi, kWh per teleriscaldamento / teleraffrescamento.</p><p style="margin-top:0.2pt;margin-right:0pt;margin-left:0pt;line-height:6pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p><p style="margin-right:0pt;margin-left:5.65pt;line-height:12pt;letter-spacing:0in">Sezione 14.4</p><p style="margin-top:3.35pt;margin-right:0pt;margin-left:5.65pt;line-height:12pt;letter-spacing:0in">In questa scheda si indicano i quantitativi di sale per il trattamento anticalcare dell’acs, i quantitativi di prodotti anticorrosivi, etc.</p><p style="margin-right:0pt;line-height:12pt;letter-spacing:0in"><span style="xfa-spacerun:yes"> </span></p></body>
                     </exData>
                  </value>
                  <font size="7pt" typeface="Verdana" baselineShift="0pt">
                     <fill>
                        <color value="128,128,128"/>
                     </fill>
                  </font>
                  <margin topInset="0.5mm" bottomInset="0.5mm" leftInset="0.5mm" rightInset="0.5mm"/>
                  <para spaceAbove="0pt" spaceBelow="0pt" textIndent="0pt" marginLeft="2pt" marginRight="8.504pt"/>
                  <keep intact="none"/>
                  <border>
                     <edge>
                        <color value="192,192,192"/>
                     </edge>
                     <corner thickness="0.176mm">
                        <color value="192,192,192"/>
                     </corner>
                  </border>
               </draw>
               <breakBefore/>
               <?templateDesigner expand 0?>
               <traversal>
                  <traverse operation="first" ref="Text1[0]"/>
               </traversal>
            </subform>
            <?templateDesigner expand 0?>
            <traversal>
               <traverse operation="first" ref="scheda9[0]"/>
            </traversal>
         </subform>
         <breakBefore/>
         <traversal>
            <traverse operation="first" ref="schedaGeneratori4_1[0].generatori[0].rowGT[0].datiGT[0].RendimentoTermico[0]"/>
         </traversal>
         <?templateDesigner expand 1?></subform>
      <variables>
         <script contentType="application/x-javascript" name="XMLDatasetUtils">/*
 * XML DATA function:
 * - readValue (dataXPath)
 * - setDataXPathValue (toDataXPath, fromDataXPaths[])
 */
function readValue(dataXPath)
{
	var valore = null;
	try{
		var node = readXmlNode(dataXPath);
		valore = node.value;
	}catch(e){ 
		//xfa.host.messageBox("Errore readValue at "+dataXPath+'\n'+ e);
	}
	return valore;
}

function readXmlNode(dataXPath)
{
	return xfa.datasets.data.resolveNode(dataXPath);	
}


function setDataXPathValue(toDataXPath, fromDataXPath)
{
	var fromDataXPaths = [fromDataXPath];
	setDataXPathValues(toDataXPath, fromDataXPaths, false, "");	
}

function setDataXPathValues(toDataXPath, fromDataXPaths, trim, separator)
{
	var node = readXmlNode(toDataXPath);	

	if(node != null) {
		var valori = "";
		var nDataXPathLength = fromDataXPaths.length;
		for (var nCount = 0; nCount &lt; nDataXPathLength ; nCount ++) {
			var valore = readValue(fromDataXPaths[nCount]);
			if (valore != null) {
				valori= valori+ separator + valore;
			}
		}

		if(trim){
			valori= valori.trim();	
		}
		
		node.value = valori;	
	}
}
/*
 * String function:
 * - trim
 * - ltrim 
 * - rtrim 
 * - contains
 * - tokenize(string separator, string trim, boolean ignoreEmptyTokens)
 */
String.prototype.trim = function() {
    return this.replace(/^\s+|\s+$/g,"");
}
String.prototype.ltrim = function() {
    return this.replace(/^\s+/,"");
}
String.prototype.rtrim = function() {
    return this.replace(/\s+$/,"");
}
String.prototype.contains = function(s) { 
return this.indexOf(s) != -1; 
}

String.prototype.tokenize = tokenize;
function tokenize()
{
    var input             = "";
    var separator         = " ";
    var trim              = "";
    var ignoreEmptyTokens = true;
    try {
       String(this.toLowerCase());
    }
    catch(e) {
       xfa.host.messageBox("Tokenizer Usage: string myTokens[] = myString.tokenize(string separator, string trim, boolean ignoreEmptyTokens);");
       return;
    }

    if(typeof(this) != "undefined")
    {
	input = String(this);
    }

    if(typeof(tokenize.arguments[0]) != "undefined")
    {
	separator = String(tokenize.arguments[0]);
    }

    if(typeof(tokenize.arguments[1]) != "undefined")
    {
	trim = String(tokenize.arguments[1]);
    }

    if(typeof(tokenize.arguments[2]) != "undefined")
    {
    	if(!tokenize.arguments[2])
	    ignoreEmptyTokens = false;
    }

    var array = input.split(separator);

    if(trim){
       for(var i=0; i&lt;array.length; i++)
       {
           while(array[i].slice(0, trim.length) == trim){
             array[i] = array[i].slice(trim.length);
	   }
           
	   while(array[i].slice(array[i].length-trim.length) == trim)
           {
             array[i] = array[i].slice(0, array[i].length-trim.length);
	   }
       }
     }
     var token = new Array();
     if(ignoreEmptyTokens)
     {
          for(var i=0; i&lt;array.length; i++)
            if(array[i] != "")
              token.push(array[i]);
     }
     else
     {
          token = array;
     }
     return token;
}
</script>
         <script contentType="application/x-javascript" name="controlli">
//var fullPathValidationField = "Richiesta.formValido";
var editableField = Richiesta.statoModulo;
 

function validationError (oField,messageSuffix,VALIDATION_FAIL_MSG,tipoVerifica,oValidationField) 
{
/*	//xfa.host.messageBox("oValidationField"+oValidationField.name);
	//error				
	var COLOR_ERROR_BORDER = "255,0,0";
	var SIZE_ERROR_BORDER = "0.0250in";
	//correct
	var COLOR_BORDER = "24,240,120";
	var SIZE_BORDER = "0.0069in";	

	if (tipoVerifica == "ERR" &amp;&amp; editableField.rawValue != "DEFINITIVO"){
		//flag error
		
		//oField.rawValue = "";
		oField.border.edge.presence = "visible";
		oField.borderColor = COLOR_ERROR_BORDER;
		oField.borderWidth = SIZE_ERROR_BORDER;
		
		if (messageSuffix.rawValue != null) {
			xfa.host.messageBox(messageSuffix);
		}	
		oField.assist.speak = ""+VALIDATION_FAIL_MSG;
	//xfa.host.messageBox("oField.name: "+oField.name);

		fail(oValidationField,oField.assist.toolTip.value,messageSuffix);

	}else { 
		
		oField.border.edge.presence = "invisible";
		//oField.borderColor = COLOR_BORDER;
		//this.borderWidth = SIZE_BORDER;
		oField.assist.speak = "";	
	}*/
}

function run(oCheckValidi,oCheckValidiParz){
	clean(oCheckValidi,oCheckValidiParz);
/*	//xfa.host.messageBox("oCheckValidi"+oCheckValidi.rawValue);
	try{
		for (var nPageCount = 0; nPageCount &lt; xfa.host.numPages; nPageCount++) {
			var oFields = xfa.layout.pageContent(nPageCount, "field");
			var nNodesLength = oFields.length;
			for (var nNodeCount = 0; nNodeCount &lt; nNodesLength; nNodeCount++) {
			
				var vFieldVisible = oFields.item(nNodeCount).presence;
				var vFieldAccess = oFields.item(nNodeCount).access;
				
				if ( vFieldVisible == "visible" &amp;&amp; vFieldAccess != "protected") {
					oFields.item(nNodeCount).execValidate();
					//oFields.item(nNodeCount).execEvent("enter"); 
				}
			}
		}
	}catch (e) {
		xfa.host.messageBox("Errore on validate :"+e);
	}*/
}

function fail(oCheckValidi,oFieldName,sVALIDATION_FAIL_MSG){
	//var fCheckValidi = xfa.resolveNode(fullPathValidationField);
	VAL_FAIL_MSG.value += "; ["+oFieldName + "- "+sVALIDATION_FAIL_MSG +"] ";
	oCheckValidi.rawValue = 1;
}

function isOk(oCheckValidi){
	//var fCheckValidi = xfa.resolveNode(fullPathValidationField);
	//return fCheckValidi.rawValue == 0;
	return oCheckValidi.rawValue == 0; }

function clean(oCheckValidi,oCheckValidiParz){
	//var fCheckValidi = xfa.resolveNode(fullPathValidationField);
	//fCheckValidi.rawValue = 0;
	oCheckValidiParz.rawValue = 0;
	oCheckValidi.rawValue = 0;
}
</script>
         <script contentType="application/x-javascript" name="Vars">
// enable javascript alert for debugging
var DEBUG = false;
//xfa.host.messageBox ();

// messaggio errore di validazione 
//var VALIDATION_FAIL_MSG = "La validazione ha dato esito negativo."+'\n'
//	+"Compilare correttamente i campi evidenziati in rosso prima di poter continuare.";



</script>
         <script contentType="application/x-javascript" name="regExp">
//Valida formato date  DD/MM/YYYY
function checkDateFormat(editValue) {
	return /(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20|21)\d\d/.test(editValue);
}


//accetta solo un numero (compreso lo zero) senza caratteri separatori
function demoMatchClick(sField) {

	var vValue = sField.rawValue;
	var vName = sField.name;
	var vMessageSuffix = "";
	//var VALIDATION_MSG = "Errore!"+'\n'
	//				+"Consentiti solo numeri.";
					
	var sObj = sField.parent.name+"[*]."+ sField.name;
	var oField = xfa.resolveNode(sObj);			
	var re = new RegExp("^[0-9][0-9]*$");
	if (vValue.match(re)) {
	  //xfa.host.messageBox("Successful match");
	  if ( (vValue.length != 5 &amp;&amp; vName == "CAP") ){
	     var VALIDATION_MSG = "Errore!"+'\n'+"Lunghezza non valida.";	  
	     controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
	  } else {   
	  	 controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
	  }	  	
	} else {
	  //xfa.host.messageBox("No match");
	  var VALIDATION_MSG = "Errore!"+'\n'
					+"Consentiti solo numeri.";	  
	  controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
	}
}


 
//accetta solo LETTERE(maiuscole o minuscole) senza caratteri separatori
function demoMatchClickLett(sField) {

	var vValue = sField.rawValue;
	var vName = sField.name;
	var vMessageSuffix = "";
	//var VALIDATION_MSG = "Errore!"+'\n'
	//				+"Consentiti solo lettere.";
					
	var sObj = sField.parent.name+"[*]."+ sField.name;
	var oField = xfa.resolveNode(sObj);			
	var re = new RegExp("^[a-zA-Z]*$");
	if (vValue.match(re)) {
	  //xfa.host.messageBox("Successful match");
	  if ( (vValue.length &lt; 2  ) ){
	     var VALIDATION_MSG = "Errore!"+'\n'+"Lunghezza non valida.";	  
	     controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
	  } else {   
	  	 controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
	  }	  	
	} else {
	  //xfa.host.messageBox("No match");
	  var VALIDATION_MSG = "Errore!"+'\n'
					+"Consentiti solo lettere.";	  
	  controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
	}
}


var patternEmail = "^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})$";

function matchEMAIL(sValue,sField) {

	var vValue = sValue;
	var vMessageSuffix = "";
	var VALIDATION_MSG = "Errore!"+'\n'
					+"Indirizzo/i email non valido/i.";
					
	var sObj = sField.parent.name+"[*]."+ sField.name;
	var oField = xfa.resolveNode(sObj);			
	var re = new RegExp(patternEmail,"g");
	if (vValue.match(re)) {
	  //xfa.host.messageBox("Successful match");
	  controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"CORR");
	} else {
	  //xfa.host.messageBox("No match");
	  controlli.validationError(oField,vMessageSuffix,VALIDATION_MSG,"ERR");
	}
}
</script>
         <manifest name="MOD" id="8fdaf5b1-84ae-4a2d-b908-6b3f60ac7f6a">
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].cf[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].cognome[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].nome[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].comuneNascita[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].dataNascita[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].comuneResidenza[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].provResidenza[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].indirizzo[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].cap[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].anag[0].mail[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].flagCittadinanza[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].flagCittadinanza2[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].flagCittadinanza3[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].documenti[0].flagPermessoSogg[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].documenti[0].flagStatusRifugiato[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].documenti[0].flagStatusProtezione[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].documenti[0].flagStatoEU[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].documenti[0].statoEU[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].dichiarazioni[0].flagPA[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].allegaDocs[0].Salvataggio[0].documentiAllegati[0].tipoDocumentiAllegati[0].tipoDocumento[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].titoloStudio[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].dataTitoloStudio[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].nomeIstituto[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].comuneIstituto[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagInglese[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagFrancese[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagSi[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagNo[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].ausilii[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagAusiliiSi[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagAusiliiNo[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagDirittoDPR487[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].motivazione[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].numFigliCarico[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagDirittoPostoArt18[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].flagDirittoPostoLegge68[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].dataPagTassa[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].altriDati[0].numRicevutaTassa[0].dataNode</ref>
            <ref>xfa[0].form[0].MOD[0].Richiesta[0].allegaDocs[0].Salvataggio[0].documentiAllegati[0].tipoDocumentiAllegati[0].nomeDocumento[0].dataNode</ref>
         </manifest>
         <script contentType="application/x-javascript" name="Focus">
// riferimento a lastFocusField
var lastFocusREF = "Richiesta.lastFocus";

// se lastFocus non impostato (isNull) esegue il set
function init(){
	try{
		if(xfa.resolveNode(lastFocusREF).isNull){
			save();
		}
	}catch(e){
		xfa.host.messageBox(this.somExpression+"::init - errore "+e);
	}
}

// imposta lastFocus
function save(){
	try{
		var oFieldFocus = xfa.host.getFocus();
		if(oFieldFocus != null){
			var currentFocusREF = oFieldFocus.somExpression;
			if(currentFocusREF.indexOf(".righeDiBudget[") != -1 ){
				var lastFocusField = xfa.resolveNode(lastFocusREF);
				lastFocusField.rawValue = currentFocusREF;
				// set rawValue lost focus?!?!?
				//xfa.host.setFocus(oFieldFocus);
			}
		}
	}catch(e){
		xfa.host.messageBox(this.somExpression+"::save - errore "+e);
	}
}

function set(){
	try{
		var lastFocusField = xfa.resolveNode(lastFocusREF);
		if(!lastFocusField.isNull){
			xfa.host.setFocus(lastFocusField.rawValue);
			//lastFocusField.rawValue = null;
		}
	}catch(e){
		xfa.host.messageBox(this.somExpression+"::set - errore "+e);
	}
}

function evidenziaPassaggioMouse(oParam,oField,oColor,oUnderline){
	try{
		if (oParam == "enter"){
			// set caption to red ("255,0,0") and underlined (1)
			oField.caption.font.underline = oUnderline; 
			oField.caption.font.fill.color.value = oColor; 
		}else if (oParam == "exit"){
			// set caption to black ("0,0,0") and no underline (0)
			oField.caption.font.underline = oUnderline; 
			oField.caption.font.fill.color.value = oColor; 
		}	
	}catch(e){
		xfa.host.messageBox(this.somExpression+"::passaggioMouse - errore "+e);
	}	
}
</script>
         <script contentType="application/x-javascript" name="numerazione">
//"abcdefghilmnopqrstuvz";
var alfabeto = "ilmnopqrstuvz";

	
	function addParagraph(sIndex){

	var cursore = sIndex;
	var radice = "";	

		cursore++;
		

		var letteraCorrente = alfabeto.substring(cursore-1,cursore);

		vValore = radice+letteraCorrente;
		if (cursore == alfabeto.length){
			if (radice==""){
				radice += alfabeto.substring(0,1);
			}else {						
				var cursoreRadice = alfabeto.indexOf(radice);
				radice = alfabeto.substring(cursoreRadice+1,cursoreRadice+2);
			}
			cursore = 0;
		}
		return vValore;
	}
</script>
         <script contentType="application/x-javascript" name="scriptsJS">
function getDataSuccessivaString(vData) 
{
	var adesso = new Date(vData);
	adesso.setDate(adesso.getDate() +1 );
	var dayOfMonth = adesso.getDate()+"";
	if (dayOfMonth.length == 1)
	{
		dayOfMonth = "0"+dayOfMonth;
	}
	var month = (adesso.getMonth()+1)+"";
	if (month.length == 1)
	{
		month = "0"+month;
	}
	var year = adesso.getFullYear()+"";
	var ora = adesso.getHours()+"";	
	if (ora.length == 1)
	{
		ora = "0"+ora;
	}
	var minuti = adesso.getMinutes()+"";
	if (minuti.length == 1)
	{
		minuti = "0"+minuti;
	}
	
	var secondi = adesso.getSeconds()+"";
	if (secondi.length == 1)
	{
		secondi = "0"+secondi;
	}
	 
	var dateString = year+"-"+month+"-"+dayOfMonth;
	//+" - "+ora+":"+minuti+":"+secondi;
	return dateString;
	//printDebug(dateString);
}

 var DEBUG = "false"; 
 function printDebug(message) 
 {
 	if (DEBUG == "true")  
 	{
 		xfa.host.messageBox(message);
 	}
 }
 
function isFieldSigned(oField)
{
	var digSig = event.target.getField(GetFQSOMExp(oField));
	var isSigned = false;
    if (digSig)
	{
		var status = digSig.signatureValidate();
		if (status == 4 || status==3)
		{
    	   printDebug('lo stato della firma : '+status);
 		   isSigned = true;
		}
    }
    return isSigned;
}

function getDataString() 
{
	var adesso = new Date();
	var dayOfMonth = adesso.getDate()+"";
	if (dayOfMonth.length == 1)
	{
		dayOfMonth = "0"+dayOfMonth;
	}
	var month = (adesso.getMonth()+1)+"";
	if (month.length == 1)
	{
		month = "0"+month;
	}
	var year = adesso.getFullYear()+"";
	var ora = adesso.getHours()+"";	
	if (ora.length == 1)
	{
		ora = "0"+ora;
	}
	var minuti = adesso.getMinutes()+"";
	if (minuti.length == 1)
	{
		minuti = "0"+minuti;
	}
	
	var secondi = adesso.getSeconds()+"";
	if (secondi.length == 1)
	{
		secondi = "0"+secondi;
	}
	 
	var dateString = year+"-"+month+"-"+dayOfMonth;
	//+" - "+ora+":"+minuti+":"+secondi;
	return dateString;
	//printDebug(dateString);
}

function getOraString() 
{
	var adesso = new Date();
	var dayOfMonth = adesso.getDate()+"";
	if (dayOfMonth.length == 1)
	{
		dayOfMonth = "0"+dayOfMonth;
	}
	var month = (adesso.getMonth()+1)+"";
	if (month.length == 1)
	{
		month = "0"+month;
	}
	var year = adesso.getFullYear()+"";
	var ora = adesso.getHours()+"";	
	if (ora.length == 1)
	{
		ora = "0"+ora;
	}
	var minuti = adesso.getMinutes()+"";
	if (minuti.length == 1)
	{
		minuti = "0"+minuti;
	}
	
	var secondi = adesso.getSeconds()+"";
	if (secondi.length == 1)
	{
		secondi = "0"+secondi;
	}
	 
	//var dateString = dayOfMonth+"/"+month+"/"+year+" - "+ora+":"+minuti+":"+secondi;
	var dateString =ora+":"+minuti;
	return dateString;
	//printDebug(dateString);
}

// Returns the fully-qualified name for the specified object.
//  This means the name always specifies the index.
//  Therefore, if the name is specified, it's "name[index]".
//  If the name isn't specified, it's "#className[index]".
function GetVerboseFieldName(oNode)
{
  // Unnamed nodes have default names which their class name
  //  ("subform", "field", etc.) with a "#" prefix.
  //  Unfortunately, oNode.name won't return this if the node
  //  doesn't have a specific name. It'll just return an empty
  //  string. Also, oNode.index will be undefined. If it weren't
  //  for oNode.index being undefined in this case, we could've
  //  done something like
  //  SOM = "#" + oNode.className + "[" + oNode.index + "]"

  //  but we'll have to use the somExpression property instead
  //  and extract the name out of it because this will return
  //  the "#" name with the correct index.
  // Since somExpression returns the name and index for the
  //  object in all cases (whether the name is specified or
  //  not), we can use the following syntax in all cases:

  var nPos = oNode.somExpression.lastIndexOf(".");

  // If the field has a name, check to see if it has any periods in its name.
  // If that's the case, they'll be escaped with backslashes and we need to
  //  look for another period.
  if (oNode.name != null &amp;&amp; oNode.name.length &gt; 0)
  {
    while (nPos &gt; 0)
    {
      if (oNode.somExpression.charAt(nPos - 1) == "\\\\")
      {
        // we found an escaped period, keep looking
        nPos = oNode.somExpression.lastIndexOf(".", nPos - 1);
      }
      else
      {
        // stop looking since we have an unescaped period
        break;
      }
    }
  }
 
  if (nPos &gt;= 0)
  {
    // get everything after the last "." to the end
    return oNode.somExpression.substr(nPos + 1);
  }
  else
  {
    // in this case, the SOM expression is a single name (unlikely
    //  but theoretically possible)
    return oNode.somExpression;
  }
}

// Returns the Fully-Qualified SOM Expression for the specified field.
function GetFQSOMExp(oField)
{
  var sFQFieldName = GetVerboseFieldName(oField);
  var oParentNode = oField.parent;

  // The absolute root of the XFA Object Model is the xfa object
  //  which contains a single form object, which then contains
  //  what the Hierarchy palette shows as being the "root
  //  subform" ("form1" by default). So we stop when we reach
  //  xfa.form.
  while (oParentNode != xfa.form)
  {
    sFQFieldName = GetVerboseFieldName(oParentNode) +
      "." + sFQFieldName;
    oParentNode = oParentNode.parent;
  }

  return sFQFieldName;
}
</script>
         <script contentType="application/x-javascript" name="Utils">
function setInterval()
{
 timeout = app.setTimeOut(" xfa.host.messageBox('Attenzione! Sta per scadere la sessione di lavoro. Effettuare almeno un salva in bozza per non perdere il lavoro svolto.', 'Avviso', 1, 0);  ", TIME_OUT.value); 
}


function clearInterval()
{
 if (timeout != null)
 {
  timeout = app.clearInterval(timeout);
 }
}
</script>
         <text name="TIME_OUT">1500000</text>
         <text name="VAL_FAIL_MSG"> La validazione ha dato esito negativo. &#xD;Compilare correttamente i campi evidenziati in rosso prima di poter continuare: </text>
         <?templateDesigner expand 1?></variables>
      <proto/>
      <desc>
         <text name="version">8.2.1.3158.1.475346.466429</text>
      </desc>
      <proto>
         <field name="designer__defaultHyphenation"/>
      </proto>
      <event activity="initialize" name="event__initialize">
         <script contentType="application/x-javascript">
/*var editableField = Richiesta.statoModulo;
 
if (editableField.rawValue == "BOZZA"){
	Utils.setInterval();
}*/
</script>
      </event>
      <?templateDesigner expand 1?>
      <?templateDesigner Hyphenation excludeInitialCap:1, excludeAllCaps:1, wordCharCnt:7, remainCharCnt:3, pushCharCnt:3?>
      <?renderCache.subset "Adobe Pi Std" 0 0 UTF-16 2 8 00350054?>
      <?renderCache.subset "Arial" 0 0 ISO-8859-1 4 4 1 0046c?>
      <?renderCache.subset "Arial" 0 0 UTF-16 2 4 0218?>
      <?renderCache.subset "Arial" 0 1 ISO-8859-1 4 48 12 0003002F004400450048004C005000510052005300550057 Labeimnoprt?>
      <?renderCache.subset "Myriad Pro" 0 0 ISO-8859-1 4 152 38 000100120013001400150016001700180019002300240025002600270028002E0031003400400042004300440045004600470048004A004D004E004F0050005100530054005500560057005B 12345678BCDEFGMPS_abcdefgilmnoprstuvz?>
      <?renderCache.subset "Myriad Pro" 1 0 ISO-8859-1 4 4 1 0059x?>
      <?renderCache.subset "Verdana" 0 0 ISO-8859-1 4 296 76 000300060008000A000B000C000F0010001100120013001400150016001700180019001A001B001C001D001F00200021002400250026002700280029002A002B002C002E002F0030003100320033003400350036003700380039003A003D003E0040004400450046004700480049004A004B004C004E004F0050005100520053005400550056005700580059005B005D006A0083 #%'(),-./0123456789:<=>ABCDEFGHIKLMNOPQRSTUVWZ[]abcdefghiklmnopqrstuvxzà°?>
      <?renderCache.subset "Verdana" 0 0 UTF-16 2 4 01CB?>
      <?renderCache.subset "Verdana" 1 0 ISO-8859-1 4 248 62 0003000A000B000C000E0010001100120013001400150016001700180019001A001B001C001D002400250026002700280029002A002B002C002F0030003100320033003400350036003700380039003B003D004400450046004700480049004A004B004C004F0050005100520053005400550056005700580059005D '()+-./0123456789:ABCDEFGHILMNOPQRSTUVXZabcdefghilmnopqrstuvz?>
      <?renderCache.subset "Verdana" 0 1 ISO-8859-1 4 84 21 00030011002400440045004700480049004A004C004F005000510052005300550056005700580059005D .Aabdefgilmnoprstuvz?></subform>
   <?originalXFAVersion http://www.xfa.org/schema/xfa-template/2.6/?>
   <?templateDesigner SavePDFWithLog 0?>
   <?templateDesigner Grid show:1, snap:1, units:17, color:ff8080, origin:(0,0), interval:(5055,5055)?>
   <?templateDesigner Zoom 127?>
   <?templateDesigner FormTargetVersion 28?>
   <?templateDesigner DefaultLanguage JavaScript?>
   <?templateDesigner DefaultRunAt client?>
   <?acrobat JavaScript strictScoping?>
   <?PDFPrintOptions embedViewerPrefs 0?>
   <?PDFPrintOptions embedPrintOnFormOpen 0?>
   <?PDFPrintOptions scalingPrefs 0?>
   <?PDFPrintOptions enforceScalingPrefs 0?>
   <?PDFPrintOptions paperSource 0?>
   <?PDFPrintOptions duplexMode 0?>
   <?templateDesigner DefaultPreviewType interactive?>
   <?templateDesigner DefaultPreviewPagination simplex?>
   <?templateDesigner XDPPreviewFormat 20?>
   <?templateDesigner DefaultPreviewDataFileName ..\Schemas\showLibretto_221201_versione 2.1.0_dati.xml?>
   <?templateDesigner DefaultCaptionFontSettings face:Myriad Pro;size:10;weight:normal;style:normal?>
   <?templateDesigner DefaultValueFontSettings face:Myriad Pro;size:10;weight:normal;style:normal?>
   <?templateDesigner Rulers horizontal:1, vertical:1, guidelines:1, crosshairs:0?>
   <?templateDesigner SaveTaggedPDF 0?>
   <?templateDesigner SavePDFWithEmbeddedFonts 0?></template>
<config xmlns="http://www.xfa.org/schema/xci/2.8/">
   <agent name="designer">
      <!--  [0..n]  -->
      <destination>pdf</destination>
      <pdf>
         <!--  [0..n]  -->
         <fontInfo/>
      </pdf>
   </agent>
   <present>
      <!--  [0..n]  -->
      <pdf>
         <!--  [0..n]  -->
         <fontInfo>
            <embed>0</embed>
         </fontInfo>
         <tagged>0</tagged>
         <version>1.7</version>
         <adobeExtensionLevel>3</adobeExtensionLevel>
      </pdf>
      <common>
         <data>
            <xsl>
               <uri/>
            </xsl>
            <outputXSL>
               <uri/>
            </outputXSL>
         </data>
      </common>
      <cache>
         <macroCache/>
      </cache>
      <script>
         <runScripts>server</runScripts>
      </script>
      <xdp>
         <packets>*</packets>
      </xdp>
   </present>
   <psMap>
      <font typeface="Berlin Sans FB" psName="BerlinSansFB-Reg" weight="normal" posture="normal"/>
      <font typeface="Calibri" psName="Calibri" weight="normal" posture="normal"/>
      <font typeface="DaunPenh" psName="DaunPenh" weight="normal" posture="normal"/>
      <font typeface="Tw Cen MT" psName="TwCenMT-Bold" weight="bold" posture="normal"/>
      <font typeface="Tw Cen MT" psName="TwCenMT-Regular" weight="normal" posture="normal"/>
   </psMap>
</config>
<localeSet xmlns="http://www.xfa.org/schema/xfa-locale-set/2.7/">
   <locale name="it_IT" desc="Italiano (Italia)">
      <calendarSymbols name="gregorian">
         <monthNames>
            <month>gennaio</month>
            <month>febbraio</month>
            <month>marzo</month>
            <month>aprile</month>
            <month>maggio</month>
            <month>giugno</month>
            <month>luglio</month>
            <month>agosto</month>
            <month>settembre</month>
            <month>ottobre</month>
            <month>novembre</month>
            <month>dicembre</month>
         </monthNames>
         <monthNames abbr="1">
            <month>gen</month>
            <month>feb</month>
            <month>mar</month>
            <month>apr</month>
            <month>mag</month>
            <month>giu</month>
            <month>lug</month>
            <month>ago</month>
            <month>set</month>
            <month>ott</month>
            <month>nov</month>
            <month>dic</month>
         </monthNames>
         <dayNames>
            <day>domenica</day>
            <day>lunedì</day>
            <day>martedì</day>
            <day>mercoledì</day>
            <day>giovedì</day>
            <day>venerdì</day>
            <day>sabato</day>
         </dayNames>
         <dayNames abbr="1">
            <day>dom</day>
            <day>lun</day>
            <day>mar</day>
            <day>mer</day>
            <day>gio</day>
            <day>ven</day>
            <day>sab</day>
         </dayNames>
         <meridiemNames>
            <meridiem>AM</meridiem>
            <meridiem>PM</meridiem>
         </meridiemNames>
         <eraNames>
            <era>aC</era>
            <era>dC</era>
         </eraNames>
      </calendarSymbols>
      <datePatterns>
         <datePattern name="full">EEEE D MMMM YYYY</datePattern>
         <datePattern name="long">DD MMMM YYYY</datePattern>
         <datePattern name="med">DD/MMM/YY</datePattern>
         <datePattern name="short">DD/MM/YY</datePattern>
      </datePatterns>
      <timePatterns>
         <timePattern name="full">HH:MM:SS Z</timePattern>
         <timePattern name="long">H:MM:SS Z</timePattern>
         <timePattern name="med">HH:MM:SS</timePattern>
         <timePattern name="short">HH:MM</timePattern>
      </timePatterns>
      <dateTimeSymbols>GyMdkHmsSEDFwWahKzZ</dateTimeSymbols>
      <numberPatterns>
         <numberPattern name="numeric">z,zz9.zzz</numberPattern>
         <numberPattern name="currency">$ z,zz9.99</numberPattern>
         <numberPattern name="percent">z,zz9%</numberPattern>
      </numberPatterns>
      <numberSymbols>
         <numberSymbol name="decimal">,</numberSymbol>
         <numberSymbol name="grouping">.</numberSymbol>
         <numberSymbol name="percent">%</numberSymbol>
         <numberSymbol name="minus">-</numberSymbol>
         <numberSymbol name="zero">0</numberSymbol>
      </numberSymbols>
      <currencySymbols>
         <currencySymbol name="symbol">€</currencySymbol>
         <currencySymbol name="isoname">EUR</currencySymbol>
         <currencySymbol name="decimal">,</currencySymbol>
      </currencySymbols>
      <typefaces>
         <typeface name="Myriad Pro"/>
         <typeface name="Minion Pro"/>
         <typeface name="Courier Std"/>
         <typeface name="Adobe Pi Std"/>
         <typeface name="Adobe Hebrew"/>
         <typeface name="Adobe Arabic"/>
         <typeface name="Adobe Thai"/>
         <typeface name="Kozuka Gothic Pro-VI M"/>
         <typeface name="Kozuka Mincho Pro-VI R"/>
         <typeface name="Adobe Ming Std L"/>
         <typeface name="Adobe Song Std L"/>
         <typeface name="Adobe Myungjo Std M"/>
      </typefaces>
   </locale>
   <?originalXFAVersion http://www.xfa.org/schema/xfa-locale-set/2.6/?></localeSet>
<connectionSet xmlns="http://www.xfa.org/schema/xfa-connection-set/2.8/">
   <xsdConnection name="DataConnection-v1.0.0" dataDescription="MOD">
      <uri>..\Schemas\MODsigit-schema-v2.1.0.xsd</uri>
      <rootElement>MOD</rootElement>
      <?templateDesigner fileDigest shaHash="jieleSdNfLigpEe8fJWoD+MedMs="?></xsdConnection>
</connectionSet>
<xfa:datasets xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/">
   <xfa:data xfa:dataNode="dataGroup"/>
   <dd:dataDescription xmlns:dd="http://ns.adobe.com/data-description/" dd:name="MOD">
      <MOD xmlns="http://www.csi.it/sigit/sigitwebn/xml/libretto/data">
         <Richiesta>
            <datiPrecompilati>
               <data_aggiornamento/>
               <statoModulo/>
               <codice_impianto/>
               <codiceCatasto/>
               <L1_2indirizzo/>
               <L1_2civico/>
               <L1_2palazzo/>
               <L1_2scala/>
               <L1_2interno/>
               <L1_2comune/>
               <L1_2prov/>
               <sezCatasto>
                  <rowCatasto dd:maxOccur="-1">
                     <L1_2sezione/>
                     <L1_2foglio/>
                     <L1_2particella/>
                     <L1_2sub/>
                     <L1_2pod/>
                     <L1_2pdr/>
                  </rowCatasto>
               </sezCatasto>
               <L1_6cognome/>
               <L1_6nome/>
               <L1_6cf/>
               <L1_6ragSociale/>
               <L1_6piva/>
               <sezNomine>
                  <rowNomine dd:maxOccur="-1">
                     <L3cognome/>
                     <L3nome/>
                     <L3codiceFiscale/>
                     <L3ragioneSociale/>
                     <L3piva/>
                     <L3flagProprietario/>
                     <L3flagAmministratore/>
                     <L3ragSocialeDitta/>
                     <L3cciaa/>
                     <L3dataValiditaContrattoDal/>
                     <L3dataValiditaContrattoAl/>
                     <L3apparecchiature/>
                  </rowNomine>
               </sezNomine>
               <elencoFabbricante>
                  <fabbricante dd:maxOccur="-1">
                     <codice/>
                     <descrizione/>
                  </fabbricante>
               </elencoFabbricante>
               <elencoCombustibile>
                  <combustibile dd:maxOccur="-1">
                     <codice/>
                     <descrizione/>
                  </combustibile>
               </elencoCombustibile>
               <elencoFluidoTermoVett>
                  <fluidoTermoVett dd:maxOccur="-1">
                     <codice/>
                     <descrizione/>
                  </fluidoTermoVett>
               </elencoFluidoTermoVett>
               <elencoUM>
                  <unitaMisura dd:maxOccur="-1">
                     <codice/>
                     <descrizione/>
                  </unitaMisura>
               </elencoUM>
            </datiPrecompilati>
            <datiModulo>
               <flag_controllo_bozza/>
            </datiModulo>
            <datiSchedaIdentificativaImp>
               <L1_1dataIntervento/>
               <L1_1flagNuovaInst/>
               <L1_1flagRistrutt/>
               <L1_1flagSostGenerat/>
               <L1_1flagCompilaLibretto/>
               <L1_2flagUnitaImmSingle/>
               <L1_2flagE1/>
               <L1_2flagE2/>
               <L1_2flagE3/>
               <L1_2flagE4/>
               <L1_2flagE5/>
               <L1_2flagE6/>
               <L1_2flagE7/>
               <L1_2flagE8/>
               <L1_2volLordoRisc/>
               <L1_2volLordoRaffr/>
               <L1_3flagProdACS/>
               <L1_3potUtileACS/>
               <L1_3flagClimaInv/>
               <L1_3potUtileClimaInv/>
               <L1_3flagClimaEst/>
               <L1_3potUtileClimaEst/>
               <L1_3flagAltro/>
               <L1_3descrAltro/>
               <L1_4flagH2O/>
               <L1_4flagAria/>
               <L1_4flagAltro/>
               <L1_4descrAltro/>
               <L1_5flagGeneratCombu/>
               <L1_5flagPompaCal/>
               <L1_5flagMaccFrigo/>
               <L1_5flagTelerisc/>
               <L1_5flagTeleraffr/>
               <L1_5flagCogener/>
               <L1_5flagAltro/>
               <L1_5descrAltro/>
               <L1_5flagPannelliSol/>
               <L1_5superfLordaTot/>
               <L1_5flagAltraIntegraz/>
               <L1_5descrAltrIntegraz/>
               <L1_5potUtile/>
               <L1_5flagClimaInv/>
               <L1_5flagClimaEst/>
               <L1_5flagProdACS/>
               <L1_5flagAltroPer/>
               <L1_5descrAltroPer/>
            </datiSchedaIdentificativaImp>
            <datiSchedaTrattH2O>
               <L2_1contenutoH2OimpClima/>
               <L2_2durezzaTotaleH2O/>
               <L2_3flagAssenteH2Oclima/>
               <L2_3flagFiltrazione/>
               <L2_3flagAddolcimento/>
               <L2_3durezzaTotaleH2O/>
               <L2_3flagCondizChimico/>
               <L2_3flagAssenteProtGelo/>
               <L2_3flagGlicoleEtilenic/>
               <L2_3percConcentrazEtilenic/>
               <L2_3PHconcentrazEtilenic/>
               <L2_3flagGlicolePropLenic/>
               <L2_3percConcentrazPropLenic/>
               <L2_3PHconcentrazPropLenic/>
               <L2_4flagAssente/>
               <L2_4flagFiltrazione/>
               <L2_4flagAddolcimento/>
               <L2_4durezzaTotaleAddolcit/>
               <L2_4flagCondizChimico/>
               <L2_5flagAssente/>
               <L2_5flagSenzaRecupTerm/>
               <L2_5flagRecupTermParz/>
               <L2_5flagRecupTermTot/>
               <L2_5flagAcquedotto/>
               <L2_5flagPozzo/>
               <L2_5flagAcquaSuperficiale/>
               <L2_5flagFiltrazione/>
               <L2_5flagFiltrazSicurezza/>
               <L2_5flagFiltrazMasse/>
               <L2_5flagFiltrazAltro/>
               <L2_5filtrazioneAltro/>
               <L2_5flagFiltrazNoTrattam/>
               <L2_5flagTrattamentoH2O/>
               <L2_5flagTrattAddolcim/>
               <L2_5flagTrattOsmosi/>
               <L2_5flagTrattDemineralizz/>
               <L2_5flagTrattAltro/>
               <L2_5trattamentoAltro/>
               <L2_5flagTrattNoTrattam/>
               <L2_5flagCondizChimico/>
               <L2_5flagCondChimAnticrosta/>
               <L2_5flagCondChimAnticorr/>
               <L2_5flagCondChimAnticrostaAntiCorr/>
               <L2_5flagCondChimBiocida/>
               <L2_5flagCondChimAltro/>
               <L2_5condChimAltro/>
               <L2_5flagCondChimNoTrattam/>
               <L2_5flagPrefSpurgoAutom/>
               <L2_5conducibH2Oingresso/>
               <L2_5taraturaSpurgo/>
            </datiSchedaTrattH2O>
            <datiSchedaGT>
               <sezGruppiTermici>
                  <rowGT dd:maxOccur="-1">
                     <L4_1dataControllo/>
                     <flagDismissione/>
                     <flagAnnullaDismissione/>
                     <flagGiaPresenteDB/>
                     <L4_1numGT/>
                     <L4_1dataInstallaz/>
                     <L4_1dataDismiss/>
                     <L4_1fabbricante/>
                     <L4_1modello/>
                     <L4_1matricola/>
                     <L4_1combustibile/>
                     <L4_1fluidoTermoVett/>
                     <L4_1potTermUtileMax/>
                     <L4_1percRendimTermUtileMax/>
                     <L4_1GTsingolo/>
                     <L4_1GTModulare/>
                     <L4_1numAnalisiFumi/>
                     <L4_1tupoRadiante/>
                     <L4_1GenAriaCalda/>
                     <L4_1manutenzioneAnni/>
                     <sezGTsostituite>
                        <rowGTsost dd:minOccur="0" dd:maxOccur="-1">
                           <L4_1dataControllo/>
                           <flagRollBack4_1/>
                           <L4_1dataInstallaz/>
                           <L4_1dataDismiss/>
                           <L4_1fabbricante/>
                           <L4_1modello/>
                           <L4_1matricola/>
                           <L4_1combustibile/>
                           <L4_1fluidoTermoVett/>
                           <L4_1potTermUtileMax/>
                           <L4_1percRendimTermUtileMax/>
                           <L4_1GTsingolo/>
                           <L4_1GTModulare/>
                           <L4_1numAnalisiFumi/>
                           <L4_1tupoRadiante/>
                           <L4_1GenAriaCalda/>
                           <L4_1manutenzioneAnni/>
                        </rowGTsost>
                     </sezGTsostituite>
                  </rowGT>
               </sezGruppiTermici>
            </datiSchedaGT>
            <datiSchedaBR>
               <sezBR>
                  <rowBR dd:maxOccur="-1">
                     <flagDismissione/>
                     <flagAnnullaDismissione/>
                     <L4_2numBR/>
                     <L4_2numGT/>
                     <L4_2dataInstallaz/>
                     <L4_2dataDismiss/>
                     <L4_2fabbricante/>
                     <L4_2modello/>
                     <L4_2matricola/>
                     <L4_2tipologia/>
                     <L4_2combustibile/>
                     <L4_2portataTermMaxNom/>
                     <L4_2portataTermMinNom/>
                     <sezBRsostituite>
                        <rowBRsost dd:minOccur="0" dd:maxOccur="-1">
                           <flagRollBack4_2/>
                           <L4_2numGT/>
                           <L4_2dataInstallaz/>
                           <L4_2dataDismiss/>
                           <L4_2fabbricante/>
                           <L4_2modello/>
                           <L4_2matricola/>
                           <L4_2tipologia/>
                           <L4_2combustibile/>
                           <L4_2portataTermMaxNom/>
                           <L4_2portataTermMinNom/>
                        </rowBRsost>
                     </sezBRsostituite>
                  </rowBR>
               </sezBR>
            </datiSchedaBR>
            <datiSchedaRC>
               <sezRC>
                  <rowRC dd:maxOccur="-1">
                     <flagDismissione/>
                     <flagAnnullaDismissione/>
                     <L4_3numRC/>
                     <L4_3numGT/>
                     <L4_3dataInstallaz/>
                     <L4_3dataDismiss/>
                     <L4_3fabbricante/>
                     <L4_3modello/>
                     <L4_3matricola/>
                     <L4_3potTermNomTot/>
                     <sezRCsostituite>
                        <rowRCsost dd:minOccur="0" dd:maxOccur="-1">
                           <flagRollBack4_3/>
                           <L4_3numGT/>
                           <L4_3dataInstallaz/>
                           <L4_3dataDismiss/>
                           <L4_3fabbricante/>
                           <L4_3modello/>
                           <L4_3matricola/>
                           <L4_3potTermNomTot/>
                        </rowRCsost>
                     </sezRCsostituite>
                  </rowRC>
               </sezRC>
            </datiSchedaRC>
            <datiSchedaGF>
               <sezGF>
                  <rowGF dd:maxOccur="-1">
                     <L4_4dataControllo/>
                     <flagDismissione/>
                     <flagAnnullaDismissione/>
                     <flagGiaPresenteDB/>
                     <L4_4numGF/>
                     <L4_4dataInstallaz/>
                     <L4_4dataDismiss/>
                     <L4_4fabbricante/>
                     <L4_4modello/>
                     <L4_4matricola/>
                     <L4_4flagSorgARIA/>
                     <L4_4flagSorgACQUA/>
                     <L4_4fluidoFrigo/>
                     <L4_4flagFluidoARIA/>
                     <L4_4flagFluidoACQUA/>
                     <L4_4flagRecupCalore/>
                     <L4_4flagFiammaDiretta/>
                     <L4_4tipoCombustibile/>
                     <L4_4flagCicloCompress/>
                     <L4_4numCircuiti/>
                     <L4_4raffrescam/>
                     <L4_4potFrigoNom/>
                     <L4_4potFrigoAssorb/>
                     <L4_4riscaldam/>
                     <L4_4potTermNom/>
                     <L4_4potTermAssorb/>
                     <L4_4manutenzioneAnni/>
                     <sezGFsostituite>
                        <rowGFsost dd:minOccur="0" dd:maxOccur="-1">
                           <L4_4dataControllo/>
                           <flagRollBack4_4/>
                           <L4_4dataInstallaz/>
                           <L4_4dataDismiss/>
                           <L4_4fabbricante/>
                           <L4_4modello/>
                           <L4_4matricola/>
                           <L4_4flagSorgARIA/>
                           <L4_4flagSorgACQUA/>
                           <L4_4fluidoFrigo/>
                           <L4_4flagFluidoARIA/>
                           <L4_4flagFluidoACQUA/>
                           <L4_4flagRecupCalore/>
                           <L4_4flagFiammaDiretta/>
                           <L4_4tipoCombustibile/>
                           <L4_4flagCicloCompress/>
                           <L4_4numCircuiti/>
                           <L4_4raffrescam/>
                           <L4_4potFrigoNom/>
                           <L4_4potFrigoAssorb/>
                           <L4_4riscaldam/>
                           <L4_4potTermNom/>
                           <L4_4potTermAssorb/>
                           <L4_4manutenzioneAnni/>
                        </rowGFsost>
                     </sezGFsostituite>
                  </rowGF>
               </sezGF>
            </datiSchedaGF>
            <datiSchedaSC>
               <sezSC>
                  <rowSC dd:maxOccur="-1">
                     <L4_5dataControllo/>
                     <flagDismissione/>
                     <flagAnnullaDismissione/>
                     <flagGiaPresenteDB/>
                     <L4_5numSC/>
                     <L4_5dataInstallaz/>
                     <L4_5dataDismiss/>
                     <L4_5fabbricante/>
                     <L4_5modello/>
                     <L4_5matricola/>
                     <L4_5potTermNomTot/>
                     <L4_5manutenzioneAnni/>
                     <sezSCsostituite>
                        <rowSCsost dd:minOccur="0" dd:maxOccur="-1">
                           <L4_5dataControllo/>
                           <flagRollBack4_5/>
                           <L4_5dataInstallaz/>
                           <L4_5dataDismiss/>
                           <L4_5fabbricante/>
                           <L4_5modello/>
                           <L4_5matricola/>
                           <L4_5potTermNomTot/>
                           <L4_5manutenzioneAnni/>
                        </rowSCsost>
                     </sezSCsostituite>
                  </rowSC>
               </sezSC>
            </datiSchedaSC>
            <datiSchedaCG>
               <sezCG>
                  <rowCG dd:maxOccur="-1">
                     <L4_6dataControllo/>
                     <flagDismissione/>
                     <flagAnnullaDismissione/>
                     <flagGiaPresenteDB/>
                     <L4_6numCG/>
                     <L4_6dataInstallaz/>
                     <L4_6dataDismiss/>
                     <L4_6fabbricante/>
                     <L4_6modello/>
                     <L4_6matricola/>
                     <L4_6tipologia/>
                     <L4_6combustibile/>
                     <L4_6potTermNom/>
                     <L4_6potElettrNom/>
                     <L4_6tempAcquaUscitaMIN/>
                     <L4_6tempAcquaUscitaMAX/>
                     <L4_6tempFumiValleMIN/>
                     <L4_6tempFumiValleMAX/>
                     <L4_6tempAcquaIngressoMIN/>
                     <L4_6tempAcquaIngressoMAX/>
                     <L4_6tempFumiMonteMIN/>
                     <L4_6tempFumiMonteMAX/>
                     <L4_6tempAcquaMotoreMIN/>
                     <L4_6tempAcquaMotoreMAX/>
                     <L4_6emissioniMonossidoMIN/>
                     <L4_6emissioniMonossidoMAX/>
                     <L4_6manutenzioneAnni/>
                     <sezCGsostituite>
                        <rowCGsost dd:minOccur="0" dd:maxOccur="-1">
                           <L4_6dataControllo/>
                           <flagRollBack4_6/>
                           <L4_6dataInstallaz/>
                           <L4_6dataDismiss/>
                           <L4_6fabbricante/>
                           <L4_6modello/>
                           <L4_6matricola/>
                           <L4_6tipologia/>
                           <L4_6combustibile/>
                           <L4_6potTermNom/>
                           <L4_6potElettrNom/>
                           <L4_6tempAcquaUscitaMIN/>
                           <L4_6tempAcquaUscitaMAX/>
                           <L4_6tempFumiValleMIN/>
                           <L4_6tempFumiValleMAX/>
                           <L4_6tempAcquaIngressoMIN/>
                           <L4_6tempAcquaIngressoMAX/>
                           <L4_6tempFumiMonteMIN/>
                           <L4_6tempFumiMonteMAX/>
                           <L4_6tempAcquaMotoreMIN/>
                           <L4_6tempAcquaMotoreMAX/>
                           <L4_6emissioniMonossidoMIN/>
                           <L4_6emissioniMonossidoMAX/>
                           <L4_6manutenzioneAnni/>
                        </rowCGsost>
                     </sezCGsostituite>
                  </rowCG>
               </sezCG>
            </datiSchedaCG>
            <datiSchedaCS>
               <sezCS>
                  <rowCS dd:maxOccur="-1">
                     <flagDismissione/>
                     <flagAnnullaDismissione/>
                     <L4_7numCS/>
                     <L4_7dataInstallaz/>
                     <L4_7dataDismissione/>
                     <L4_7fabbricante/>
                     <L4_7collettori/>
                     <L4_7superfTotApertura/>
                     <sezCSvariate>
                        <rowCSvar dd:minOccur="0" dd:maxOccur="-1">
                           <flagRollBack4_7/>
                           <L4_7dataInstallaz/>
                           <L4_7dataDismissione/>
                           <L4_7fabbricante/>
                           <L4_7collettori/>
                           <L4_7superfTotApertura/>
                        </rowCSvar>
                     </sezCSvariate>
                  </rowCS>
               </sezCS>
            </datiSchedaCS>
            <datiSchedaAG>
               <sezAG>
                  <rowAG dd:maxOccur="-1">
                     <flagDismissione/>
                     <flagAnnullaDismissione/>
                     <L4_8numAG/>
                     <L4_8dataInstallaz/>
                     <L4_8dataDismiss/>
                     <L4_8fabbricante/>
                     <L4_8modello/>
                     <L4_8matricola/>
                     <L4_8tipologia/>
                     <L4_8potUtile/>
                     <sezAGsostituite>
                        <rowAGsost dd:minOccur="0" dd:maxOccur="-1">
                           <flagRollBack4_8/>
                           <L4_8dataInstallaz/>
                           <L4_8dataDismiss/>
                           <L4_8fabbricante/>
                           <L4_8modello/>
                           <L4_8matricola/>
                           <L4_8tipologia/>
                           <L4_8potUtile/>
                        </rowAGsost>
                     </sezAGsostituite>
                  </rowAG>
               </sezAG>
            </datiSchedaAG>
            <datiSchedaSistemiRegolaz>
               <regolazionePrimaria>
                  <L5_1flagRegolazOnOff/>
                  <L5_1flagRegolazCurvaIntegr/>
                  <L5_1flagRegolazCurvaIndipen/>
                  <sezSR>
                     <rowSR dd:maxOccur="-1">
                        <flagDismissione/>
                        <L5_1numSR/>
                        <L5_1dataInstallaz/>
                        <L5_1dataDismiss/>
                        <L5_1fabbricante/>
                        <L5_1modello/>
                        <L5_1numPuntiReg/>
                        <L5_1numLivTemp/>
                        <sezSRsostituite>
                           <rowSRsost dd:minOccur="0" dd:maxOccur="-1">
                              <L5_1dataInstallaz/>
                              <L5_1dataDismiss/>
                              <L5_1fabbricante/>
                              <L5_1modello/>
                              <L5_1numPuntiReg/>
                              <L5_1numLivTemp/>
                           </rowSRsost>
                        </sezSRsostituite>
                     </rowSR>
                  </sezSR>
                  <L5_1flagValvoleReg/>
                  <sezVR>
                     <rowVR dd:maxOccur="-1">
                        <flagDismissione/>
                        <L5_1numVR/>
                        <L5_1dataInstallaz/>
                        <L5_1dataDismiss/>
                        <L5_1fabbricante/>
                        <L5_1modello/>
                        <L5_1numVie/>
                        <L5_1servomotore/>
                        <sezVRsostituite>
                           <rowVRsost dd:minOccur="0" dd:maxOccur="-1">
                              <L5_1dataInstallaz/>
                              <L5_1dataDismiss/>
                              <L5_1fabbricante/>
                              <L5_1modello/>
                              <L5_1numVie/>
                              <L5_1servomotore/>
                           </rowVRsost>
                        </sezVRsostituite>
                     </rowVR>
                  </sezVR>
                  <L5_1flagRegMultiGrad/>
                  <L5_1flagRegInverter/>
                  <L5_1flagAltriSistRegPrim/>
                  <L5_1descrSistema/>
               </regolazionePrimaria>
               <regolazioneSingoloAmb>
                  <L5_2flagTermostatoOnOff/>
                  <L5_2flagTermostatoProporz/>
                  <L5_2flagControlEntalpico/>
                  <L5_2flagControlPortata/>
                  <L5_2flagValvTermostSI/>
                  <L5_2flagValvTermostNO/>
                  <L5_2flagValvDueVieSI/>
                  <L5_2flagValvDueVieNO/>
                  <L5_2flagValvTreVieSI/>
                  <L5_2flagValvTreVieNO/>
                  <L5_2note/>
                  <L5_3flagTeleLetturaSI/>
                  <L5_3flagTeleLetturaNO/>
                  <L5_3flagTeleGestioneSI/>
                  <L5_3flagTeleGestioneNO/>
                  <L5_3descrSistema/>
                  <L5_3dataSostituzione/>
                  <L5_3descrSistemaSost/>
                  <L5_4flagUIcontabilizzSI/>
                  <L5_4flagUIcontabilizzNO/>
                  <L5_4flagSistemaDiretto/>
                  <L5_4flagSistemaIndiretto/>
                  <L5_4flagRiscald/>
                  <L5_4flagRaffresc/>
                  <L5_4flagACS/>
                  <L5_4descrSistema/>
                  <L5_4dataSostituzione/>
                  <L5_4descrSistemaSost/>
               </regolazioneSingoloAmb>
            </datiSchedaSistemiRegolaz>
            <datiSchedaSistemiDistrib>
               <L6_1flagVerticale/>
               <L6_1flagOrizzontale/>
               <L6_1flagCanaliAria/>
               <L6_1flagAltro/>
               <L6_1DescrAltro/>
               <L6_2flagCoibentNO/>
               <L6_2flagCoibentSI/>
               <L6_2note/>
               <sezVasi>
                  <rowVasi dd:maxOccur="-1">
                     <L6_3codice/>
                     <L6_3capacita/>
                     <L6_3vasoAperto/>
                     <L6_3vasoChiuso/>
                     <L6_3pressione/>
                  </rowVasi>
               </sezVasi>
               <sezPO>
                  <rowPO dd:maxOccur="-1">
                     <flagDismissione/>
                     <L6_4numPO/>
                     <L6_4dataInstallaz/>
                     <L6_4dataDismiss/>
                     <L6_4fabbricante/>
                     <L6_4modello/>
                     <L6_4GiriVarSI/>
                     <L6_4GiriVarNO/>
                     <L6_4potNominale/>
                     <sezPOsostituite>
                        <rowPOsost dd:minOccur="0" dd:maxOccur="-1">
                           <L6_4dataInstallaz/>
                           <L6_4dataDismiss/>
                           <L6_4fabbricante/>
                           <L6_4modello/>
                           <L6_4GiriVarSI/>
                           <L6_4GiriVarNO/>
                           <L6_4potNominale/>
                        </rowPOsost>
                     </sezPOsostituite>
                  </rowPO>
               </sezPO>
            </datiSchedaSistemiDistrib>
            <datiSchedaSistemaEmissione>
               <L7flagRadiatori/>
               <L7flagTermoConvett/>
               <L7flagVentilConvett/>
               <L7flagPannelRadianti/>
               <L7flagBocchette/>
               <L7flagStrisce/>
               <L7flagTravi/>
               <L7flagAltro/>
               <L7descrAltro/>
            </datiSchedaSistemaEmissione>
            <datiSchedaSistemaAC>
               <sezAC>
                  <rowAC dd:maxOccur="-1">
                     <flagDismissione/>
                     <L8_1numAC/>
                     <L8_1dataInstallaz/>
                     <L8_1dataDismiss/>
                     <L8_1fabbricante/>
                     <L8_1modello/>
                     <L8_1matricola/>
                     <L8_1capacita/>
                     <L8_1flagACS/>
                     <L8_1flagRiscald/>
                     <L8_1flagRaffresc/>
                     <L8_1flagCoibentNO/>
                     <L8_1flagCoibentSI/>
                     <sezACsostituite>
                        <rowACsost dd:minOccur="0" dd:maxOccur="-1">
                           <L8_1dataInstallaz/>
                           <L8_1dataDismiss/>
                           <L8_1fabbricante/>
                           <L8_1modello/>
                           <L8_1matricola/>
                           <L8_1capacita/>
                           <L8_1flagACS/>
                           <L8_1flagRiscald/>
                           <L8_1flagRaffresc/>
                           <L8_1flagCoibentNO/>
                           <L8_1flagCoibentSI/>
                        </rowACsost>
                     </sezACsostituite>
                  </rowAC>
               </sezAC>
            </datiSchedaSistemaAC>
            <datiAltriComponentiTE>
               <sezTE>
                  <rowTE dd:maxOccur="-1">
                     <flagDismissione/>
                     <L9_1numTE/>
                     <L9_1dataInstallaz/>
                     <L9_1dataDismiss/>
                     <L9_1fabbricante/>
                     <L9_1modello/>
                     <L9_1matricola/>
                     <L9_1capacita/>
                     <L9_1numVentilatori/>
                     <L9_1tipoVentilatori/>
                     <sezTEsostituite>
                        <rowTEsost dd:minOccur="0" dd:maxOccur="-1">
                           <L9_1dataInstallaz/>
                           <L9_1dataDismiss/>
                           <L9_1fabbricante/>
                           <L9_1modello/>
                           <L9_1matricola/>
                           <L9_1capacita/>
                           <L9_1numVentilatori/>
                           <L9_1tipoVentilatori/>
                        </rowTEsost>
                     </sezTEsostituite>
                  </rowTE>
               </sezTE>
            </datiAltriComponentiTE>
            <datiAltriComponentiRV>
               <sezRV>
                  <rowRV dd:maxOccur="-1">
                     <flagDismissione/>
                     <L9_2numRV/>
                     <L9_2dataInstallaz/>
                     <L9_2dataDismiss/>
                     <L9_2fabbricante/>
                     <L9_2modello/>
                     <L9_2matricola/>
                     <L9_2numVentilatori/>
                     <L9_2tipoVentilatori/>
                     <sezRVsostituite>
                        <rowRVsost dd:minOccur="0" dd:maxOccur="-1">
                           <L9_2dataInstallaz/>
                           <L9_2dataDismiss/>
                           <L9_2fabbricante/>
                           <L9_2modello/>
                           <L9_2matricola/>
                           <L9_2numVentilatori/>
                           <L9_2tipoVentilatori/>
                        </rowRVsost>
                     </sezRVsostituite>
                  </rowRV>
               </sezRV>
            </datiAltriComponentiRV>
            <datiAltriComponentiSC>
               <sezSC>
                  <rowSCcal dd:maxOccur="-1">
                     <flagDismissione/>
                     <L9_3numSC/>
                     <L9_3dataInstallaz/>
                     <L9_3dataDismiss/>
                     <L9_3fabbricante/>
                     <L9_3modello/>
                     <sezSCsostituite>
                        <rowSCcalsost dd:minOccur="0" dd:maxOccur="-1">
                           <L9_3dataInstallaz/>
                           <L9_3dataDismiss/>
                           <L9_3fabbricante/>
                           <L9_3modello/>
                        </rowSCcalsost>
                     </sezSCsostituite>
                  </rowSCcal>
               </sezSC>
            </datiAltriComponentiSC>
            <datiAltriComponentiCI>
               <sezCI>
                  <rowCI dd:maxOccur="-1">
                     <flagDismissione/>
                     <L9_4numCI/>
                     <L9_4dataInstallaz/>
                     <L9_4dataDismiss/>
                     <L9_4lungCircuito/>
                     <L9_4superfScamb/>
                     <L9_4profInstallaz/>
                     <sezCIsostituite>
                        <rowCIsost dd:minOccur="0" dd:maxOccur="-1">
                           <L9_4dataInstallaz/>
                           <L9_4dataDismiss/>
                           <L9_4lungCircuito/>
                           <L9_4superfScamb/>
                           <L9_4profInstallaz/>
                        </rowCIsost>
                     </sezCIsostituite>
                  </rowCI>
               </sezCI>
            </datiAltriComponentiCI>
            <datiAltriComponentiRC>
               <sezRC>
                  <rowRCcal dd:maxOccur="-1">
                     <flagDismissione/>
                     <L9_6numRC/>
                     <L9_6dataInstallaz/>
                     <L9_6dataDismiss/>
                     <L9_6tipologia/>
                     <L9_6flagInstallato/>
                     <L9_6flagIndipendente/>
                     <L9_6portataVentMandata/>
                     <L9_6portataVentRipresa/>
                     <L9_6potenzaVentMandata/>
                     <L9_6potenzaVentRipresa/>
                     <sezRCsostituite>
                        <rowRCcalsost dd:minOccur="0" dd:maxOccur="-1">
                           <L9_6dataInstallaz/>
                           <L9_6dataDismiss/>
                           <L9_6tipologia/>
                           <L9_6flagInstallato/>
                           <L9_6flagIndipendente/>
                           <L9_6portataVentMandata/>
                           <L9_6portataVentRipresa/>
                           <L9_6potenzaVentMandata/>
                           <L9_6potenzaVentRipresa/>
                        </rowRCcalsost>
                     </sezRCsostituite>
                  </rowRCcal>
               </sezRC>
            </datiAltriComponentiRC>
            <datiAltriComponentiUT>
               <sezUT>
                  <rowUT dd:maxOccur="-1">
                     <flagDismissione/>
                     <L9_5numUT/>
                     <L9_5dataInstallaz/>
                     <L9_5dataDismiss/>
                     <L9_5fabbricante/>
                     <L9_5modello/>
                     <L9_5matricola/>
                     <L9_5portataVentMandata/>
                     <L9_5portataVentRipresa/>
                     <L9_5potenzaVentMandata/>
                     <L9_5potenzaVentRipresa/>
                     <sezUTsostituite>
                        <rowUTsost dd:minOccur="0" dd:maxOccur="-1">
                           <L9_5dataInstallaz/>
                           <L9_5dataDismiss/>
                           <L9_5fabbricante/>
                           <L9_5modello/>
                           <L9_5matricola/>
                           <L9_5portataVentMandata/>
                           <L9_5portataVentRipresa/>
                           <L9_5potenzaVentMandata/>
                           <L9_5potenzaVentRipresa/>
                        </rowUTsost>
                     </sezUTsostituite>
                  </rowUT>
               </sezUT>
            </datiAltriComponentiUT>
            <datiVentilazMeccanicaVM>
               <sezVM>
                  <rowVM dd:maxOccur="-1">
                     <flagDismissione/>
                     <L10_1numVM/>
                     <L10_1dataInstallaz/>
                     <L10_1dataDismiss/>
                     <L10_1fabbricante/>
                     <L10_1modello/>
                     <L10_1flagSolaEstraz/>
                     <L10_1flagFlussoIncrociato/>
                     <L10_1flagFlussoTermoDinamico/>
                     <L10_1flagAltro/>
                     <L10_1descrAltro/>
                     <L10_1maxPortataAria/>
                     <L10_1rendimentoRecupero/>
                     <sezVMsostituite>
                        <rowVMsost dd:minOccur="0" dd:maxOccur="-1">
                           <L10_1dataInstallaz/>
                           <L10_1dataDismiss/>
                           <L10_1fabbricante/>
                           <L10_1modello/>
                           <L10_1flagSolaEstraz/>
                           <L10_1flagFlussoIncrociato/>
                           <L10_1flagFlussoTermoDinamico/>
                           <L10_1flagAltro/>
                           <L10_1descrAltro/>
                           <L10_1maxPortataAria/>
                           <L10_1rendimentoRecupero/>
                        </rowVMsost>
                     </sezVMsostituite>
                  </rowVM>
               </sezVM>
            </datiVentilazMeccanicaVM>
            <datiRisultatiGT>
               <sezGruppiTermici>
                  <L11_1rowGT dd:maxOccur="-1">
                     <L11_1numGT/>
                     <L11_1flagNorma/>
                     <L11_1flagAltro/>
                     <L11_1descrAltro/>
                     <sezDateGT>
                        <rowDateGT dd:maxOccur="-1">
                           <L11_1data/>
                           <sezNumeroModuliGT>
                              <rowNumModuliGT dd:maxOccur="-1">
                                 <L11_1numModulo/>
                                 <L11_1portataTermEff/>
                                 <L11_1tempFumi/>
                                 <L11_1tempAriaComb/>
                                 <L11_1O2/>
                                 <L11_1CO2/>
                                 <L11_1indBacharach1/>
                                 <L11_1indBacharach2/>
                                 <L11_1indBacharach3/>
                                 <L11_1CO/>
                                 <L11_1portataCombu/>
                                 <L11_1nox/>
                                 <L11_1COsenzaAria/>
                                 <L11_1rendimentoCombu/>
                                 <L11_1flagIndBachSI/>
                                 <L11_1flagIndBachNO/>
                                 <L11_1flagfumiSecchiSI/>
                                 <L11_1flagfumiSecchiNO/>
                                 <L11_1percMinimoLegge/>
                                 <L11_1flagMinimoSI/>
                                 <L11_1flagMinimoNO/>
                                 <L11_1firma/>
                              </rowNumModuliGT>
                           </sezNumeroModuliGT>
                        </rowDateGT>
                     </sezDateGT>
                  </L11_1rowGT>
               </sezGruppiTermici>
            </datiRisultatiGT>
            <datiRisultatiGF>
               <sezMacchineFrigo>
                  <L11_2rowGF dd:maxOccur="-1">
                     <L11_2numGF/>
                     <sezDateGF>
                        <rowDateGF dd:maxOccur="-1">
                           <L11_2data/>
                           <sezCircuitiGF>
                              <rowCircuitiGF dd:maxOccur="-1">
                                 <L11_2numCircuito/>
                                 <L11_2flagAssenzaPerditeSI/>
                                 <L11_2flagAssenzaPerditeNO/>
                                 <L11_2flagRaffr/>
                                 <L11_2flagRisc/>
                                 <L11_2surrisc/>
                                 <L11_2sottoraffr/>
                                 <L11_2condens/>
                                 <L11_2evaporaz/>
                                 <L11_2sorgenteIngresso/>
                                 <L11_2sorgenteUscita/>
                                 <L11_2ingressoUtenze/>
                                 <L11_2usciteUtenze/>
                                 <L11_2uscitaFluido/>
                                 <L11_2bulboUmido/>
                                 <L11_2ingressoFluido/>
                                 <L11_2uscitaFluidoSorg/>
                                 <L11_2ingressoFluidoMacc/>
                                 <L11_2uscitaFluidoMacc/>
                                 <L11_2potAssorbita/>
                                 <L11_2flagFiltriSI/>
                                 <L11_2flagFiltriNO/>
                                 <L11_2flagVerificaSI/>
                                 <L11_2flagVerificaNO/>
                                 <L11_2dataRispristino/>
                                 <L11_2firma/>
                              </rowCircuitiGF>
                           </sezCircuitiGF>
                        </rowDateGF>
                     </sezDateGF>
                  </L11_2rowGF>
               </sezMacchineFrigo>
            </datiRisultatiGF>
            <datiRisultatiSC>
               <sezScambiatori>
                  <L11_3rowSC dd:maxOccur="-1">
                     <L11_3numSC/>
                     <sezSC>
                        <rowDateSC dd:maxOccur="-1">
                           <L11_3data/>
                           <L11_3tempEsterna/>
                           <L11_3tempMandPrimario/>
                           <L11_3tempRitPrimario/>
                           <L11_3tempMandSecond/>
                           <L11_3tempRitSecond/>
                           <L11_3portataFluidoPrim/>
                           <L11_3potTermica/>
                           <L11_3flagPotCompatibSI/>
                           <L11_3flagPotCompatibNO/>
                           <L11_3flagPotCompatibNC/>
                           <L11_3flagStatoCoibSI/>
                           <L11_3flagStatoCoibNO/>
                           <L11_3flagStatoCoibNC/>
                           <L11_3flagDispRegSI/>
                           <L11_3flagDispRegNO/>
                           <L11_3flagDispRegNC/>
                           <L11_3firma/>
                        </rowDateSC>
                     </sezSC>
                  </L11_3rowSC>
               </sezScambiatori>
            </datiRisultatiSC>
            <datiRisultatiCG>
               <sezCogen>
                  <L11_4rowCG dd:maxOccur="-1">
                     <L11_4numCG/>
                     <sezCG>
                        <rowDateCG dd:maxOccur="-1">
                           <L11_4data/>
                           <L11_4tempAriaComb/>
                           <L11_4tempH2Ouscita/>
                           <L11_4tempH2Oingresso/>
                           <L11_4tempH2Omotore/>
                           <L11_4tempFumiValle/>
                           <L11_4tempFumiMonte/>
                           <L11_4potElettricaMorsetti/>
                           <L11_4emissioniCO/>
                           <L11_4sovraFreqSoglia1/>
                           <L11_4sovraFreqSoglia2/>
                           <L11_4sovraFreqSoglia3/>
                           <L11_4sovraFreqTempo1/>
                           <L11_4sovraFreqTempo2/>
                           <L11_4sovraFreqTempo3/>
                           <L11_4sottoFreqSoglia1/>
                           <L11_4sottoFreqSoglia2/>
                           <L11_4sottoFreqSoglia3/>
                           <L11_4sottoFreqTempo1/>
                           <L11_4sottoFreqTempo2/>
                           <L11_4sottoFreqTempo3/>
                           <L11_4sovraTensSoglia1/>
                           <L11_4sovraTensSoglia2/>
                           <L11_4sovraTensSoglia3/>
                           <L11_4sovraTensTempo1/>
                           <L11_4sovraTensTempo2/>
                           <L11_4sovraTensTempo3/>
                           <L11_4sottoTensSoglia1/>
                           <L11_4sottoTensSoglia2/>
                           <L11_4sottoTensSoglia3/>
                           <L11_4sottoTensTempo1/>
                           <L11_4sottoTensTempo2/>
                           <L11_4sottoTensTempo3/>
                           <L11_4firma/>
                        </rowDateCG>
                     </sezCG>
                  </L11_4rowCG>
               </sezCogen>
            </datiRisultatiCG>
            <datiInterventiControllo>
               <sezInterventi>
                  <intervControllo dd:maxOccur="-1">
                     <L12dataControllo/>
                     <L12ragioneSociale/>
                     <L12cciaa/>
                     <L12tipoAllegato/>
                     <L12flagRaccSI/>
                     <L12flagRaccNO/>
                     <L12flagPrescrSI/>
                     <L12flagPrescrNO/>
                  </intervControllo>
               </sezInterventi>
            </datiInterventiControllo>
            <datiRisultatiIspez>
               <sezRisultati>
                  <rowRisultatiIspez dd:maxOccur="-1">
                     <L13dataIspez/>
                     <L13cognomeTecnico/>
                     <L13nomeTecnico/>
                     <L13codiceFiscale/>
                     <L13enteCompetente/>
                     <L13flagPositivo/>
                     <L13flagNegativo/>
                     <L13note/>
                     <L13rapportoProva/>
                     <L13firmaIspettore/>
                  </rowRisultatiIspez>
               </sezRisultati>
            </datiRisultatiIspez>
            <datiConsumoCombu>
               <sezCombu>
                  <rowCombu dd:maxOccur="-1">
                     <L14_1tipoCombu/>
                     <L14_1unitaMisura/>
                     <sezRowConsumo>
                        <rowConsumo dd:minOccur="0" dd:maxOccur="-1">
                           <L14_1esercizio1/>
                           <L14_1esercizio2/>
                           <L14_1acquisti/>
                           <L14_1letturaIniz/>
                           <L14_1letturaFinale/>
                           <L14_1consumo/>
                        </rowConsumo>
                     </sezRowConsumo>
                  </rowCombu>
               </sezCombu>
            </datiConsumoCombu>
            <datiConsumoEE>
               <sezConsumo>
                  <rowConsumoEE dd:maxOccur="-1">
                     <L14_2esercizio1/>
                     <L14_2esercizio2/>
                     <L14_2letturaIniz/>
                     <L14_2letturaFinale/>
                     <L14_2consumoTot/>
                  </rowConsumoEE>
               </sezConsumo>
            </datiConsumoEE>
            <datiConsumoH2O>
               <L14_3unitaMisura/>
               <sezConsumo>
                  <rowConsumoH2O dd:maxOccur="-1">
                     <L14_3esercizio1/>
                     <L14_3esercizio2/>
                     <L14_3letturaIniz/>
                     <L14_3letturaFinale/>
                     <L14_3consumoTot/>
                  </rowConsumoH2O>
               </sezConsumo>
            </datiConsumoH2O>
            <datiConsumoProdottiChimici>
               <sezConsumo>
                  <rowConsumoPROD dd:maxOccur="-1">
                     <L14_4esercizio1/>
                     <L14_4esercizio2/>
                     <L14_4flagCircuitoIT/>
                     <L14_4flagCircuitoACS/>
                     <L14_4flagCircuitoAltri/>
                     <L14_4nomeProdotto/>
                     <L14_4qtaConsumata/>
                     <L14_4unitaMisura/>
                  </rowConsumoPROD>
               </sezConsumo>
            </datiConsumoProdottiChimici>
            <datiInterventiManutenzione>
               <sezInterventi>
                  <rowIntervento dd:minOccur="0" dd:maxOccur="-1">
                     <L15_dataManutenzione/>
                     <L15_ragSocManutentore/>
                     <L15_cciaa/>
                     <L15_tipoIntervento/>
                     <L15_intManEntroIl/>
                     <L15_note/>
                  </rowIntervento>
               </sezInterventi>
            </datiInterventiManutenzione>
         </Richiesta>
      </MOD>
   </dd:dataDescription>
</xfa:datasets>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 4.2.1-c041 52.337767, 2008/04/13-15:41:00        ">
   <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <rdf:Description xmlns:xmp="http://ns.adobe.com/xap/1.0/" rdf:about="">
         <xmp:MetadataDate>2018-10-05T09:04:01Z</xmp:MetadataDate>
         <xmp:CreatorTool>Adobe LiveCycle Designer 11.0</xmp:CreatorTool>
      </rdf:Description>
      <rdf:Description xmlns:pdf="http://ns.adobe.com/pdf/1.3/" rdf:about="">
         <pdf:Producer>Adobe LiveCycle Designer 11.0</pdf:Producer>
      </rdf:Description>
      <rdf:Description xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/" rdf:about="">
         <xmpMM:DocumentID>uuid:637d1c42-5089-4862-9178-784641de0e7f</xmpMM:DocumentID>
         <xmpMM:InstanceID>uuid:b2299ba2-ceeb-473d-8c41-df34376277ba</xmpMM:InstanceID>
      </rdf:Description>
      <rdf:Description xmlns:dc="http://purl.org/dc/elements/1.1/" rdf:about="">
         <dc:format>application/pdf</dc:format>
      </rdf:Description>
      <rdf:Description xmlns:desc="http://ns.adobe.com/xfa/promoted-desc/" rdf:about="">
         <desc:version rdf:parseType="Resource">
            <rdf:value>8.2.1.3158.1.475346.466429</rdf:value>
            <desc:ref>/template/subform[1]</desc:ref>
         </desc:version>
      </rdf:Description>
   </rdf:RDF>
</x:xmpmeta>
<xfdf xmlns="http://ns.adobe.com/xfdf/" xml:space="preserve">
   <annots/>
</xfdf></xdp:xdp>
